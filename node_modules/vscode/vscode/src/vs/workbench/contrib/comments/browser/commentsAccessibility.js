import { __decorate, __param } from '../../../../../../../external/tslib/tslib.es6.js';
import { Disposable } from '../../../../base/common/lifecycle.js';
import { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';
import { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';
import { IAccessibleViewService } from '../../accessibility/browser/accessibleView.js';
import { AccessibilityHelpAction } from '../../accessibility/browser/accessibleViewActions.js';
import { ctxCommentEditorFocused } from './simpleCommentEditor.js';
import { CommentContextKeys } from '../common/commentContextKeys.js';
import { localizeWithPath } from '../../../../nls.js';
import { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';
import { format } from '../../../../base/common/strings.js';
import { getActiveElement } from '../../../../base/browser/dom.js';
import { ToggleTabFocusModeAction } from '../../../../editor/contrib/toggleTabFocusMode/browser/toggleTabFocusMode.js';
var CommentAccessibilityHelpNLS;
( (function(CommentAccessibilityHelpNLS) {
    CommentAccessibilityHelpNLS.intro = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'intro',
        "The editor contains commentable range(s). Some useful commands include:"
    ));
    CommentAccessibilityHelpNLS.introWidget = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'introWidget',
        "This widget contains a text area, for composition of new comments, and actions, that can be tabbed to once tab moves focus mode has been enabled ({0})."
    ));
    CommentAccessibilityHelpNLS.introWidgetNoKb = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'introWidgetNoKb',
        "This widget contains a text area, for composition of new comments, and actions, that can be tabbed to once tab moves focus mode has been enabled with the command Toggle Tab Key Moves Focus, which is currently not triggerable via keybinding."
    ));
    CommentAccessibilityHelpNLS.commentCommands = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'commentCommands',
        "Some useful comment commands include:"
    ));
    CommentAccessibilityHelpNLS.escape = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'escape',
        "- Dismiss Comment (Escape)"
    ));
    CommentAccessibilityHelpNLS.nextRange = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'next',
        "- Go to Next Commenting Range ({0})"
    ));
    CommentAccessibilityHelpNLS.nextRangeNoKb = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'nextNoKb',
        "- Go to Next Commenting Range, which is currently not triggerable via keybinding."
    ));
    CommentAccessibilityHelpNLS.previousRange = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'previous',
        "- Go to Previous Commenting Range ({0})"
    ));
    CommentAccessibilityHelpNLS.previousRangeNoKb = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'previousNoKb',
        "- Go to Previous Commenting Range, which is currently not triggerable via keybinding."
    ));
    CommentAccessibilityHelpNLS.nextCommentThreadKb = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'nextCommentThreadKb',
        "- Go to Next Comment Thread ({0})"
    ));
    CommentAccessibilityHelpNLS.nextCommentThreadNoKb = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'nextCommentThreadNoKb',
        "- Go to Next Comment Thread, which is currently not triggerable via keybinding."
    ));
    CommentAccessibilityHelpNLS.previousCommentThreadKb = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'previousCommentThreadKb',
        "- Go to Previous Comment Thread ({0})"
    ));
    CommentAccessibilityHelpNLS.previousCommentThreadNoKb = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'previousCommentThreadNoKb',
        "- Go to Previous Comment Thread, which is currently not triggerable via keybinding."
    ));
    CommentAccessibilityHelpNLS.addComment = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'addComment',
        "- Add Comment ({0})"
    ));
    CommentAccessibilityHelpNLS.addCommentNoKb = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'addCommentNoKb',
        "- Add Comment on Current Selection, which is currently not triggerable via keybinding."
    ));
    CommentAccessibilityHelpNLS.submitComment = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'submitComment',
        "- Submit Comment ({0})"
    ));
    CommentAccessibilityHelpNLS.submitCommentNoKb = ( localizeWithPath(
        'vs/workbench/contrib/comments/browser/commentsAccessibility',
        'submitCommentNoKb',
        "- Submit Comment, accessible via tabbing, as it's currently not triggerable with a keybinding."
    ));
})(CommentAccessibilityHelpNLS || (CommentAccessibilityHelpNLS = {})));
let CommentsAccessibilityHelpProvider = class CommentsAccessibilityHelpProvider {
    constructor(_keybindingService) {
        this._keybindingService = _keybindingService;
        this.id = "comments" ;
        this.verbositySettingKey = "accessibility.verbosity.comments" ;
        this.options = { type: "help"  };
    }
    _descriptionForCommand(commandId, msg, noKbMsg) {
        const kb = this._keybindingService.lookupKeybinding(commandId);
        if (kb) {
            return format(msg, kb.getAriaLabel());
        }
        return format(noKbMsg, commandId);
    }
    provideContent() {
        this._element = getActiveElement();
        const content = [];
        content.push(this._descriptionForCommand(ToggleTabFocusModeAction.ID, CommentAccessibilityHelpNLS.introWidget, CommentAccessibilityHelpNLS.introWidgetNoKb) + '\n');
        content.push(CommentAccessibilityHelpNLS.commentCommands);
        content.push(CommentAccessibilityHelpNLS.escape);
        content.push(this._descriptionForCommand("workbench.action.addComment" , CommentAccessibilityHelpNLS.addComment, CommentAccessibilityHelpNLS.addCommentNoKb));
        content.push(this._descriptionForCommand("editor.action.submitComment" , CommentAccessibilityHelpNLS.submitComment, CommentAccessibilityHelpNLS.submitCommentNoKb));
        content.push(this._descriptionForCommand("editor.action.nextCommentingRange" , CommentAccessibilityHelpNLS.nextRange, CommentAccessibilityHelpNLS.nextRangeNoKb));
        content.push(this._descriptionForCommand("editor.action.previousCommentingRange" , CommentAccessibilityHelpNLS.previousRange, CommentAccessibilityHelpNLS.previousRangeNoKb));
        return content.join('\n');
    }
    onClose() {
        this._element?.focus();
    }
};
CommentsAccessibilityHelpProvider = ( __decorate([
    ( __param(0, IKeybindingService))
], CommentsAccessibilityHelpProvider));
class CommentsAccessibilityHelpContribution extends Disposable {
    constructor() {
        super();
        this._register(AccessibilityHelpAction.addImplementation(110, 'comments', accessor => {
            const instantiationService = accessor.get(IInstantiationService);
            const accessibleViewService = accessor.get(IAccessibleViewService);
            accessibleViewService.show(instantiationService.createInstance(CommentsAccessibilityHelpProvider));
            return true;
        }, ( ContextKeyExpr.or(ctxCommentEditorFocused, CommentContextKeys.commentFocused))));
    }
}
export { CommentAccessibilityHelpNLS, CommentsAccessibilityHelpContribution, CommentsAccessibilityHelpProvider };
