var Gw=(ut,Vt,zt)=>{if(!Vt.has(ut))throw TypeError("Cannot "+zt)};var I=(ut,Vt,zt)=>(Gw(ut,Vt,"read from private field"),zt?zt.call(ut):Vt.get(ut)),ae=(ut,Vt,zt)=>{if(Vt.has(ut))throw TypeError("Cannot add the same private member more than once");Vt instanceof WeakSet?Vt.add(ut):Vt.set(ut,zt)},K=(ut,Vt,zt,fo)=>(Gw(ut,Vt,"write to private field"),fo?fo.call(ut,zt):Vt.set(ut,zt),zt);var Su=(ut,Vt,zt)=>(Gw(ut,Vt,"access private method"),zt);(function(){"use strict";var Zl,Rr,G0,Wn,hi,Vs,Q0,La,Wt,J0,Vn,zn,iu,jn,zs,Eu,K0,nu,bi,Hf,qn,ru,su,X0,Lr,js,ou,qs,Gs,au,$a,Js,Ks,cu,lu,uu,dn,Xs,Ys,Zs,eo,du,Na,to,Jn,Or,At,$r,fu,pu,hn,gu,Rt,Ma,Ha,Ua,ji,ro,mu,yi,Ba,Nr,Fr,vu,Va,_u,so,za,Kn,ja,qa,Mr,Ga,Qa,Hr,Ur,wu,Ja,Br,oo,ao,Ka,co,Xa,Ya,Za;class ut{constructor(e){this.executor=e,this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}let Vt=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?Zn.isErrorNoTelemetry(e)?new Zn(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}};const zt=new Vt;function fo(r){zt.setUnexpectedErrorHandler(r)}function mn(r){qr(r)||zt.onUnexpectedError(r)}function mp(r){qr(r)||zt.onUnexpectedExternalError(r)}function ku(r){if(r instanceof Error){const{name:e,message:t}=r,i=r.stacktrace||r.stack;return{$isError:!0,name:e,message:t,stack:i,noTelemetry:Zn.isErrorNoTelemetry(r)}}return r}const Du="Canceled";function qr(r){return r instanceof Gr?!0:r instanceof Error&&r.name===Du&&r.message===Du}class Gr extends Error{constructor(){super(Du),this.name=this.message}}function Zw(){const r=new Error(Du);return r.name=r.message,r}function xe(r){return r?new Error(`Illegal argument: ${r}`):new Error("Illegal argument")}function vp(r){return r?new Error(`Illegal state: ${r}`):new Error("Illegal state")}class Qr extends TypeError{constructor(e){super(e?`${e} is read-only and cannot be changed`:"Cannot change read-only property")}}class Z0 extends Error{constructor(e){super("NotImplemented"),e&&(this.message=e)}}class _p extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class Zn extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof Zn)return e;const t=new Zn;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}function er(r,e,t=(i,n)=>i===n){if(r===e)return!0;if(!r||!e||r.length!==e.length)return!1;for(let i=0,n=r.length;i<n;i++)if(!t(r[i],e[i]))return!1;return!0}function eS(r,e){const t=[];let i;for(const n of r.slice(0).sort(e))!i||e(i[0],n)!==0?(i=[n],t.push(i)):i.push(n);return t}function eb(r,e,t){const i=[];function n(a,c,l){if(c===0&&l.length===0)return;const u=i[i.length-1];u&&u.start+u.deleteCount===a?(u.deleteCount+=c,u.toInsert.push(...l)):i.push({start:a,deleteCount:c,toInsert:l})}let s=0,o=0;for(;;){if(s===r.length){n(s,0,e.slice(o));break}if(o===e.length){n(s,r.length-s,[]);break}const a=r[s],c=e[o],l=t(a,c);l===0?(s+=1,o+=1):l<0?(n(s,1,[]),s+=1):l>0&&(n(s,0,[c]),o+=1)}return i}function tS(r,e,t){const i=eb(r,e,t),n=[],s=[];for(const o of i)n.push(...r.slice(o.start,o.start+o.deleteCount)),s.push(...o.toInsert);return{removed:n,added:s}}function Jt(r){return r.filter(e=>!!e)}function iS(r){let e=0;for(let t=0;t<r.length;t++)r[t]&&(r[e]=r[t],e+=1);r.length=e}function wp(r){return!Array.isArray(r)||r.length===0}function cc(r){return Array.isArray(r)&&r.length>0}function po(r,e=t=>t){const t=new Set;return r.filter(i=>{const n=e(i);return t.has(n)?!1:(t.add(n),!0)})}function Iu(r){return[].concat(...r)}function tb(r,e){let t;if(typeof e=="number"){let i=e;t=()=>{const n=Math.sin(i++)*179426549;return n-Math.floor(n)}}else t=Math.random;for(let i=r.length-1;i>0;i-=1){const n=Math.floor(t()*(i+1)),s=r[i];r[i]=r[n],r[n]=s}}function lc(r,e){return Array.isArray(r)?r.map(e):e(r)}function uc(r){return Array.isArray(r)?r:[r]}var bp;(function(r){function e(s){return s<0}r.isLessThan=e;function t(s){return s<=0}r.isLessThanOrEqual=t;function i(s){return s>0}r.isGreaterThan=i;function n(s){return s===0}r.isNeitherLessOrGreaterThan=n,r.greaterThan=1,r.lessThan=-1,r.neitherLessOrGreaterThan=0})(bp||(bp={}));const Ia=class Ia{constructor(e){this.iterate=e}forEach(e){this.iterate(t=>(e(t),!0))}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new Ia(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new Ia(t=>this.iterate(i=>t(e(i))))}some(e){let t=!1;return this.iterate(i=>(t=e(i),!t)),t}findFirst(e){let t;return this.iterate(i=>e(i)?(t=i,!1):!0),t}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(n=>((i||bp.isGreaterThan(e(n,t)))&&(i=!1,t=n),!0)),t}};Ia.empty=new Ia(e=>{});let ib=Ia;function nS(r,e){const t=Object.create(null);for(const i of r){const n=e(i);let s=t[n];s||(s=t[n]=[]),s.push(i)}return t}function rS(r,e){const t=[],i=[];for(const n of r)e.has(n)||t.push(n);for(const n of e)r.has(n)||i.push(n);return{removed:t,added:i}}var nb,rb,sb;function sS(r,e,t){let i=r.get(e);return i===void 0&&(i=t,r.set(e,i)),i}class oS{constructor(e,t){this.uri=e,this.value=t}}function aS(r){return Array.isArray(r)}const Bs=class Bs{constructor(e,t){if(this[nb]="ResourceMap",e instanceof Bs)this.map=new Map(e.map),this.toKey=t??Bs.defaultToKey;else if(aS(e)){this.map=new Map,this.toKey=t??Bs.defaultToKey;for(const[i,n]of e)this.set(i,n)}else this.map=new Map,this.toKey=e??Bs.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new oS(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[i,n]of this.map)e(n.value,n.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[(nb=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}};Bs.defaultToKey=e=>e.toString();let pt=Bs;class ob{constructor(e,t){this[rb]="ResourceSet",!e||typeof e=="function"?this._map=new pt(e):(this._map=new pt(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((i,n)=>e.call(t,n,n,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(rb=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}}class cS{constructor(){this[sb]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let n=this._map.get(e);if(n)n.value=t,i!==0&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(n);break;case 1:this.addItemFirst(n);break;case 2:this.addItemLast(n);break;default:this.addItemLast(n);break}this._map.set(e,n),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.key,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return n}values(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.value,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return n}entries(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:[i.key,i.value],done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return n}[(sb=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(i.previous=n,n.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,n=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=n,n.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class ab extends cS{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}class lS{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}get(e){const t=this.map.get(e);return t||new Set}}function yp(r,e){const t=this;let i=!1,n;return function(){if(i)return n;if(i=!0,e)try{n=r.apply(t,arguments)}finally{e()}else n=r.apply(t,arguments);return n}}var Jr;(function(r){function e(C){return C&&typeof C=="object"&&typeof C[Symbol.iterator]=="function"}r.is=e;const t=Object.freeze([]);function i(){return t}r.empty=i;function*n(C){yield C}r.single=n;function s(C){return e(C)?C:n(C)}r.wrap=s;function o(C){return C||t}r.from=o;function*a(C){for(let R=C.length-1;R>=0;R--)yield C[R]}r.reverse=a;function c(C){return!C||C[Symbol.iterator]().next().done===!0}r.isEmpty=c;function l(C){return C[Symbol.iterator]().next().value}r.first=l;function u(C,R){for(const A of C)if(R(A))return!0;return!1}r.some=u;function d(C,R){for(const A of C)if(R(A))return A}r.find=d;function*h(C,R){for(const A of C)R(A)&&(yield A)}r.filter=h;function*g(C,R){let A=0;for(const B of C)yield R(B,A++)}r.map=g;function*w(...C){for(const R of C)yield*R}r.concat=w;function p(C,R,A){let B=A;for(const Q of C)B=R(B,Q);return B}r.reduce=p;function*b(C,R,A=C.length){for(R<0&&(R+=C.length),A<0?A+=C.length:A>C.length&&(A=C.length);R<A;R++)yield C[R]}r.slice=b;function k(C,R=Number.POSITIVE_INFINITY){const A=[];if(R===0)return[A,C];const B=C[Symbol.iterator]();for(let Q=0;Q<R;Q++){const ee=B.next();if(ee.done)return[A,r.empty()];A.push(ee.value)}return[A,{[Symbol.iterator](){return B}}]}r.consume=k;async function D(C){const R=[];for await(const A of C)R.push(A);return Promise.resolve(R)}r.asyncToArray=D})(Jr||(Jr={}));function AA(r){return r}function RA(r,e){}function Kr(r){if(Jr.is(r)){const e=[];for(const t of r)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}function cb(...r){return Le(()=>Kr(r))}function Le(r){return{dispose:yp(()=>{r()})}}const Of=class Of{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Kr(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?Of.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&this._toDispose.delete(e)}};Of.DISABLE_DISPOSED_WARNING=!1;let Ae=Of,Be=(Zl=class{constructor(){this._store=new Ae,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},Zl.None=Object.freeze({dispose(){}}),Zl);class go{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||((t=this._value)==null||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,(e=this._value)==null||e.dispose(),this._value=void 0}clearAndLeak(){const e=this._value;return this._value=void 0,e}}class lb{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Kr(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,i=!1){var n;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||(n=this._store.get(e))==null||n.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}const Pu=typeof Buffer<"u",uS=new ut(()=>new Uint8Array(256));let xp,Cp;class me{static alloc(e){return Pu?new me(Buffer.allocUnsafe(e)):new me(new Uint8Array(e))}static wrap(e){return Pu&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new me(e)}static fromString(e,t){return!((t==null?void 0:t.dontUseNodeBuffer)||!1)&&Pu?new me(Buffer.from(e)):(xp||(xp=new TextEncoder),new me(xp.encode(e)))}static fromByteArray(e){const t=me.alloc(e.length);for(let i=0,n=e.length;i<n;i++)t.buffer[i]=e[i];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let s=0,o=e.length;s<o;s++)t+=e[s].byteLength}const i=me.alloc(t);let n=0;for(let s=0,o=e.length;s<o;s++){const a=e[s];i.set(a,n),n+=a.byteLength}return i}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){const e=me.alloc(this.byteLength);return e.set(this),e}toString(){return Pu?this.buffer.toString():(Cp||(Cp=new TextDecoder),Cp.decode(this.buffer))}slice(e,t){return new me(this.buffer.subarray(e,t))}set(e,t){if(e instanceof me)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return Tu(this.buffer,e)}writeUInt32BE(e,t){Au(this.buffer,e,t)}readUInt32LE(e){return pS(this.buffer,e)}writeUInt32LE(e,t){gS(this.buffer,e,t)}readUInt8(e){return mS(this.buffer,e)}writeUInt8(e,t){vS(this.buffer,e,t)}indexOf(e,t=0){return dS(this.buffer,e instanceof me?e.buffer:e,t)}}function dS(r,e,t=0){const i=e.byteLength,n=r.byteLength;if(i===0)return 0;if(i===1)return r.indexOf(e[0]);if(i>n-t)return-1;const s=uS.value;s.fill(e.length);for(let l=0;l<e.length;l++)s[e[l]]=e.length-l-1;let o=t+e.length-1,a=o,c=-1;for(;o<n;)if(r[o]===e[a]){if(a===0){c=o;break}o--,a--}else o+=Math.max(e.length-a,s[r[o]]),a=e.length-1;return c}function hS(r,e){return r[e+0]<<0>>>0|r[e+1]<<8>>>0}function fS(r,e,t){r[t+0]=e&255,e=e>>>8,r[t+1]=e&255}function Tu(r,e){return r[e]*2**24+r[e+1]*2**16+r[e+2]*2**8+r[e+3]}function Au(r,e,t){r[t+3]=e,e=e>>>8,r[t+2]=e,e=e>>>8,r[t+1]=e,e=e>>>8,r[t]=e}function pS(r,e){return r[e+0]<<0>>>0|r[e+1]<<8>>>0|r[e+2]<<16>>>0|r[e+3]<<24>>>0}function gS(r,e,t){r[t+0]=e&255,e=e>>>8,r[t+1]=e&255,e=e>>>8,r[t+2]=e&255,e=e>>>8,r[t+3]=e&255}function mS(r,e){return r[e]}function vS(r,e,t){r[t]=e}function _S(r){let e=0,t=0,i=0;const n=new Uint8Array(Math.floor(r.length/4*3)),s=a=>{switch(t){case 3:n[i++]=e|a,t=0;break;case 2:n[i++]=e|a>>>2,e=a<<6,t=3;break;case 1:n[i++]=e|a>>>4,e=a<<4,t=2;break;default:e=a<<2,t=1}};for(let a=0;a<r.length;a++){const c=r.charCodeAt(a);if(c>=65&&c<=90)s(c-65);else if(c>=97&&c<=122)s(c-97+26);else if(c>=48&&c<=57)s(c-48+52);else if(c===43||c===45)s(62);else if(c===47||c===95)s(63);else{if(c===61)break;throw new SyntaxError(`Unexpected base64 character ${r[a]}`)}}const o=i;for(;t>0;)s(0);return me.wrap(n).slice(0,o)}const wS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function ub({buffer:r},e=!0,t=!1){const i=t?bS:wS;let n="";const s=r.byteLength%3;let o=0;for(;o<r.byteLength-s;o+=3){const a=r[o+0],c=r[o+1],l=r[o+2];n+=i[a>>>2],n+=i[(a<<4|c>>>4)&63],n+=i[(c<<2|l>>>6)&63],n+=i[l&63]}if(s===1){const a=r[o+0];n+=i[a>>>2],n+=i[a<<4&63],e&&(n+="==")}else if(s===2){const a=r[o+0],c=r[o+1];n+=i[a>>>2],n+=i[(a<<4|c>>>4)&63],n+=i[c<<2&63],e&&(n+="=")}return n}let dt=(Rr=class{constructor(e){this.element=e,this.next=Rr.Undefined,this.prev=Rr.Undefined}},Rr.Undefined=new Rr(void 0),Rr);class dc{constructor(){this._first=dt.Undefined,this._last=dt.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===dt.Undefined}clear(){let e=this._first;for(;e!==dt.Undefined;){const t=e.next;e.prev=dt.Undefined,e.next=dt.Undefined,e=t}this._first=dt.Undefined,this._last=dt.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new dt(e);if(this._first===dt.Undefined)this._first=i,this._last=i;else if(t){const s=this._last;this._last=i,i.prev=s,s.next=i}else{const s=this._first;this._first=i,i.next=s,s.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==dt.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==dt.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==dt.Undefined&&e.next!==dt.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===dt.Undefined&&e.next===dt.Undefined?(this._first=dt.Undefined,this._last=dt.Undefined):e.next===dt.Undefined?(this._last=this._last.prev,this._last.next=dt.Undefined):e.prev===dt.Undefined&&(this._first=this._first.next,this._first.prev=dt.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==dt.Undefined;)yield e.element,e=e.next}}const yS=globalThis.performance&&typeof globalThis.performance.now=="function";class vn{static create(e){return new vn(e)}constructor(e){this._now=yS&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var _t;(function(r){r.None=()=>Be.None;function e(q,U){return d(q,()=>{},0,void 0,!0,void 0,U)}r.defer=e;function t(q){return(U,J=null,j)=>{let oe=!1,ge;return ge=q(le=>{if(!oe)return ge?ge.dispose():oe=!0,U.call(J,le)},null,j),oe&&ge.dispose(),ge}}r.once=t;function i(q,U,J){return l((j,oe=null,ge)=>q(le=>j.call(oe,U(le)),null,ge),J)}r.map=i;function n(q,U,J){return l((j,oe=null,ge)=>q(le=>{U(le),j.call(oe,le)},null,ge),J)}r.forEach=n;function s(q,U,J){return l((j,oe=null,ge)=>q(le=>U(le)&&j.call(oe,le),null,ge),J)}r.filter=s;function o(q){return q}r.signal=o;function a(...q){return(U,J=null,j)=>{const oe=cb(...q.map(ge=>ge(le=>U.call(J,le))));return u(oe,j)}}r.any=a;function c(q,U,J,j){let oe=J;return i(q,ge=>(oe=U(oe,ge),oe),j)}r.reduce=c;function l(q,U){let J;const j={onWillAddFirstListener(){J=q(oe.fire,oe)},onDidRemoveLastListener(){J==null||J.dispose()}},oe=new T(j);return U==null||U.add(oe),oe.event}function u(q,U){return U instanceof Array?U.push(q):U&&U.add(q),q}function d(q,U,J=100,j=!1,oe=!1,ge,le){let Ye,Ze,kt,Qt=0,vt;const ct={leakWarningThreshold:ge,onWillAddFirstListener(){Ye=q(xi=>{Qt++,Ze=U(Ze,xi),j&&!kt&&(ft.fire(Ze),Ze=void 0),vt=()=>{const Nt=Ze;Ze=void 0,kt=void 0,(!j||Qt>1)&&ft.fire(Nt),Qt=0},typeof J=="number"?(clearTimeout(kt),kt=setTimeout(vt,J)):kt===void 0&&(kt=0,queueMicrotask(vt))})},onWillRemoveListener(){oe&&Qt>0&&(vt==null||vt())},onDidRemoveLastListener(){vt=void 0,Ye.dispose()}},ft=new T(ct);return le==null||le.add(ft),ft.event}r.debounce=d;function h(q,U=0,J){return r.debounce(q,(j,oe)=>j?(j.push(oe),j):[oe],U,void 0,!0,void 0,J)}r.accumulate=h;function g(q,U=(j,oe)=>j===oe,J){let j=!0,oe;return s(q,ge=>{const le=j||!U(ge,oe);return j=!1,oe=ge,le},J)}r.latch=g;function w(q,U,J){return[r.filter(q,U,J),r.filter(q,j=>!U(j),J)]}r.split=w;function p(q,U=!1,J=[],j){let oe=J.slice(),ge=q(Ze=>{oe?oe.push(Ze):Ye.fire(Ze)});j&&j.add(ge);const le=()=>{oe==null||oe.forEach(Ze=>Ye.fire(Ze)),oe=null},Ye=new T({onWillAddFirstListener(){ge||(ge=q(Ze=>Ye.fire(Ze)),j&&j.add(ge))},onDidAddFirstListener(){oe&&(U?setTimeout(le):le())},onDidRemoveLastListener(){ge&&ge.dispose(),ge=null}});return j&&j.add(Ye),Ye.event}r.buffer=p;function b(q,U){return(j,oe,ge)=>{const le=U(new D);return q(function(Ye){const Ze=le.evaluate(Ye);Ze!==k&&j.call(oe,Ze)},void 0,ge)}}r.chain=b;const k=Symbol("HaltChainable");class D{constructor(){this.steps=[]}map(U){return this.steps.push(U),this}forEach(U){return this.steps.push(J=>(U(J),J)),this}filter(U){return this.steps.push(J=>U(J)?J:k),this}reduce(U,J){let j=J;return this.steps.push(oe=>(j=U(j,oe),j)),this}latch(U=(J,j)=>J===j){let J=!0,j;return this.steps.push(oe=>{const ge=J||!U(oe,j);return J=!1,j=oe,ge?oe:k}),this}evaluate(U){for(const J of this.steps)if(U=J(U),U===k)break;return U}}function C(q,U,J=j=>j){const j=(...Ye)=>le.fire(J(...Ye)),oe=()=>q.on(U,j),ge=()=>q.removeListener(U,j),le=new T({onWillAddFirstListener:oe,onDidRemoveLastListener:ge});return le.event}r.fromNodeEventEmitter=C;function R(q,U,J=j=>j){const j=(...Ye)=>le.fire(J(...Ye)),oe=()=>q.addEventListener(U,j),ge=()=>q.removeEventListener(U,j),le=new T({onWillAddFirstListener:oe,onDidRemoveLastListener:ge});return le.event}r.fromDOMEventEmitter=R;function A(q){return new Promise(U=>t(q)(U))}r.toPromise=A;function B(q){const U=new T;return q.then(J=>{U.fire(J)},()=>{U.fire(void 0)}).finally(()=>{U.dispose()}),U.event}r.fromPromise=B;function Q(q,U,J){return U(J),q(j=>U(j))}r.runAndSubscribe=Q;class ee{constructor(U,J){this._observable=U,this._counter=0,this._hasChanged=!1;const j={onWillAddFirstListener:()=>{U.addObserver(this)},onDidRemoveLastListener:()=>{U.removeObserver(this)}};this.emitter=new T(j),J&&J.add(this.emitter)}beginUpdate(U){this._counter++}handlePossibleChange(U){}handleChange(U,J){this._hasChanged=!0}endUpdate(U){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function ue(q,U){return new ee(q,U).emitter.event}r.fromObservable=ue;function Re(q){return(U,J,j)=>{let oe=0,ge=!1;const le={beginUpdate(){oe++},endUpdate(){oe--,oe===0&&(q.reportChanges(),ge&&(ge=!1,U.call(J)))},handlePossibleChange(){},handleChange(){ge=!0}};q.addObserver(le),q.reportChanges();const Ye={dispose(){q.removeObserver(le)}};return j instanceof Ae?j.add(Ye):Array.isArray(j)&&j.push(Ye),Ye}}r.fromObservableLight=Re})(_t||(_t={}));const Pa=class Pa{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${Pa._idPool++}`,Pa.all.add(this)}start(e){this._stopWatch=new vn,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}};Pa.all=new Set,Pa._idPool=0;let Sp=Pa,xS=-1;class CS{constructor(e,t=Math.random().toString(18).slice(2,5)){this.threshold=e,this.name=t,this._warnCountdown=0}dispose(){var e;(e=this._stacks)==null||e.clear()}check(e,t){const i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);const n=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;let s,o=0;for(const[a,c]of this._stacks)(!s||o<c)&&(s=a,o=c);console.warn(`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${o}):`),console.warn(s)}return()=>{const s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}}class Ep{static create(){return new Ep(new Error().stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}let SS=0;class Ru{constructor(e){this.value=e,this.id=SS++}}const ES=2,kS=(r,e)=>{if(r instanceof Ru)e(r);else for(let t=0;t<r.length;t++){const i=r[t];i&&e(i)}};class T{constructor(e){var t,i,n,s;this._size=0,this._options=e,this._leakageMon=(t=this._options)!=null&&t.leakWarningThreshold?new CS(((i=this._options)==null?void 0:i.leakWarningThreshold)??xS):void 0,this._perfMon=(n=this._options)!=null&&n._profName?new Sp(this._options._profName):void 0,this._deliveryQueue=(s=this._options)==null?void 0:s.deliveryQueue}dispose(){var e,t,i,n;this._disposed||(this._disposed=!0,((e=this._deliveryQueue)==null?void 0:e.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),(i=(t=this._options)==null?void 0:t.onDidRemoveLastListener)==null||i.call(t),(n=this._leakageMon)==null||n.dispose())}get event(){return this._event??(this._event=(e,t,i)=>{var a,c,l,u;if(this._leakageMon&&this._size>this._leakageMon.threshold*3)return console.warn(`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far`),Be.None;if(this._disposed)return Be.None;t&&(e=e.bind(t));const n=new Ru(e);let s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(n.stack=Ep.create(),s=this._leakageMon.check(n.stack,this._size+1)),this._listeners?this._listeners instanceof Ru?(this._deliveryQueue??(this._deliveryQueue=new DS),this._listeners=[this._listeners,n]):this._listeners.push(n):((c=(a=this._options)==null?void 0:a.onWillAddFirstListener)==null||c.call(a,this),this._listeners=n,(u=(l=this._options)==null?void 0:l.onDidAddFirstListener)==null||u.call(l,this)),this._size++;const o=Le(()=>{s==null||s(),this._removeListener(n)});return i instanceof Ae?i.add(o):Array.isArray(i)&&i.push(o),o}),this._event}_removeListener(e){var s,o,a,c;if((o=(s=this._options)==null?void 0:s.onWillRemoveListener)==null||o.call(s,this),!this._listeners)return;if(this._size===1){this._listeners=void 0,(c=(a=this._options)==null?void 0:a.onDidRemoveLastListener)==null||c.call(a,this),this._size=0;return}const t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;const n=this._deliveryQueue.current===this;if(this._size*ES<=t.length){let l=0;for(let u=0;u<t.length;u++)t[u]?t[l++]=t[u]:n&&(this._deliveryQueue.end--,l<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=l}}_deliver(e,t){var n;if(!e)return;const i=((n=this._options)==null?void 0:n.onListenerError)||mn;if(!i){e.value(t);return}try{e.value(t)}catch(s){i(s)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){var t,i,n,s;if((t=this._deliveryQueue)!=null&&t.current&&(this._deliverQueue(this._deliveryQueue),(i=this._perfMon)==null||i.stop()),(n=this._perfMon)==null||n.start(this._size),this._listeners)if(this._listeners instanceof Ru)this._deliver(this._listeners,e);else{const o=this._deliveryQueue;o.enqueue(this,e,this._listeners.length),this._deliverQueue(o)}(s=this._perfMon)==null||s.stop()}hasListeners(){return this._size>0}}class DS{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class hc extends T{async fireAsync(e,t,i){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new dc),kS(this._listeners,n=>this._asyncDeliveryQueue.push([n.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){const[n,s]=this._asyncDeliveryQueue.shift(),o=[],a={...s,token:t,waitUntil:c=>{if(Object.isFrozen(o))throw new Error("waitUntil can NOT be called asynchronous");i&&(c=i(c,n)),o.push(c)}};try{n(a)}catch(c){mn(c);continue}await Promise.allSettled(o).then(c=>{for(const l of c)l.status==="rejected"&&mn(l.reason)})}}}class IS extends T{get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._isPaused=0,this._eventQueue=new dc,this._mergeFn=e==null?void 0:e.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class PS extends IS{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}var fc;(function(r){r[r.Desktop=1]="Desktop",r[r.Web=2]="Web"})(fc||(fc={}));function db(r){const e=me.alloc(1);switch(r){case 0:e.writeUInt8(1,0);break;case 1:e.writeUInt8(2,0);break;case 2:e.writeUInt8(3,0);break}return e}function TS(r,e){if(r.byteLength!==1)return!1;switch(r.readUInt8(0)){case 1:return e===0;case 2:return e===1;case 3:return e===2;default:return!1}}const pi=r=>{performance.mark(r)},AS=()=>{let r=performance.timeOrigin;typeof r!="number"&&(r=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);const e=[{name:"code/timeOrigin",startTime:Math.round(r)}];for(const t of performance.getEntriesByType("mark"))e.push({name:t.name,startTime:Math.round(r+t.startTime)});return e};let RS=typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function kp(r,e){let t;return e.length===0?t=r:t=r.replace(/\{(\d+)\}/g,(i,n)=>{const s=n[0],o=e[s];let a=i;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),RS&&(t="［"+t.replace(/[aouei]/g,"$&$&")+"］"),t}let LS,hb={};function m(r,e,t,...i){const n=typeof e=="object"?e.key:e,s=(hb[r]??{})[n]??t;return kp(s,i)}function fb(r,e,t,...i){const n=typeof e=="object"?e.key:e,s=(hb[r]??{})[n]??t;return{value:kp(s,i),original:kp(t,i)}}function OS(r){return LS}const Xr="en";let Lu=!1,Ou=!1,Dp=!1,pb=!1,Ip=!1,gb=!1,mb=!1,$u,Nu=Xr,vb=Xr,Ti;const _n=globalThis;let Kt;typeof _n.vscode<"u"&&typeof _n.vscode.process<"u"?Kt=_n.vscode.process:typeof process<"u"&&(Kt=process);const $S=typeof((G0=Kt==null?void 0:Kt.versions)==null?void 0:G0.electron)=="string"&&(Kt==null?void 0:Kt.type)==="renderer";if(typeof Kt=="object"){Lu=Kt.platform==="win32",Ou=Kt.platform==="darwin",Dp=Kt.platform==="linux",mb=!!Kt.env.CI||!!Kt.env.BUILD_ARTIFACTSTAGINGDIRECTORY,$u=Xr,Nu=Xr;const r=Kt.env.VSCODE_NLS_CONFIG;if(r)try{const e=JSON.parse(r),t=e.availableLanguages["*"];$u=e.locale,vb=e.osLocale,Nu=t||Xr}catch{}pb=!0}else typeof navigator=="object"&&!$S?(Ti=navigator.userAgent,Lu=Ti.indexOf("Windows")>=0,Ou=Ti.indexOf("Macintosh")>=0,gb=(Ti.indexOf("Macintosh")>=0||Ti.indexOf("iPad")>=0||Ti.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,Dp=Ti.indexOf("Linux")>=0,(Ti==null?void 0:Ti.indexOf("Mobi"))>=0,Ip=!0,OS(m("vs/base/common/platform",{key:"ensureLoaderPluginIsLoaded",comment:["{Locked}"]},"_")),$u=Xr,Nu=$u,vb=navigator.language):console.error("Unable to resolve platform.");var _b;(function(r){r[r.Web=0]="Web",r[r.Mac=1]="Mac",r[r.Linux=2]="Linux",r[r.Windows=3]="Windows"})(_b||(_b={}));function NS(r){switch(r){case 0:return"Web";case 1:return"Mac";case 2:return"Linux";case 3:return"Windows"}}const si=Lu,Ai=Ou,tr=Dp,FS=pb,Pp=Ip,pc=Ip&&typeof _n.importScripts=="function",MS=pc?_n.origin:void 0,Yr=mb,Qi=Ti,ir=Nu;var wb;(function(r){function e(){return ir}r.value=e;function t(){return ir.length===2?ir==="en":ir.length>=3?ir[0]==="e"&&ir[1]==="n"&&ir[2]==="-":!1}r.isDefaultVariant=t;function i(){return ir==="en"}r.isDefault=i})(wb||(wb={}));const HS=typeof _n.postMessage=="function"&&!_n.importScripts,bb=(()=>{if(HS){const r=[];_n.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,n=r.length;i<n;i++){const s=r[i];if(s.id===t.data.vscodeScheduleAsyncWork){r.splice(i,1),s.callback();return}}});let e=0;return t=>{const i=++e;r.push({id:i,callback:t}),_n.postMessage({vscodeScheduleAsyncWork:i},"*")}}return r=>setTimeout(r)})();var yb;(function(r){r[r.Windows=1]="Windows",r[r.Macintosh=2]="Macintosh",r[r.Linux=3]="Linux"})(yb||(yb={}));const US=Ou||gb?2:Lu?1:3;let xb=!0,Cb=!1;function Sb(){if(!Cb){Cb=!0;const r=new Uint8Array(2);r[0]=1,r[1]=2,xb=new Uint16Array(r.buffer)[0]===513}return xb}const Eb=!!(Qi&&Qi.indexOf("Chrome")>=0),BS=!!(Qi&&Qi.indexOf("Firefox")>=0),WS=!!(!Eb&&Qi&&Qi.indexOf("Safari")>=0),VS=!!(Qi&&Qi.indexOf("Edg/")>=0);Qi&&Qi.indexOf("Android")>=0;let Zr;const Tp=globalThis.vscode;if(typeof Tp<"u"&&typeof Tp.process<"u"){const r=Tp.process;Zr={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process<"u"?Zr={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Zr={get platform(){return si?"win32":Ai?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const mo=Zr.cwd,Ap=Zr.env,zS=Zr.platform;Zr.arch;const jS=65,qS=97,GS=90,QS=122,nr=46,Lt=47,oi=92,rr=58,JS=63;class kb extends Error{constructor(e,t,i){let n;typeof t=="string"&&t.indexOf("not ")===0?(n="must not be",t=t.replace(/^not /,"")):n="must be";const s=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${s} ${n} of type ${t}`;o+=`. Received type ${typeof i}`,super(o),this.code="ERR_INVALID_ARG_TYPE"}}function KS(r,e){if(r===null||typeof r!="object")throw new kb(e,"Object",r)}function gt(r,e){if(typeof r!="string")throw new kb(e,"string",r)}const Si=zS==="win32";function De(r){return r===Lt||r===oi}function Rp(r){return r===Lt}function sr(r){return r>=jS&&r<=GS||r>=qS&&r<=QS}function Fu(r,e,t,i){let n="",s=0,o=-1,a=0,c=0;for(let l=0;l<=r.length;++l){if(l<r.length)c=r.charCodeAt(l);else{if(i(c))break;c=Lt}if(i(c)){if(!(o===l-1||a===1))if(a===2){if(n.length<2||s!==2||n.charCodeAt(n.length-1)!==nr||n.charCodeAt(n.length-2)!==nr){if(n.length>2){const u=n.lastIndexOf(t);u===-1?(n="",s=0):(n=n.slice(0,u),s=n.length-1-n.lastIndexOf(t)),o=l,a=0;continue}else if(n.length!==0){n="",s=0,o=l,a=0;continue}}e&&(n+=n.length>0?`${t}..`:"..",s=2)}else n.length>0?n+=`${t}${r.slice(o+1,l)}`:n=r.slice(o+1,l),s=l-o-1;o=l,a=0}else c===nr&&a!==-1?++a:a=-1}return n}function Db(r,e){KS(e,"pathObject");const t=e.dir||e.root,i=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${i}`:`${t}${r}${i}`:i}const Ct={resolve(...r){let e="",t="",i=!1;for(let n=r.length-1;n>=-1;n--){let s;if(n>=0){if(s=r[n],gt(s,"path"),s.length===0)continue}else e.length===0?s=mo():(s=Ap[`=${e}`]||mo(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===oi)&&(s=`${e}\\`));const o=s.length;let a=0,c="",l=!1;const u=s.charCodeAt(0);if(o===1)De(u)&&(a=1,l=!0);else if(De(u))if(l=!0,De(s.charCodeAt(1))){let d=2,h=d;for(;d<o&&!De(s.charCodeAt(d));)d++;if(d<o&&d!==h){const g=s.slice(h,d);for(h=d;d<o&&De(s.charCodeAt(d));)d++;if(d<o&&d!==h){for(h=d;d<o&&!De(s.charCodeAt(d));)d++;(d===o||d!==h)&&(c=`\\\\${g}\\${s.slice(h,d)}`,a=d)}}}else a=1;else sr(u)&&s.charCodeAt(1)===rr&&(c=s.slice(0,2),a=2,o>2&&De(s.charCodeAt(2))&&(l=!0,a=3));if(c.length>0)if(e.length>0){if(c.toLowerCase()!==e.toLowerCase())continue}else e=c;if(i){if(e.length>0)break}else if(t=`${s.slice(a)}\\${t}`,i=l,l&&e.length>0)break}return t=Fu(t,!i,"\\",De),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(r){gt(r,"path");const e=r.length;if(e===0)return".";let t=0,i,n=!1;const s=r.charCodeAt(0);if(e===1)return Rp(s)?"\\":r;if(De(s))if(n=!0,De(r.charCodeAt(1))){let a=2,c=a;for(;a<e&&!De(r.charCodeAt(a));)a++;if(a<e&&a!==c){const l=r.slice(c,a);for(c=a;a<e&&De(r.charCodeAt(a));)a++;if(a<e&&a!==c){for(c=a;a<e&&!De(r.charCodeAt(a));)a++;if(a===e)return`\\\\${l}\\${r.slice(c)}\\`;a!==c&&(i=`\\\\${l}\\${r.slice(c,a)}`,t=a)}}}else t=1;else sr(s)&&r.charCodeAt(1)===rr&&(i=r.slice(0,2),t=2,e>2&&De(r.charCodeAt(2))&&(n=!0,t=3));let o=t<e?Fu(r.slice(t),!n,"\\",De):"";return o.length===0&&!n&&(o="."),o.length>0&&De(r.charCodeAt(e-1))&&(o+="\\"),i===void 0?n?`\\${o}`:o:n?`${i}\\${o}`:`${i}${o}`},isAbsolute(r){gt(r,"path");const e=r.length;if(e===0)return!1;const t=r.charCodeAt(0);return De(t)||e>2&&sr(t)&&r.charCodeAt(1)===rr&&De(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let e,t;for(let s=0;s<r.length;++s){const o=r[s];gt(o,"path"),o.length>0&&(e===void 0?e=t=o:e+=`\\${o}`)}if(e===void 0)return".";let i=!0,n=0;if(typeof t=="string"&&De(t.charCodeAt(0))){++n;const s=t.length;s>1&&De(t.charCodeAt(1))&&(++n,s>2&&(De(t.charCodeAt(2))?++n:i=!1))}if(i){for(;n<e.length&&De(e.charCodeAt(n));)n++;n>=2&&(e=`\\${e.slice(n)}`)}return Ct.normalize(e)},relative(r,e){if(gt(r,"from"),gt(e,"to"),r===e)return"";const t=Ct.resolve(r),i=Ct.resolve(e);if(t===i||(r=t.toLowerCase(),e=i.toLowerCase(),r===e))return"";let n=0;for(;n<r.length&&r.charCodeAt(n)===oi;)n++;let s=r.length;for(;s-1>n&&r.charCodeAt(s-1)===oi;)s--;const o=s-n;let a=0;for(;a<e.length&&e.charCodeAt(a)===oi;)a++;let c=e.length;for(;c-1>a&&e.charCodeAt(c-1)===oi;)c--;const l=c-a,u=o<l?o:l;let d=-1,h=0;for(;h<u;h++){const w=r.charCodeAt(n+h);if(w!==e.charCodeAt(a+h))break;w===oi&&(d=h)}if(h!==u){if(d===-1)return i}else{if(l>u){if(e.charCodeAt(a+h)===oi)return i.slice(a+h+1);if(h===2)return i.slice(a+h)}o>u&&(r.charCodeAt(n+h)===oi?d=h:h===2&&(d=3)),d===-1&&(d=0)}let g="";for(h=n+d+1;h<=s;++h)(h===s||r.charCodeAt(h)===oi)&&(g+=g.length===0?"..":"\\..");return a+=d,g.length>0?`${g}${i.slice(a,c)}`:(i.charCodeAt(a)===oi&&++a,i.slice(a,c))},toNamespacedPath(r){if(typeof r!="string"||r.length===0)return r;const e=Ct.resolve(r);if(e.length<=2)return r;if(e.charCodeAt(0)===oi){if(e.charCodeAt(1)===oi){const t=e.charCodeAt(2);if(t!==JS&&t!==nr)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(sr(e.charCodeAt(0))&&e.charCodeAt(1)===rr&&e.charCodeAt(2)===oi)return`\\\\?\\${e}`;return r},dirname(r){gt(r,"path");const e=r.length;if(e===0)return".";let t=-1,i=0;const n=r.charCodeAt(0);if(e===1)return De(n)?r:".";if(De(n)){if(t=i=1,De(r.charCodeAt(1))){let a=2,c=a;for(;a<e&&!De(r.charCodeAt(a));)a++;if(a<e&&a!==c){for(c=a;a<e&&De(r.charCodeAt(a));)a++;if(a<e&&a!==c){for(c=a;a<e&&!De(r.charCodeAt(a));)a++;if(a===e)return r;a!==c&&(t=i=a+1)}}}}else sr(n)&&r.charCodeAt(1)===rr&&(t=e>2&&De(r.charCodeAt(2))?3:2,i=t);let s=-1,o=!0;for(let a=e-1;a>=i;--a)if(De(r.charCodeAt(a))){if(!o){s=a;break}}else o=!1;if(s===-1){if(t===-1)return".";s=t}return r.slice(0,s)},basename(r,e){e!==void 0&&gt(e,"ext"),gt(r,"path");let t=0,i=-1,n=!0,s;if(r.length>=2&&sr(r.charCodeAt(0))&&r.charCodeAt(1)===rr&&(t=2),e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let o=e.length-1,a=-1;for(s=r.length-1;s>=t;--s){const c=r.charCodeAt(s);if(De(c)){if(!n){t=s+1;break}}else a===-1&&(n=!1,a=s+1),o>=0&&(c===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=r.length),r.slice(t,i)}for(s=r.length-1;s>=t;--s)if(De(r.charCodeAt(s))){if(!n){t=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":r.slice(t,i)},extname(r){gt(r,"path");let e=0,t=-1,i=0,n=-1,s=!0,o=0;r.length>=2&&r.charCodeAt(1)===rr&&sr(r.charCodeAt(0))&&(e=i=2);for(let a=r.length-1;a>=e;--a){const c=r.charCodeAt(a);if(De(c)){if(!s){i=a+1;break}continue}n===-1&&(s=!1,n=a+1),c===nr?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||n===-1||o===0||o===1&&t===n-1&&t===i+1?"":r.slice(t,n)},format:Db.bind(null,"\\"),parse(r){gt(r,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;const t=r.length;let i=0,n=r.charCodeAt(0);if(t===1)return De(n)?(e.root=e.dir=r,e):(e.base=e.name=r,e);if(De(n)){if(i=1,De(r.charCodeAt(1))){let d=2,h=d;for(;d<t&&!De(r.charCodeAt(d));)d++;if(d<t&&d!==h){for(h=d;d<t&&De(r.charCodeAt(d));)d++;if(d<t&&d!==h){for(h=d;d<t&&!De(r.charCodeAt(d));)d++;d===t?i=d:d!==h&&(i=d+1)}}}}else if(sr(n)&&r.charCodeAt(1)===rr){if(t<=2)return e.root=e.dir=r,e;if(i=2,De(r.charCodeAt(2))){if(t===3)return e.root=e.dir=r,e;i=3}}i>0&&(e.root=r.slice(0,i));let s=-1,o=i,a=-1,c=!0,l=r.length-1,u=0;for(;l>=i;--l){if(n=r.charCodeAt(l),De(n)){if(!c){o=l+1;break}continue}a===-1&&(c=!1,a=l+1),n===nr?s===-1?s=l:u!==1&&(u=1):s!==-1&&(u=-1)}return a!==-1&&(s===-1||u===0||u===1&&s===a-1&&s===o+1?e.base=e.name=r.slice(o,a):(e.name=r.slice(o,s),e.base=r.slice(o,a),e.ext=r.slice(s,a))),o>0&&o!==i?e.dir=r.slice(0,o-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},XS=(()=>{if(Si){const r=/\\/g;return()=>{const e=mo().replace(r,"/");return e.slice(e.indexOf("/"))}}return()=>mo()})(),Me={resolve(...r){let e="",t=!1;for(let i=r.length-1;i>=-1&&!t;i--){const n=i>=0?r[i]:XS();gt(n,"path"),n.length!==0&&(e=`${n}/${e}`,t=n.charCodeAt(0)===Lt)}return e=Fu(e,!t,"/",Rp),t?`/${e}`:e.length>0?e:"."},normalize(r){if(gt(r,"path"),r.length===0)return".";const e=r.charCodeAt(0)===Lt,t=r.charCodeAt(r.length-1)===Lt;return r=Fu(r,!e,"/",Rp),r.length===0?e?"/":t?"./":".":(t&&(r+="/"),e?`/${r}`:r)},isAbsolute(r){return gt(r,"path"),r.length>0&&r.charCodeAt(0)===Lt},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){const i=r[t];gt(i,"path"),i.length>0&&(e===void 0?e=i:e+=`/${i}`)}return e===void 0?".":Me.normalize(e)},relative(r,e){if(gt(r,"from"),gt(e,"to"),r===e||(r=Me.resolve(r),e=Me.resolve(e),r===e))return"";const t=1,i=r.length,n=i-t,s=1,o=e.length-s,a=n<o?n:o;let c=-1,l=0;for(;l<a;l++){const d=r.charCodeAt(t+l);if(d!==e.charCodeAt(s+l))break;d===Lt&&(c=l)}if(l===a)if(o>a){if(e.charCodeAt(s+l)===Lt)return e.slice(s+l+1);if(l===0)return e.slice(s+l)}else n>a&&(r.charCodeAt(t+l)===Lt?c=l:l===0&&(c=0));let u="";for(l=t+c+1;l<=i;++l)(l===i||r.charCodeAt(l)===Lt)&&(u+=u.length===0?"..":"/..");return`${u}${e.slice(s+c)}`},toNamespacedPath(r){return r},dirname(r){if(gt(r,"path"),r.length===0)return".";const e=r.charCodeAt(0)===Lt;let t=-1,i=!0;for(let n=r.length-1;n>=1;--n)if(r.charCodeAt(n)===Lt){if(!i){t=n;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":r.slice(0,t)},basename(r,e){e!==void 0&&gt(e,"ext"),gt(r,"path");let t=0,i=-1,n=!0,s;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let o=e.length-1,a=-1;for(s=r.length-1;s>=0;--s){const c=r.charCodeAt(s);if(c===Lt){if(!n){t=s+1;break}}else a===-1&&(n=!1,a=s+1),o>=0&&(c===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=r.length),r.slice(t,i)}for(s=r.length-1;s>=0;--s)if(r.charCodeAt(s)===Lt){if(!n){t=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":r.slice(t,i)},extname(r){gt(r,"path");let e=-1,t=0,i=-1,n=!0,s=0;for(let o=r.length-1;o>=0;--o){const a=r.charCodeAt(o);if(a===Lt){if(!n){t=o+1;break}continue}i===-1&&(n=!1,i=o+1),a===nr?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===t+1?"":r.slice(e,i)},format:Db.bind(null,"/"),parse(r){gt(r,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;const t=r.charCodeAt(0)===Lt;let i;t?(e.root="/",i=1):i=0;let n=-1,s=0,o=-1,a=!0,c=r.length-1,l=0;for(;c>=i;--c){const u=r.charCodeAt(c);if(u===Lt){if(!a){s=c+1;break}continue}o===-1&&(a=!1,o=c+1),u===nr?n===-1?n=c:l!==1&&(l=1):n!==-1&&(l=-1)}if(o!==-1){const u=s===0&&t?1:s;n===-1||l===0||l===1&&n===o-1&&n===s+1?e.base=e.name=r.slice(u,o):(e.name=r.slice(u,n),e.base=r.slice(u,o),e.ext=r.slice(n,o))}return s>0?e.dir=r.slice(0,s-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Me.win32=Ct.win32=Ct,Me.posix=Ct.posix=Me;const vo=Si?Ct.normalize:Me.normalize,Lp=Si?Ct.isAbsolute:Me.isAbsolute,Ib=Si?Ct.join:Me.join,YS=Si?Ct.resolve:Me.resolve,gc=Si?Ct.relative:Me.relative,es=Si?Ct.dirname:Me.dirname,ai=Si?Ct.basename:Me.basename,Op=Si?Ct.extname:Me.extname;Si?Ct.parse:Me.parse;const Ri=Si?Ct.sep:Me.sep;Si?Ct.delimiter:Me.delimiter;const ZS=/^\w[\w\d+.-]*$/,eE=/^\//,tE=/^\/\//;function iE(r,e){if(!r.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${r.authority}", path: "${r.path}", query: "${r.query}", fragment: "${r.fragment}"}`);if(r.scheme&&!ZS.test(r.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(r.path){if(r.authority){if(!eE.test(r.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(tE.test(r.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function nE(r,e){return!r&&!e?"file":r}function rE(r,e){switch(r){case"https":case"http":case"file":e?e[0]!==Li&&(e=Li+e):e=Li;break}return e}const et="",Li="/",sE=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class y{static isUri(e){return e instanceof y?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,t,i,n,s,o=!1){typeof e=="object"?(this.scheme=e.scheme||et,this.authority=e.authority||et,this.path=e.path||et,this.query=e.query||et,this.fragment=e.fragment||et):(this.scheme=nE(e,o),this.authority=t||et,this.path=rE(this.scheme,i||et),this.query=n||et,this.fragment=s||et,iE(this,o))}get fsPath(){return Mu(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:n,query:s,fragment:o}=e;return t===void 0?t=this.scheme:t===null&&(t=et),i===void 0?i=this.authority:i===null&&(i=et),n===void 0?n=this.path:n===null&&(n=et),s===void 0?s=this.query:s===null&&(s=et),o===void 0?o=this.fragment:o===null&&(o=et),t===this.scheme&&i===this.authority&&n===this.path&&s===this.query&&o===this.fragment?this:new _o(t,i,n,s,o)}static parse(e,t=!1){const i=sE.exec(e);return i?new _o(i[2]||et,Hu(i[4]||et),Hu(i[5]||et),Hu(i[7]||et),Hu(i[9]||et),t):new _o(et,et,et,et,et)}static file(e){let t=et;if(si&&(e=e.replace(/\\/g,Li)),e[0]===Li&&e[1]===Li){const i=e.indexOf(Li,2);i===-1?(t=e.substring(2),e=Li):(t=e.substring(2,i),e=e.substring(i)||Li)}return new _o("file",t,e,et,et)}static from(e,t){return new _o(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return si&&e.scheme==="file"?i=y.file(Ct.join(Mu(e,!0),...t)).path:i=Me.join(e.path,...t),e.with({path:i})}toString(e=!1){return Np(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof y)return e;{const t=new _o(e);return t._formatted=e.external??null,t._fsPath=e._sep===Pb?e.fsPath??null:null,t}}else return e}}function $p(r){return!r||typeof r!="object"?!1:typeof r.scheme=="string"&&(typeof r.authority=="string"||typeof r.authority>"u")&&(typeof r.path=="string"||typeof r.path>"u")&&(typeof r.query=="string"||typeof r.query>"u")&&(typeof r.fragment=="string"||typeof r.fragment>"u")}const Pb=si?1:void 0;class _o extends y{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=Mu(this,!1)),this._fsPath}toString(e=!1){return e?Np(this,!0):(this._formatted||(this._formatted=Np(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=Pb),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}}const Tb={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function Ab(r,e,t){let i,n=-1;for(let s=0;s<r.length;s++){const o=r.charCodeAt(s);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||e&&o===47||t&&o===91||t&&o===93||t&&o===58)n!==-1&&(i+=encodeURIComponent(r.substring(n,s)),n=-1),i!==void 0&&(i+=r.charAt(s));else{i===void 0&&(i=r.substr(0,s));const a=Tb[o];a!==void 0?(n!==-1&&(i+=encodeURIComponent(r.substring(n,s)),n=-1),i+=a):n===-1&&(n=s)}}return n!==-1&&(i+=encodeURIComponent(r.substring(n))),i!==void 0?i:r}function oE(r){let e;for(let t=0;t<r.length;t++){const i=r.charCodeAt(t);i===35||i===63?(e===void 0&&(e=r.substr(0,t)),e+=Tb[i]):e!==void 0&&(e+=r[t])}return e!==void 0?e:r}function Mu(r,e){let t;return r.authority&&r.path.length>1&&r.scheme==="file"?t=`//${r.authority}${r.path}`:r.path.charCodeAt(0)===47&&(r.path.charCodeAt(1)>=65&&r.path.charCodeAt(1)<=90||r.path.charCodeAt(1)>=97&&r.path.charCodeAt(1)<=122)&&r.path.charCodeAt(2)===58?e?t=r.path.substr(1):t=r.path[1].toLowerCase()+r.path.substr(2):t=r.path,si&&(t=t.replace(/\//g,"\\")),t}function Np(r,e){const t=e?oE:Ab;let i="",{scheme:n,authority:s,path:o,query:a,fragment:c}=r;if(n&&(i+=n,i+=":"),(s||n==="file")&&(i+=Li,i+=Li),s){let l=s.indexOf("@");if(l!==-1){const u=s.substr(0,l);s=s.substr(l+1),l=u.lastIndexOf(":"),l===-1?i+=t(u,!1,!1):(i+=t(u.substr(0,l),!1,!1),i+=":",i+=t(u.substr(l+1),!1,!0)),i+="@"}s=s.toLowerCase(),l=s.lastIndexOf(":"),l===-1?i+=t(s,!1,!0):(i+=t(s.substr(0,l),!1,!0),i+=s.substr(l))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const l=o.charCodeAt(1);l>=65&&l<=90&&(o=`/${String.fromCharCode(l+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const l=o.charCodeAt(0);l>=65&&l<=90&&(o=`${String.fromCharCode(l+32)}:${o.substr(2)}`)}i+=t(o,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),c&&(i+="#",i+=e?c:Ab(c,!1,!1)),i}function Rb(r){try{return decodeURIComponent(r)}catch{return r.length>3?r.substr(0,3)+Rb(r.substr(3)):r}}const Lb=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function Hu(r){return r.match(Lb)?r.replace(Lb,e=>Rb(e)):r}const $f=class $f{constructor(e){this._proxyIdentifierBrand=void 0,this.sid=e,this.nid=++$f.count}};$f.count=0;let Uu=$f;const Ob=[];function $(r){const e=new Uu(r);return Ob[e.nid]=e,e}function Bu(r){return Ob[r].sid}class Ji{constructor(e){this.value=e}}var $b;(function(r){r[r.Default=0]="Default",r[r.InCenter=1]="InCenter",r[r.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",r[r.AtTop=3]="AtTop"})($b||($b={}));var Nb;(function(r){r[r.Default=0]="Default",r[r.InCenter=1]="InCenter",r[r.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",r[r.AtTop=3]="AtTop"})(Nb||(Nb={}));var Fp;(function(r){r[r.None=0]="None",r[r.Process=1]="Process",r[r.Output=2]="Output"})(Fp||(Fp={}));const G={MainThreadAuthentication:$("MainThreadAuthentication"),MainThreadBulkEdits:$("MainThreadBulkEdits"),MainThreadChatProvider:$("MainThreadChatProvider"),MainThreadChatAgents2:$("MainThreadChatAgents2"),MainThreadChatVariables:$("MainThreadChatVariables"),MainThreadClipboard:$("MainThreadClipboard"),MainThreadCommands:$("MainThreadCommands"),MainThreadComments:$("MainThreadComments"),MainThreadConfiguration:$("MainThreadConfiguration"),MainThreadConsole:$("MainThreadConsole"),MainThreadDebugService:$("MainThreadDebugService"),MainThreadDecorations:$("MainThreadDecorations"),MainThreadDiagnostics:$("MainThreadDiagnostics"),MainThreadDialogs:$("MainThreadDiaglogs"),MainThreadDocuments:$("MainThreadDocuments"),MainThreadDocumentContentProviders:$("MainThreadDocumentContentProviders"),MainThreadTextEditors:$("MainThreadTextEditors"),MainThreadEditorInsets:$("MainThreadEditorInsets"),MainThreadEditorTabs:$("MainThreadEditorTabs"),MainThreadErrors:$("MainThreadErrors"),MainThreadTreeViews:$("MainThreadTreeViews"),MainThreadDownloadService:$("MainThreadDownloadService"),MainThreadLanguageFeatures:$("MainThreadLanguageFeatures"),MainThreadLanguages:$("MainThreadLanguages"),MainThreadLogger:$("MainThreadLogger"),MainThreadMessageService:$("MainThreadMessageService"),MainThreadOutputService:$("MainThreadOutputService"),MainThreadProgress:$("MainThreadProgress"),MainThreadQuickDiff:$("MainThreadQuickDiff"),MainThreadQuickOpen:$("MainThreadQuickOpen"),MainThreadStatusBar:$("MainThreadStatusBar"),MainThreadSecretState:$("MainThreadSecretState"),MainThreadStorage:$("MainThreadStorage"),MainThreadSpeech:$("MainThreadSpeechProvider"),MainThreadTelemetry:$("MainThreadTelemetry"),MainThreadTerminalService:$("MainThreadTerminalService"),MainThreadWebviews:$("MainThreadWebviews"),MainThreadWebviewPanels:$("MainThreadWebviewPanels"),MainThreadWebviewViews:$("MainThreadWebviewViews"),MainThreadCustomEditors:$("MainThreadCustomEditors"),MainThreadUrls:$("MainThreadUrls"),MainThreadUriOpeners:$("MainThreadUriOpeners"),MainThreadProfileContentHandlers:$("MainThreadProfileContentHandlers"),MainThreadWorkspace:$("MainThreadWorkspace"),MainThreadFileSystem:$("MainThreadFileSystem"),MainThreadFileSystemEventService:$("MainThreadFileSystemEventService"),MainThreadExtensionService:$("MainThreadExtensionService"),MainThreadSCM:$("MainThreadSCM"),MainThreadSearch:$("MainThreadSearch"),MainThreadShare:$("MainThreadShare"),MainThreadTask:$("MainThreadTask"),MainThreadWindow:$("MainThreadWindow"),MainThreadLabelService:$("MainThreadLabelService"),MainThreadNotebook:$("MainThreadNotebook"),MainThreadNotebookDocuments:$("MainThreadNotebookDocumentsShape"),MainThreadNotebookEditors:$("MainThreadNotebookEditorsShape"),MainThreadNotebookKernels:$("MainThreadNotebookKernels"),MainThreadNotebookRenderers:$("MainThreadNotebookRenderers"),MainThreadInteractive:$("MainThreadInteractive"),MainThreadChat:$("MainThreadChat"),MainThreadInlineChat:$("MainThreadInlineChatShape"),MainThreadTheming:$("MainThreadTheming"),MainThreadTunnelService:$("MainThreadTunnelService"),MainThreadManagedSockets:$("MainThreadManagedSockets"),MainThreadTimeline:$("MainThreadTimeline"),MainThreadTesting:$("MainThreadTesting"),MainThreadLocalization:$("MainThreadLocalizationShape"),MainThreadAiRelatedInformation:$("MainThreadAiRelatedInformation"),MainThreadAiEmbeddingVector:$("MainThreadAiEmbeddingVector"),MainThreadIssueReporter:$("MainThreadIssueReporter")},ie={ExtHostCommands:$("ExtHostCommands"),ExtHostConfiguration:$("ExtHostConfiguration"),ExtHostDiagnostics:$("ExtHostDiagnostics"),ExtHostDebugService:$("ExtHostDebugService"),ExtHostDecorations:$("ExtHostDecorations"),ExtHostDocumentsAndEditors:$("ExtHostDocumentsAndEditors"),ExtHostDocuments:$("ExtHostDocuments"),ExtHostDocumentContentProviders:$("ExtHostDocumentContentProviders"),ExtHostDocumentSaveParticipant:$("ExtHostDocumentSaveParticipant"),ExtHostEditors:$("ExtHostEditors"),ExtHostTreeViews:$("ExtHostTreeViews"),ExtHostFileSystem:$("ExtHostFileSystem"),ExtHostFileSystemInfo:$("ExtHostFileSystemInfo"),ExtHostFileSystemEventService:$("ExtHostFileSystemEventService"),ExtHostLanguages:$("ExtHostLanguages"),ExtHostLanguageFeatures:$("ExtHostLanguageFeatures"),ExtHostQuickOpen:$("ExtHostQuickOpen"),ExtHostQuickDiff:$("ExtHostQuickDiff"),ExtHostStatusBar:$("ExtHostStatusBar"),ExtHostShare:$("ExtHostShare"),ExtHostExtensionService:$("ExtHostExtensionService"),ExtHostLogLevelServiceShape:$("ExtHostLogLevelServiceShape"),ExtHostTerminalService:$("ExtHostTerminalService"),ExtHostSCM:$("ExtHostSCM"),ExtHostSearch:$("ExtHostSearch"),ExtHostTask:$("ExtHostTask"),ExtHostWorkspace:$("ExtHostWorkspace"),ExtHostWindow:$("ExtHostWindow"),ExtHostWebviews:$("ExtHostWebviews"),ExtHostWebviewPanels:$("ExtHostWebviewPanels"),ExtHostCustomEditors:$("ExtHostCustomEditors"),ExtHostWebviewViews:$("ExtHostWebviewViews"),ExtHostEditorInsets:$("ExtHostEditorInsets"),ExtHostEditorTabs:$("ExtHostEditorTabs"),ExtHostProgress:$("ExtHostProgress"),ExtHostComments:$("ExtHostComments"),ExtHostSecretState:$("ExtHostSecretState"),ExtHostStorage:$("ExtHostStorage"),ExtHostUrls:$("ExtHostUrls"),ExtHostUriOpeners:$("ExtHostUriOpeners"),ExtHostProfileContentHandlers:$("ExtHostProfileContentHandlers"),ExtHostOutputService:$("ExtHostOutputService"),ExtHostLabelService:$("ExtHostLabelService"),ExtHostNotebook:$("ExtHostNotebook"),ExtHostNotebookDocuments:$("ExtHostNotebookDocuments"),ExtHostNotebookEditors:$("ExtHostNotebookEditors"),ExtHostNotebookKernels:$("ExtHostNotebookKernels"),ExtHostNotebookRenderers:$("ExtHostNotebookRenderers"),ExtHostNotebookDocumentSaveParticipant:$("ExtHostNotebookDocumentSaveParticipant"),ExtHostInteractive:$("ExtHostInteractive"),ExtHostInlineChat:$("ExtHostInlineChatShape"),ExtHostChat:$("ExtHostChat"),ExtHostChatAgents2:$("ExtHostChatAgents"),ExtHostChatVariables:$("ExtHostChatVariables"),ExtHostChatProvider:$("ExtHostChatProvider"),ExtHostSpeech:$("ExtHostSpeech"),ExtHostAiRelatedInformation:$("ExtHostAiRelatedInformation"),ExtHostAiEmbeddingVector:$("ExtHostAiEmbeddingVector"),ExtHostTheming:$("ExtHostTheming"),ExtHostTunnelService:$("ExtHostTunnelService"),ExtHostManagedSockets:$("ExtHostManagedSockets"),ExtHostAuthentication:$("ExtHostAuthentication"),ExtHostTimeline:$("ExtHostTimeline"),ExtHostTesting:$("ExtHostTesting"),ExtHostTelemetry:$("ExtHostTelemetry"),ExtHostLocalization:$("ExtHostLocalization"),ExtHostIssueReporter:$("ExtHostIssueReporter")},Fb=Object.freeze(function(r,e){const t=setTimeout(r.bind(e),0);return{dispose(){clearTimeout(t)}}});var It;(function(r){function e(t){return t===r.None||t===r.Cancelled||t instanceof Wu?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}r.isCancellationToken=e,r.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:_t.None}),r.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Fb})})(It||(It={}));class Wu{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Fb:(this._emitter||(this._emitter=new T),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}class mt{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new Wu),this._token}cancel(){this._token?this._token instanceof Wu&&this._token.cancel():this._token=It.Cancelled}dispose(e=!1){var t;e&&this.cancel(),(t=this._parentListener)==null||t.dispose(),this._token?this._token instanceof Wu&&this._token.dispose():this._token=It.None}}function Vu(r){return!r||typeof r!="string"?!0:r.trim().length===0}const aE=/{([^}]+)}/g;function Mb(r,e){return Object.keys(e).length===0?r:r.replace(aE,(t,i)=>e[i]??t)}function wo(r){return r.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function cE(r,e){let t=0;const i=e.charCodeAt(0);for(let n=r.length-1;n>=0;n--)r.charCodeAt(n)===i&&t++;return t}function lE(r,e){if(!r||!e)return r;const t=e.length;if(t===0||r.length===0)return r;let i=0;for(;r.indexOf(e,i)===i;)i=i+t;return r.substring(i)}function Hb(r,e){if(!r||!e)return r;const t=e.length,i=r.length;if(t===0||i===0)return r;let n=i,s=-1;for(;s=r.lastIndexOf(e,n-1),!(s===-1||s+t!==n);){if(s===0)return"";n=s}return r.substring(0,n)}function uE(r,e,t={}){if(!r)throw new Error("Cannot create regex from empty string");e||(r=wo(r)),t.wholeWord&&(/\B/.test(r.charAt(0))||(r="\\b"+r),/\B/.test(r.charAt(r.length-1))||(r=r+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(r,i)}function Ub(r){return r.source==="^"||r.source==="^$"||r.source==="$"||r.source==="^\\s*$"?!1:!!(r.exec("")&&r.lastIndex===0)}function Bb(r){return r.split(/\r\n|\r|\n/)}function Mp(r){for(let e=0,t=r.length;e<t;e++){const i=r.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function dE(r,e=r.length-1){for(let t=e;t>=0;t--){const i=r.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function hE(r,e,t){const i=[];let n=0;for(const s of r.matchAll(e)){if(i.push(r.slice(n,s.index)),s.index===void 0)throw new Error("match.index should be defined");n=s.index+s[0].length,i.push(t(s[0],...s.slice(1),s.index,r,s.groups))}return i.push(r.slice(n)),Promise.all(i).then(s=>s.join(""))}function ts(r,e){return r<e?-1:r>e?1:0}function Hp(r,e,t=0,i=r.length,n=0,s=e.length){for(;t<i&&n<s;t++,n++){const c=r.charCodeAt(t),l=e.charCodeAt(n);if(c<l)return-1;if(c>l)return 1}const o=i-t,a=s-n;return o<a?-1:o>a?1:0}function Wb(r,e){return mc(r,e,0,r.length,0,e.length)}function mc(r,e,t=0,i=r.length,n=0,s=e.length){for(;t<i&&n<s;t++,n++){let c=r.charCodeAt(t),l=e.charCodeAt(n);if(c===l)continue;if(c>=128||l>=128)return Hp(r.toLowerCase(),e.toLowerCase(),t,i,n,s);Vb(c)&&(c-=32),Vb(l)&&(l-=32);const u=c-l;if(u!==0)return u}const o=i-t,a=s-n;return o<a?-1:o>a?1:0}function Vb(r){return r>=97&&r<=122}function is(r,e){return r.length===e.length&&mc(r,e)===0}function Up(r,e){const t=e.length;return e.length>r.length?!1:mc(r,e,0,t)===0}function fE(r,e){const t=Math.min(r.length,e.length);let i;for(i=0;i<t;i++)if(r.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function Bp(r){return 55296<=r&&r<=56319}function zb(r){return 56320<=r&&r<=57343}function jb(r,e){return(r-55296<<10)+(e-56320)+65536}function qb(r,e,t){const i=r.charCodeAt(t);if(Bp(i)&&t+1<e){const n=r.charCodeAt(t+1);if(zb(n))return jb(i,n)}return i}function pE(r,e){const t=r.charCodeAt(e-1);if(zb(t)&&e>1){const i=r.charCodeAt(e-2);if(Bp(i))return jb(i,t)}return t}class gE{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=pE(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=qb(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}}class mE{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new gE(e,t)}nextGraphemeLength(){const e=zu.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const s=t.offset,o=e.getGraphemeBreakType(t.nextCodePoint());if(Xb(n,o)){t.setOffset(s);break}n=o}return t.offset-i}prevGraphemeLength(){const e=zu.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const s=t.offset,o=e.getGraphemeBreakType(t.prevCodePoint());if(Xb(o,n)){t.setOffset(s);break}n=o}return i-t.offset}eol(){return this._iterator.eol()}}function Gb(r,e){return new mE(r,e).nextGraphemeLength()}let Wp;function vE(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function Qb(r){return Wp||(Wp=vE()),Wp.test(r)}const _E=/^[\t\n\r\x20-\x7E]*$/;function wE(r){return _E.test(r)}const bE=/[\u2028\u2029]/;function Jb(r){return bE.test(r)}const yE="\uFEFF";function xE(r){return!!(r&&r.length>0&&r.charCodeAt(0)===65279)}function Kb(r,e=!1){return r?(e&&(r=r.replace(/\\./g,"")),r.toLowerCase()!==r):!1}function CE(r,e=1){if(e===0)return"";let t=-1;do t=r.indexOf(`
`,t+1),e--;while(e>0&&t>=0);return t===-1?r:(r[t-1]==="\r"&&t--,r.substr(0,t))}function Xb(r,e){return r===0?e!==5&&e!==7:r===2&&e===3?!1:r===4||r===2||r===3||e===4||e===2||e===3?!0:!(r===8&&(e===8||e===9||e===11||e===12)||(r===11||r===9)&&(e===9||e===10)||(r===12||r===10)&&e===10||e===5||e===13||e===7||r===1||r===13&&e===14||r===6&&e===6)}const Ws=class Ws{static getInstance(){return Ws._INSTANCE||(Ws._INSTANCE=new Ws),Ws._INSTANCE}constructor(){this._data=SE()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let n=1;for(;n<=i;)if(e<t[3*n])n=2*n;else if(e>t[3*n+1])n=2*n+1;else return t[3*n+2];return 0}};Ws._INSTANCE=null;let zu=Ws;function SE(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function Ne(r){return typeof r=="string"}function EE(r){return Array.isArray(r)&&r.every(e=>Ne(e))}function Ft(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}function kE(r){const e=Object.getPrototypeOf(Uint8Array);return typeof r=="object"&&r instanceof e}function or(r){return typeof r=="number"&&!isNaN(r)}function Vp(r){return typeof r>"u"}function bo(r){return!jt(r)}function jt(r){return Vp(r)||r===null}function Yb(r,e){if(!r)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function yo(r){if(jt(r))throw new Error("Assertion Failed: argument is undefined or null");return r}const DE=Object.prototype.hasOwnProperty;function IE(r){if(!Ft(r))return!1;for(const e in r)if(DE.call(r,e))return!1;return!0}function PE(r){return typeof r=="function"}function TE(r,e){if(Ne(e)){if(typeof r!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(PE(e)){try{if(r instanceof e)return}catch{}if(!jt(r)&&r.constructor===e||e.length===1&&e.call(void 0,r)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function ar(r){return r===47||r===92}function Zb(r){return r.replace(/[\\/]/g,Me.sep)}function AE(r){return r.indexOf("/")===-1&&(r=Zb(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function ey(r,e=Me.sep){if(!r)return"";const t=r.length,i=r.charCodeAt(0);if(ar(i)){if(ar(r.charCodeAt(1))&&!ar(r.charCodeAt(2))){let s=3;const o=s;for(;s<t&&!ar(r.charCodeAt(s));s++);if(o!==s&&!ar(r.charCodeAt(s+1))){for(s+=1;s<t;s++)if(ar(r.charCodeAt(s)))return r.slice(0,s+1).replace(/[\\/]/g,e)}}return e}else if(ty(i)&&r.charCodeAt(1)===58)return ar(r.charCodeAt(2))?r.slice(0,2)+e:r.slice(0,2);let n=r.indexOf("://");if(n!==-1){for(n+=3;n<t;n++)if(ar(r.charCodeAt(n)))return r.slice(0,n+1)}return""}const RE=/[\\/:\*\?"<>\|]/g,LE=/[\\/]/g,OE=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function $E(r,e=si){const t=e?RE:LE;return!(!r||r.length===0||/^\s+$/.test(r)||(t.lastIndex=0,t.test(r))||e&&OE.test(r)||r==="."||r===".."||e&&r[r.length-1]==="."||e&&r.length!==r.trim().length||r.length>255)}function ju(r,e,t,i=Ri){if(r===e)return!0;if(!r||!e||e.length>r.length)return!1;if(t){if(!Up(r,e))return!1;if(e.length===r.length)return!0;let s=e.length;return e.charAt(e.length-1)===i&&s--,r.charAt(s)===i}return e.charAt(e.length-1)!==i&&(e+=i),r.indexOf(e)===0}function ty(r){return r>=65&&r<=90||r>=97&&r<=122}function NE(r,e=si){return e?ty(r.charCodeAt(0))&&r.charCodeAt(1)===58:!1}var Z;(function(r){r.inMemory="inmemory",r.vscode="vscode",r.internal="private",r.walkThrough="walkThrough",r.walkThroughSnippet="walkThroughSnippet",r.http="http",r.https="https",r.file="file",r.mailto="mailto",r.untitled="untitled",r.data="data",r.command="command",r.vscodeRemote="vscode-remote",r.vscodeRemoteResource="vscode-remote-resource",r.vscodeManagedRemoteResource="vscode-managed-remote-resource",r.vscodeUserData="vscode-userdata",r.vscodeCustomEditor="vscode-custom-editor",r.vscodeNotebookCell="vscode-notebook-cell",r.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",r.vscodeNotebookCellOutput="vscode-notebook-cell-output",r.vscodeInteractiveInput="vscode-interactive-input",r.vscodeSettings="vscode-settings",r.vscodeWorkspaceTrust="vscode-workspace-trust",r.vscodeTerminal="vscode-terminal",r.vscodeChatCodeBlock="vscode-chat-code-block",r.vscodeChatSesssion="vscode-chat-editor",r.webviewPanel="webview-panel",r.vscodeWebview="vscode-webview",r.extension="extension",r.vscodeFileResource="vscode-file",r.tmp="tmp",r.vsls="vsls",r.vscodeSourceControl="vscode-scm",r.codeSetting="code-setting",r.codeFeature="code-feature"})(Z||(Z={}));function zp(r,e){return y.isUri(r)?is(r.scheme,e):Up(r,e+":")}function FE(r,...e){return e.some(t=>zp(r,t))}const ME="tkn";class HE{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._remoteResourcesPath=`/${Z.vscodeRemoteResource}`}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e){this._remoteResourcesPath=`${e}/${Z.vscodeRemoteResource}`}set(e,t,i){this._hosts[e]=t,this._ports[e]=i}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return mn(a),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const n=this._ports[t],s=this._connectionTokens[t];let o=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(o+=`&${ME}=${encodeURIComponent(s)}`),y.from({scheme:Pp?this._preferredWebSchema:Z.vscodeRemoteResource,authority:`${i}:${n}`,path:this._remoteResourcesPath,query:o})}}const UE=new HE,BE="vscode-app",Ta=class Ta{constructor(){this.staticBrowserUris=new pt,this.appResourcePathUrls=new Map,this.moduleContentProvider=new Map}registerModuleContentProvider(e,t){this.moduleContentProvider.set(e,t)}toModuleContent(e){return this.moduleContentProvider.get(e)()}registerAppResourcePathUrl(e,t){this.appResourcePathUrls.set(e,t)}toUrl(e){var i;let t=this.appResourcePathUrls.get(e);return typeof t=="function"&&(t=t()),new URL(t??e,((i=globalThis.location)==null?void 0:i.href)??self.location.href).toString()}asBrowserUri(e){const t=this.toUri(e,{toUrl:this.toUrl.bind(this)});return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===Z.vscodeRemote?UE.rewrite(e):e.scheme===Z.file&&(FS||MS===`${Z.vscodeFileResource}://${Ta.FALLBACK_AUTHORITY}`)?e.with({scheme:Z.vscodeFileResource,authority:e.authority||Ta.FALLBACK_AUTHORITY,query:null,fragment:null}):this.staticBrowserUris.get(e)??e}asFileUri(e){const t=this.toUri(e,{toUrl:this.toUrl.bind(this)});return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===Z.vscodeFileResource?e.with({scheme:Z.file,authority:e.authority!==Ta.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){return y.isUri(e)?e:y.parse(t.toUrl(e))}registerStaticBrowserUri(e,t){return this.staticBrowserUris.set(e,t),Le(()=>{this.staticBrowserUris.get(e)===t&&this.staticBrowserUris.delete(e)})}getRegisteredBrowserUris(){return this.staticBrowserUris.keys()}};Ta.FALLBACK_AUTHORITY=BE;let jp=Ta;new jp;var iy;(function(r){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);r.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function i(s){let o;typeof s=="string"?o=new URL(s).searchParams:s instanceof URL?o=s.searchParams:y.isUri(s)&&(o=new URL(s.toString(!0)).searchParams);const a=o==null?void 0:o.get(t);if(a)return e.get(a)}r.getHeadersFromQuery=i;function n(s,o,a){if(!globalThis.crossOriginIsolated)return;const c=o&&a?"3":a?"2":"1";s instanceof URLSearchParams?s.set(t,c):s[t]=c}r.addSearchParam=n})(iy||(iy={}));function Oi(r){return Mu(r,!0)}class vc{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:ts(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===Z.file)return ju(Oi(e),Oi(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(sy(e.authority,t.authority))return ju(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return y.joinPath(e,...t)}basenameOrAuthority(e){return ns(e)||e.authority}basename(e){return Me.basename(e.path)}extname(e){return Me.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===Z.file?t=y.file(es(Oi(e))).path:(t=Me.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===Z.file?t=y.file(vo(Oi(e))).path:t=Me.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!sy(e.authority,t.authority))return;if(e.scheme===Z.file){const s=gc(Oi(e),Oi(t));return si?Zb(s):s}let i=e.path||"/";const n=t.path||"/";if(this._ignorePathCasing(e)){let s=0;for(const o=Math.min(i.length,n.length);s<o&&!(i.charCodeAt(s)!==n.charCodeAt(s)&&i.charAt(s).toLowerCase()!==n.charAt(s).toLowerCase());s++);i=n.substr(0,s)+i.substr(s)}return Me.relative(i,n)}resolvePath(e,t){if(e.scheme===Z.file){const i=y.file(YS(Oi(e),t));return e.with({authority:i.authority,path:i.path})}return t=AE(t),e.with({path:Me.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&is(e,t)}hasTrailingPathSeparator(e,t=Ri){if(e.scheme===Z.file){const i=Oi(e);return i.length>ey(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Ri){return oy(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Ri){let i=!1;if(e.scheme===Z.file){const n=Oi(e);i=n!==void 0&&n.length===ey(n).length&&n[n.length-1]===t}else{t="/";const n=e.path;i=n.length===1&&n.charCodeAt(n.length-1)===47}return!i&&!oy(e,t)?e.with({path:e.path+"/"}):e}}const Fe=new vc(()=>!1),WE=new vc(r=>r.scheme===Z.file?!tr:!0),VE=new vc(r=>!0),ny=Fe.isEqual.bind(Fe);Fe.isEqualOrParent.bind(Fe),Fe.getComparisonKey.bind(Fe);const qp=Fe.basenameOrAuthority.bind(Fe),ns=Fe.basename.bind(Fe);Fe.extname.bind(Fe);const Gp=Fe.dirname.bind(Fe),xo=Fe.joinPath.bind(Fe);Fe.normalizePath.bind(Fe);const ry=Fe.relativePath.bind(Fe);Fe.resolvePath.bind(Fe);const zE=Fe.isAbsolutePath.bind(Fe),sy=Fe.isEqualAuthority.bind(Fe),oy=Fe.hasTrailingPathSeparator.bind(Fe);Fe.removeTrailingPathSeparator.bind(Fe),Fe.addTrailingPathSeparator.bind(Fe);var ay;(function(r){r.META_DATA_LABEL="label",r.META_DATA_DESCRIPTION="description",r.META_DATA_SIZE="size",r.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,c]=o.split(":");a&&c&&i.set(a,c)});const s=t.path.substring(0,t.path.indexOf(";"));return s&&i.set(r.META_DATA_MIME,s),i}r.parseMetaData=e})(ay||(ay={}));function cr(r){return!!r&&typeof r.then=="function"}function jE(r){const e=new mt,t=r(e.token),i=new Promise((n,s)=>{const o=e.token.onCancellationRequested(()=>{o.dispose(),s(new Gr)});Promise.resolve(t).then(a=>{o.dispose(),e.dispose(),n(a)},a=>{o.dispose(),e.dispose(),s(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(n,s){return i.then(n,s)}catch(n){return this.then(void 0,n)}finally(n){return i.finally(n)}}}function Qp(r,e,t){return new Promise((i,n)=>{const s=e.onCancellationRequested(()=>{s.dispose(),i(t)});r.then(i,n).finally(()=>s.dispose())})}function qE(r,e){return new Promise((t,i)=>{const n=e.onCancellationRequested(()=>{n.dispose(),i(new Gr)});r.then(t,i).finally(()=>n.dispose())})}function Mt(r){return new Promise((e,t)=>{const i=r();cr(i)?i.then(e,t):e(i)})}function GE(){let r,e;return{promise:new Promise((i,n)=>{r=i,e=n}),resolve:r,reject:e}}class wn{constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}}function lr(r,e){return e?new Promise((t,i)=>{const n=setTimeout(()=>{s.dispose(),t()},r),s=e.onCancellationRequested(()=>{clearTimeout(n),s.dispose(),i(new Gr)})}):jE(t=>lr(r,t))}function QE(r,e=0,t){const i=setTimeout(()=>{r(),t&&n.dispose()},e),n=Le(()=>{clearTimeout(i),t==null||t.deleteAndLeak(n)});return t==null||t.add(n),n}class JE{constructor(e){this._size=0,this._isDisposed=!1,this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new T}whenIdle(){return this.size>0?_t.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((t,i)=>{this.outstandingPromises.push({factory:e,c:t,e:i}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){const e=this.outstandingPromises.shift();this.runningPromises++;const t=e.factory();t.then(e.c,e.e),t.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}}class KE extends JE{constructor(){super(1)}}class XE{constructor(){this.queues=new Map,this.drainers=new Set,this.drainListeners=void 0,this.drainListenerCount=0}async whenDrained(){if(this.isDrained())return;const e=new Co;return this.drainers.add(e),e.p}isDrained(){for(const[,e]of this.queues)if(e.size>0)return!1;return!0}queueSize(e,t=Fe){var n;const i=t.getComparisonKey(e);return((n=this.queues.get(i))==null?void 0:n.size)??0}queueFor(e,t,i=Fe){const n=i.getComparisonKey(e);let s=this.queues.get(n);if(!s){s=new KE;const o=this.drainListenerCount++,a=_t.once(s.onDrained)(()=>{var c,l;s==null||s.dispose(),this.queues.delete(n),this.onDidQueueDrain(),(c=this.drainListeners)==null||c.deleteAndDispose(o),((l=this.drainListeners)==null?void 0:l.size)===0&&(this.drainListeners.dispose(),this.drainListeners=void 0)});this.drainListeners||(this.drainListeners=new lb),this.drainListeners.set(o,a),this.queues.set(n,s)}return s.queue(t)}onDidQueueDrain(){this.isDrained()&&this.releaseDrainers()}releaseDrainers(){for(const e of this.drainers)e.complete();this.drainers.clear()}dispose(){var e;for(const[,t]of this.queues)t.dispose();this.queues.clear(),this.releaseDrainers(),(e=this.drainListeners)==null||e.dispose()}}class YE{constructor(){this.disposable=void 0}cancel(){var e;(e=this.disposable)==null||e.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){this.cancel();const n=i.setInterval(()=>{e()},t);this.disposable=Le(()=>{i.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel()}}class _c{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){var e;(e=this.runner)==null||e.call(this)}}let Jp;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Jp=(r,e)=>{bb(()=>{if(t)return;const i=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:Jp=(r,e,t)=>{const i=r.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0);let n=!1;return{dispose(){n||(n=!0,r.cancelIdleCallback(i))}}}})();class ZE{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=Jp(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class ek extends ZE{constructor(e){super(globalThis,e)}}class Co{get isRejected(){var e;return((e=this.outcome)==null?void 0:e.outcome)===1}get isResolved(){var e;return((e=this.outcome)==null?void 0:e.outcome)===0}get isSettled(){return!!this.outcome}get value(){var e,t;return((e=this.outcome)==null?void 0:e.outcome)===0?(t=this.outcome)==null?void 0:t.value:void 0}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new Gr)}}var Kp;(function(r){async function e(i){let n;const s=await Promise.all(i.map(o=>o.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return s}r.settled=e;function t(i){return new Promise(async(n,s)=>{try{await i(n,s)}catch(o){s(o)}})}r.withAsyncBody=t})(Kp||(Kp={}));const ri=class ri{static fromArray(e){return new ri(t=>{t.emitMany(e)})}static fromPromise(e){return new ri(async t=>{t.emitMany(await e)})}static fromPromises(e){return new ri(async t=>{await Promise.all(e.map(async i=>t.emitOne(await i)))})}static merge(e){return new ri(async t=>{await Promise.all(e.map(async i=>{for await(const n of i)t.emitOne(n)}))})}constructor(e){this._state=0,this._results=[],this._error=null,this._onStateChanged=new T,queueMicrotask(async()=>{const t={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{await Promise.resolve(e(t)),this.resolve()}catch(i){this.reject(i)}finally{t.emitOne=void 0,t.emitMany=void 0,t.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await _t.toPromise(this._onStateChanged.event)}while(!0)}}}static map(e,t){return new ri(async i=>{for await(const n of e)i.emitOne(t(n))})}map(e){return ri.map(this,e)}static filter(e,t){return new ri(async i=>{for await(const n of e)t(n)&&i.emitOne(n)})}filter(e){return ri.filter(this,e)}static coalesce(e){return ri.filter(e,t=>!!t)}coalesce(){return ri.coalesce(this)}static async toPromise(e){const t=[];for await(const i of e)t.push(i);return t}toPromise(){return ri.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};ri.EMPTY=ri.fromArray([]);let Xp=ri;class Yp{constructor(){this._deferred=new Co,this._asyncIterable=new Xp(i=>{if(e){i.reject(e);return}return t&&i.emitMany(t),this._errorFn=n=>i.reject(n),this._emitFn=n=>i.emitOne(n),this._deferred.p});let e,t;this._emitFn=i=>{t||(t=[]),t.push(i)},this._errorFn=i=>{e||(e=i)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e),this._deferred.complete()}emitOne(e){this._emitFn(e)}}function cy(r,e,t,i){if(!r||i>200)return null;if(typeof r=="object"){if(r.$mid===1)return t?y.revive(e.transformIncoming(r)):e.transformIncoming(r);if(r instanceof me)return null;for(const n in r)if(Object.hasOwnProperty.call(r,n)){const s=cy(r[n],e,t,i+1);s!==null&&(r[n]=s)}}return null}function wc(r,e){const t=cy(r,e,!1,0);return t===null?r:t}class ly{constructor(){this._actual=null,this._actualOk=null,this._actualErr=null,this._hasValue=!1,this._value=null,this._hasErr=!1,this._err=null}get[Symbol.toStringTag](){return this.toString()}_ensureActual(){return this._actual||(this._actual=new Promise((e,t)=>{this._actualOk=e,this._actualErr=t,this._hasValue&&this._actualOk(this._value),this._hasErr&&this._actualErr(this._err)})),this._actual}resolveOk(e){this._hasValue||this._hasErr||(this._hasValue=!0,this._value=e,this._actual&&this._actualOk(e))}resolveErr(e){this._hasValue||this._hasErr||(this._hasErr=!0,this._err=e,this._actual?this._actualErr(e):mn(e))}then(e,t){return this._ensureActual().then(e,t)}catch(e){return this._ensureActual().then(void 0,e)}finally(e){return this._ensureActual().finally(e)}}class tk extends ly{constructor(){super(),this._hasErr=!0,this._err=new Gr}}var uy;function Zp(r,e){try{return JSON.stringify(r,e)}catch{return"null"}}const eg="$$ref$$",ik={[eg]:-1};function dy(r,e=null,t=!1){const i=[];return{jsonString:(t?Zp:JSON.stringify)(r,(s,o)=>{if(typeof o>"u")return ik;if(typeof o=="object"){if(o instanceof me){const a=i.push(o)-1;return{[eg]:a}}if(e)return e(s,o)}return o}),referencedBuffers:i}}function hy(r,e,t){return JSON.parse(r,(i,n)=>{if(n){const s=n[eg];if(typeof s=="number")return e[s];if(t&&n.$mid===1)return t.transformIncoming(n)}return n})}function fy(r,e){return JSON.stringify(r,e)}function nk(r){return r?(e,t)=>t&&t.$mid===1?r.transformOutgoing(t):t:null}const rk=()=>{},sk=Symbol.for("rpcProtocol"),ok=Symbol.for("rpcProxy"),eu=class eu extends Be{constructor(e,t=null,i=null){super(),this[uy]=!0,this._onDidChangeResponsiveState=this._register(new T),this.onDidChangeResponsiveState=this._onDidChangeResponsiveState.event,this._protocol=e,this._logger=t,this._uriTransformer=i,this._uriReplacer=nk(this._uriTransformer),this._isDisposed=!1,this._locals=[],this._proxies=[];for(let n=0,s=Uu.count;n<s;n++)this._locals[n]=null,this._proxies[n]=null;this._lastMessageId=0,this._cancelInvokedHandlers=Object.create(null),this._pendingRPCReplies={},this._responsiveState=0,this._unacknowledgedCount=0,this._unresponsiveTime=0,this._asyncCheckUresponsive=this._register(new _c(()=>this._checkUnresponsive(),1e3)),this._protocol.onMessage(n=>this._receiveOneMessage(n))}dispose(){this._isDisposed=!0,Object.keys(this._pendingRPCReplies).forEach(e=>{const t=this._pendingRPCReplies[e];delete this._pendingRPCReplies[e],t.resolveErr(Zw())}),super.dispose()}drain(){return typeof this._protocol.drain=="function"?this._protocol.drain():Promise.resolve()}_onWillSendRequest(e){this._unacknowledgedCount===0&&(this._unresponsiveTime=Date.now()+eu.UNRESPONSIVE_TIME),this._unacknowledgedCount++,this._asyncCheckUresponsive.isScheduled()||this._asyncCheckUresponsive.schedule()}_onDidReceiveAcknowledge(e){this._unresponsiveTime=Date.now()+eu.UNRESPONSIVE_TIME,this._unacknowledgedCount--,this._unacknowledgedCount===0&&this._asyncCheckUresponsive.cancel(),this._setResponsiveState(0)}_checkUnresponsive(){this._unacknowledgedCount!==0&&(Date.now()>this._unresponsiveTime?this._setResponsiveState(1):this._asyncCheckUresponsive.schedule())}_setResponsiveState(e){this._responsiveState!==e&&(this._responsiveState=e,this._onDidChangeResponsiveState.fire(this._responsiveState))}get responsiveState(){return this._responsiveState}transformIncomingURIs(e){return this._uriTransformer?wc(e,this._uriTransformer):e}getProxy(e){const{nid:t,sid:i}=e;return this._proxies[t]||(this._proxies[t]=this._createProxy(t,i)),this._proxies[t]}_createProxy(e,t){const i={get:(n,s)=>(typeof s=="string"&&!n[s]&&s.charCodeAt(0)===36&&(n[s]=(...o)=>this._remoteCall(e,s,o)),s===ok?t:n[s])};return new Proxy(Object.create(null),i)}set(e,t){return this._locals[e.nid]=t,t}assertRegistered(e){for(let t=0,i=e.length;t<i;t++){const n=e[t];if(!this._locals[n.nid])throw new Error(`Missing proxy instance ${n.sid}`)}}_receiveOneMessage(e){var o;if(this._isDisposed)return;const t=e.byteLength,i=st.read(e,0),n=i.readUInt8(),s=i.readUInt32();switch(n){case 1:case 2:{let{rpcId:a,method:c,args:l}=gi.deserializeRequestJSONArgs(i);this._uriTransformer&&(l=wc(l,this._uriTransformer)),this._receiveRequest(t,s,a,c,l,n===2);break}case 3:case 4:{let{rpcId:a,method:c,args:l}=gi.deserializeRequestMixedArgs(i);this._uriTransformer&&(l=wc(l,this._uriTransformer)),this._receiveRequest(t,s,a,c,l,n===4);break}case 5:{(o=this._logger)==null||o.logIncoming(t,s,0,"ack"),this._onDidReceiveAcknowledge(s);break}case 6:{this._receiveCancel(t,s);break}case 7:{this._receiveReply(t,s,void 0);break}case 9:{let a=gi.deserializeReplyOKJSON(i);this._uriTransformer&&(a=wc(a,this._uriTransformer)),this._receiveReply(t,s,a);break}case 10:{const a=gi.deserializeReplyOKJSONWithBuffers(i,this._uriTransformer);this._receiveReply(t,s,a);break}case 8:{const a=gi.deserializeReplyOKVSBuffer(i);this._receiveReply(t,s,a);break}case 11:{let a=gi.deserializeReplyErrError(i);this._uriTransformer&&(a=wc(a,this._uriTransformer)),this._receiveReplyErr(t,s,a);break}case 12:{this._receiveReplyErr(t,s,void 0);break}default:console.error("received unexpected message"),console.error(e)}}_receiveRequest(e,t,i,n,s,o){var d,h;(d=this._logger)==null||d.logIncoming(e,t,1,`receiveRequest ${Bu(i)}.${n}(`,s);const a=String(t);let c,l;if(o){const g=new mt;s.push(g.token),c=this._invokeHandler(i,n,s),l=()=>g.cancel()}else c=this._invokeHandler(i,n,s),l=rk;this._cancelInvokedHandlers[a]=l;const u=gi.serializeAcknowledged(t);(h=this._logger)==null||h.logOutgoing(u.byteLength,t,1,"ack"),this._protocol.send(u),c.then(g=>{var p;delete this._cancelInvokedHandlers[a];const w=gi.serializeReplyOK(t,g,this._uriReplacer);(p=this._logger)==null||p.logOutgoing(w.byteLength,t,1,"reply:",g),this._protocol.send(w)},g=>{var p;delete this._cancelInvokedHandlers[a];const w=gi.serializeReplyErr(t,g);(p=this._logger)==null||p.logOutgoing(w.byteLength,t,1,"replyErr:",g),this._protocol.send(w)})}_receiveCancel(e,t){var n,s,o;(n=this._logger)==null||n.logIncoming(e,t,1,"receiveCancel");const i=String(t);(o=(s=this._cancelInvokedHandlers)[i])==null||o.call(s)}_receiveReply(e,t,i){var o;(o=this._logger)==null||o.logIncoming(e,t,0,"receiveReply:",i);const n=String(t);if(!this._pendingRPCReplies.hasOwnProperty(n))return;const s=this._pendingRPCReplies[n];delete this._pendingRPCReplies[n],s.resolveOk(i)}_receiveReplyErr(e,t,i){var a;(a=this._logger)==null||a.logIncoming(e,t,0,"receiveReplyErr:",i);const n=String(t);if(!this._pendingRPCReplies.hasOwnProperty(n))return;const s=this._pendingRPCReplies[n];delete this._pendingRPCReplies[n];let o;i&&(i.$isError?(o=new Error,o.name=i.name,o.message=i.message,o.stack=i.stack):o=i),s.resolveErr(o)}_invokeHandler(e,t,i){try{return Promise.resolve(this._doInvokeHandler(e,t,i))}catch(n){return Promise.reject(n)}}_doInvokeHandler(e,t,i){const n=this._locals[e];if(!n)throw new Error("Unknown actor "+Bu(e));const s=n[t];if(typeof s!="function")throw new Error("Unknown method "+t+" on actor "+Bu(e));return s.apply(n,i)}_remoteCall(e,t,i){var d;if(this._isDisposed)return new tk;let n=null;if(i.length>0&&It.isCancellationToken(i[i.length-1])&&(n=i.pop()),n&&n.isCancellationRequested)return Promise.reject(Zw());const s=gi.serializeRequestArguments(i,this._uriReplacer),o=++this._lastMessageId,a=String(o),c=new ly,l=new Ae;n&&l.add(n.onCancellationRequested(()=>{var g;const h=gi.serializeCancel(o);(g=this._logger)==null||g.logOutgoing(h.byteLength,o,0,"cancel"),this._protocol.send(gi.serializeCancel(o))})),this._pendingRPCReplies[a]=new ak(c,l),this._onWillSendRequest(o);const u=gi.serializeRequest(o,e,t,s,!!n);return(d=this._logger)==null||d.logOutgoing(u.byteLength,o,0,`request: ${Bu(e)}.${t}(`,i),this._protocol.send(u),c}};uy=sk,eu.UNRESPONSIVE_TIME=3*1e3;let tg=eu;class ak{constructor(e,t){this._promise=e,this._disposable=t}resolveOk(e){this._promise.resolveOk(e),this._disposable.dispose()}resolveErr(e){this._promise.resolveErr(e),this._disposable.dispose()}}const tu=class tu{static alloc(e,t,i){const n=new tu(me.alloc(i+1+4),0);return n.writeUInt8(e),n.writeUInt32(t),n}static read(e,t){return new tu(e,t)}get buffer(){return this._buff}constructor(e,t){this._buff=e,this._offset=t}static sizeUInt8(){return 1}writeUInt8(e){this._buff.writeUInt8(e,this._offset),this._offset+=1}readUInt8(){const e=this._buff.readUInt8(this._offset);return this._offset+=1,e}writeUInt32(e){this._buff.writeUInt32BE(e,this._offset),this._offset+=4}readUInt32(){const e=this._buff.readUInt32BE(this._offset);return this._offset+=4,e}static sizeShortString(e){return 1+e.byteLength}writeShortString(e){this._buff.writeUInt8(e.byteLength,this._offset),this._offset+=1,this._buff.set(e,this._offset),this._offset+=e.byteLength}readShortString(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const i=this._buff.slice(this._offset,this._offset+e).toString();return this._offset+=e,i}static sizeLongString(e){return 4+e.byteLength}writeLongString(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readLongString(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const i=this._buff.slice(this._offset,this._offset+e).toString();return this._offset+=e,i}writeBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}static sizeVSBuffer(e){return 4+e.byteLength}writeVSBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readVSBuffer(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const t=this._buff.slice(this._offset,this._offset+e);return this._offset+=e,t}static sizeMixedArray(e){let t=0;t+=1;for(let i=0,n=e.length;i<n;i++){const s=e[i];switch(t+=1,s.type){case 1:t+=this.sizeLongString(s.value);break;case 2:t+=this.sizeVSBuffer(s.value);break;case 3:t+=this.sizeUInt32,t+=this.sizeLongString(s.value);for(let o=0;o<s.buffers.length;++o)t+=this.sizeVSBuffer(s.buffers[o]);break}}return t}writeMixedArray(e){this._buff.writeUInt8(e.length,this._offset),this._offset+=1;for(let t=0,i=e.length;t<i;t++){const n=e[t];switch(n.type){case 1:this.writeUInt8(1),this.writeLongString(n.value);break;case 2:this.writeUInt8(2),this.writeVSBuffer(n.value);break;case 3:this.writeUInt8(3),this.writeUInt32(n.buffers.length),this.writeLongString(n.value);for(let s=0;s<n.buffers.length;++s)this.writeBuffer(n.buffers[s]);break;case 4:this.writeUInt8(4);break}}}readMixedArray(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const t=new Array(e);for(let i=0;i<e;i++)switch(this.readUInt8()){case 1:t[i]=this.readLongString();break;case 2:t[i]=this.readVSBuffer();break;case 3:{const s=this.readUInt32(),o=this.readLongString(),a=[];for(let c=0;c<s;++c)a.push(this.readVSBuffer());t[i]=new Ji(hy(o,a,null));break}case 4:t[i]=void 0;break}return t}};tu.sizeUInt32=4;let st=tu;class gi{static _useMixedArgSerialization(e){for(let t=0,i=e.length;t<i;t++)if(e[t]instanceof me||e[t]instanceof Ji||typeof e[t]>"u")return!0;return!1}static serializeRequestArguments(e,t){if(this._useMixedArgSerialization(e)){const i=[];for(let n=0,s=e.length;n<s;n++){const o=e[n];if(o instanceof me)i[n]={type:2,value:o};else if(typeof o>"u")i[n]={type:4};else if(o instanceof Ji){const{jsonString:a,referencedBuffers:c}=dy(o.value,t);i[n]={type:3,value:me.fromString(a),buffers:c}}else i[n]={type:1,value:me.fromString(fy(o,t))}}return{type:1,args:i}}return{type:0,args:fy(e,t)}}static serializeRequest(e,t,i,n,s){switch(n.type){case 0:return this._requestJSONArgs(e,t,i,n.args,s);case 1:return this._requestMixedArgs(e,t,i,n.args,s)}}static _requestJSONArgs(e,t,i,n,s){const o=me.fromString(i),a=me.fromString(n);let c=0;c+=st.sizeUInt8(),c+=st.sizeShortString(o),c+=st.sizeLongString(a);const l=st.alloc(s?2:1,e,c);return l.writeUInt8(t),l.writeShortString(o),l.writeLongString(a),l.buffer}static deserializeRequestJSONArgs(e){const t=e.readUInt8(),i=e.readShortString(),n=e.readLongString();return{rpcId:t,method:i,args:JSON.parse(n)}}static _requestMixedArgs(e,t,i,n,s){const o=me.fromString(i);let a=0;a+=st.sizeUInt8(),a+=st.sizeShortString(o),a+=st.sizeMixedArray(n);const c=st.alloc(s?4:3,e,a);return c.writeUInt8(t),c.writeShortString(o),c.writeMixedArray(n),c.buffer}static deserializeRequestMixedArgs(e){const t=e.readUInt8(),i=e.readShortString(),n=e.readMixedArray(),s=new Array(n.length);for(let o=0,a=n.length;o<a;o++){const c=n[o];typeof c=="string"?s[o]=JSON.parse(c):s[o]=c}return{rpcId:t,method:i,args:s}}static serializeAcknowledged(e){return st.alloc(5,e,0).buffer}static serializeCancel(e){return st.alloc(6,e,0).buffer}static serializeReplyOK(e,t,i){if(typeof t>"u")return this._serializeReplyOKEmpty(e);if(t instanceof me)return this._serializeReplyOKVSBuffer(e,t);if(t instanceof Ji){const{jsonString:n,referencedBuffers:s}=dy(t.value,i,!0);return this._serializeReplyOKJSONWithBuffers(e,n,s)}else return this._serializeReplyOKJSON(e,Zp(t,i))}static _serializeReplyOKEmpty(e){return st.alloc(7,e,0).buffer}static _serializeReplyOKVSBuffer(e,t){let i=0;i+=st.sizeVSBuffer(t);const n=st.alloc(8,e,i);return n.writeVSBuffer(t),n.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static _serializeReplyOKJSON(e,t){const i=me.fromString(t);let n=0;n+=st.sizeLongString(i);const s=st.alloc(9,e,n);return s.writeLongString(i),s.buffer}static _serializeReplyOKJSONWithBuffers(e,t,i){const n=me.fromString(t);let s=0;s+=st.sizeUInt32,s+=st.sizeLongString(n);for(const a of i)s+=st.sizeVSBuffer(a);const o=st.alloc(10,e,s);o.writeUInt32(i.length),o.writeLongString(n);for(const a of i)o.writeBuffer(a);return o.buffer}static deserializeReplyOKJSON(e){const t=e.readLongString();return JSON.parse(t)}static deserializeReplyOKJSONWithBuffers(e,t){const i=e.readUInt32(),n=e.readLongString(),s=[];for(let o=0;o<i;++o)s.push(e.readVSBuffer());return new Ji(hy(n,s,t))}static serializeReplyErr(e,t){const i=t?Zp(ku(t),null):void 0;if(typeof i!="string")return this._serializeReplyErrEmpty(e);const n=me.fromString(i);let s=0;s+=st.sizeLongString(n);const o=st.alloc(11,e,s);return o.writeLongString(n),o.buffer}static deserializeReplyErrError(e){const t=e.readLongString();return JSON.parse(t)}static _serializeReplyErrEmpty(e){return st.alloc(12,e,0).buffer}}function ig(r,e){return e&&(r.stack||r.stacktrace)?m("vs/base/common/errorMessage","stackTrace.format","{0}: {1}",gy(r),py(r.stack)||py(r.stacktrace)):gy(r)}function py(r){return Array.isArray(r)?r.join(`
`):r}function gy(r){return r.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${r.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof r.code=="string"&&typeof r.errno=="number"&&typeof r.syscall=="string"?m("vs/base/common/errorMessage","nodeExceptionMessage","A system error occurred ({0})",r.message):r.message||m("vs/base/common/errorMessage","error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function ur(r=null,e=!1){if(!r)return m("vs/base/common/errorMessage","error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(r)){const t=Jt(r),i=ur(t[0],e);return t.length>1?m("vs/base/common/errorMessage","error.moreErrors","{0} ({1} errors in total)",i,t.length):i}if(Ne(r))return r;if(r.detail){const t=r.detail;if(t.error)return ig(t.error,e);if(t.exception)return ig(t.exception,e)}return r.stack?ig(r,e):r.message?r.message:m("vs/base/common/errorMessage","error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function ng(r){return rg(r,0)}function rg(r,e){switch(typeof r){case"object":return r===null?bn(349,e):Array.isArray(r)?lk(r,e):uk(r,e);case"string":return my(r,e);case"boolean":return ck(r,e);case"number":return bn(r,e);case"undefined":return bn(937,e);default:return bn(617,e)}}function bn(r,e){return(e<<5)-e+r|0}function ck(r,e){return bn(r?433:863,e)}function my(r,e){e=bn(149417,e);for(let t=0,i=r.length;t<i;t++)e=bn(r.charCodeAt(t),e);return e}function lk(r,e){return e=bn(104579,e),r.reduce((t,i)=>rg(i,t),e)}function uk(r,e){return e=bn(181387,e),Object.keys(r).sort().reduce((t,i)=>(t=my(i,t),rg(r[i],t)),e)}function sg(...r){switch(r.length){case 1:return m("vs/platform/contextkey/common/scanner","contextkey.scanner.hint.didYouMean1","Did you mean {0}?",r[0]);case 2:return m("vs/platform/contextkey/common/scanner","contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",r[0],r[1]);case 3:return m("vs/platform/contextkey/common/scanner","contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",r[0],r[1],r[2]);default:return}}const dk=m("vs/platform/contextkey/common/scanner","contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),hk=m("vs/platform/contextkey/common/scanner","contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),Aa=class Aa{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw vp(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(sg("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(sg("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(sg("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(n)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=Aa._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(dk);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(hk);return}const s=this._input.charCodeAt(e);if(t)t=!1;else if(s===47&&!i){e++;break}else s===91?i=!0:s===92?t=!0:s===93&&(i=!1);e++}for(;e<this._input.length&&Aa._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};Aa._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0))),Aa._keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);let rs=Aa;var $i;(function(r){r.serviceIds=new Map,r.DI_TARGET="$di$target",r.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[r.DI_DEPENDENCIES]||[]}r.getServiceDependencies=e})($i||($i={}));const qu=ne("instantiationService");function fk(r,e,t){e[$i.DI_TARGET]===e?e[$i.DI_DEPENDENCIES].push({id:r,index:t}):(e[$i.DI_DEPENDENCIES]=[{id:r,index:t}],e[$i.DI_TARGET]=e)}function ne(r){if($i.serviceIds.has(r))return $i.serviceIds.get(r);const e=function(t,i,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");fk(e,t,n)};return e.toString=()=>r,$i.serviceIds.set(r,e),e}function OA(r){return r}const Pt=new Map;Pt.set("false",!1),Pt.set("true",!0),Pt.set("isMac",Ai),Pt.set("isLinux",tr),Pt.set("isWindows",si),Pt.set("isWeb",Pp),Pt.set("isMacNative",Ai&&!Pp),Pt.set("isEdge",VS),Pt.set("isFirefox",BS),Pt.set("isChrome",Eb),Pt.set("isSafari",WS);const pk=Object.prototype.hasOwnProperty,gk={regexParsingWithErrorRecovery:!0},mk=m("vs/platform/contextkey/common/contextkey","contextkey.parser.error.emptyString","Empty context key expression"),vk=m("vs/platform/contextkey/common/contextkey","contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),_k=m("vs/platform/contextkey/common/contextkey","contextkey.parser.error.noInAfterNot","'in' after 'not'."),vy=m("vs/platform/contextkey/common/contextkey","contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),wk=m("vs/platform/contextkey/common/contextkey","contextkey.parser.error.unexpectedToken","Unexpected token"),bk=m("vs/platform/contextkey/common/contextkey","contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),yk=m("vs/platform/contextkey/common/contextkey","contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),xk=m("vs/platform/contextkey/common/contextkey","contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?");let _y=(Wn=class{get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}constructor(e=gk){this._config=e,this._scanner=new rs,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:mk,offset:0,lexeme:"",additionalInfo:vk});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const i=this._peek(),n=i.type===17?bk:void 0;throw this._parsingErrors.push({message:wk,offset:i.offset,lexeme:rs.getLexeme(i),additionalInfo:n}),Wn._parseError}return t}catch(t){if(t!==Wn._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(16);){const t=this._and();e.push(t)}return e.length===1?e[0]:Ot.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(15);){const t=this._term();e.push(t)}return e.length===1?e[0]:Ot.and(...e)}_term(){if(this._matchOne(2)){const e=this._peek();switch(e.type){case 11:return this._advance(),Ht.INSTANCE;case 12:return this._advance(),qt.INSTANCE;case 0:{this._advance();const t=this._expr();return this._consume(1,vy),t==null?void 0:t.negate()}case 17:return this._advance(),os.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case 11:return this._advance(),Ot.true();case 12:return this._advance(),Ot.false();case 0:{this._advance();const t=this._expr();return this._consume(1,vy),t}case 17:{const t=e.lexeme;if(this._advance(),this._matchOne(9)){const n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);const s=n.lexeme,o=s.lastIndexOf("/"),a=o===s.length-1?void 0:this._removeFlagsGY(s.substring(o+1));let c;try{c=new RegExp(s.substring(1,o),a)}catch{throw this._errExpectedButGot("REGEX",n)}return Dc.create(t,c)}switch(n.type){case 10:case 19:{const s=[n.lexeme];this._advance();let o=this._peek(),a=0;for(let h=0;h<n.lexeme.length;h++)n.lexeme.charCodeAt(h)===40?a++:n.lexeme.charCodeAt(h)===41&&a--;for(;!this._isAtEnd()&&o.type!==15&&o.type!==16;){switch(o.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let h=0;h<o.lexeme.length;h++)o.lexeme.charCodeAt(h)===40?a++:n.lexeme.charCodeAt(h)===41&&a--}if(a<0)break;s.push(rs.getLexeme(o)),this._advance(),o=this._peek()}const c=s.join(""),l=c.lastIndexOf("/"),u=l===c.length-1?void 0:this._removeFlagsGY(c.substring(l+1));let d;try{d=new RegExp(c.substring(1,l),u)}catch{throw this._errExpectedButGot("REGEX",n)}return Ot.regex(t,d)}case 18:{const s=n.lexeme;this._advance();let o=null;if(!Vu(s)){const a=s.indexOf("/"),c=s.lastIndexOf("/");if(a!==c&&a>=0){const l=s.slice(a+1,c),u=s[c+1]==="i"?"i":"";try{o=new RegExp(l,u)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(o===null)throw this._errExpectedButGot("REGEX",n);return Dc.create(t,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,_k);const n=this._value();return Ot.notIn(t,n)}switch(this._peek().type){case 3:{this._advance();const n=this._value();if(this._previous().type===18)return Ot.equals(t,n);switch(n){case"true":return Ot.has(t);case"false":return Ot.not(t);default:return Ot.equals(t,n)}}case 4:{this._advance();const n=this._value();if(this._previous().type===18)return Ot.notEquals(t,n);switch(n){case"true":return Ot.not(t);case"false":return Ot.has(t);default:return Ot.notEquals(t,n)}}case 5:return this._advance(),Ec.create(t,this._value());case 6:return this._advance(),kc.create(t,this._value());case 7:return this._advance(),Cc.create(t,this._value());case 8:return this._advance(),Sc.create(t,this._value());case 13:return this._advance(),Ot.in(t,this._value());default:return Ot.has(t)}}case 20:throw this._parsingErrors.push({message:yk,offset:e.offset,lexeme:"",additionalInfo:xk}),Wn._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){const n=m("vs/platform/contextkey/common/contextkey","contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,rs.getLexeme(t)),s=t.offset,o=rs.getLexeme(t);return this._parsingErrors.push({message:n,offset:s,lexeme:o,additionalInfo:i}),Wn._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},Wn._parseError=new Error,Wn);const kw=class kw{static false(){return Ht.INSTANCE}static true(){return qt.INSTANCE}static has(e){return ss.create(e)}static equals(e,t){return yc.create(e,t)}static notEquals(e,t){return xc.create(e,t)}static regex(e,t){return Dc.create(e,t)}static in(e,t){return Gu.create(e,t)}static notIn(e,t){return Qu.create(e,t)}static not(e){return os.create(e)}static and(...e){return dr.create(e,null,!0)}static or(...e){return Ki.create(e,null,!0)}static greater(e,t){return Cc.create(e,t)}static greaterEquals(e,t){return Sc.create(e,t)}static smaller(e,t){return Ec.create(e,t)}static smallerEquals(e,t){return kc.create(e,t)}static deserialize(e){return e==null?void 0:this._parser.parse(e)}};kw._parser=new _y({regexParsingWithErrorRecovery:!1});let Ot=kw;function Ck(r){const e=new _y({regexParsingWithErrorRecovery:!1});return r.map(t=>(e.parse(t),e.lexingErrors.length>0?e.lexingErrors.map(i=>({errorMessage:i.additionalInfo?m("vs/platform/contextkey/common/contextkey","contextkey.scanner.errorForLinterWithHint","Unexpected token. Hint: {0}",i.additionalInfo):m("vs/platform/contextkey/common/contextkey","contextkey.scanner.errorForLinter","Unexpected token."),offset:i.offset,length:i.lexeme.length})):e.parsingErrors.length>0?e.parsingErrors.map(i=>({errorMessage:i.additionalInfo?`${i.message}. ${i.additionalInfo}`:i.message,offset:i.offset,length:i.lexeme.length})):[]))}function bc(r,e){return r.cmp(e)}const Nf=class Nf{constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return qt.INSTANCE}};Nf.INSTANCE=new Nf;let Ht=Nf;const Ff=class Ff{constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return Ht.INSTANCE}};Ff.INSTANCE=new Ff;let qt=Ff;class ss{static create(e,t=null){const i=Pt.get(e);return typeof i=="boolean"?i?qt.INSTANCE:Ht.INSTANCE:new ss(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=2}cmp(e){return e.type!==this.type?this.type-e.type:by(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Pt.get(this.key);return typeof e=="boolean"?e?qt.INSTANCE:Ht.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=os.create(this.key,this)),this.negated}}class yc{static create(e,t,i=null){if(typeof t=="boolean")return t?ss.create(e,i):os.create(e,i);const n=Pt.get(e);return typeof n=="boolean"?t===(n?"true":"false")?qt.INSTANCE:Ht.INSTANCE:new yc(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}cmp(e){return e.type!==this.type?this.type-e.type:as(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Pt.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?qt.INSTANCE:Ht.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=xc.create(this.key,this.value,this)),this.negated}}class Gu{static create(e,t){return new Gu(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:as(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?pk.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=Qu.create(this.key,this.valueKey)),this.negated}}class Qu{static create(e,t){return new Qu(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=11,this._negated=Gu.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}}class xc{static create(e,t,i=null){if(typeof t=="boolean")return t?os.create(e,i):ss.create(e,i);const n=Pt.get(e);return typeof n=="boolean"?t===(n?"true":"false")?Ht.INSTANCE:qt.INSTANCE:new xc(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}cmp(e){return e.type!==this.type?this.type-e.type:as(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Pt.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?Ht.INSTANCE:qt.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=yc.create(this.key,this.value,this)),this.negated}}class os{static create(e,t=null){const i=Pt.get(e);return typeof i=="boolean"?i?Ht.INSTANCE:qt.INSTANCE:new os(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=3}cmp(e){return e.type!==this.type?this.type-e.type:by(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Pt.get(this.key);return typeof e=="boolean"?e?Ht.INSTANCE:qt.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=ss.create(this.key,this)),this.negated}}function Ju(r,e){if(typeof r=="string"){const t=parseFloat(r);isNaN(t)||(r=t)}return typeof r=="string"||typeof r=="number"?e(r):Ht.INSTANCE}class Cc{static create(e,t,i=null){return Ju(t,n=>new Cc(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}cmp(e){return e.type!==this.type?this.type-e.type:as(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=kc.create(this.key,this.value,this)),this.negated}}class Sc{static create(e,t,i=null){return Ju(t,n=>new Sc(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}cmp(e){return e.type!==this.type?this.type-e.type:as(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Ec.create(this.key,this.value,this)),this.negated}}class Ec{static create(e,t,i=null){return Ju(t,n=>new Ec(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}cmp(e){return e.type!==this.type?this.type-e.type:as(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=Sc.create(this.key,this.value,this)),this.negated}}class kc{static create(e,t,i=null){return Ju(t,n=>new kc(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}cmp(e){return e.type!==this.type?this.type-e.type:as(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Cc.create(this.key,this.value,this)),this.negated}}class Dc{static create(e,t){return new Dc(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=Ku.create(this)),this.negated}}class Ku{static create(e){return new Ku(e)}constructor(e){this._actual=e,this.type=8}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new Ku(this._actual.map(e))}negate(){return this._actual}}function wy(r){let e=null;for(let t=0,i=r.length;t<i;t++){const n=r[t].substituteConstants();if(r[t]!==n&&e===null){e=[];for(let s=0;s<t;s++)e[s]=r[s]}e!==null&&(e[t]=n)}return e===null?r:e}class dr{static create(e,t,i){return dr._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=6}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=bc(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=wy(this.expr);return e===this.expr?this:dr.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){const n=[];let s=!1;for(const o of e)if(o){if(o.type===1){s=!0;continue}if(o.type===0)return Ht.INSTANCE;if(o.type===6){n.push(...o.expr);continue}n.push(o)}if(n.length===0&&s)return qt.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(bc);for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];for(;n.length>1;){const o=n[n.length-1];if(o.type!==9)break;n.pop();const a=n.pop(),c=n.length===0,l=Ki.create(o.expr.map(u=>dr.create([u,a],null,i)),null,c);l&&(n.push(l),n.sort(bc))}if(n.length===1)return n[0];if(i){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return Ht.INSTANCE;if(n.length===1)return n[0]}return new dr(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}map(e){return new dr(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=Ki.create(e,this,!0)}return this.negated}}class Ki{static create(e,t,i){return Ki._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=9}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=bc(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=wy(this.expr);return e===this.expr?this:Ki.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let n=[],s=!1;if(e){for(let o=0,a=e.length;o<a;o++){const c=e[o];if(c){if(c.type===0){s=!0;continue}if(c.type===1)return qt.INSTANCE;if(c.type===9){n=n.concat(c.expr);continue}n.push(c)}}if(n.length===0&&s)return Ht.INSTANCE;n.sort(bc)}if(n.length!==0){if(n.length===1)return n[0];for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];if(i){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return qt.INSTANCE;if(n.length===1)return n[0]}return new Ki(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}map(e){return new Ki(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),n=[];for(const s of yy(t))for(const o of yy(i))n.push(dr.create([s,o],null,!1));e.unshift(Ki.create(n,null,!1))}this.negated=Ki.create(e,this,!0)}return this.negated}}const Ra=class Ra extends ss{static all(){return Ra._info.values()}constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?Ra._info.push({...i,key:e}):i!==!0&&Ra._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return yc.create(this.key,e)}notEqualsTo(e){return xc.create(this.key,e)}};Ra._info=[];let re=Ra;ne("contextKeyService");function by(r,e){return r<e?-1:r>e?1:0}function as(r,e,t,i){return r<t?-1:r>t?1:e<i?-1:e>i?1:0}function yy(r){return r.type===9?r.expr:[r]}const Ge=ne("logService"),So=ne("loggerService");function Sk(r){return or(r)}var Oe;(function(r){r[r.Off=0]="Off",r[r.Trace=1]="Trace",r[r.Debug=2]="Debug",r[r.Info=3]="Info",r[r.Warning=4]="Warning",r[r.Error=5]="Error"})(Oe||(Oe={}));const Ek=Oe.Info;function kk(r,e,t){switch(e){case Oe.Trace:r.trace(t);break;case Oe.Debug:r.debug(t);break;case Oe.Info:r.info(t);break;case Oe.Warning:r.warn(t);break;case Oe.Error:r.error(t);break;case Oe.Off:break;default:throw new Error(`Invalid log level ${e}`)}}function Eo(r,e=!1){let t="";for(let i=0;i<r.length;i++){let n=r[i];if(n instanceof Error&&(n=ur(n,e)),typeof n=="object")try{n=JSON.stringify(n)}catch{}t+=(i>0?" ":"")+n}return t}class xy extends Be{constructor(){super(...arguments),this.level=Ek,this._onDidChangeLogLevel=this._register(new T),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return this.level!==Oe.Off&&this.level<=e}}class Cy extends xy{constructor(e){super(),this.logAlways=e}checkLogLevel(e){return this.logAlways||super.checkLogLevel(e)}trace(e,...t){this.checkLogLevel(Oe.Trace)&&this.log(Oe.Trace,Eo([e,...t],!0))}debug(e,...t){this.checkLogLevel(Oe.Debug)&&this.log(Oe.Debug,Eo([e,...t]))}info(e,...t){this.checkLogLevel(Oe.Info)&&this.log(Oe.Info,Eo([e,...t]))}warn(e,...t){this.checkLogLevel(Oe.Warning)&&this.log(Oe.Warning,Eo([e,...t]))}error(e,...t){if(this.checkLogLevel(Oe.Error))if(e instanceof Error){const i=Array.prototype.slice.call(arguments);i[0]=e.stack,this.log(Oe.Error,Eo(i))}else this.log(Oe.Error,Eo([e,...t]))}flush(){}}class Dk extends xy{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}flush(){for(const e of this.loggers)e.flush()}dispose(){for(const e of this.loggers)e.dispose();super.dispose()}}class Ik extends Be{constructor(e,t,i){if(super(),this.logLevel=e,this.logsHome=t,this._loggers=new pt,this._onDidChangeLoggers=this._register(new T),this.onDidChangeLoggers=this._onDidChangeLoggers.event,this._onDidChangeLogLevel=this._register(new T),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event,this._onDidChangeVisibility=this._register(new T),this.onDidChangeVisibility=this._onDidChangeVisibility.event,i)for(const n of i)this._loggers.set(n.resource,{logger:void 0,info:n})}getLoggerEntry(e){return Ne(e)?[...this._loggers.values()].find(t=>t.info.id===e):this._loggers.get(e)}getLogger(e){var t;return(t=this.getLoggerEntry(e))==null?void 0:t.logger}createLogger(e,t){var c;const i=this.toResource(e),n=Ne(e)?e:(t==null?void 0:t.id)??ng(i.toString()).toString(16);let s=(c=this._loggers.get(i))==null?void 0:c.logger;const o=(t==null?void 0:t.logLevel)==="always"?Oe.Trace:t==null?void 0:t.logLevel;s||(s=this.doCreateLogger(i,o??this.getLogLevel(i)??this.logLevel,{...t,id:n}));const a={logger:s,info:{resource:i,id:n,logLevel:o,name:t==null?void 0:t.name,hidden:t==null?void 0:t.hidden,extensionId:t==null?void 0:t.extensionId,when:t==null?void 0:t.when}};return this.registerLogger(a.info),this._loggers.set(i,a),s}toResource(e){return Ne(e)?xo(this.logsHome,`${e}.log`):e}setLogLevel(e,t){var i,n,s;if(y.isUri(e)){const o=e,a=t,c=this._loggers.get(o);c&&a!==c.info.logLevel&&(c.info.logLevel=a===this.logLevel?void 0:a,(i=c.logger)==null||i.setLevel(a),this._loggers.set(c.info.resource,c),this._onDidChangeLogLevel.fire([o,a]))}else{this.logLevel=e;for(const[o,a]of this._loggers.entries())((n=this._loggers.get(o))==null?void 0:n.info.logLevel)===void 0&&((s=a.logger)==null||s.setLevel(this.logLevel));this._onDidChangeLogLevel.fire(this.logLevel)}}setVisibility(e,t){const i=this.getLoggerEntry(e);i&&t!==!i.info.hidden&&(i.info.hidden=!t,this._loggers.set(i.info.resource,i),this._onDidChangeVisibility.fire([i.info.resource,t]))}getLogLevel(e){var i;let t;return e&&(t=(i=this._loggers.get(e))==null?void 0:i.info.logLevel),t??this.logLevel}registerLogger(e){const t=this._loggers.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this._loggers.set(e.resource,{info:e,logger:void 0}),this._onDidChangeLoggers.fire({added:[e],removed:[]}))}deregisterLogger(e){const t=this._loggers.get(e);t&&(t.logger&&t.logger.dispose(),this._loggers.delete(e),this._onDidChangeLoggers.fire({added:[],removed:[t.info]}))}*getRegisteredLoggers(){for(const e of this._loggers.values())yield e.info}getRegisteredLogger(e){var t;return(t=this._loggers.get(e))==null?void 0:t.info}dispose(){this._loggers.forEach(e=>{var t;return(t=e.logger)==null?void 0:t.dispose()}),this._loggers.clear(),super.dispose()}}function Pk(r){switch(r){case Oe.Trace:return"trace";case Oe.Debug:return"debug";case Oe.Info:return"info";case Oe.Warning:return"warn";case Oe.Error:return"error";case Oe.Off:return"off"}}function Tk(r){switch(r){case"trace":return Oe.Trace;case"debug":return Oe.Debug;case"info":return Oe.Info;case"warn":return Oe.Warning;case"error":return Oe.Error;case"critical":return Oe.Error;case"off":return Oe.Off}}new re("logLevel",Pk(Oe.Info));class Xi{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const Sy=[];function ot(r,e,t){e instanceof Xi||(e=new Xi(e,[],!!t)),Sy.push([r,e])}function Ak(){return Sy}class og{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}const Ut=ne("IExtHostInitDataService");class Rk{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}}class Ey{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t);i.outgoing.set(n.key,n),n.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new Rk(t,e),this._nodes.set(t,i)),i}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),n=this._findCycle(t,i);if(n)return n}}_findCycle(e,t){for(const[i,n]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const s=this._findCycle(n,t);if(s)return s;t.delete(i)}}}const Lk=!1;class ky extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class Xu{constructor(e=new og,t=!1,i,n=Lk){this._services=e,this._strict=t,this._parent=i,this._enableTracing=n,this._activeInstantiations=new Set,this._services.set(qu,this),this._globalGraph=n?(i==null?void 0:i._globalGraph)??new Ey(s=>s):void 0}createChild(e){return new Xu(e,this._strict,this,this._enableTracing)}invokeFunction(e,...t){const i=Ic.traceInvocation(this._enableTracing,e);let n=!1;try{return e({get:o=>{if(n)throw vp("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(o,i);if(!a)throw new Error(`[invokeFunction] unknown service '${o}'`);return a}},...t)}finally{n=!0,i.stop()}}createInstance(e,...t){let i,n;return e instanceof Xi?(i=Ic.traceCreation(this._enableTracing,e.ctor),n=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=Ic.traceCreation(this._enableTracing,e),n=this._createInstance(e,t,i)),i.stop(),n}_createInstance(e,t=[],i){const n=$i.getServiceDependencies(e).sort((a,c)=>a.index-c.index),s=[];for(const a of n){const c=this._getOrCreateServiceInstance(a.id,i);c||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),s.push(c)}const o=n.length>0?n[0].index:t.length;if(t.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);const a=o-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,o)}return Reflect.construct(e,t.concat(s))}_setServiceInstance(e,t){if(this._services.get(e)instanceof Xi)this._services.set(e,t);else if(this._parent)this._parent._setServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof Xi?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){var a;const n=new Ey(c=>c.id.toString());let s=0;const o=[{id:e,desc:t,_trace:i}];for(;o.length;){const c=o.pop();if(n.lookupOrInsertNode(c),s++>1e3)throw new ky(n);for(const l of $i.getServiceDependencies(c.desc.ctor)){const u=this._getServiceInstanceOrDescriptor(l.id);if(u||this._throwIfStrict(`[createInstance] ${e} depends on ${l.id} which is NOT registered.`,!0),(a=this._globalGraph)==null||a.insertEdge(String(c.id),String(l.id)),u instanceof Xi){const d={id:l.id,desc:u,_trace:c._trace.branch(l.id,!0)};n.lookup(d)||o.push(d),n.insertEdge(c,d)}}}for(;;){const c=n.roots();if(c.length===0){if(!n.isEmpty())throw new ky(n);break}for(const{data:l}of c){if(this._getServiceInstanceOrDescriptor(l.id)instanceof Xi){const d=this._createServiceInstanceWithOwner(l.id,l.desc.ctor,l.desc.staticArguments,l.desc.supportsDelayedInstantiation,l._trace);this._setServiceInstance(l.id,d)}n.removeNode(l)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],n,s){if(this._services.get(e)instanceof Xi)return this._createServiceInstance(e,t,i,n,s);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,n,s);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],n,s){if(n){const o=new Xu(void 0,this._strict,this,this._enableTracing);o._globalGraphImplicitDependency=String(e);const a=new Map,c=new ek(()=>{const l=o._createInstance(t,i,s);for(const[u,d]of a){const h=l[u];if(typeof h=="function")for(const g of d)g.disposable=h.apply(l,g.listener)}return a.clear(),l});return new Proxy(Object.create(null),{get(l,u){if(!c.isInitialized&&typeof u=="string"&&(u.startsWith("onDid")||u.startsWith("onWill"))){let g=a.get(u);return g||(g=new dc,a.set(u,g)),(p,b,k)=>{if(c.isInitialized)return c.value[u](p,b,k);{const D={listener:[p,b,k],disposable:void 0},C=g.push(D);return Le(()=>{var A;C(),(A=D.disposable)==null||A.dispose()})}}}if(u in l)return l[u];const d=c.value;let h=d[u];return typeof h!="function"||(h=h.bind(d),l[u]=h),h},set(l,u,d){return c.value[u]=d,!0},getPrototypeOf(l){return t.prototype}})}else return this._createInstance(t,i,s)}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}const di=class di{static traceInvocation(e,t){return e?new di(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):di._None}static traceCreation(e,t){return e?new di(1,t.name):di._None}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new di(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;di._totals+=e;let t=!1;function i(s,o){const a=[],c=new Array(s+1).join("	");for(const[l,u,d]of o._dep)if(u&&d){t=!0,a.push(`${c}CREATES -> ${l}`);const h=i(s+1,d);h&&a.push(h)}else a.push(`${c}uses -> ${l}`);return a.join(`
`)}const n=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${di._totals.toFixed(2)}ms)`];(e>2||t)&&di.all.add(n.join(`
`))}};di.all=new Set,di._None=new class extends di{constructor(){super(0,null)}stop(){}branch(){return this}},di._totals=0;let Ic=di;const Ve=ne("IExtHostRpcService");class Ok{constructor(e){this.getProxy=e.getProxy.bind(e),this.set=e.set.bind(e),this.dispose=e.dispose.bind(e),this.assertRegistered=e.assertRegistered.bind(e),this.drain=e.drain.bind(e)}}const Yu=ne("IURITransformerService");class $k{constructor(e){e?(this.transformIncoming=e.transformIncoming.bind(e),this.transformOutgoing=e.transformOutgoing.bind(e),this.transformOutgoingURI=e.transformOutgoingURI.bind(e),this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)):(this.transformIncoming=t=>t,this.transformOutgoing=t=>t,this.transformOutgoingURI=t=>t,this.transformOutgoingScheme=t=>t)}}function H(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s}function N(r,e){return function(t,i){e(t,i,r)}}class Nk{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class Fk{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?Hp(e,this._value,0,e.length,this._from,this._to):mc(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class Dy{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?Hp(e,this._value,0,e.length,this._from,this._to):mc(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class Mk{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new Dy(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return Wb(e,this._value.scheme);if(this._states[this._stateIdx]===2)return Wb(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return ts(e,this._value.query);if(this._states[this._stateIdx]===5)return ts(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}class Zu{constructor(){this.height=1}isEmpty(){return!this.left&&!this.mid&&!this.right&&!this.value}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var e;return((e=this.left)==null?void 0:e.height)??0}get heightRight(){var e;return((e=this.right)==null?void 0:e.height)??0}}class yn{static forUris(e=()=>!1,t=()=>!1){return new yn(new Mk(e,t))}static forPaths(e=!1){return new yn(new Dy(void 0,!e))}static forStrings(){return new yn(new Nk)}static forConfigKeys(){return new yn(new Fk)}constructor(e){this._iter=e}clear(){this._root=void 0}fill(e,t){if(t){const i=t.slice(0);tb(i);for(const n of i)this.set(n,e)}else{const i=e.slice(0);tb(i);for(const n of i)this.set(n[0],n[1])}}set(e,t){const i=this._iter.reset(e);let n;this._root||(this._root=new Zu,this._root.segment=i.value());const s=[];for(n=this._root;;){const a=i.cmp(n.segment);if(a>0)n.left||(n.left=new Zu,n.left.segment=i.value()),s.push([-1,n]),n=n.left;else if(a<0)n.right||(n.right=new Zu,n.right.segment=i.value()),s.push([1,n]),n=n.right;else if(i.hasNext())i.next(),n.mid||(n.mid=new Zu,n.mid.segment=i.value()),s.push([0,n]),n=n.mid;else break}const o=n.value;n.value=t,n.key=e;for(let a=s.length-1;a>=0;a--){const c=s[a][1];c.updateHeight();const l=c.balanceFactor();if(l<-1||l>1){const u=s[a][0],d=s[a+1][0];if(u===1&&d===1)s[a][1]=c.rotateLeft();else if(u===-1&&d===-1)s[a][1]=c.rotateRight();else if(u===1&&d===-1)c.right=s[a+1][1]=s[a+1][1].rotateRight(),s[a][1]=c.rotateLeft();else if(u===-1&&d===1)c.left=s[a+1][1]=s[a+1][1].rotateLeft(),s[a][1]=c.rotateRight();else throw new Error;if(a>0)switch(s[a-1][0]){case-1:s[a-1][1].left=s[a][1];break;case 1:s[a-1][1].right=s[a][1];break;case 0:s[a-1][1].mid=s[a][1];break}else this._root=s[0][1]}}return o}get(e){var t;return(t=this._getNode(e))==null?void 0:t.value}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const n=t.cmp(i.segment);if(n>0)i=i.left;else if(n<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!((t==null?void 0:t.value)===void 0&&(t==null?void 0:t.mid)===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){const i=this._iter.reset(e),n=[];let s=this._root;for(;s;){const o=i.cmp(s.segment);if(o>0)n.push([-1,s]),s=s.left;else if(o<0)n.push([1,s]),s=s.right;else if(i.hasNext())i.next(),n.push([0,s]),s=s.mid;else break}if(s){if(t?(s.left=void 0,s.mid=void 0,s.right=void 0,s.height=1):(s.key=void 0,s.value=void 0),!s.mid&&!s.value)if(s.left&&s.right){const o=this._min(s.right);if(o.key){const{key:a,value:c,segment:l}=o;this._delete(o.key,!1),s.key=a,s.value=c,s.segment=l}}else{const o=s.left??s.right;if(n.length>0){const[a,c]=n[n.length-1];switch(a){case-1:c.left=o;break;case 0:c.mid=o;break;case 1:c.right=o;break}}else this._root=o}for(let o=n.length-1;o>=0;o--){const a=n[o][1];a.updateHeight();const c=a.balanceFactor();if(c>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),n[o][1]=a.rotateLeft()):c<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),n[o][1]=a.rotateRight()),o>0)switch(n[o-1][0]){case-1:n[o-1][1].left=n[o][1];break;case 1:n[o-1][1].right=n[o][1];break;case 0:n[o-1][1].mid=n[o][1];break}else this._root=n[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){const t=this._iter.reset(e);let i=this._root,n;for(;i;){const s=t.cmp(i.segment);if(s>0)i=i.left;else if(s<0)i=i.right;else if(t.hasNext())t.next(),n=i.value||n,i=i.mid;else break}return i&&i.value||n}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const i=this._iter.reset(e);let n=this._root;for(;n;){const s=i.cmp(n.segment);if(s>0)n=n.left;else if(s<0)n=n.right;else if(i.hasNext())i.next(),n=n.mid;else return n.mid?this._entries(n.mid):t?n.value:void 0}}hasElementOrSubtree(e){return this._findSuperstrOrElement(e,!0)!==void 0}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value&&t.push([e.key,e.value]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}_isBalanced(){const e=t=>{if(!t)return!0;const i=t.balanceFactor();return i<-1||i>1?!1:e(t.left)&&e(t.right)};return e(this._root)}}function ht(r){if(!r||typeof r!="object"||r instanceof RegExp)return r;const e=Array.isArray(r)?[]:{};return Object.entries(r).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?ht(i):i}),e}function ag(r){if(!r||typeof r!="object")return r;const e=[r];for(;e.length>0;){const t=e.shift();for(const i in t)if(Iy.call(t,i)){const n=t[i];typeof n=="object"&&!Object.isFrozen(n)&&!kE(n)&&e.push(n)}}return r}const Iy=Object.prototype.hasOwnProperty;function ed(r,e){return cg(r,e,new Set)}function cg(r,e,t){if(jt(r))return r;const i=e(r);if(typeof i<"u")return i;if(Array.isArray(r)){const n=[];for(const s of r)n.push(cg(s,e,t));return n}if(Ft(r)){if(t.has(r))throw new Error("Cannot clone recursive data-structure");t.add(r);const n={};for(const s in r)Iy.call(r,s)&&(n[s]=cg(r[s],e,t));return t.delete(r),n}return r}function cs(r,e,t=!0){return Ft(r)?(Ft(e)&&Object.keys(e).forEach(i=>{i in r?t&&(Ft(r[i])&&Ft(e[i])?cs(r[i],e[i],t):r[i]=e[i]):r[i]=e[i]}),r):e}function Ni(r,e){if(r===e)return!0;if(r==null||e===null||e===void 0||typeof r!=typeof e||typeof r!="object"||Array.isArray(r)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(r)){if(r.length!==e.length)return!1;for(t=0;t<r.length;t++)if(!Ni(r[t],e[t]))return!1}else{const n=[];for(i in r)n.push(i);n.sort();const s=[];for(i in e)s.push(i);if(s.sort(),!Ni(n,s))return!1;for(t=0;t<n.length;t++)if(!Ni(r[n[t]],e[n[t]]))return!1}return!0}function Hk(r){const e=new Set;return JSON.stringify(r,(t,i)=>{if(Ft(i)||Array.isArray(i)){if(e.has(i))return"[Circular]";e.add(i)}return i})}function Py(r,e){const t=Object.create(null);for(const[i,n]of Object.entries(r))e(i,n)&&(t[i]=n);return t}class Uk{constructor(){this._next=0}getNext(){return this._next++}}var tt;(function(r){r[r.Ignore=0]="Ignore",r[r.Info=1]="Info",r[r.Warning=2]="Warning",r[r.Error=3]="Error"})(tt||(tt={})),function(r){const e="error",t="warning",i="warn",n="info",s="ignore";function o(c){return c?is(e,c)?r.Error:is(t,c)||is(i,c)?r.Warning:is(n,c)?r.Info:r.Ignore:r.Ignore}r.fromValue=o;function a(c){switch(c){case r.Error:return e;case r.Warning:return t;case r.Info:return n;default:return s}}r.toString=a}(tt||(tt={}));var Bk=tt;ne("notificationService");var Ty;(function(r){r[r.DEFAULT=0]="DEFAULT",r[r.SILENT=1]="SILENT",r[r.URGENT=2]="URGENT"})(Ty||(Ty={}));var Ay;(function(r){r[r.WORKSPACE=0]="WORKSPACE",r[r.PROFILE=1]="PROFILE",r[r.APPLICATION=2]="APPLICATION"})(Ay||(Ay={}));var Ry;(function(r){r[r.OFF=0]="OFF",r[r.ERROR=1]="ERROR"})(Ry||(Ry={}));const lg=ne("contextService");let Wk=class{constructor(e,t,i,n,s){this._id=e,this._transient=i,this._configuration=n,this._ignorePathCasing=s,this._foldersMap=yn.forUris(this._ignorePathCasing,()=>!0),this.folders=t}update(e){this._id=e.id,this._configuration=e.configuration,this._transient=e.transient,this._ignorePathCasing=e._ignorePathCasing,this.folders=e.folders}get folders(){return this._folders}set folders(e){this._folders=e,this.updateFoldersMap()}get id(){return this._id}get transient(){return this._transient}get configuration(){return this._configuration}set configuration(e){this._configuration=e}getFolder(e){return e&&this._foldersMap.findSubstr(e)||null}updateFoldersMap(){this._foldersMap=yn.forUris(this._ignorePathCasing,()=>!0);for(const e of this.folders)this._foldersMap.set(e.uri,e)}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration}}};class Ly{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toResource(e){return xo(this.uri,e)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}function Oy(r){return new Ly({uri:r,index:0,name:qp(r)},{uri:r.toString()})}const Vk="code-workspace";m("vs/platform/workspace/common/workspace","codeWorkspace","Code Workspace");class zk{constructor(){this._systemSchemes=new Set(Object.keys(Z)),this._providerInfo=new Map,this.extUri=new vc(e=>{const t=this._providerInfo.get(e.scheme);return!(t===void 0||t&1024)})}$acceptProviderInfos(e,t){t===null?this._providerInfo.delete(e.scheme):this._providerInfo.set(e.scheme,t)}isFreeScheme(e){return!this._providerInfo.has(e)&&!this._systemSchemes.has(e)}getCapabilities(e){return this._providerInfo.get(e)}}const ko=ne("IExtHostFileSystemInfo"),xn=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let r;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?r=crypto.getRandomValues.bind(crypto):r=function(i){for(let n=0;n<i.length;n++)i[n]=Math.floor(Math.random()*256);return i};const e=new Uint8Array(16),t=[];for(let i=0;i<256;i++)t.push(i.toString(16).padStart(2,"0"));return function(){r(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let n=0,s="";return s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s}}(),ug=Object.freeze({create:r=>po(r.map(e=>e.toString())).join(`\r
`),split:r=>r.split(`\r
`),parse:r=>ug.split(r).filter(e=>!e.startsWith("#"))});$y.bind(void 0,!1),$y.bind(void 0,!0);function $y(r,e,t){if(!t||t.length<e.length)return null;let i;return r?i=Up(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}const jk=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(r=>jk.add(r.charCodeAt(0))),new ab(1e4);const Ny=128;function dg(){const r=[],e=[];for(let t=0;t<=Ny;t++)e[t]=0;for(let t=0;t<=Ny;t++)r.push(e.slice(0));return r}dg(),dg(),dg();var Fy;(function(r){r.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}r.isDefault=e})(Fy||(Fy={}));const hg=Object.create(null);function f(r,e){if(Ne(e)){const t=hg[e];if(t===void 0)throw new Error(`${r} references an unknown codicon: ${e}`);e=t}return hg[r]=e,{id:r}}function qk(){return hg}const ce={add:f("add",6e4),plus:f("plus",6e4),gistNew:f("gist-new",6e4),repoCreate:f("repo-create",6e4),lightbulb:f("lightbulb",60001),lightBulb:f("light-bulb",60001),repo:f("repo",60002),repoDelete:f("repo-delete",60002),gistFork:f("gist-fork",60003),repoForked:f("repo-forked",60003),gitPullRequest:f("git-pull-request",60004),gitPullRequestAbandoned:f("git-pull-request-abandoned",60004),recordKeys:f("record-keys",60005),keyboard:f("keyboard",60005),tag:f("tag",60006),tagAdd:f("tag-add",60006),tagRemove:f("tag-remove",60006),gitPullRequestLabel:f("git-pull-request-label",60006),person:f("person",60007),personFollow:f("person-follow",60007),personOutline:f("person-outline",60007),personFilled:f("person-filled",60007),gitBranch:f("git-branch",60008),gitBranchCreate:f("git-branch-create",60008),gitBranchDelete:f("git-branch-delete",60008),sourceControl:f("source-control",60008),mirror:f("mirror",60009),mirrorPublic:f("mirror-public",60009),star:f("star",60010),starAdd:f("star-add",60010),starDelete:f("star-delete",60010),starEmpty:f("star-empty",60010),comment:f("comment",60011),commentAdd:f("comment-add",60011),alert:f("alert",60012),warning:f("warning",60012),search:f("search",60013),searchSave:f("search-save",60013),logOut:f("log-out",60014),signOut:f("sign-out",60014),logIn:f("log-in",60015),signIn:f("sign-in",60015),eye:f("eye",60016),eyeUnwatch:f("eye-unwatch",60016),eyeWatch:f("eye-watch",60016),circleFilled:f("circle-filled",60017),primitiveDot:f("primitive-dot",60017),closeDirty:f("close-dirty",60017),debugBreakpoint:f("debug-breakpoint",60017),debugBreakpointDisabled:f("debug-breakpoint-disabled",60017),debugBreakpointPending:f("debug-breakpoint-pending",60377),debugHint:f("debug-hint",60017),primitiveSquare:f("primitive-square",60018),edit:f("edit",60019),pencil:f("pencil",60019),info:f("info",60020),issueOpened:f("issue-opened",60020),gistPrivate:f("gist-private",60021),gitForkPrivate:f("git-fork-private",60021),lock:f("lock",60021),mirrorPrivate:f("mirror-private",60021),close:f("close",60022),removeClose:f("remove-close",60022),x:f("x",60022),repoSync:f("repo-sync",60023),sync:f("sync",60023),clone:f("clone",60024),desktopDownload:f("desktop-download",60024),beaker:f("beaker",60025),microscope:f("microscope",60025),vm:f("vm",60026),deviceDesktop:f("device-desktop",60026),file:f("file",60027),fileText:f("file-text",60027),more:f("more",60028),ellipsis:f("ellipsis",60028),kebabHorizontal:f("kebab-horizontal",60028),mailReply:f("mail-reply",60029),reply:f("reply",60029),organization:f("organization",60030),organizationFilled:f("organization-filled",60030),organizationOutline:f("organization-outline",60030),newFile:f("new-file",60031),fileAdd:f("file-add",60031),newFolder:f("new-folder",60032),fileDirectoryCreate:f("file-directory-create",60032),trash:f("trash",60033),trashcan:f("trashcan",60033),history:f("history",60034),clock:f("clock",60034),folder:f("folder",60035),fileDirectory:f("file-directory",60035),symbolFolder:f("symbol-folder",60035),logoGithub:f("logo-github",60036),markGithub:f("mark-github",60036),github:f("github",60036),terminal:f("terminal",60037),console:f("console",60037),repl:f("repl",60037),zap:f("zap",60038),symbolEvent:f("symbol-event",60038),error:f("error",60039),stop:f("stop",60039),variable:f("variable",60040),symbolVariable:f("symbol-variable",60040),array:f("array",60042),symbolArray:f("symbol-array",60042),symbolModule:f("symbol-module",60043),symbolPackage:f("symbol-package",60043),symbolNamespace:f("symbol-namespace",60043),symbolObject:f("symbol-object",60043),symbolMethod:f("symbol-method",60044),symbolFunction:f("symbol-function",60044),symbolConstructor:f("symbol-constructor",60044),symbolBoolean:f("symbol-boolean",60047),symbolNull:f("symbol-null",60047),symbolNumeric:f("symbol-numeric",60048),symbolNumber:f("symbol-number",60048),symbolStructure:f("symbol-structure",60049),symbolStruct:f("symbol-struct",60049),symbolParameter:f("symbol-parameter",60050),symbolTypeParameter:f("symbol-type-parameter",60050),symbolKey:f("symbol-key",60051),symbolText:f("symbol-text",60051),symbolReference:f("symbol-reference",60052),goToFile:f("go-to-file",60052),symbolEnum:f("symbol-enum",60053),symbolValue:f("symbol-value",60053),symbolRuler:f("symbol-ruler",60054),symbolUnit:f("symbol-unit",60054),activateBreakpoints:f("activate-breakpoints",60055),archive:f("archive",60056),arrowBoth:f("arrow-both",60057),arrowDown:f("arrow-down",60058),arrowLeft:f("arrow-left",60059),arrowRight:f("arrow-right",60060),arrowSmallDown:f("arrow-small-down",60061),arrowSmallLeft:f("arrow-small-left",60062),arrowSmallRight:f("arrow-small-right",60063),arrowSmallUp:f("arrow-small-up",60064),arrowUp:f("arrow-up",60065),bell:f("bell",60066),bold:f("bold",60067),book:f("book",60068),bookmark:f("bookmark",60069),debugBreakpointConditionalUnverified:f("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:f("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:f("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:f("debug-breakpoint-data-unverified",60072),debugBreakpointData:f("debug-breakpoint-data",60073),debugBreakpointDataDisabled:f("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:f("debug-breakpoint-log-unverified",60074),debugBreakpointLog:f("debug-breakpoint-log",60075),debugBreakpointLogDisabled:f("debug-breakpoint-log-disabled",60075),briefcase:f("briefcase",60076),broadcast:f("broadcast",60077),browser:f("browser",60078),bug:f("bug",60079),calendar:f("calendar",60080),caseSensitive:f("case-sensitive",60081),check:f("check",60082),checklist:f("checklist",60083),chevronDown:f("chevron-down",60084),dropDownButton:f("drop-down-button",60084),chevronLeft:f("chevron-left",60085),chevronRight:f("chevron-right",60086),chevronUp:f("chevron-up",60087),chromeClose:f("chrome-close",60088),chromeMaximize:f("chrome-maximize",60089),chromeMinimize:f("chrome-minimize",60090),chromeRestore:f("chrome-restore",60091),circle:f("circle",60092),circleOutline:f("circle-outline",60092),debugBreakpointUnverified:f("debug-breakpoint-unverified",60092),circleSlash:f("circle-slash",60093),circuitBoard:f("circuit-board",60094),clearAll:f("clear-all",60095),clippy:f("clippy",60096),closeAll:f("close-all",60097),cloudDownload:f("cloud-download",60098),cloudUpload:f("cloud-upload",60099),code:f("code",60100),collapseAll:f("collapse-all",60101),colorMode:f("color-mode",60102),commentDiscussion:f("comment-discussion",60103),compareChanges:f("compare-changes",60157),creditCard:f("credit-card",60105),dash:f("dash",60108),dashboard:f("dashboard",60109),database:f("database",60110),debugContinue:f("debug-continue",60111),debugDisconnect:f("debug-disconnect",60112),debugPause:f("debug-pause",60113),debugRestart:f("debug-restart",60114),debugStart:f("debug-start",60115),debugStepInto:f("debug-step-into",60116),debugStepOut:f("debug-step-out",60117),debugStepOver:f("debug-step-over",60118),debugStop:f("debug-stop",60119),debug:f("debug",60120),deviceCameraVideo:f("device-camera-video",60121),deviceCamera:f("device-camera",60122),deviceMobile:f("device-mobile",60123),diffAdded:f("diff-added",60124),diffIgnored:f("diff-ignored",60125),diffModified:f("diff-modified",60126),diffRemoved:f("diff-removed",60127),diffRenamed:f("diff-renamed",60128),diff:f("diff",60129),discard:f("discard",60130),editorLayout:f("editor-layout",60131),emptyWindow:f("empty-window",60132),exclude:f("exclude",60133),extensions:f("extensions",60134),eyeClosed:f("eye-closed",60135),fileBinary:f("file-binary",60136),fileCode:f("file-code",60137),fileMedia:f("file-media",60138),filePdf:f("file-pdf",60139),fileSubmodule:f("file-submodule",60140),fileSymlinkDirectory:f("file-symlink-directory",60141),fileSymlinkFile:f("file-symlink-file",60142),fileZip:f("file-zip",60143),files:f("files",60144),filter:f("filter",60145),flame:f("flame",60146),foldDown:f("fold-down",60147),foldUp:f("fold-up",60148),fold:f("fold",60149),folderActive:f("folder-active",60150),folderOpened:f("folder-opened",60151),gear:f("gear",60152),gift:f("gift",60153),gistSecret:f("gist-secret",60154),gist:f("gist",60155),gitCommit:f("git-commit",60156),gitCompare:f("git-compare",60157),gitMerge:f("git-merge",60158),githubAction:f("github-action",60159),githubAlt:f("github-alt",60160),globe:f("globe",60161),grabber:f("grabber",60162),graph:f("graph",60163),gripper:f("gripper",60164),heart:f("heart",60165),home:f("home",60166),horizontalRule:f("horizontal-rule",60167),hubot:f("hubot",60168),inbox:f("inbox",60169),issueClosed:f("issue-closed",60324),issueReopened:f("issue-reopened",60171),issues:f("issues",60172),italic:f("italic",60173),jersey:f("jersey",60174),json:f("json",60175),bracket:f("bracket",60175),kebabVertical:f("kebab-vertical",60176),key:f("key",60177),law:f("law",60178),lightbulbAutofix:f("lightbulb-autofix",60179),linkExternal:f("link-external",60180),link:f("link",60181),listOrdered:f("list-ordered",60182),listUnordered:f("list-unordered",60183),liveShare:f("live-share",60184),loading:f("loading",60185),location:f("location",60186),mailRead:f("mail-read",60187),mail:f("mail",60188),markdown:f("markdown",60189),megaphone:f("megaphone",60190),mention:f("mention",60191),milestone:f("milestone",60192),gitPullRequestMilestone:f("git-pull-request-milestone",60192),mortarBoard:f("mortar-board",60193),move:f("move",60194),multipleWindows:f("multiple-windows",60195),mute:f("mute",60196),noNewline:f("no-newline",60197),note:f("note",60198),octoface:f("octoface",60199),openPreview:f("open-preview",60200),package:f("package",60201),paintcan:f("paintcan",60202),pin:f("pin",60203),play:f("play",60204),run:f("run",60204),plug:f("plug",60205),preserveCase:f("preserve-case",60206),preview:f("preview",60207),project:f("project",60208),pulse:f("pulse",60209),question:f("question",60210),quote:f("quote",60211),radioTower:f("radio-tower",60212),reactions:f("reactions",60213),references:f("references",60214),refresh:f("refresh",60215),regex:f("regex",60216),remoteExplorer:f("remote-explorer",60217),remote:f("remote",60218),remove:f("remove",60219),replaceAll:f("replace-all",60220),replace:f("replace",60221),repoClone:f("repo-clone",60222),repoForcePush:f("repo-force-push",60223),repoPull:f("repo-pull",60224),repoPush:f("repo-push",60225),report:f("report",60226),requestChanges:f("request-changes",60227),rocket:f("rocket",60228),rootFolderOpened:f("root-folder-opened",60229),rootFolder:f("root-folder",60230),rss:f("rss",60231),ruby:f("ruby",60232),saveAll:f("save-all",60233),saveAs:f("save-as",60234),save:f("save",60235),screenFull:f("screen-full",60236),screenNormal:f("screen-normal",60237),searchStop:f("search-stop",60238),server:f("server",60240),settingsGear:f("settings-gear",60241),settings:f("settings",60242),shield:f("shield",60243),smiley:f("smiley",60244),sortPrecedence:f("sort-precedence",60245),splitHorizontal:f("split-horizontal",60246),splitVertical:f("split-vertical",60247),squirrel:f("squirrel",60248),starFull:f("star-full",60249),starHalf:f("star-half",60250),symbolClass:f("symbol-class",60251),symbolColor:f("symbol-color",60252),symbolCustomColor:f("symbol-customcolor",60252),symbolConstant:f("symbol-constant",60253),symbolEnumMember:f("symbol-enum-member",60254),symbolField:f("symbol-field",60255),symbolFile:f("symbol-file",60256),symbolInterface:f("symbol-interface",60257),symbolKeyword:f("symbol-keyword",60258),symbolMisc:f("symbol-misc",60259),symbolOperator:f("symbol-operator",60260),symbolProperty:f("symbol-property",60261),wrench:f("wrench",60261),wrenchSubaction:f("wrench-subaction",60261),symbolSnippet:f("symbol-snippet",60262),tasklist:f("tasklist",60263),telescope:f("telescope",60264),textSize:f("text-size",60265),threeBars:f("three-bars",60266),thumbsdown:f("thumbsdown",60267),thumbsup:f("thumbsup",60268),tools:f("tools",60269),triangleDown:f("triangle-down",60270),triangleLeft:f("triangle-left",60271),triangleRight:f("triangle-right",60272),triangleUp:f("triangle-up",60273),twitter:f("twitter",60274),unfold:f("unfold",60275),unlock:f("unlock",60276),unmute:f("unmute",60277),unverified:f("unverified",60278),verified:f("verified",60279),versions:f("versions",60280),vmActive:f("vm-active",60281),vmOutline:f("vm-outline",60282),vmRunning:f("vm-running",60283),watch:f("watch",60284),whitespace:f("whitespace",60285),wholeWord:f("whole-word",60286),window:f("window",60287),wordWrap:f("word-wrap",60288),zoomIn:f("zoom-in",60289),zoomOut:f("zoom-out",60290),listFilter:f("list-filter",60291),listFlat:f("list-flat",60292),listSelection:f("list-selection",60293),selection:f("selection",60293),listTree:f("list-tree",60294),debugBreakpointFunctionUnverified:f("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:f("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:f("debug-breakpoint-function-disabled",60296),debugStackframeActive:f("debug-stackframe-active",60297),circleSmallFilled:f("circle-small-filled",60298),debugStackframeDot:f("debug-stackframe-dot",60298),debugStackframe:f("debug-stackframe",60299),debugStackframeFocused:f("debug-stackframe-focused",60299),debugBreakpointUnsupported:f("debug-breakpoint-unsupported",60300),symbolString:f("symbol-string",60301),debugReverseContinue:f("debug-reverse-continue",60302),debugStepBack:f("debug-step-back",60303),debugRestartFrame:f("debug-restart-frame",60304),callIncoming:f("call-incoming",60306),callOutgoing:f("call-outgoing",60307),menu:f("menu",60308),expandAll:f("expand-all",60309),feedback:f("feedback",60310),gitPullRequestReviewer:f("git-pull-request-reviewer",60310),groupByRefType:f("group-by-ref-type",60311),ungroupByRefType:f("ungroup-by-ref-type",60312),account:f("account",60313),gitPullRequestAssignee:f("git-pull-request-assignee",60313),bellDot:f("bell-dot",60314),debugConsole:f("debug-console",60315),library:f("library",60316),output:f("output",60317),runAll:f("run-all",60318),syncIgnored:f("sync-ignored",60319),pinned:f("pinned",60320),githubInverted:f("github-inverted",60321),debugAlt:f("debug-alt",60305),serverProcess:f("server-process",60322),serverEnvironment:f("server-environment",60323),pass:f("pass",60324),stopCircle:f("stop-circle",60325),playCircle:f("play-circle",60326),record:f("record",60327),debugAltSmall:f("debug-alt-small",60328),vmConnect:f("vm-connect",60329),cloud:f("cloud",60330),merge:f("merge",60331),exportIcon:f("export",60332),graphLeft:f("graph-left",60333),magnet:f("magnet",60334),notebook:f("notebook",60335),redo:f("redo",60336),checkAll:f("check-all",60337),pinnedDirty:f("pinned-dirty",60338),passFilled:f("pass-filled",60339),circleLargeFilled:f("circle-large-filled",60340),circleLarge:f("circle-large",60341),circleLargeOutline:f("circle-large-outline",60341),combine:f("combine",60342),gather:f("gather",60342),table:f("table",60343),variableGroup:f("variable-group",60344),typeHierarchy:f("type-hierarchy",60345),typeHierarchySub:f("type-hierarchy-sub",60346),typeHierarchySuper:f("type-hierarchy-super",60347),gitPullRequestCreate:f("git-pull-request-create",60348),runAbove:f("run-above",60349),runBelow:f("run-below",60350),notebookTemplate:f("notebook-template",60351),debugRerun:f("debug-rerun",60352),workspaceTrusted:f("workspace-trusted",60353),workspaceUntrusted:f("workspace-untrusted",60354),workspaceUnspecified:f("workspace-unspecified",60355),terminalCmd:f("terminal-cmd",60356),terminalDebian:f("terminal-debian",60357),terminalLinux:f("terminal-linux",60358),terminalPowershell:f("terminal-powershell",60359),terminalTmux:f("terminal-tmux",60360),terminalUbuntu:f("terminal-ubuntu",60361),terminalBash:f("terminal-bash",60362),arrowSwap:f("arrow-swap",60363),copy:f("copy",60364),personAdd:f("person-add",60365),filterFilled:f("filter-filled",60366),wand:f("wand",60367),debugLineByLine:f("debug-line-by-line",60368),inspect:f("inspect",60369),layers:f("layers",60370),layersDot:f("layers-dot",60371),layersActive:f("layers-active",60372),compass:f("compass",60373),compassDot:f("compass-dot",60374),compassActive:f("compass-active",60375),azure:f("azure",60376),issueDraft:f("issue-draft",60377),gitPullRequestClosed:f("git-pull-request-closed",60378),gitPullRequestDraft:f("git-pull-request-draft",60379),debugAll:f("debug-all",60380),debugCoverage:f("debug-coverage",60381),runErrors:f("run-errors",60382),folderLibrary:f("folder-library",60383),debugContinueSmall:f("debug-continue-small",60384),beakerStop:f("beaker-stop",60385),graphLine:f("graph-line",60386),graphScatter:f("graph-scatter",60387),pieChart:f("pie-chart",60388),bracketDot:f("bracket-dot",60389),bracketError:f("bracket-error",60390),lockSmall:f("lock-small",60391),azureDevops:f("azure-devops",60392),verifiedFilled:f("verified-filled",60393),newLine:f("newline",60394),layout:f("layout",60395),layoutActivitybarLeft:f("layout-activitybar-left",60396),layoutActivitybarRight:f("layout-activitybar-right",60397),layoutPanelLeft:f("layout-panel-left",60398),layoutPanelCenter:f("layout-panel-center",60399),layoutPanelJustify:f("layout-panel-justify",60400),layoutPanelRight:f("layout-panel-right",60401),layoutPanel:f("layout-panel",60402),layoutSidebarLeft:f("layout-sidebar-left",60403),layoutSidebarRight:f("layout-sidebar-right",60404),layoutStatusbar:f("layout-statusbar",60405),layoutMenubar:f("layout-menubar",60406),layoutCentered:f("layout-centered",60407),layoutSidebarRightOff:f("layout-sidebar-right-off",60416),layoutPanelOff:f("layout-panel-off",60417),layoutSidebarLeftOff:f("layout-sidebar-left-off",60418),target:f("target",60408),indent:f("indent",60409),recordSmall:f("record-small",60410),errorSmall:f("error-small",60411),arrowCircleDown:f("arrow-circle-down",60412),arrowCircleLeft:f("arrow-circle-left",60413),arrowCircleRight:f("arrow-circle-right",60414),arrowCircleUp:f("arrow-circle-up",60415),heartFilled:f("heart-filled",60420),map:f("map",60421),mapFilled:f("map-filled",60422),circleSmall:f("circle-small",60423),bellSlash:f("bell-slash",60424),bellSlashDot:f("bell-slash-dot",60425),commentUnresolved:f("comment-unresolved",60426),gitPullRequestGoToChanges:f("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:f("git-pull-request-new-changes",60428),searchFuzzy:f("search-fuzzy",60429),commentDraft:f("comment-draft",60430),send:f("send",60431),sparkle:f("sparkle",60432),insert:f("insert",60433),mic:f("mic",60434),thumbsDownFilled:f("thumbsdown-filled",60435),thumbsUpFilled:f("thumbsup-filled",60436),coffee:f("coffee",60437),snake:f("snake",60438),game:f("game",60439),vr:f("vr",60440),chip:f("chip",60441),piano:f("piano",60442),music:f("music",60443),micFilled:f("mic-filled",60444),gitFetch:f("git-fetch",60445),copilot:f("copilot",60446),lightbulbSparkle:f("lightbulb-sparkle",60447),lightbulbSparkleAutofix:f("lightbulb-sparkle-autofix",60447),robot:f("robot",60448),sparkleFilled:f("sparkle-filled",60449),diffSingle:f("diff-single",60450),diffMultiple:f("diff-multiple",60451),surroundWith:f("surround-with",60452),gitStash:f("git-stash",60454),gitStashApply:f("git-stash-apply",60455),gitStashPop:f("git-stash-pop",60456),runAllCoverage:f("run-all-coverage",60461),runCoverage:f("run-all-coverage",60460),coverage:f("coverage",60462),githubProject:f("github-project",60463),dialogError:f("dialog-error","error"),dialogWarning:f("dialog-warning","warning"),dialogInfo:f("dialog-info","info"),dialogClose:f("dialog-close","close"),treeItemExpanded:f("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:f("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:f("tree-filter-on-type-off","list-selection"),treeFilterClear:f("tree-filter-clear","close"),treeItemLoading:f("tree-item-loading","loading"),menuSelection:f("menu-selection","check"),menuSubmenu:f("menu-submenu","chevron-right"),menuBarMore:f("menubar-more","more"),scrollbarButtonLeft:f("scrollbar-button-left","triangle-left"),scrollbarButtonRight:f("scrollbar-button-right","triangle-right"),scrollbarButtonUp:f("scrollbar-button-up","triangle-up"),scrollbarButtonDown:f("scrollbar-button-down","triangle-down"),toolBarMore:f("toolbar-more","more"),quickInputBack:f("quick-input-back","arrow-left")};var Do;(function(r){function e(t){return t&&typeof t=="object"&&typeof t.id=="string"}r.isThemeColor=e})(Do||(Do={}));var Xt;(function(r){r.iconNameSegment="[A-Za-z0-9]+",r.iconNameExpression="[A-Za-z0-9-]+",r.iconModifierExpression="~[A-Za-z]+",r.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${r.iconNameExpression})(${r.iconModifierExpression})?$`);function t(h){const g=e.exec(h.id);if(!g)return t(ce.error);const[,w,p]=g,b=["codicon","codicon-"+w];return p&&b.push("codicon-modifier-"+p.substring(1)),b}r.asClassNameArray=t;function i(h){return t(h).join(" ")}r.asClassName=i;function n(h){return"."+t(h).join(".")}r.asCSSSelector=n;function s(h){return h&&typeof h=="object"&&typeof h.id=="string"&&(typeof h.color>"u"||Do.isThemeColor(h.color))}r.isThemeIcon=s;const o=new RegExp(`^\\$\\((${r.iconNameExpression}(?:${r.iconModifierExpression})?)\\)$`);function a(h){const g=o.exec(h);if(!g)return;const[,w]=g;return{id:w}}r.fromString=a;function c(h){return{id:h}}r.fromId=c;function l(h,g){let w=h.id;const p=w.lastIndexOf("~");return p!==-1&&(w=w.substring(0,p)),g&&(w=`${w}~${g}`),{id:w}}r.modify=l;function u(h){const g=h.id.lastIndexOf("~");if(g!==-1)return h.id.substring(g+1)}r.getModifier=u;function d(h,g){var w,p;return h.id===g.id&&((w=h.color)==null?void 0:w.id)===((p=g.color)==null?void 0:p.id)}r.isEqual=d})(Xt||(Xt={}));const fg=new RegExp(`\\$\\(${Xt.iconNameExpression}(?:${Xt.iconModifierExpression})?\\)`,"g"),Gk=new RegExp(`(\\\\)?${fg.source}`,"g");function Qk(r){return r.replace(Gk,(e,t)=>t?e:`\\${e}`)}new RegExp(`\\\\${fg.source}`,"g"),new RegExp(`(\\s)?(\\\\)?${fg.source}(\\s)?`,"g"),new RegExp(`\\$\\(${Xt.iconNameCharacter}+\\)`,"g");let My=class{constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw xe("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=0){return this.value+=Jk(this.supportThemeIcons?Qk(e):e).replace(/([ \t]+)/g,(i,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${Kk(t,e)}
`,this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){const i=new RegExp(wo(t),"g");return e.replace(i,(n,s)=>e.charAt(s-1)!=="\\"?`\\${n}`:n)}};function ls(r){return r instanceof My?!0:r&&typeof r=="object"?typeof r.value=="string"&&(typeof r.isTrusted=="boolean"||typeof r.isTrusted=="object"||r.isTrusted===void 0)&&(typeof r.supportThemeIcons=="boolean"||r.supportThemeIcons===void 0):!1}function Jk(r){return r.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function Kk(r,e){var n;const t=((n=r.match(/^`+/gm))==null?void 0:n.reduce((s,o)=>s.length>o.length?s:o).length)??0,i=t>=3?t+1:3;return[`${"`".repeat(i)}${e}`,r,`${"`".repeat(i)}`].join(`
`)}function Xk(r){const e=[],t=r.split("|").map(n=>n.trim());r=t[0];const i=t[1];if(i){const n=/height=(\d+)/.exec(i),s=/width=(\d+)/.exec(i),o=n?n[1]:"",a=s?s[1]:"",c=isFinite(parseInt(a)),l=isFinite(parseInt(o));c&&e.push(`width="${a}"`),l&&e.push(`height="${o}"`)}return{href:r,dimensions:e}}var us={exports:{}};function Hy(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function Yk(r){us.exports.defaults=r}us.exports={defaults:Hy(),getDefaults:Hy,changeDefaults:Yk};const Zk=/[&<>"']/,e2=/[&<>"']/g,t2=/[<>"']|&(?!#?\w+;)/,i2=/[<>"']|&(?!#?\w+;)/g,n2={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Uy=r=>n2[r];function r2(r,e){if(e){if(Zk.test(r))return r.replace(e2,Uy)}else if(t2.test(r))return r.replace(i2,Uy);return r}const s2=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function By(r){return r.replace(s2,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const o2=/(^|[^\[])\^/g;function a2(r,e){r=r.source||r,e=e||"";const t={replace:(i,n)=>(n=n.source||n,n=n.replace(o2,"$1"),r=r.replace(i,n),t),getRegex:()=>new RegExp(r,e)};return t}const c2=/[^\w:]/g,l2=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function u2(r,e,t){if(r){let i;try{i=decodeURIComponent(By(t)).replace(c2,"").toLowerCase()}catch{return null}if(i.indexOf("javascript:")===0||i.indexOf("vbscript:")===0||i.indexOf("data:")===0)return null}e&&!l2.test(t)&&(t=Wy(e,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const td={},d2=/^[^:]+:\/*[^/]*$/,h2=/^([^:]+:)[\s\S]*$/,f2=/^([^:]+:\/*[^/]*)[\s\S]*$/;function Wy(r,e){td[" "+r]||(d2.test(r)?td[" "+r]=r+"/":td[" "+r]=Vy(r,"/",!0)),r=td[" "+r];const t=r.indexOf(":")===-1;return e.substring(0,2)==="//"?t?e:r.replace(h2,"$1")+e:e.charAt(0)==="/"?t?e:r.replace(f2,"$1")+e:r+e}const p2={exec:function(){}};function g2(r){let e=1,t,i;for(;e<arguments.length;e++){t=arguments[e];for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r}function m2(r,e){const t=r.replace(/\|/g,(s,o,a)=>{let c=!1,l=o;for(;--l>=0&&a[l]==="\\";)c=!c;return c?"|":" |"}),i=t.split(/ \|/);let n=0;if(i[0].trim()||i.shift(),i[i.length-1].trim()||i.pop(),i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;n<i.length;n++)i[n]=i[n].trim().replace(/\\\|/g,"|");return i}function Vy(r,e,t){const i=r.length;if(i===0)return"";let n=0;for(;n<i;){const s=r.charAt(i-n-1);if(s===e&&!t)n++;else if(s!==e&&t)n++;else break}return r.substr(0,i-n)}function v2(r,e){if(r.indexOf(e[1])===-1)return-1;const t=r.length;let i=0,n=0;for(;n<t;n++)if(r[n]==="\\")n++;else if(r[n]===e[0])i++;else if(r[n]===e[1]&&(i--,i<0))return n;return-1}function _2(r){r&&r.sanitize&&!r.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function w2(r,e){if(e<1)return"";let t="";for(;e>1;)e&1&&(t+=r),e>>=1,r+=r;return t+r}var Io={escape:r2,unescape:By,edit:a2,cleanUrl:u2,resolveUrl:Wy,noopTest:p2,merge:g2,splitCells:m2,rtrim:Vy,findClosingBracket:v2,checkSanitizeDeprecation:_2,repeatString:w2};const{defaults:b2}=us.exports,{rtrim:pg,splitCells:zy,escape:Ei,findClosingBracket:y2}=Io;function jy(r,e,t,i){const n=e.href,s=e.title?Ei(e.title):null,o=r[1].replace(/\\([\[\]])/g,"$1");if(r[0].charAt(0)!=="!"){i.state.inLink=!0;const a={type:"link",raw:t,href:n,title:s,text:o,tokens:i.inlineTokens(o,[])};return i.state.inLink=!1,a}else return{type:"image",raw:t,href:n,title:s,text:Ei(o)}}function x2(r,e){const t=r.match(/^(\s+)(?:```)/);if(t===null)return e;const i=t[1];return e.split(`
`).map(n=>{const s=n.match(/^\s+/);if(s===null)return n;const[o]=s;return o.length>=i.length?n.slice(i.length):n}).join(`
`)}var qy=class{constructor(e){this.options=e||b2}space(e){const t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:`
`}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:pg(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],n=x2(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim():t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const s=pg(i,"#");(this.options.pedantic||!s||/ $/.test(s))&&(i=s.trim())}const n={type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const i=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(i,[]),text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i,n,s,o,a,c,l,u,d,h,g=t[1].trim();const w=g.length>1,p={type:"list",raw:"",ordered:w,start:w?+g.slice(0,-1):"",loose:!1,items:[]};g=w?`\\d{1,9}\\${g.slice(-1)}`:`\\${g}`,this.options.pedantic&&(g=w?g:"[*+-]");const b=new RegExp(`^( {0,3}${g})((?: [^\\n]*| *)(?:\\n[^\\n]*)*(?:\\n|$))`);for(;e&&!(this.rules.block.hr.test(e)||!(t=b.exec(e)));){d=t[2].split(`
`),this.options.pedantic?(o=2,h=d[0].trimLeft()):(o=t[2].search(/[^ ]/),o=t[1].length+(o>4?1:o),h=d[0].slice(o-t[1].length)),c=!1,i=t[0],!d[0]&&/^ *$/.test(d[1])&&(i=t[1]+d.slice(0,2).join(`
`)+`
`,p.loose=!0,d=[]);const D=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(a=1;a<d.length;a++){if(u=d[a],this.options.pedantic&&(u=u.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),D.test(u)){i=t[1]+d.slice(0,a).join(`
`)+`
`;break}if(!c){u.trim()||(c=!0),u.search(/[^ ]/)>=o?h+=`
`+u.slice(o):h+=`
`+u;continue}if(u.search(/[^ ]/)>=o||!u.trim()){h+=`
`+u.slice(o);continue}else{i=t[1]+d.slice(0,a).join(`
`)+`
`;break}}p.loose||(l?p.loose=!0:/\n *\n *$/.test(i)&&(l=!0)),this.options.gfm&&(n=/^\[[ xX]\] /.exec(h),n&&(s=n[0]!=="[ ] ",h=h.replace(/^\[[ xX]\] +/,""))),p.items.push({type:"list_item",raw:i,task:!!n,checked:s,loose:!1,text:h}),p.raw+=i,e=e.slice(i.length)}p.items[p.items.length-1].raw=i.trimRight(),p.items[p.items.length-1].text=h.trimRight(),p.raw=p.raw.trimRight();const k=p.items.length;for(a=0;a<k;a++)this.lexer.state.top=!1,p.items[a].tokens=this.lexer.blockTokens(p.items[a].text,[]),p.items[a].tokens.some(D=>D.type==="space")&&(p.loose=!0,p.items[a].loose=!0);return p}}html(e){const t=this.rules.block.html.exec(e);if(t){const i={type:"html",raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};return this.options.sanitize&&(i.type="paragraph",i.text=this.options.sanitizer?this.options.sanitizer(t[0]):Ei(t[0]),i.tokens=[],this.lexer.inline(i.text,i.tokens)),i}}def(e){const t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}table(e){const t=this.rules.block.table.exec(e);if(t){const i={type:"table",header:zy(t[1]).map(n=>({text:n})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]?t[3].replace(/\n$/,"").split(`
`):[]};if(i.header.length===i.align.length){i.raw=t[0];let n=i.align.length,s,o,a,c;for(s=0;s<n;s++)/^ *-+: *$/.test(i.align[s])?i.align[s]="right":/^ *:-+: *$/.test(i.align[s])?i.align[s]="center":/^ *:-+ *$/.test(i.align[s])?i.align[s]="left":i.align[s]=null;for(n=i.rows.length,s=0;s<n;s++)i.rows[s]=zy(i.rows[s],i.header.length).map(l=>({text:l}));for(n=i.header.length,o=0;o<n;o++)i.header[o].tokens=[],this.lexer.inlineTokens(i.header[o].text,i.header[o].tokens);for(n=i.rows.length,o=0;o<n;o++)for(c=i.rows[o],a=0;a<c.length;a++)c[a].tokens=[],this.lexer.inlineTokens(c[a].text,c[a].tokens);return i}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t){const i={type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i={type:"paragraph",raw:t[0],text:t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}text(e){const t=this.rules.block.text.exec(e);if(t){const i={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Ei(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):Ei(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const o=pg(i.slice(0,-1),"\\");if((i.length-o.length)%2===0)return}else{const o=y2(t[2],"()");if(o>-1){const c=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,c).trim(),t[3]=""}}let n=t[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);o&&(n=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(this.options.pedantic&&!/>$/.test(i)?n=n.slice(1):n=n.slice(1,-1)),jy(t,{href:n&&n.replace(this.rules.inline._escapes,"$1"),title:s&&s.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){let n=(i[2]||i[1]).replace(/\s+/g," ");if(n=t[n.toLowerCase()],!n||!n.href){const s=i[0].charAt(0);return{type:"text",raw:s,text:s}}return jy(i,n,i[0],this.lexer)}}emStrong(e,t,i=""){let n=this.rules.inline.emStrong.lDelim.exec(e);if(!n||n[3]&&i.match(/[\p{L}\p{N}]/u))return;const s=n[1]||n[2]||"";if(!s||s&&(i===""||this.rules.inline.punctuation.exec(i))){const o=n[0].length-1;let a,c,l=o,u=0;const d=n[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+o);(n=d.exec(t))!=null;){if(a=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!a)continue;if(c=a.length,n[3]||n[4]){l+=c;continue}else if((n[5]||n[6])&&o%3&&!((o+c)%3)){u+=c;continue}if(l-=c,l>0)continue;if(c=Math.min(c,c+l+u),Math.min(o,c)%2){const g=e.slice(1,o+n.index+c);return{type:"em",raw:e.slice(0,o+n.index+c+1),text:g,tokens:this.lexer.inlineTokens(g,[])}}const h=e.slice(2,o+n.index+c-1);return{type:"strong",raw:e.slice(0,o+n.index+c+1),text:h,tokens:this.lexer.inlineTokens(h,[])}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const n=/[^ ]/.test(i),s=/^ /.test(i)&&/ $/.test(i);return n&&s&&(i=i.substring(1,i.length-1)),i=Ei(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}}autolink(e,t){const i=this.rules.inline.autolink.exec(e);if(i){let n,s;return i[2]==="@"?(n=Ei(this.options.mangle?t(i[1]):i[1]),s="mailto:"+n):(n=Ei(i[1]),s=n),{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}url(e,t){let i;if(i=this.rules.inline.url.exec(e)){let n,s;if(i[2]==="@")n=Ei(this.options.mangle?t(i[0]):i[0]),s="mailto:"+n;else{let o;do o=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0];while(o!==i[0]);n=Ei(i[0]),i[1]==="www."?s="http://"+n:s=n}return{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e,t){const i=this.rules.inline.text.exec(e);if(i){let n;return this.lexer.state.inRawBlock?n=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):Ei(i[0]):i[0]:n=Ei(this.options.smartypants?t(i[0]):i[0]),{type:"text",raw:i[0],text:n}}}};const{noopTest:id,edit:at,merge:ds}=Io,Ee={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:id,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/};Ee._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,Ee._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,Ee.def=at(Ee.def).replace("label",Ee._label).replace("title",Ee._title).getRegex(),Ee.bullet=/(?:[*+-]|\d{1,9}[.)])/,Ee.listItemStart=at(/^( *)(bull) */).replace("bull",Ee.bullet).getRegex(),Ee.list=at(Ee.list).replace(/bull/g,Ee.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Ee.def.source+")").getRegex(),Ee._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ee._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Ee.html=at(Ee.html,"i").replace("comment",Ee._comment).replace("tag",Ee._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ee.paragraph=at(Ee._paragraph).replace("hr",Ee.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ee._tag).getRegex(),Ee.blockquote=at(Ee.blockquote).replace("paragraph",Ee.paragraph).getRegex(),Ee.normal=ds({},Ee),Ee.gfm=ds({},Ee.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)\\|?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Ee.gfm.table=at(Ee.gfm.table).replace("hr",Ee.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ee._tag).getRegex(),Ee.pedantic=ds({},Ee.normal,{html:at(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ee._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:id,paragraph:at(Ee.normal._paragraph).replace("hr",Ee.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ee.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const he={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:id,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:id,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};he._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",he.punctuation=at(he.punctuation).replace(/punctuation/g,he._punctuation).getRegex(),he.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,he.escapedEmSt=/\\\*|\\_/g,he._comment=at(Ee._comment).replace("(?:-->|$)","-->").getRegex(),he.emStrong.lDelim=at(he.emStrong.lDelim).replace(/punct/g,he._punctuation).getRegex(),he.emStrong.rDelimAst=at(he.emStrong.rDelimAst,"g").replace(/punct/g,he._punctuation).getRegex(),he.emStrong.rDelimUnd=at(he.emStrong.rDelimUnd,"g").replace(/punct/g,he._punctuation).getRegex(),he._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,he._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,he._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,he.autolink=at(he.autolink).replace("scheme",he._scheme).replace("email",he._email).getRegex(),he._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,he.tag=at(he.tag).replace("comment",he._comment).replace("attribute",he._attribute).getRegex(),he._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,he._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,he._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,he.link=at(he.link).replace("label",he._label).replace("href",he._href).replace("title",he._title).getRegex(),he.reflink=at(he.reflink).replace("label",he._label).getRegex(),he.reflinkSearch=at(he.reflinkSearch,"g").replace("reflink",he.reflink).replace("nolink",he.nolink).getRegex(),he.normal=ds({},he),he.pedantic=ds({},he.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:at(/^!?\[(label)\]\((.*?)\)/).replace("label",he._label).getRegex(),reflink:at(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",he._label).getRegex()}),he.gfm=ds({},he.normal,{escape:at(he.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),he.gfm.url=at(he.gfm.url,"i").replace("email",he.gfm._extended_email).getRegex(),he.breaks=ds({},he.gfm,{br:at(he.br).replace("{2,}","*").getRegex(),text:at(he.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var C2={block:Ee,inline:he};const S2=qy,{defaults:E2}=us.exports,{block:nd,inline:Pc}=C2,{repeatString:Gy}=Io;function k2(r){return r.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function Qy(r){let e="",t,i;const n=r.length;for(t=0;t<n;t++)i=r.charCodeAt(t),Math.random()>.5&&(i="x"+i.toString(16)),e+="&#"+i+";";return e}var D2=class Qw{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||E2,this.options.tokenizer=this.options.tokenizer||new S2,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:nd.normal,inline:Pc.normal};this.options.pedantic?(t.block=nd.pedantic,t.inline=Pc.pedantic):this.options.gfm&&(t.block=nd.gfm,this.options.breaks?t.inline=Pc.breaks:t.inline=Pc.gfm),this.tokenizer.rules=t}static get rules(){return{block:nd,inline:Pc}}static lex(e,t){return new Qw(t).lex(e)}static lexInline(e,t){return new Qw(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic&&(e=e.replace(/^ +$/gm,""));let i,n,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(i=a.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length),i.type&&t.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+i.raw,n.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const c=e.slice(1);let l;this.options.extensions.startBlock.forEach(function(u){l=u.call({lexer:this},c),typeof l=="number"&&l>=0&&(a=Math.min(a,l))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s))){n=t[t.length-1],o&&n.type==="paragraph"?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i),o=s.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&n.type==="text"?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t){this.inlineQueue.push({src:e,tokens:t})}inlineTokens(e,t=[]){let i,n,s,o=e,a,c,l;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+Gy("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+Gy("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.escapedEmSt.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(c||(l=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(i=u.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),n=t[t.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,o,l)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e,Qy)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e,Qy))){e=e.substring(i.raw.length),t.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=e.slice(1);let h;this.options.extensions.startInline.forEach(function(g){h=g.call({lexer:this},d),typeof h=="number"&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(s=e.substring(0,u+1))}if(i=this.tokenizer.inlineText(s,k2)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(l=i.raw.slice(-1)),c=!0,n=t[t.length-1],n&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return t}};const{defaults:I2}=us.exports,{cleanUrl:Jy,escape:rd}=Io;var Ky=class{constructor(e){this.options=e||I2}code(e,t,i){const n=(t||"").match(/\S*/)[0];if(this.options.highlight){const s=this.options.highlight(e,n);s!=null&&s!==e&&(i=!0,e=s)}return e=e.replace(/\n$/,"")+`
`,n?'<pre><code class="'+this.options.langPrefix+rd(n,!0)+'">'+(i?e:rd(e,!0))+`</code></pre>
`:"<pre><code>"+(i?e:rd(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
`+e+`</blockquote>
`}html(e){return e}heading(e,t,i,n){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+n.slug(i)+'">'+e+"</h"+t+`>
`:"<h"+t+">"+e+"</h"+t+`>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t,i){const n=t?"ol":"ul",s=t&&i!==1?' start="'+i+'"':"";return"<"+n+s+`>
`+e+"</"+n+`>
`}listitem(e){return"<li>"+e+`</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+`</p>
`}table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
`+e+`</tr>
`}tablecell(e,t){const i=t.header?"th":"td";return(t.align?"<"+i+' align="'+t.align+'">':"<"+i+">")+e+"</"+i+`>
`}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,i){if(e=Jy(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let n='<a href="'+rd(e)+'"';return t&&(n+=' title="'+t+'"'),n+=">"+i+"</a>",n}image(e,t,i){if(e=Jy(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let n='<img src="'+e+'" alt="'+i+'"';return t&&(n+=' title="'+t+'"'),n+=this.options.xhtml?"/>":">",n}text(e){return e}},Xy=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,i){return""+i}image(e,t,i){return""+i}br(){return""}},Yy=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let i=e,n=0;if(this.seen.hasOwnProperty(i)){n=this.seen[e];do n++,i=e+"-"+n;while(this.seen.hasOwnProperty(i))}return t||(this.seen[e]=n,this.seen[i]=0),i}slug(e,t={}){const i=this.serialize(e);return this.getNextSafeSlug(i,t.dryrun)}};const P2=Ky,T2=Xy,A2=Yy,{defaults:R2}=us.exports,{unescape:L2}=Io;var O2=class Jw{constructor(e){this.options=e||R2,this.options.renderer=this.options.renderer||new P2,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new T2,this.slugger=new A2}static parse(e,t){return new Jw(t).parse(e)}static parseInline(e,t){return new Jw(t).parseInline(e)}parse(e,t=!0){let i="",n,s,o,a,c,l,u,d,h,g,w,p,b,k,D,C,R,A,B;const Q=e.length;for(n=0;n<Q;n++){if(g=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[g.type]&&(B=this.options.extensions.renderers[g.type].call({parser:this},g),B!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(g.type))){i+=B||"";continue}switch(g.type){case"space":continue;case"hr":{i+=this.renderer.hr();continue}case"heading":{i+=this.renderer.heading(this.parseInline(g.tokens),g.depth,L2(this.parseInline(g.tokens,this.textRenderer)),this.slugger);continue}case"code":{i+=this.renderer.code(g.text,g.lang,g.escaped);continue}case"table":{for(d="",u="",a=g.header.length,s=0;s<a;s++)u+=this.renderer.tablecell(this.parseInline(g.header[s].tokens),{header:!0,align:g.align[s]});for(d+=this.renderer.tablerow(u),h="",a=g.rows.length,s=0;s<a;s++){for(l=g.rows[s],u="",c=l.length,o=0;o<c;o++)u+=this.renderer.tablecell(this.parseInline(l[o].tokens),{header:!1,align:g.align[o]});h+=this.renderer.tablerow(u)}i+=this.renderer.table(d,h);continue}case"blockquote":{h=this.parse(g.tokens),i+=this.renderer.blockquote(h);continue}case"list":{for(w=g.ordered,p=g.start,b=g.loose,a=g.items.length,h="",s=0;s<a;s++)D=g.items[s],C=D.checked,R=D.task,k="",D.task&&(A=this.renderer.checkbox(C),b?D.tokens.length>0&&D.tokens[0].type==="paragraph"?(D.tokens[0].text=A+" "+D.tokens[0].text,D.tokens[0].tokens&&D.tokens[0].tokens.length>0&&D.tokens[0].tokens[0].type==="text"&&(D.tokens[0].tokens[0].text=A+" "+D.tokens[0].tokens[0].text)):D.tokens.unshift({type:"text",text:A}):k+=A),k+=this.parse(D.tokens,b),h+=this.renderer.listitem(k,R,C);i+=this.renderer.list(h,w,p);continue}case"html":{i+=this.renderer.html(g.text);continue}case"paragraph":{i+=this.renderer.paragraph(this.parseInline(g.tokens));continue}case"text":{for(h=g.tokens?this.parseInline(g.tokens):g.text;n+1<Q&&e[n+1].type==="text";)g=e[++n],h+=`
`+(g.tokens?this.parseInline(g.tokens):g.text);i+=t?this.renderer.paragraph(h):h;continue}default:{const ee='Token with "'+g.type+'" type was not found.';if(this.options.silent){console.error(ee);return}else throw new Error(ee)}}}return i}parseInline(e,t){t=t||this.renderer;let i="",n,s,o;const a=e.length;for(n=0;n<a;n++){if(s=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]&&(o=this.options.extensions.renderers[s.type].call({parser:this},s),o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type))){i+=o||"";continue}switch(s.type){case"escape":{i+=t.text(s.text);break}case"html":{i+=t.html(s.text);break}case"link":{i+=t.link(s.href,s.title,this.parseInline(s.tokens,t));break}case"image":{i+=t.image(s.href,s.title,s.text);break}case"strong":{i+=t.strong(this.parseInline(s.tokens,t));break}case"em":{i+=t.em(this.parseInline(s.tokens,t));break}case"codespan":{i+=t.codespan(s.text);break}case"br":{i+=t.br();break}case"del":{i+=t.del(this.parseInline(s.tokens,t));break}case"text":{i+=t.text(s.text);break}default:{const c='Token with "'+s.type+'" type was not found.';if(this.options.silent){console.error(c);return}else throw new Error(c)}}}return i}};const Tc=D2,Ac=O2,Zy=qy,e1=Ky,$2=Xy,N2=Yy,{merge:sd,checkSanitizeDeprecation:t1,escape:i1}=Io,{getDefaults:F2,changeDefaults:M2,defaults:H2}=us.exports;function Ie(r,e,t){if(typeof r>"u"||r===null)throw new Error("marked(): input parameter is undefined or null");if(typeof r!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected");if(typeof e=="function"&&(t=e,e=null),e=sd({},Ie.defaults,e||{}),t1(e),t){const i=e.highlight;let n;try{n=Tc.lex(r,e)}catch(a){return t(a)}const s=function(a){let c;if(!a)try{e.walkTokens&&Ie.walkTokens(n,e.walkTokens),c=Ac.parse(n,e)}catch(l){a=l}return e.highlight=i,a?t(a):t(null,c)};if(!i||i.length<3||(delete e.highlight,!n.length))return s();let o=0;Ie.walkTokens(n,function(a){a.type==="code"&&(o++,setTimeout(()=>{i(a.text,a.lang,function(c,l){if(c)return s(c);l!=null&&l!==a.text&&(a.text=l,a.escaped=!0),o--,o===0&&s()})},0))}),o===0&&s();return}try{const i=Tc.lex(r,e);return e.walkTokens&&Ie.walkTokens(i,e.walkTokens),Ac.parse(i,e)}catch(i){if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+i1(i.message+"",!0)+"</pre>";throw i}}Ie.options=Ie.setOptions=function(r){return sd(Ie.defaults,r),M2(Ie.defaults),Ie},Ie.getDefaults=F2,Ie.defaults=H2,Ie.use=function(...r){const e=sd({},...r),t=Ie.defaults.extensions||{renderers:{},childTokens:{}};let i;r.forEach(n=>{if(n.extensions&&(i=!0,n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if(s.renderer){const o=t.renderers?t.renderers[s.name]:null;o?t.renderers[s.name]=function(...a){let c=s.renderer.apply(this,a);return c===!1&&(c=o.apply(this,a)),c}:t.renderers[s.name]=s.renderer}if(s.tokenizer){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");t[s.level]?t[s.level].unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}s.childTokens&&(t.childTokens[s.name]=s.childTokens)})),n.renderer){const s=Ie.defaults.renderer||new e1;for(const o in n.renderer){const a=s[o];s[o]=(...c)=>{let l=n.renderer[o].apply(s,c);return l===!1&&(l=a.apply(s,c)),l}}e.renderer=s}if(n.tokenizer){const s=Ie.defaults.tokenizer||new Zy;for(const o in n.tokenizer){const a=s[o];s[o]=(...c)=>{let l=n.tokenizer[o].apply(s,c);return l===!1&&(l=a.apply(s,c)),l}}e.tokenizer=s}if(n.walkTokens){const s=Ie.defaults.walkTokens;e.walkTokens=o=>{n.walkTokens.call(this,o),s&&s(o)}}i&&(e.extensions=t),Ie.setOptions(e)})},Ie.walkTokens=function(r,e){for(const t of r)switch(e(t),t.type){case"table":{for(const i of t.header)Ie.walkTokens(i.tokens,e);for(const i of t.rows)for(const n of i)Ie.walkTokens(n.tokens,e);break}case"list":{Ie.walkTokens(t.items,e);break}default:Ie.defaults.extensions&&Ie.defaults.extensions.childTokens&&Ie.defaults.extensions.childTokens[t.type]?Ie.defaults.extensions.childTokens[t.type].forEach(function(i){Ie.walkTokens(t[i],e)}):t.tokens&&Ie.walkTokens(t.tokens,e)}},Ie.parseInline=function(r,e){if(typeof r>"u"||r===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof r!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected");e=sd({},Ie.defaults,e||{}),t1(e);try{const t=Tc.lexInline(r,e);return e.walkTokens&&Ie.walkTokens(t,e.walkTokens),Ac.parseInline(t,e)}catch(t){if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+i1(t.message+"",!0)+"</pre>";throw t}},Ie.Parser=Ac,Ie.parser=Ac.parse,Ie.Renderer=e1,Ie.TextRenderer=$2,Ie.Lexer=Tc,Ie.lexer=Tc.lex,Ie.Tokenizer=Zy,Ie.Slugger=N2,Ie.parse=Ie;var n1=Ie;function U2(r){let e=JSON.parse(r);return e=Yi(e),e}function Yi(r,e=0){if(!r||e>200)return r;if(typeof r=="object"){switch(r.$mid){case 1:return y.revive(r);case 2:return new RegExp(r.source,r.flags);case 17:return new Date(r.source)}if(r instanceof me||r instanceof Uint8Array)return r;if(Array.isArray(r))for(let t=0;t<r.length;++t)r[t]=Yi(r[t],e+1);else for(const t in r)Object.hasOwnProperty.call(r,t)&&(r[t]=Yi(r[t],e+1))}return r}const Cn=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),B2=/^(.+)\/(.+?)(;.+)?$/;function r1(r,e){const t=B2.exec(r);return t?`${t[1].toLowerCase()}/${t[2].toLowerCase()}${t[3]??""}`:e?void 0:r}let ki=class ho{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new ho(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return ho.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return ho.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return ho.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const i=e.lineNumber|0,n=t.lineNumber|0;if(i===n){const s=e.column|0,o=t.column|0;return s-o}return i-n}clone(){return new ho(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new ho(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},ze=class xt{constructor(e,t,i,n){e>i||e===i&&t>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return xt.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return xt.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return xt.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return xt.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return xt.plusRange(this,e)}static plusRange(e,t){let i,n,s,o;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,n=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,n=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,n=e.startColumn),t.endLineNumber>e.endLineNumber?(s=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(s=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(s=e.endLineNumber,o=e.endColumn),new xt(i,n,s,o)}intersectRanges(e){return xt.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,n=e.startColumn,s=e.endLineNumber,o=e.endColumn;const a=t.startLineNumber,c=t.startColumn,l=t.endLineNumber,u=t.endColumn;return i<a?(i=a,n=c):i===a&&(n=Math.max(n,c)),s>l?(s=l,o=u):s===l&&(o=Math.min(o,u)),i>s||i===s&&n>o?null:new xt(i,n,s,o)}equalsRange(e){return xt.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return xt.getEndPosition(this)}static getEndPosition(e){return new ki(e.endLineNumber,e.endColumn)}getStartPosition(){return xt.getStartPosition(this)}static getStartPosition(e){return new ki(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new xt(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new xt(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return xt.collapseToStart(this)}static collapseToStart(e){return new xt(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return xt.collapseToEnd(this)}static collapseToEnd(e){return new xt(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new xt(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new xt(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new xt(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const s=e.startLineNumber|0,o=t.startLineNumber|0;if(s===o){const a=e.startColumn|0,c=t.startColumn|0;if(a===c){const l=e.endLineNumber|0,u=t.endLineNumber|0;if(l===u){const d=e.endColumn|0,h=t.endColumn|0;return d-h}return l-u}return a-c}return s-o}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};class W2{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new T,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),Le(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){var n;(n=this._factories.get(e))==null||n.dispose();const i=new V2(this,e,t);return this._factories.set(e,i),Le(()=>{const s=this._factories.get(e);!s||s!==i||(this._factories.delete(e),s.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}}class V2 extends Be{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}}var s1;(function(r){const e=new Map;e.set(0,ce.symbolMethod),e.set(1,ce.symbolFunction),e.set(2,ce.symbolConstructor),e.set(3,ce.symbolField),e.set(4,ce.symbolVariable),e.set(5,ce.symbolClass),e.set(6,ce.symbolStruct),e.set(7,ce.symbolInterface),e.set(8,ce.symbolModule),e.set(9,ce.symbolProperty),e.set(10,ce.symbolEvent),e.set(11,ce.symbolOperator),e.set(12,ce.symbolUnit),e.set(13,ce.symbolValue),e.set(15,ce.symbolEnum),e.set(14,ce.symbolConstant),e.set(15,ce.symbolEnum),e.set(16,ce.symbolEnumMember),e.set(17,ce.symbolKeyword),e.set(27,ce.symbolSnippet),e.set(18,ce.symbolText),e.set(19,ce.symbolColor),e.set(20,ce.symbolFile),e.set(21,ce.symbolReference),e.set(22,ce.symbolCustomColor),e.set(23,ce.symbolFolder),e.set(24,ce.symbolTypeParameter),e.set(25,ce.account),e.set(26,ce.issues);function t(s){let o=e.get(s);return o||(console.info("No codicon found for CompletionItemKind "+s),o=ce.symbolProperty),o}r.toIcon=t;const i=new Map;i.set("method",0),i.set("function",1),i.set("constructor",2),i.set("field",3),i.set("variable",4),i.set("class",5),i.set("struct",6),i.set("interface",7),i.set("module",8),i.set("property",9),i.set("event",10),i.set("operator",11),i.set("unit",12),i.set("value",13),i.set("constant",14),i.set("enum",15),i.set("enum-member",16),i.set("enumMember",16),i.set("keyword",17),i.set("snippet",27),i.set("text",18),i.set("color",19),i.set("file",20),i.set("reference",21),i.set("customcolor",22),i.set("folder",23),i.set("type-parameter",24),i.set("typeParameter",24),i.set("account",25),i.set("issue",26);function n(s,o){let a=i.get(s);return typeof a>"u"&&!o&&(a=9),a}r.fromString=n})(s1||(s1={}));var od;(function(r){r[r.Automatic=0]="Automatic",r[r.Explicit=1]="Explicit"})(od||(od={}));var o1;(function(r){r[r.Invoke=1]="Invoke",r[r.TriggerCharacter=2]="TriggerCharacter",r[r.ContentChange=3]="ContentChange"})(o1||(o1={}));var a1;(function(r){r[r.Text=0]="Text",r[r.Read=1]="Read",r[r.Write=2]="Write"})(a1||(a1={}));function z2(r){return r&&y.isUri(r.uri)&&ze.isIRange(r.range)&&(ze.isIRange(r.originSelectionRange)||ze.isIRange(r.targetSelectionRange))}m("vs/editor/common/languages","Array","array"),m("vs/editor/common/languages","Boolean","boolean"),m("vs/editor/common/languages","Class","class"),m("vs/editor/common/languages","Constant","constant"),m("vs/editor/common/languages","Constructor","constructor"),m("vs/editor/common/languages","Enum","enumeration"),m("vs/editor/common/languages","EnumMember","enumeration member"),m("vs/editor/common/languages","Event","event"),m("vs/editor/common/languages","Field","field"),m("vs/editor/common/languages","File","file"),m("vs/editor/common/languages","Function","function"),m("vs/editor/common/languages","Interface","interface"),m("vs/editor/common/languages","Key","key"),m("vs/editor/common/languages","Method","method"),m("vs/editor/common/languages","Module","module"),m("vs/editor/common/languages","Namespace","namespace"),m("vs/editor/common/languages","Null","null"),m("vs/editor/common/languages","Number","number"),m("vs/editor/common/languages","Object","object"),m("vs/editor/common/languages","Operator","operator"),m("vs/editor/common/languages","Package","package"),m("vs/editor/common/languages","Property","property"),m("vs/editor/common/languages","String","string"),m("vs/editor/common/languages","Struct","struct"),m("vs/editor/common/languages","TypeParameter","type parameter"),m("vs/editor/common/languages","Variable","variable");var c1;(function(r){const e=new Map;e.set(0,ce.symbolFile),e.set(1,ce.symbolModule),e.set(2,ce.symbolNamespace),e.set(3,ce.symbolPackage),e.set(4,ce.symbolClass),e.set(5,ce.symbolMethod),e.set(6,ce.symbolProperty),e.set(7,ce.symbolField),e.set(8,ce.symbolConstructor),e.set(9,ce.symbolEnum),e.set(10,ce.symbolInterface),e.set(11,ce.symbolFunction),e.set(12,ce.symbolVariable),e.set(13,ce.symbolConstant),e.set(14,ce.symbolString),e.set(15,ce.symbolNumber),e.set(16,ce.symbolBoolean),e.set(17,ce.symbolArray),e.set(18,ce.symbolObject),e.set(19,ce.symbolKey),e.set(20,ce.symbolNull),e.set(21,ce.symbolEnumMember),e.set(22,ce.symbolStruct),e.set(23,ce.symbolEvent),e.set(24,ce.symbolOperator),e.set(25,ce.symbolTypeParameter);function t(i){let n=e.get(i);return n||(console.info("No codicon found for SymbolKind "+i),n=ce.symbolProperty),n}r.toIcon=t})(c1||(c1={}));let Po=(hi=class{static fromValue(e){switch(e){case"comment":return hi.Comment;case"imports":return hi.Imports;case"region":return hi.Region}return new hi(e)}constructor(e){this.value=e}},hi.Comment=new hi("comment"),hi.Imports=new hi("imports"),hi.Region=new hi("region"),hi);var gg;(function(r){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}r.is=e})(gg||(gg={}));var To;(function(r){r[r.Collapsed=0]="Collapsed",r[r.Expanded=1]="Expanded"})(To||(To={}));var Rc;(function(r){r[r.Unresolved=0]="Unresolved",r[r.Resolved=1]="Resolved"})(Rc||(Rc={}));var l1;(function(r){r[r.Editing=0]="Editing",r[r.Preview=1]="Preview"})(l1||(l1={}));var u1;(function(r){r[r.Type=1]="Type",r[r.Parameter=2]="Parameter"})(u1||(u1={})),new W2;var d1;(function(r){r[r.None=0]="None",r[r.Option=1]="Option",r[r.Default=2]="Default",r[r.Preferred=3]="Preferred"})(d1||(d1={}));var ad;(function(r){r[r.Invoke=0]="Invoke",r[r.Automatic=1]="Automatic"})(ad||(ad={}));var Yt;(function(r){r[r.Hint=1]="Hint",r[r.Info=2]="Info",r[r.Warning=4]="Warning",r[r.Error=8]="Error"})(Yt||(Yt={})),function(r){function e(o,a){return a-o}r.compare=e;const t=Object.create(null);t[r.Error]=m("vs/platform/markers/common/markers","sev.error","Error"),t[r.Warning]=m("vs/platform/markers/common/markers","sev.warning","Warning"),t[r.Info]=m("vs/platform/markers/common/markers","sev.info","Info");function i(o){return t[o]||""}r.toString=i;function n(o){switch(o){case tt.Error:return r.Error;case tt.Warning:return r.Warning;case tt.Info:return r.Info;case tt.Ignore:return r.Hint}}r.fromSeverity=n;function s(o){switch(o){case r.Error:return tt.Error;case r.Warning:return tt.Warning;case r.Info:return tt.Info;case r.Hint:return tt.Ignore}}r.toSeverity=s}(Yt||(Yt={}));var h1;(function(r){const e="";function t(n){return i(n,!0)}r.makeKey=t;function i(n,s){const o=[e];return n.source?o.push(n.source.replace("¦","\\¦")):o.push(e),n.code?typeof n.code=="string"?o.push(n.code.replace("¦","\\¦")):o.push(n.code.value.replace("¦","\\¦")):o.push(e),n.severity!==void 0&&n.severity!==null?o.push(Yt.toString(n.severity)):o.push(e),n.message&&s?o.push(n.message.replace("¦","\\¦")):o.push(e),n.startLineNumber!==void 0&&n.startLineNumber!==null?o.push(n.startLineNumber.toString()):o.push(e),n.startColumn!==void 0&&n.startColumn!==null?o.push(n.startColumn.toString()):o.push(e),n.endLineNumber!==void 0&&n.endLineNumber!==null?o.push(n.endLineNumber.toString()):o.push(e),n.endColumn!==void 0&&n.endColumn!==null?o.push(n.endColumn.toString()):o.push(e),o.push(e),o.join("¦")}r.makeKeyOptionalMessage=i})(h1||(h1={})),ne("markerService");function ci(r,e){if(!r)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function j2(r,e="Unreachable"){throw new Error(e)}class we{static fromExtHostTestItem(e,t,i=e.parent){if(e._isRoot)return new we([t]);const n=[e.id];for(let s=i;s&&s.id!==t;s=s.parent)n.push(s.id);return n.push(t),new we(n.reverse())}static isRoot(e){return!e.includes("\0")}static root(e){const t=e.indexOf("\0");return t===-1?e:e.slice(0,t)}static fromString(e){return new we(e.split("\0"))}static join(e,t){return new we([...e.path,t])}static joinToString(e,t){return e.toString()+"\0"+t}static parentId(e){const t=e.lastIndexOf("\0");return t===-1?void 0:e.slice(0,t)}static localId(e){const t=e.lastIndexOf("\0");return t===-1?e:e.slice(t+1)}static isChild(e,t){return t.startsWith(e)&&t[e.length]==="\0"}static compare(e,t){return e===t?0:we.isChild(e,t)?2:we.isChild(t,e)?3:1}constructor(e,t=e.length){if(this.path=e,this.viewEnd=t,e.length===0||t<1)throw new Error("cannot create test with empty path")}get rootId(){return new we(this.path,1)}get parentId(){return this.viewEnd>1?new we(this.path,this.viewEnd-1):void 0}get localId(){return this.path[this.viewEnd-1]}get controllerId(){return this.path[0]}get isRoot(){return this.viewEnd===1}*idsFromRoot(){for(let e=1;e<=this.viewEnd;e++)yield new we(this.path,e)}*idsToRoot(){for(let e=this.viewEnd;e>0;e--)yield new we(this.path,e)}compare(e){if(typeof e=="string")return we.compare(this.toString(),e);for(let t=0;t<e.viewEnd&&t<this.viewEnd;t++)if(e.path[t]!==this.path[t])return 1;return e.viewEnd>this.viewEnd?2:e.viewEnd<this.viewEnd?3:0}toJSON(){return this.toString()}toString(){if(!this.stringifed){this.stringifed=this.path[0];for(let e=1;e<this.viewEnd;e++)this.stringifed+="\0",this.stringifed+=this.path[e]}return this.stringifed}}const q2=r=>"runId"in r;var Ao;(function(r){r.serialize=e=>({range:e.range.toJSON(),uri:e.uri.toJSON()}),r.deserialize=(e,t)=>({range:ze.lift(t.range),uri:e.asCanonicalUri(y.revive(t.uri))})})(Ao||(Ao={}));var cd;(function(r){r.serialize=e=>({message:e.message,type:0,expected:e.expected,actual:e.actual,contextValue:e.contextValue,location:e.location&&Ao.serialize(e.location)}),r.deserialize=(e,t)=>({message:t.message,type:0,expected:t.expected,actual:t.actual,contextValue:t.contextValue,location:t.location&&Ao.deserialize(e,t.location)})})(cd||(cd={}));var ld;(function(r){r.serialize=e=>({message:e.message,type:1,offset:e.offset,length:e.length,location:e.location&&Ao.serialize(e.location)}),r.deserialize=(e,t)=>({message:t.message,type:1,offset:t.offset,length:t.length,location:t.location&&Ao.deserialize(e,t.location)})})(ld||(ld={}));var ud;(function(r){r.serialize=e=>e.type===0?cd.serialize(e):ld.serialize(e),r.deserialize=(e,t)=>t.type===0?cd.deserialize(e,t):ld.deserialize(e,t)})(ud||(ud={}));var Lc;(function(r){r.serializeWithoutMessages=e=>({state:e.state,duration:e.duration,messages:[]}),r.serialize=e=>({state:e.state,duration:e.duration,messages:e.messages.map(ud.serialize)}),r.deserialize=(e,t)=>({state:t.state,duration:t.duration,messages:t.messages.map(i=>ud.deserialize(e,i))})})(Lc||(Lc={}));const f1="\0",dd=(r,e)=>r+f1+e,p1=r=>{const e=r.indexOf(f1);return{ctrlId:r.slice(0,e),tagId:r.slice(e+1)}};var hd;(function(r){r.serialize=e=>{var t,i;return{extId:e.extId,label:e.label,tags:e.tags,busy:e.busy,children:void 0,uri:(t=e.uri)==null?void 0:t.toJSON(),range:((i=e.range)==null?void 0:i.toJSON())||null,description:e.description,error:e.error,sortText:e.sortText}},r.deserialize=(e,t)=>({extId:t.extId,label:t.label,tags:t.tags,busy:t.busy,children:void 0,uri:t.uri?e.asCanonicalUri(y.revive(t.uri)):void 0,range:t.range?ze.lift(t.range):null,description:t.description,error:t.error,sortText:t.sortText})})(hd||(hd={}));var hr;(function(r){r.serialize=e=>({expand:e.expand,item:hd.serialize(e.item)}),r.deserialize=(e,t)=>({controllerId:we.root(t.item.extId),expand:t.expand,item:hd.deserialize(e,t.item)})})(hr||(hr={}));var Oc;(function(r){r.serialize=e=>{var i,n;let t;return e.item&&(t={},e.item.label!==void 0&&(t.label=e.item.label),e.item.tags!==void 0&&(t.tags=e.item.tags),e.item.busy!==void 0&&(t.busy=e.item.busy),e.item.uri!==void 0&&(t.uri=(i=e.item.uri)==null?void 0:i.toJSON()),e.item.range!==void 0&&(t.range=(n=e.item.range)==null?void 0:n.toJSON()),e.item.description!==void 0&&(t.description=e.item.description),e.item.error!==void 0&&(t.error=e.item.error),e.item.sortText!==void 0&&(t.sortText=e.item.sortText)),{extId:e.extId,expand:e.expand,item:t}},r.deserialize=e=>{let t;return e.item&&(t={},e.item.label!==void 0&&(t.label=e.item.label),e.item.tags!==void 0&&(t.tags=e.item.tags),e.item.busy!==void 0&&(t.busy=e.item.busy),e.item.range!==void 0&&(t.range=e.item.range?ze.lift(e.item.range):null),e.item.description!==void 0&&(t.description=e.item.description),e.item.error!==void 0&&(t.error=e.item.error),e.item.sortText!==void 0&&(t.sortText=e.item.sortText)),{extId:e.extId,expand:e.expand,item:t}}})(Oc||(Oc={}));const mg=(r,e)=>{e.expand!==void 0&&(r.expand=e.expand),e.item!==void 0&&(r.item=r.item?Object.assign(r.item,e.item):e.item)};var g1;(function(r){r.serializeWithoutMessages=e=>({...hr.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(Lc.serializeWithoutMessages)}),r.serialize=e=>({...hr.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(Lc.serialize)}),r.deserialize=(e,t)=>({...hr.deserialize(e,t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(i=>Lc.deserialize(e,i)),retired:!0})})(g1||(g1={}));var m1;(function(r){r.empty=()=>({covered:0,total:0}),r.sum=(e,t)=>{e.covered+=t.covered,e.total+=t.total}})(m1||(m1={}));var v1;(function(r){r.serialize=e=>{var t;return{statement:e.statement,branch:e.branch,declaration:e.declaration,details:(t=e.details)==null?void 0:t.map(fd.serialize),uri:e.uri.toJSON()}},r.deserialize=(e,t)=>{var i;return{statement:t.statement,branch:t.branch,declaration:t.declaration,details:(i=t.details)==null?void 0:i.map(fd.deserialize),uri:e.asCanonicalUri(y.revive(t.uri))}}})(v1||(v1={}));function vg(r){var e;return{...r,location:(e=r.location)==null?void 0:e.toJSON()}}function _g(r){return r.location=r.location?ki.isIPosition(r.location)?ki.lift(r.location):ze.lift(r.location):void 0,r}const G2=3;var fd;(function(r){r.serialize=e=>e.type===0?gd.serialize(e):md.serialize(e),r.deserialize=e=>e.type===0?gd.deserialize(e):md.deserialize(e)})(fd||(fd={}));var pd;(function(r){r.serialize=vg,r.deserialize=_g})(pd||(pd={}));var gd;(function(r){r.serialize=vg,r.deserialize=_g})(gd||(gd={}));var md;(function(r){r.serialize=e=>{var t;return{...vg(e),branches:(t=e.branches)==null?void 0:t.map(pd.serialize)}},r.deserialize=e=>{var t;return{..._g(e),branches:(t=e.branches)==null?void 0:t.map(pd.deserialize)}}})(md||(md={}));var vd;(function(r){r.deserialize=(e,t)=>t.op===0?{op:t.op,item:hr.deserialize(e,t.item)}:t.op===1?{op:t.op,item:Oc.deserialize(t.item)}:t.op===2?{op:t.op,uri:e.asCanonicalUri(y.revive(t.uri)),docv:t.docv}:t,r.serialize=e=>e.op===0?{op:e.op,item:hr.serialize(e.item)}:e.op===1?{op:e.op,item:Oc.serialize(e.item)}:e})(vd||(vd={}));class Q2{constructor(e){this.uriIdentity=e,this._tags=new Map,this.items=new Map,this.roots=new Set,this.busyControllerCount=0,this.pendingRootCount=0,this.tags=this._tags}apply(e){var i;const t=this.createChangeCollector();for(const n of e)switch(n.op){case 0:this.add(hr.deserialize(this.uriIdentity,n.item),t);break;case 1:this.update(Oc.deserialize(n.item),t);break;case 3:this.remove(n.itemId,t);break;case 5:this.retireTest(n.itemId);break;case 4:this.updatePendingRoots(n.amount);break;case 6:this._tags.set(n.tag.id,n.tag);break;case 7:this._tags.delete(n.id);break}(i=t.complete)==null||i.call(t)}add(e,t){var s,o;const i=(s=we.parentId(e.item.extId))==null?void 0:s.toString();let n;if(!i)n=this.createItem(e),this.roots.add(n),this.items.set(e.item.extId,n);else if(this.items.has(i)){const a=this.items.get(i);a.children.add(e.item.extId),n=this.createItem(e,a),this.items.set(e.item.extId,n)}else{console.error(`Test with unknown parent ID: ${JSON.stringify(e)}`);return}return(o=t.add)==null||o.call(t,n),e.expand===2&&this.busyControllerCount++,n}update(e,t){var n;const i=this.items.get(e.extId);if(i)return e.expand!==void 0&&(i.expand===2&&this.busyControllerCount--,e.expand===2&&this.busyControllerCount++),mg(i,e),(n=t.update)==null||n.call(t,i),i}remove(e,t){var o,a;const i=this.items.get(e);if(!i)return;const n=(o=we.parentId(i.item.extId))==null?void 0:o.toString();n?this.items.get(n).children.delete(i.item.extId):this.roots.delete(i);const s=[[e]];for(;s.length;)for(const c of s.pop()){const l=this.items.get(c);l&&(s.push(l.children),this.items.delete(c),(a=t.remove)==null||a.call(t,l,l!==i),l.expand===2&&this.busyControllerCount--)}}retireTest(e){}updatePendingRoots(e){this.pendingRootCount+=e}createChangeCollector(){return{}}}const $c=(r,e)=>r===e,J2=Object.entries({range:(r,e)=>r===e?!0:!r||!e?!1:r.equalsRange(e),busy:$c,label:$c,description:$c,error:$c,sortText:$c,tags:(r,e)=>!(r.length!==e.length||r.some(t=>!e.includes(t)))}),K2=(r,e)=>{let t;for(const[i,n]of J2)n(r[i],e[i])||(t?t[i]=e[i]:t={[i]:e[i]});return t};class X2 extends Be{get root(){return this.options.root}constructor(e){super(),this.options=e,this.debounceSendDiff=this._register(new _c(()=>this.flushDiff(),200)),this.diffOpEmitter=this._register(new T),this.tree=new Map,this.tags=new Map,this.diff=[],this.onDidGenerateDiff=this.diffOpEmitter.event,this.root.canResolveChildren=!0,this.upsertItem(this.root,void 0)}set resolveHandler(e){this._resolveHandler=e;for(const t of this.tree.values())this.updateExpandability(t)}get resolveHandler(){return this._resolveHandler}collectDiff(){const e=this.diff;return this.diff=[],e}pushDiff(e){switch(e.op){case 2:{for(const t of this.diff)if(t.op===2&&t.uri===e.uri){t.docv=e.docv;return}break}case 1:{const t=this.diff[this.diff.length-1];if(t){if(t.op===1&&t.item.extId===e.item.extId){mg(t.item,e.item);return}if(t.op===0&&t.item.item.extId===e.item.extId){mg(t.item,e.item);return}}break}}this.diff.push(e),this.debounceSendDiff.isScheduled()||this.debounceSendDiff.schedule()}expand(e,t){var n;const i=this.tree.get(e);if(i){if((i.expandLevels===void 0||t>i.expandLevels)&&(i.expandLevels=t),i.expand===1){const s=this.resolveChildren(i);return s.isOpen()?this.expandChildren(i,t-1):s.wait().then(()=>this.expandChildren(i,t-1))}else if(i.expand===3)return((n=i.resolveBarrier)==null?void 0:n.isOpen())===!1?i.resolveBarrier.wait().then(()=>this.expandChildren(i,t-1)):this.expandChildren(i,t-1)}}dispose(){for(const e of this.tree.values())this.options.getApiFor(e.actual).listener=void 0;this.tree.clear(),this.diff=[],super.dispose()}onTestItemEvent(e,t){switch(t.op){case 3:this.removeItem(we.joinToString(e.fullId,t.id));break;case 0:this.upsertItem(t.item,e);break;case 5:for(const i of t.ops)this.onTestItemEvent(e,i);break;case 1:this.diffTagRefs(t.new,t.old,e.fullId.toString());break;case 2:this.updateExpandability(e);break;case 4:this.pushDiff({op:1,item:{extId:e.fullId.toString(),item:t.update}});break;case 6:this.documentSynced(e.actual.uri);break;default:j2()}}documentSynced(e){e&&this.pushDiff({op:2,uri:e,docv:this.options.getDocumentVersion(e)})}upsertItem(e,t){var l,u;const i=we.fromExtHostTestItem(e,this.root.id,t==null?void 0:t.actual),n=this.options.getApiFor(e);n.parent&&n.parent!==(t==null?void 0:t.actual)&&this.options.getChildren(n.parent).delete(e.id);let s=this.tree.get(i.toString());if(!s){s={fullId:i,actual:e,expandLevels:t!=null&&t.expandLevels?t.expandLevels-1:void 0,expand:0},e.tags.forEach(this.incrementTagRefs,this),this.tree.set(s.fullId.toString(),s),this.setItemParent(e,t),this.pushDiff({op:0,item:{controllerId:this.options.controllerId,expand:s.expand,item:this.options.toITestItem(e)}}),this.connectItemAndChildren(e,s,t);return}if(s.actual===e){this.connectItem(e,s,t);return}if(((l=s.actual.uri)==null?void 0:l.toString())!==((u=e.uri)==null?void 0:u.toString()))return this.removeItem(i.toString()),this.upsertItem(e,t);const o=this.options.getChildren(s.actual),a=s.actual,c=K2(this.options.toITestItem(a),this.options.toITestItem(e));this.options.getApiFor(a).listener=void 0,s.actual=e,s.expand=0,c&&(c.hasOwnProperty("tags")&&(this.diffTagRefs(e.tags,a.tags,i.toString()),delete c.tags),this.onTestItemEvent(s,{op:4,update:c})),this.connectItemAndChildren(e,s,t);for(const[d,h]of o)this.options.getChildren(e).get(h.id)||this.removeItem(we.joinToString(i,h.id));this.documentSynced(s.actual.uri)}diffTagRefs(e,t,i){const n=new Set(t.map(s=>s.id));for(const s of e)n.delete(s.id)||this.incrementTagRefs(s);this.pushDiff({op:1,item:{extId:i,item:{tags:e.map(s=>dd(this.options.controllerId,s.id))}}}),n.forEach(this.decrementTagRefs,this)}incrementTagRefs(e){const t=this.tags.get(e.id);t?t.refCount++:(this.tags.set(e.id,{refCount:1}),this.pushDiff({op:6,tag:{id:dd(this.options.controllerId,e.id)}}))}decrementTagRefs(e){const t=this.tags.get(e);t&&!--t.refCount&&(this.tags.delete(e),this.pushDiff({op:7,id:dd(this.options.controllerId,e)}))}setItemParent(e,t){this.options.getApiFor(e).parent=t&&t.actual!==this.root?t.actual:void 0}connectItem(e,t,i){this.setItemParent(e,i);const n=this.options.getApiFor(e);n.parent=i==null?void 0:i.actual,n.listener=s=>this.onTestItemEvent(t,s),this.updateExpandability(t)}connectItemAndChildren(e,t,i){this.connectItem(e,t,i);for(const[n,s]of this.options.getChildren(e))this.upsertItem(s,t)}updateExpandability(e){let t;this._resolveHandler?e.resolveBarrier?t=e.resolveBarrier.isOpen()?3:2:t=e.actual.canResolveChildren?1:0:t=0,t!==e.expand&&(e.expand=t,this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:t}}),t===1&&e.expandLevels!==void 0&&this.resolveChildren(e))}expandChildren(e,t){if(t<0)return;const i=[];for(const[n,s]of this.options.getChildren(e.actual)){const o=this.expand(we.joinToString(e.fullId,s.id),t);cr(o)&&i.push(o)}if(i.length)return Promise.all(i).then(()=>{})}resolveChildren(e){if(e.resolveBarrier)return e.resolveBarrier;if(!this._resolveHandler){const s=new wn;return s.open(),s}e.expand=2,this.pushExpandStateUpdate(e);const t=e.resolveBarrier=new wn,i=s=>{console.error(`Unhandled error in resolveHandler of test controller "${this.options.controllerId}"`,s)};let n;try{n=this._resolveHandler(e.actual===this.root?void 0:e.actual)}catch(s){i(s)}return cr(n)?n.catch(i).then(()=>{t.open(),this.updateExpandability(e)}):(t.open(),this.updateExpandability(e)),e.resolveBarrier}pushExpandStateUpdate(e){this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:e.expand}})}removeItem(e){const t=this.tree.get(e);if(!t)throw new Error("attempting to remove non-existent child");this.pushDiff({op:3,itemId:e});const i=[t];for(;i.length;){const n=i.pop();if(n){this.options.getApiFor(n.actual).listener=void 0;for(const s of n.actual.tags)this.decrementTagRefs(s.id);this.tree.delete(n.fullId.toString());for(const[s,o]of this.options.getChildren(n.actual))i.push(this.tree.get(we.joinToString(n.fullId,o.id)))}}}flushDiff(){const e=this.collectDiff();e.length&&this.diffOpEmitter.fire(e)}}class Y2 extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}}class _d extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}}class Z2 extends Error{constructor(e,t,i){super(`TestItem with ID "${e}" is from controller "${t}" and cannot be added as a child of an item from controller "${i}".`)}}const eD=(r,e,t)=>{let i=new Map;return{get size(){return i.size},forEach(n,s){for(const o of i.values())n.call(s,o,this)},[Symbol.iterator](){return i.entries()},replace(n){var c;const s=new Map,o=new Set(i.keys()),a={op:5,ops:[]};for(const l of n){if(!(l instanceof t))throw new _d(l.id);const u=e(l).controllerId;if(u!==r.controllerId)throw new Z2(l.id,u,r.controllerId);if(s.has(l.id))throw new Y2(l.id);s.set(l.id,l),o.delete(l.id),a.ops.push({op:0,item:l})}for(const l of o.keys())a.ops.push({op:3,id:l});(c=r.listener)==null||c.call(r,a),i=s},add(n){var s;if(!(n instanceof t))throw new _d(n.id);i.set(n.id,n),(s=r.listener)==null||s.call(r,{op:0,item:n})},delete(n){var s;i.delete(n)&&((s=r.listener)==null||s.call(r,{op:3,id:n}))},get(n){return i.get(n)},toJSON(){return Array.from(i.values())}}},_1=new WeakMap,tD=(r,e)=>{const t={controllerId:e};return _1.set(r,t),t},wd=r=>{const e=_1.get(r);if(!e)throw new _d((r==null?void 0:r.id)||"<unknown>");return e};class iD{constructor(){this.data=new Map}add(e,t){ci(Ne(e)),ci(Ft(t)),ci(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}}const mi=new iD;ne("fileService");var hs;(function(r){r[r.Unknown=0]="Unknown",r[r.File=1]="File",r[r.Directory=2]="Directory",r[r.SymbolicLink=64]="SymbolicLink"})(hs||(hs={}));var Ro;(function(r){r[r.Readonly=1]="Readonly",r[r.Locked=2]="Locked"})(Ro||(Ro={}));var w1;(function(r){r[r.None=0]="None",r[r.FileReadWrite=2]="FileReadWrite",r[r.FileOpenReadWriteClose=4]="FileOpenReadWriteClose",r[r.FileReadStream=16]="FileReadStream",r[r.FileFolderCopy=8]="FileFolderCopy",r[r.PathCaseSensitive=1024]="PathCaseSensitive",r[r.Readonly=2048]="Readonly",r[r.Trash=4096]="Trash",r[r.FileWriteUnlock=8192]="FileWriteUnlock",r[r.FileAtomicRead=16384]="FileAtomicRead",r[r.FileAtomicWrite=32768]="FileAtomicWrite",r[r.FileAtomicDelete=65536]="FileAtomicDelete",r[r.FileClone=131072]="FileClone"})(w1||(w1={}));var Ce;(function(r){r.FileExists="EntryExists",r.FileNotFound="EntryNotFound",r.FileNotADirectory="EntryNotADirectory",r.FileIsADirectory="EntryIsADirectory",r.FileExceedsStorageQuota="EntryExceedsStorageQuota",r.FileTooLarge="EntryTooLarge",r.FileWriteLocked="EntryWriteLocked",r.NoPermissions="NoPermissions",r.Unavailable="Unavailable",r.Unknown="Unknown"})(Ce||(Ce={}));class bd extends Error{static create(e,t){const i=new bd(e.toString(),t);return b1(i,t),i}constructor(e,t){super(e),this.code=t}}function b1(r,e){return r.name=e?`${e} (FileSystemError)`:"FileSystemError",r}function wg(r){if(!r)return Ce.Unknown;if(r instanceof bd)return r.code;const e=/^(.+) \(FileSystemError\)$/.exec(r.name);if(!e)return Ce.Unknown;switch(e[1]){case Ce.FileExists:return Ce.FileExists;case Ce.FileIsADirectory:return Ce.FileIsADirectory;case Ce.FileNotADirectory:return Ce.FileNotADirectory;case Ce.FileNotFound:return Ce.FileNotFound;case Ce.FileTooLarge:return Ce.FileTooLarge;case Ce.FileWriteLocked:return Ce.FileWriteLocked;case Ce.NoPermissions:return Ce.NoPermissions;case Ce.Unavailable:return Ce.Unavailable}return Ce.Unknown}var y1;(function(r){r[r.UPDATED=0]="UPDATED",r[r.ADDED=1]="ADDED",r[r.DELETED=2]="DELETED"})(y1||(y1={}));class x1 extends Error{constructor(e,t,i){super(e),this.fileOperationResult=t,this.options=i}}var C1;(function(r){r[r.FILE=0]="FILE",r[r.FOLDER=1]="FOLDER",r[r.ROOT_FOLDER=2]="ROOT_FOLDER"})(C1||(C1={}));const nD="";function S1(r){if(!(typeof r.size!="number"||typeof r.mtime!="number"))return r.mtime.toString(29)+r.size.toString(31)}const Et=class Et{static formatSize(e){return or(e)||(e=0),e<Et.KB?m("vs/platform/files/common/files","sizeB","{0}B",e.toFixed(0)):e<Et.MB?m("vs/platform/files/common/files","sizeKB","{0}KB",(e/Et.KB).toFixed(2)):e<Et.GB?m("vs/platform/files/common/files","sizeMB","{0}MB",(e/Et.MB).toFixed(2)):e<Et.TB?m("vs/platform/files/common/files","sizeGB","{0}GB",(e/Et.GB).toFixed(2)):m("vs/platform/files/common/files","sizeTB","{0}TB",(e/Et.TB).toFixed(2))}};Et.KB=1024,Et.MB=Et.KB*Et.KB,Et.GB=Et.MB*Et.KB,Et.TB=Et.GB*Et.KB;let E1=Et;class rD extends Be{constructor(e,t="",i="",n=!0,s){super(),this._onDidChange=this._register(new T),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=n,this._actionCallback=s}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}}const Mf=class Mf extends rD{constructor(){super(Mf.ID,m("vs/base/common/actions","submenu.empty","(empty)"),void 0,!1)}};Mf.ID="vs.actions.empty";let k1=Mf;const sD={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},oD={id:"default",displayName:m("vs/workbench/common/editor","promptOpenWith.defaultEditor.displayName","Text Editor"),providerDisplayName:m("vs/workbench/common/editor","builtinProviderDisplayName","Built-in")};var D1;(function(r){r[r.None=0]="None",r[r.Readonly=2]="Readonly",r[r.Untitled=4]="Untitled",r[r.Singleton=8]="Singleton",r[r.RequiresTrust=16]="RequiresTrust",r[r.CanSplitInGroup=32]="CanSplitInGroup",r[r.ForceDescription=64]="ForceDescription",r[r.CanDropIntoEditor=128]="CanDropIntoEditor",r[r.MultipleEditors=256]="MultipleEditors",r[r.Scratchpad=512]="Scratchpad",r[r.AuxWindowUnsupported=1024]="AuxWindowUnsupported"})(D1||(D1={}));var I1;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.REPLACE=1]="REPLACE",r[r.MOVE=2]="MOVE",r[r.UNPIN=3]="UNPIN"})(I1||(I1={}));var P1;(function(r){r[r.PRIMARY=1]="PRIMARY",r[r.SECONDARY=2]="SECONDARY",r[r.BOTH=3]="BOTH",r[r.ANY=4]="ANY"})(P1||(P1={}));var T1;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.KEYBOARD=1]="KEYBOARD",r[r.MOUSE=2]="MOUSE"})(T1||(T1={}));var A1;(function(r){r[r.LEFT=0]="LEFT",r[r.RIGHT=1]="RIGHT"})(A1||(A1={}));class aD{constructor(){this.editorSerializerConstructors=new Map,this.editorSerializerInstances=new Map}start(e){const t=this.instantiationService=e.get(qu);for(const[i,n]of this.editorSerializerConstructors)this.createEditorSerializer(i,n,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,i){const n=i.createInstance(t);this.editorSerializerInstances.set(e,n)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return yo(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),Le(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}}mi.add(sD.EditorFactory,new aD);var R1;(function(r){r[r.MOST_RECENTLY_ACTIVE=0]="MOST_RECENTLY_ACTIVE",r[r.SEQUENTIAL=1]="SEQUENTIAL"})(R1||(R1={}));const Nc="**",bg="/",yd="[/\\\\]",xd="[^/\\\\]",cD=/\//g;function L1(r,e){switch(r){case 0:return"";case 1:return`${xd}*?`;default:return`(?:${yd}|${xd}+${yd}${e?`|${yd}${xd}+`:""})*?`}}function yg(r,e){if(!r)return[];const t=[];let i=!1,n=!1,s="";for(const o of r){switch(o){case e:if(!i&&!n){t.push(s),s="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}s+=o}return s&&t.push(s),t}function O1(r){if(!r)return"";let e="";const t=yg(r,bg);if(t.every(i=>i===Nc))e=".*";else{let i=!1;t.forEach((n,s)=>{if(n===Nc){if(i)return;e+=L1(2,s===t.length-1)}else{let o=!1,a="",c=!1,l="";for(const u of n){if(u!=="}"&&o){a+=u;continue}if(c&&(u!=="]"||!l)){let d;u==="-"?d=u:(u==="^"||u==="!")&&!l?d="^":u===bg?d="":d=wo(u),l+=d;continue}switch(u){case"{":o=!0;continue;case"[":c=!0;continue;case"}":{const h=`(?:${yg(a,",").map(g=>O1(g)).join("|")})`;e+=h,o=!1,a="";break}case"]":{e+="["+l+"]",c=!1,l="";break}case"?":e+=xd;continue;case"*":e+=L1(1);continue;default:e+=wo(u)}}s<t.length-1&&(t[s+1]!==Nc||s+2<t.length)&&(e+=yd)}i=n===Nc})}return e}const lD=/^\*\*\/\*\.[\w\.-]+$/,uD=/^\*\*\/([\w\.-]+)\/?$/,dD=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,hD=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,fD=/^\*\*((\/[\w\.-]+)+)\/?$/,pD=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,$1=new ab(1e4),N1=function(){return!1},Zi=function(){return null};function xg(r,e){if(!r)return Zi;let t;typeof r!="string"?t=r.pattern:t=r,t=t.trim();const i=`${t}_${!!e.trimForExclusions}`;let n=$1.get(i);if(n)return F1(n,r);let s;return lD.test(t)?n=gD(t.substr(4),t):(s=uD.exec(Cg(t,e)))?n=mD(s[1],t):(e.trimForExclusions?hD:dD).test(t)?n=vD(t,e):(s=fD.exec(Cg(t,e)))?n=M1(s[1].substr(1),t,!0):(s=pD.exec(Cg(t,e)))?n=M1(s[1],t,!1):n=_D(t),$1.set(i,n),F1(n,r)}function F1(r,e){if(typeof e=="string")return r;const t=function(i,n){return ju(i,e.base,!tr)?r(lE(i.substr(e.base.length),Ri),n):null};return t.allBasenames=r.allBasenames,t.allPaths=r.allPaths,t.basenames=r.basenames,t.patterns=r.patterns,t}function Cg(r,e){return e.trimForExclusions&&r.endsWith("/**")?r.substr(0,r.length-2):r}function gD(r,e){return function(t,i){return typeof t=="string"&&t.endsWith(r)?e:null}}function mD(r,e){const t=`/${r}`,i=`\\${r}`,n=function(o,a){return typeof o!="string"?null:a?a===r?e:null:o===r||o.endsWith(t)||o.endsWith(i)?e:null},s=[r];return n.basenames=s,n.patterns=[e],n.allBasenames=s,n}function vD(r,e){const t=H1(r.slice(1,-1).split(",").map(a=>xg(a,e)).filter(a=>a!==Zi),r),i=t.length;if(!i)return Zi;if(i===1)return t[0];const n=function(a,c){for(let l=0,u=t.length;l<u;l++)if(t[l](a,c))return r;return null},s=t.find(a=>!!a.allBasenames);s&&(n.allBasenames=s.allBasenames);const o=t.reduce((a,c)=>c.allPaths?a.concat(c.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function M1(r,e,t){const i=Ri===Me.sep,n=i?r:r.replace(cD,Ri),s=Ri+n,o=Me.sep+r;let a;return t?a=function(c,l){return typeof c=="string"&&(c===n||c.endsWith(s)||!i&&(c===r||c.endsWith(o)))?e:null}:a=function(c,l){return typeof c=="string"&&(c===n||!i&&c===r)?e:null},a.allPaths=[(t?"*/":"./")+r],a}function _D(r){try{const e=new RegExp(`^${O1(r)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?r:null}}catch{return Zi}}function Fc(r,e,t){return!r||typeof e!="string"?!1:Lo(r)(e,void 0,t)}function Lo(r,e={}){if(!r)return N1;if(typeof r=="string"||wD(r)){const t=xg(r,e);if(t===Zi)return N1;const i=function(n,s){return!!t(n,s)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return bD(r,e)}function wD(r){const e=r;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function bD(r,e){const t=H1(Object.getOwnPropertyNames(r).map(a=>yD(a,r[a],e)).filter(a=>a!==Zi)),i=t.length;if(!i)return Zi;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(u,d){let h;for(let g=0,w=t.length;g<w;g++){const p=t[g](u,d);if(typeof p=="string")return p;cr(p)&&(h||(h=[]),h.push(p))}return h?(async()=>{for(const g of h){const w=await g;if(typeof w=="string")return w}return null})():null},c=t.find(u=>!!u.allBasenames);c&&(a.allBasenames=c.allBasenames);const l=t.reduce((u,d)=>d.allPaths?u.concat(d.allPaths):u,[]);return l.length&&(a.allPaths=l),a}const n=function(a,c,l){let u,d;for(let h=0,g=t.length;h<g;h++){const w=t[h];w.requiresSiblings&&l&&(c||(c=ai(a)),u||(u=c.substr(0,c.length-Op(a).length)));const p=w(a,c,u,l);if(typeof p=="string")return p;cr(p)&&(d||(d=[]),d.push(p))}return d?(async()=>{for(const h of d){const g=await h;if(typeof g=="string")return g}return null})():null},s=t.find(a=>!!a.allBasenames);s&&(n.allBasenames=s.allBasenames);const o=t.reduce((a,c)=>c.allPaths?a.concat(c.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function yD(r,e,t){if(e===!1)return Zi;const i=xg(r,t);if(i===Zi)return Zi;if(typeof e=="boolean")return i;if(e){const n=e.when;if(typeof n=="string"){const s=(o,a,c,l)=>{if(!l||!i(o,a))return null;const u=n.replace("$(basename)",()=>c),d=l(u);return cr(d)?d.then(h=>h?r:null):d?r:null};return s.requiresSiblings=!0,s}}return i}function H1(r,e){const t=r.filter(a=>!!a.basenames);if(t.length<2)return r;const i=t.reduce((a,c)=>{const l=c.basenames;return l?a.concat(l):a},[]);let n;if(e){n=[];for(let a=0,c=i.length;a<c;a++)n.push(e)}else n=t.reduce((a,c)=>{const l=c.patterns;return l?a.concat(l):a},[]);const s=function(a,c){if(typeof a!="string")return null;if(!c){let u;for(u=a.length;u>0;u--){const d=a.charCodeAt(u-1);if(d===47||d===92)break}c=a.substr(u)}const l=i.indexOf(c);return l!==-1?n[l]:null};s.basenames=i,s.patterns=n,s.allBasenames=i;const o=r.filter(a=>!a.basenames);return o.push(s),o}ne("notebookDocumentService");const Sg=["W","X","Y","Z","a","b","c","d","e","f"],xD=new RegExp(`^[${Sg.join("")}]+`),U1=7;function CD(r){if(r.scheme!==Z.vscodeNotebookCell)return;const e=r.fragment.indexOf("s");if(e<0)return;const t=parseInt(r.fragment.substring(0,e).replace(xD,""),U1),i=_S(r.fragment.substring(e+1)).toString();if(!isNaN(t))return{handle:t,notebook:r.with({scheme:i,fragment:null})}}function SD(r,e){const t=e.toString(U1),n=`${t.length<Sg.length?Sg[t.length-1]:"z"}${t}s${ub(me.fromString(r.scheme),!0,!0)}`;return r.with({scheme:Z.vscodeNotebookCell,fragment:n})}var Oo;(function(r){r[r.Markup=1]="Markup",r[r.Code=2]="Code"})(Oo||(Oo={})),Cn.latex,Cn.markdown,Cn.text,Cn.latex,Cn.markdown,Cn.text;var Mc;(function(r){r[r.Unconfirmed=1]="Unconfirmed",r[r.Pending=2]="Pending",r[r.Executing=3]="Executing"})(Mc||(Mc={}));var B1;(function(r){r[r.Unconfirmed=1]="Unconfirmed",r[r.Pending=2]="Pending",r[r.Executing=3]="Executing"})(B1||(B1={}));var Fi;(function(r){r[r.ModelChange=1]="ModelChange",r[r.Move=2]="Move",r[r.ChangeCellLanguage=5]="ChangeCellLanguage",r[r.Initialize=6]="Initialize",r[r.ChangeCellMetadata=7]="ChangeCellMetadata",r[r.Output=8]="Output",r[r.OutputItem=9]="OutputItem",r[r.ChangeCellContent=10]="ChangeCellContent",r[r.ChangeDocumentMetadata=11]="ChangeDocumentMetadata",r[r.ChangeCellInternalMetadata=12]="ChangeCellInternalMetadata",r[r.ChangeCellMime=13]="ChangeCellMime",r[r.Unknown=100]="Unknown"})(Fi||(Fi={}));var W1;(function(r){r[r.Handle=0]="Handle",r[r.Index=1]="Index"})(W1||(W1={}));var V1;(function(r){r.scheme=Z.vscodeNotebookCell;function e(a,c){return SD(a,c)}r.generate=e;function t(a){return CD(a)}r.parse=t;function i(a,c){return a.with({scheme:Z.vscodeNotebookCellOutput,fragment:`op${c??""},${a.scheme!==Z.file?a.scheme:""}`})}r.generateCellOutputUri=i;function n(a){if(a.scheme!==Z.vscodeNotebookCellOutput)return;const c=/^op([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})?\,(.*)$/i.exec(a.fragment);if(!c)return;const l=c[1]&&c[1]!==""?c[1]:void 0,u=c[2];return{outputId:l,notebook:a.with({scheme:u||Z.file,fragment:null})}}r.parseCellOutputUri=n;function s(a,c,l){return r.generate(a,c).with({scheme:l})}r.generateCellPropertyUri=s;function o(a,c){if(a.scheme===c)return r.parse(a.with({scheme:r.scheme}))}r.parseCellPropertyUri=o})(V1||(V1={})),new re("notebookEditorCursorAtBoundary","none"),new re("notebookEditorCursorAtLineBoundary","none");var z1;(function(r){r.default="default",r.option="option"})(z1||(z1={}));function j1(r){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(r)}const ED=new TextDecoder;function kD(r){const e=[];let t=!1;for(const o of r)(e.length===0||t)&&(e.push(o),t=!0);let i=ID(e);const n=me.concat(e.map(o=>me.wrap(o))),s=LD(n);return i=i||s.byteLength!==n.byteLength,{data:s,didCompression:i}}const Cd="\x1B[A",Eg=Cd.split("").map(r=>r.charCodeAt(0)),DD=10;function ID(r){let e=!1;return r.forEach((t,i)=>{if(i===0||t.length<Cd.length)return;const n=r[i-1],s=t.subarray(0,Cd.length);if(s[0]===Eg[0]&&s[1]===Eg[1]&&s[2]===Eg[2]){const o=n.lastIndexOf(DD);if(o===-1)return;e=!0,r[i-1]=n.subarray(0,o),r[i]=t.subarray(Cd.length)}}),e}function PD(r){let e=r;do r=e,e=r.replace(/[^\n]\x08/gm,"");while(e.length<r.length);return r}function TD(r){for(r=r.replace(/\r+\n/gm,`
`);r.search(/\r[^$]/g)>-1;){const e=r.match(/^(.*)\r+/m)[1];let t=r.match(/\r+(.*)$/m)[1];t=t+e.slice(t.length,e.length),r=r.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,t)}return r}const AD=8,RD=13;function LD(r){return!r.buffer.includes(AD)&&!r.buffer.includes(RD)?r:me.fromString(TD(PD(ED.decode(r.buffer))))}const OD=ne("editorGroupsService");var q1;(function(r){r[r.UP=0]="UP",r[r.DOWN=1]="DOWN",r[r.LEFT=2]="LEFT",r[r.RIGHT=3]="RIGHT"})(q1||(q1={}));var G1;(function(r){r[r.HORIZONTAL=0]="HORIZONTAL",r[r.VERTICAL=1]="VERTICAL"})(G1||(G1={}));var Q1;(function(r){r[r.FIRST=0]="FIRST",r[r.LAST=1]="LAST",r[r.NEXT=2]="NEXT",r[r.PREVIOUS=3]="PREVIOUS"})(Q1||(Q1={}));var J1;(function(r){r[r.MAXIMIZE=0]="MAXIMIZE",r[r.EXPAND=1]="EXPAND",r[r.EVEN=2]="EVEN"})(J1||(J1={}));var K1;(function(r){r[r.COPY_EDITORS=0]="COPY_EDITORS",r[r.MOVE_EDITORS=1]="MOVE_EDITORS"})(K1||(K1={}));var X1;(function(r){r[r.CREATION_TIME=0]="CREATION_TIME",r[r.MOST_RECENTLY_ACTIVE=1]="MOST_RECENTLY_ACTIVE",r[r.GRID_APPEARANCE=2]="GRID_APPEARANCE"})(X1||(X1={})),ne("editorService");const $D=-1,ND=-2;ne("extensionGalleryService");var Y1;(function(r){r.Unsupported="Unsupported",r.Deprecated="Deprecated",r.Malicious="Malicious",r.Incompatible="Incompatible",r.IncompatibleTargetPlatform="IncompatibleTargetPlatform",r.ReleaseVersionNotFound="ReleaseVersionNotFound",r.Invalid="Invalid",r.Download="Download",r.DownloadSignature="DownloadSignature",r.UpdateMetadata="UpdateMetadata",r.Extract="Extract",r.Scanning="Scanning",r.Delete="Delete",r.Rename="Rename",r.CorruptZip="CorruptZip",r.IncompleteZip="IncompleteZip",r.Signature="Signature",r.NotAllowed="NotAllowed",r.Gallery="Gallery",r.Unknown="Unknown",r.Internal="Internal"})(Y1||(Y1={}));var Z1;(function(r){r.Timeout="Timeout",r.Cancelled="Cancelled",r.Failed="Failed"})(Z1||(Z1={})),ne("extensionManagementService"),ne("IGlobalExtensionEnablementService"),ne("IExtensionTipsService"),fb("vs/platform/extensionManagement/common/extensionManagement","extensions","Extensions"),fb("vs/platform/extensionManagement/common/extensionManagement","preferences","Preferences");function kg(r){if(!r)return;const e=r.indexOf("+");return e<0?r:r.substr(0,e)}class Xe{constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(typeof e>"u"||e===null)return typeof t>"u"||t===null;if(typeof t>"u"||t===null)return!1;if(typeof e=="string"||typeof t=="string"){const i=typeof e=="string"?e:e.value,n=typeof t=="string"?t:t.value;return is(i,n)}return e._lower===t._lower}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class $o{get size(){return this._set.size}constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(Xe.toKey(e))}delete(e){return this._set.delete(Xe.toKey(e))}has(e){return this._set.has(Xe.toKey(e))}}class fr{constructor(){this._map=new Map}clear(){this._map.clear()}delete(e){this._map.delete(Xe.toKey(e))}get(e){return this._map.get(Xe.toKey(e))}has(e){return this._map.has(Xe.toKey(e))}set(e,t){this._map.set(Xe.toKey(e),t)}values(){return this._map.values()}forEach(e){this._map.forEach(e)}[Symbol.iterator](){return this._map[Symbol.iterator]()}}ne("IBuiltinExtensionsScannerService"),ne("telemetryService"),ne("customEndpointTelemetryService");class Dg{constructor(e){this.value=e,this.isTrustedTelemetryValue=!0}}const FD="extensionTelemetryLog",MD=new Set(["ssh-remote","dev-container","attached-container","wsl","tunnel","codespaces","amlext"]);function HD(r){if(!r)return"none";const e=kg(r);return MD.has(e)?e:"other"}function UD(r,e){if(!r||!r.includes("/")&&!r.includes("\\"))return r;let t=r;const i=[];for(const a of e)for(;;){const c=a.exec(r);if(!c)break;i.push([c.index,a.lastIndex])}const n=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let o=0;for(t="";;){const a=s.exec(r);if(!a)break;const c=i.some(([l,u])=>a.index<u&&l<s.lastIndex);!n.test(a[0])&&!c&&(t+=r.substring(o,a.index)+"<REDACTED: user-file-path>",o=s.lastIndex)}return o<r.length&&(t+=r.substr(o)),t}function BD(r){if(!r)return r;const e=[{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/(key|token|sig|secret|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/i},{label:"Email",regex:/@[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+/}];for(const t of e)if(t.regex.test(r))return`<REDACTED: ${t.label}>`;return r}function ex(r,e){return ed(r,t=>{if(t instanceof Dg||Object.hasOwnProperty.call(t,"isTrustedTelemetryValue"))return t.value;if(typeof t=="string"){let i=t.replaceAll("%20"," ");i=UD(i,e);for(const n of e)i=i.replace(n,"");return i=BD(i),i}})}new Xe("pprice.better-merge");const WD=Object.freeze({identifier:new Xe("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:y.parse("void:location"),isBuiltin:!1,targetPlatform:"undefined",isUserBuiltin:!1,isUnderDevelopment:!1});ne("extensionService");class tx{constructor(e){this.dependency=e}}function Tt(r,e){return r.enabledApiProposals?r.enabledApiProposals.includes(e):!1}function M(r,e){var t;if(!Tt(r,e))throw new Error(`Extension '${r.identifier.value}' CANNOT use API proposal: ${e}.
Its package.json#enabledApiProposals-property declares: ${((t=r.enabledApiProposals)==null?void 0:t.join(", "))??"[]"} but NOT ${e}.
 The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${r.identifier.value}`)}ne("remoteAuthorityResolverService");class VD{constructor(e){this.id=e,this.type=1}toString(){return`Managed(${this.id})`}}class zD{constructor(e,t){this.host=e,this.port=t,this.type=0}toString(){return`WebSocket(${this.host}:${this.port})`}}var Sn;(function(r){r.Unknown="Unknown",r.NotAvailable="NotAvailable",r.TemporarilyNotAvailable="TemporarilyNotAvailable",r.NoResolverFound="NoResolverFound",r.InvalidAuthority="InvalidAuthority"})(Sn||(Sn={}));function ix(r){const e=r.indexOf("+");return e===-1?r:r.substring(0,e)}var Ig,fs,En,Pg,ps,pr,gs,Tg,Ag,Sd,Hc,Rg,en,tn,Lg,Zt,Og;function te(r){return Object.assign(r,{apply:function(...t){if(t.length===0)return Reflect.construct(r,[]);{const i=t.length===1?[]:t[1];return Reflect.construct(r,i,t[0].constructor)}},call:function(...t){if(t.length===0)return Reflect.construct(r,[]);{const[i,...n]=t;return Reflect.construct(r,n,i.constructor)}}})}var $g;(function(r){r[r.Top=0]="Top",r[r.Bottom=1]="Bottom"})($g||($g={}));let Pe=Ig=(Q0=class{constructor(e){ae(this,Vs,void 0);K(this,Vs,e)}static from(...e){let t=e;return new Ig(function(){if(t){for(const i of t)i&&typeof i.dispose=="function"&&i.dispose();t=void 0}})}dispose(){typeof I(this,Vs)=="function"&&(I(this,Vs).call(this),K(this,Vs,void 0))}},Vs=new WeakMap,Q0);Pe=Ig=H([te],Pe);let Se=fs=class{static Min(...e){if(e.length===0)throw new TypeError;let t=e[0];for(let i=1;i<e.length;i++){const n=e[i];n.isBefore(t)&&(t=n)}return t}static Max(...e){if(e.length===0)throw new TypeError;let t=e[0];for(let i=1;i<e.length;i++){const n=e[i];n.isAfter(t)&&(t=n)}return t}static isPosition(e){if(!e)return!1;if(e instanceof fs)return!0;const{line:t,character:i}=e;return typeof t=="number"&&typeof i=="number"}static of(e){if(e instanceof fs)return e;if(this.isPosition(e))return new fs(e.line,e.character);throw new Error("Invalid argument, is NOT a position-like object")}get line(){return this._line}get character(){return this._character}constructor(e,t){if(e<0)throw xe("line must be non-negative");if(t<0)throw xe("character must be non-negative");this._line=e,this._character=t}isBefore(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<e._character}isBeforeOrEqual(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<=e._character}isAfter(e){return!this.isBeforeOrEqual(e)}isAfterOrEqual(e){return!this.isBefore(e)}isEqual(e){return this._line===e._line&&this._character===e._character}compareTo(e){return this._line<e._line?-1:this._line>e.line?1:this._character<e._character?-1:this._character>e._character?1:0}translate(e,t=0){if(e===null||t===null)throw xe();let i;return typeof e>"u"?i=0:typeof e=="number"?i=e:(i=typeof e.lineDelta=="number"?e.lineDelta:0,t=typeof e.characterDelta=="number"?e.characterDelta:0),i===0&&t===0?this:new fs(this.line+i,this.character+t)}with(e,t=this.character){if(e===null||t===null)throw xe();let i;return typeof e>"u"?i=this.line:typeof e=="number"?i=e:(i=typeof e.line=="number"?e.line:this.line,t=typeof e.character=="number"?e.character:this.character),i===this.line&&t===this.character?this:new fs(i,t)}toJSON(){return{line:this.line,character:this.character}}};Se=fs=H([te],Se);let be=En=class{static isRange(e){return e instanceof En?!0:e?Se.isPosition(e.start)&&Se.isPosition(e.end):!1}static of(e){if(e instanceof En)return e;if(this.isRange(e))return new En(e.start,e.end);throw new Error("Invalid argument, is NOT a range-like object")}get start(){return this._start}get end(){return this._end}constructor(e,t,i,n){let s,o;if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof n=="number"?(s=new Se(e,t),o=new Se(i,n)):Se.isPosition(e)&&Se.isPosition(t)&&(s=Se.of(e),o=Se.of(t)),!s||!o)throw new Error("Invalid arguments");s.isBefore(o)?(this._start=s,this._end=o):(this._start=o,this._end=s)}contains(e){return En.isRange(e)?this.contains(e.start)&&this.contains(e.end):Se.isPosition(e)?!(Se.of(e).isBefore(this._start)||this._end.isBefore(e)):!1}isEqual(e){return this._start.isEqual(e._start)&&this._end.isEqual(e._end)}intersection(e){const t=Se.Max(e.start,this._start),i=Se.Min(e.end,this._end);if(!t.isAfter(i))return new En(t,i)}union(e){if(this.contains(e))return this;if(e.contains(this))return e;const t=Se.Min(e.start,this._start),i=Se.Max(e.end,this.end);return new En(t,i)}get isEmpty(){return this._start.isEqual(this._end)}get isSingleLine(){return this._start.line===this._end.line}with(e,t=this.end){if(e===null||t===null)throw xe();let i;return e?Se.isPosition(e)?i=e:(i=e.start||this.start,t=e.end||this.end):i=this.start,i.isEqual(this._start)&&t.isEqual(this.end)?this:new En(i,t)}toJSON(){return[this.start,this.end]}};be=En=H([te],be);let kn=Pg=class extends be{static isSelection(e){return e instanceof Pg?!0:e?be.isRange(e)&&Se.isPosition(e.anchor)&&Se.isPosition(e.active)&&typeof e.isReversed=="boolean":!1}get anchor(){return this._anchor}get active(){return this._active}constructor(e,t,i,n){let s,o;if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof n=="number"?(s=new Se(e,t),o=new Se(i,n)):Se.isPosition(e)&&Se.isPosition(t)&&(s=Se.of(e),o=Se.of(t)),!s||!o)throw new Error("Invalid arguments");super(s,o),this._anchor=s,this._active=o}get isReversed(){return this._anchor===this._end}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}};kn=Pg=H([te],kn);const nx=r=>{if(typeof r!="string"||r.length===0||!/^[0-9A-Za-z_\-]+$/.test(r))throw xe("connectionToken")};class jD{static isResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.host=="string"&&typeof e.port=="number"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t,i){if(typeof e!="string"||e.length===0)throw xe("host");if(typeof t!="number"||t===0||Math.round(t)!==t)throw xe("port");typeof i<"u"&&nx(i),this.host=e,this.port=Math.round(t),this.connectionToken=i}}class Ed{static isManagedResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.makeConnection=="function"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t){this.makeConnection=e,this.connectionToken=t,typeof t<"u"&&nx(t)}}class nn extends Error{static NotAvailable(e,t){return new nn(e,Sn.NotAvailable,t)}static TemporarilyNotAvailable(e){return new nn(e,Sn.TemporarilyNotAvailable)}constructor(e,t=Sn.Unknown,i){super(e),this._message=e,this._code=t,this._detail=i,Object.setPrototypeOf(this,nn.prototype)}}var Mi;(function(r){r[r.LF=1]="LF",r[r.CRLF=2]="CRLF"})(Mi||(Mi={}));var No;(function(r){r[r.Replace=1]="Replace",r[r.Append=2]="Append",r[r.Prepend=3]="Prepend"})(No||(No={}));let gr=ps=class{static isTextEdit(e){return e instanceof ps?!0:e?be.isRange(e)&&typeof e.newText=="string":!1}static replace(e,t){return new ps(e,t)}static insert(e,t){return ps.replace(new be(e,e),t)}static delete(e){return ps.replace(e,"")}static setEndOfLine(e){const t=new ps(new be(new Se(0,0),new Se(0,0)),"");return t.newEol=e,t}get range(){return this._range}set range(e){if(e&&!be.isRange(e))throw xe("range");this._range=e}get newText(){return this._newText||""}set newText(e){if(e&&typeof e!="string")throw xe("newText");this._newText=e}get newEol(){return this._newEol}set newEol(e){if(e&&typeof e!="number")throw xe("newEol");this._newEol=e}constructor(e,t){this._range=e,this._newText=t}toJSON(){return{range:this.range,newText:this.newText,newEol:this._newEol}}};gr=ps=H([te],gr);let kd=pr=class{static isNotebookCellEdit(e){return e instanceof pr?!0:e?In.isNotebookRange(e)&&Array.isArray(e.newCells):!1}static replaceCells(e,t){return new pr(e,t)}static insertCells(e,t){return new pr(new In(e,e),t)}static deleteCells(e){return new pr(e,[])}static updateCellMetadata(e,t){const i=new pr(new In(e,e),[]);return i.newCellMetadata=t,i}static updateNotebookMetadata(e){const t=new pr(new In(0,0),[]);return t.newNotebookMetadata=e,t}constructor(e,t){this.range=e,this.newCells=t}};kd=pr=H([te],kd);class ms{static isSnippetTextEdit(e){return e instanceof ms?!0:e?be.isRange(e.range)&&vs.isSnippetString(e.snippet):!1}static replace(e,t){return new ms(e,t)}static insert(e,t){return ms.replace(new be(e,e),t)}constructor(e,t){this.range=e,this.snippet=t}}let mr=class{constructor(){this._edits=[]}_allEntries(){return this._edits}renameFile(e,t,i,n){this._edits.push({_type:1,from:e,to:t,options:i,metadata:n})}createFile(e,t,i){this._edits.push({_type:1,from:void 0,to:e,options:t,metadata:i})}deleteFile(e,t,i){this._edits.push({_type:1,from:e,to:void 0,options:t,metadata:i})}replaceNotebookMetadata(e,t,i){this._edits.push({_type:3,metadata:i,uri:e,edit:{editType:5,metadata:t},notebookMetadata:t})}replaceNotebookCells(e,t,i,n){const s=t.start,o=t.end;(s!==o||i.length>0)&&this._edits.push({_type:5,uri:e,index:s,count:o-s,cells:i,metadata:n})}replaceNotebookCellMetadata(e,t,i,n){this._edits.push({_type:3,metadata:n,uri:e,edit:{editType:3,index:t,metadata:i}})}replace(e,t,i,n){this._edits.push({_type:2,uri:e,edit:new gr(t,i),metadata:n})}insert(e,t,i,n){this.replace(e,new be(t,t),i,n)}delete(e,t,i){this.replace(e,t,"",i)}has(e){return this._edits.some(t=>t._type===2&&t.uri.toString()===e.toString())}set(e,t){if(t)for(const i of t){if(!i)continue;let n,s;Array.isArray(i)?(n=i[0],s=i[1]):n=i,kd.isNotebookCellEdit(n)?n.newCellMetadata?this.replaceNotebookCellMetadata(e,n.range.start,n.newCellMetadata,s):n.newNotebookMetadata?this.replaceNotebookMetadata(e,n.newNotebookMetadata,s):this.replaceNotebookCells(e,n.range,n.newCells,s):ms.isSnippetTextEdit(n)?this._edits.push({_type:6,uri:e,range:n.range,edit:n.snippet,metadata:s}):this._edits.push({_type:2,uri:e,edit:n,metadata:s})}else{for(let i=0;i<this._edits.length;i++){const n=this._edits[i];switch(n._type){case 2:case 6:case 3:case 5:n.uri.toString()===e.toString()&&(this._edits[i]=void 0);break}}iS(this._edits)}}get(e){const t=[];for(const i of this._edits)i._type===2&&i.uri.toString()===e.toString()&&t.push(i.edit);return t}entries(){const e=new pt;for(const t of this._edits)if(t._type===2){let i=e.get(t.uri);i||(i=[t.uri,[]],e.set(t.uri,i)),i[1].push(t.edit)}return[...e.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};mr=H([te],mr);let vs=gs=class{static isSnippetString(e){return e instanceof gs?!0:e?typeof e.value=="string":!1}static _escape(e){return e.replace(/\$|}|\\/g,"\\$&")}constructor(e){this._tabstop=1,this.value=e||""}appendText(e){return this.value+=gs._escape(e),this}appendTabstop(e=this._tabstop++){return this.value+="$",this.value+=e,this}appendPlaceholder(e,t=this._tabstop++){if(typeof e=="function"){const i=new gs;i._tabstop=this._tabstop,e(i),this._tabstop=i._tabstop,e=i.value}else e=gs._escape(e);return this.value+="${",this.value+=t,this.value+=":",this.value+=e,this.value+="}",this}appendChoice(e,t=this._tabstop++){const i=e.map(n=>n.replaceAll(/[|\\,]/g,"\\$&")).join(",");return this.value+="${",this.value+=t,this.value+="|",this.value+=i,this.value+="|}",this}appendVariable(e,t){if(typeof t=="function"){const i=new gs;i._tabstop=this._tabstop,t(i),this._tabstop=i._tabstop,t=i.value}else typeof t=="string"&&(t=t.replace(/\$|}/g,"\\$&"));return this.value+="${",this.value+=e,t&&(this.value+=":",this.value+=t),this.value+="}",this}};vs=gs=H([te],vs);var _s;(function(r){r[r.Unnecessary=1]="Unnecessary",r[r.Deprecated=2]="Deprecated"})(_s||(_s={}));var $t;(function(r){r[r.Hint=3]="Hint",r[r.Information=2]="Information",r[r.Warning=1]="Warning",r[r.Error=0]="Error"})($t||($t={}));let vi=Tg=class{static isLocation(e){return e instanceof Tg?!0:e?be.isRange(e.range)&&y.isUri(e.uri):!1}constructor(e,t){if(this.uri=e,t)if(be.isRange(t))this.range=be.of(t);else if(Se.isPosition(t))this.range=new be(t,t);else throw new Error("Illegal argument")}toJSON(){return{uri:this.uri,range:this.range}}};vi=Tg=H([te],vi);let Uc=class{static is(e){return e?typeof e.message=="string"&&e.location&&be.isRange(e.location.range)&&y.isUri(e.location.uri):!1}constructor(e,t){this.location=e,this.message=t}static isEqual(e,t){return e===t?!0:!e||!t?!1:e.message===t.message&&e.location.range.isEqual(t.location.range)&&e.location.uri.toString()===t.location.uri.toString()}};Uc=H([te],Uc);let Dd=class{constructor(e,t,i=$t.Error){if(!be.isRange(e))throw new TypeError("range must be set");if(!t)throw new TypeError("message must be set");this.range=e,this.message=t,this.severity=i}toJSON(){return{severity:$t[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(e,t){return e===t?!0:!e||!t?!1:e.message===t.message&&e.severity===t.severity&&e.code===t.code&&e.severity===t.severity&&e.source===t.source&&e.range.isEqual(t.range)&&er(e.tags,t.tags)&&er(e.relatedInformation,t.relatedInformation,Uc.isEqual)}};Dd=H([te],Dd);let Id=class{constructor(e,t){if(!e)throw new Error("Illegal argument, contents must be defined");Array.isArray(e)?this.contents=e:this.contents=[e],this.range=t}};Id=H([te],Id);var Bc;(function(r){r[r.Text=0]="Text",r[r.Read=1]="Read",r[r.Write=2]="Write"})(Bc||(Bc={}));let Pd=class{constructor(e,t=Bc.Text){this.range=e,this.kind=t}toJSON(){return{range:this.range,kind:Bc[this.kind]}}};Pd=H([te],Pd);let Td=class{constructor(e,t){this.uri=e,this.highlights=t}toJSON(){return{uri:this.uri,highlights:this.highlights.map(e=>e.toJSON())}}};Td=H([te],Td);var qe;(function(r){r[r.File=0]="File",r[r.Module=1]="Module",r[r.Namespace=2]="Namespace",r[r.Package=3]="Package",r[r.Class=4]="Class",r[r.Method=5]="Method",r[r.Property=6]="Property",r[r.Field=7]="Field",r[r.Constructor=8]="Constructor",r[r.Enum=9]="Enum",r[r.Interface=10]="Interface",r[r.Function=11]="Function",r[r.Variable=12]="Variable",r[r.Constant=13]="Constant",r[r.String=14]="String",r[r.Number=15]="Number",r[r.Boolean=16]="Boolean",r[r.Array=17]="Array",r[r.Object=18]="Object",r[r.Key=19]="Key",r[r.Null=20]="Null",r[r.EnumMember=21]="EnumMember",r[r.Struct=22]="Struct",r[r.Event=23]="Event",r[r.Operator=24]="Operator",r[r.TypeParameter=25]="TypeParameter"})(qe||(qe={}));var Wc;(function(r){r[r.Deprecated=1]="Deprecated"})(Wc||(Wc={}));let Vc=Ag=class{static validate(e){if(!e.name)throw new Error("name must not be falsy")}constructor(e,t,i,n,s){this.name=e,this.kind=t,this.containerName=s,typeof i=="string"&&(this.containerName=i),n instanceof vi?this.location=n:i instanceof be&&(this.location=new vi(n,i)),Ag.validate(this)}toJSON(){return{name:this.name,kind:qe[this.kind],location:this.location,containerName:this.containerName}}};Vc=Ag=H([te],Vc);let zc=Sd=class{static validate(e){var t;if(!e.name)throw new Error("name must not be falsy");if(!e.range.contains(e.selectionRange))throw new Error("selectionRange must be contained in fullRange");(t=e.children)==null||t.forEach(Sd.validate)}constructor(e,t,i,n,s){this.name=e,this.detail=t,this.kind=i,this.range=n,this.selectionRange=s,this.children=[],Sd.validate(this)}};zc=Sd=H([te],zc);var jc;(function(r){r[r.Invoke=1]="Invoke",r[r.Automatic=2]="Automatic"})(jc||(jc={}));let Ad=class{constructor(e,t){this.title=e,this.kind=t}};Ad=H([te],Ad);let it=(La=class{constructor(e){this.value=e}append(e){return new Hc(this.value?this.value+Hc.sep+e:e)}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+Hc.sep)}},Hc=La,La.sep=".",La);it=Hc=H([te],it),it.Empty=new it(""),it.QuickFix=it.Empty.append("quickfix"),it.Refactor=it.Empty.append("refactor"),it.RefactorExtract=it.Refactor.append("extract"),it.RefactorInline=it.Refactor.append("inline"),it.RefactorMove=it.Refactor.append("move"),it.RefactorRewrite=it.Refactor.append("rewrite"),it.Source=it.Empty.append("source"),it.SourceOrganizeImports=it.Source.append("organizeImports"),it.SourceFixAll=it.Source.append("fixAll"),it.Notebook=it.Empty.append("notebook");let qc=class{constructor(e,t){if(this.range=e,this.parent=t,t&&!t.range.contains(this.range))throw new Error("Invalid argument: parent must contain this range")}};qc=H([te],qc);let Ng=class{constructor(e,t,i,n,s,o){this.kind=e,this.name=t,this.detail=i,this.uri=n,this.range=s,this.selectionRange=o}},rx=class{constructor(e,t){this.fromRanges=t,this.from=e}},sx=class{constructor(e,t){this.fromRanges=t,this.to=e}};var Fo;(function(r){r[r.Information=0]="Information",r[r.Warning=1]="Warning",r[r.Error=2]="Error"})(Fo||(Fo={}));let Rd=class{constructor(e,t){this.range=e,this.command=t}get isResolved(){return!!this.command}};Rd=H([te],Rd);let Di=Rg=(J0=class{constructor(e,t=!1){ae(this,Wt,void 0);K(this,Wt,new My(e,{supportThemeIcons:t}))}static isMarkdownString(e){return e instanceof Rg?!0:e&&e.appendCodeblock&&e.appendMarkdown&&e.appendText&&e.value!==void 0}get value(){return I(this,Wt).value}set value(e){I(this,Wt).value=e}get isTrusted(){return I(this,Wt).isTrusted}set isTrusted(e){I(this,Wt).isTrusted=e}get supportThemeIcons(){return I(this,Wt).supportThemeIcons}set supportThemeIcons(e){I(this,Wt).supportThemeIcons=e}get supportHtml(){return I(this,Wt).supportHtml}set supportHtml(e){I(this,Wt).supportHtml=e}get baseUri(){return I(this,Wt).baseUri}set baseUri(e){I(this,Wt).baseUri=e}appendText(e){return I(this,Wt).appendText(e),this}appendMarkdown(e){return I(this,Wt).appendMarkdown(e),this}appendCodeblock(e,t){return I(this,Wt).appendCodeblock(t??"",e),this}},Wt=new WeakMap,J0);Di=Rg=H([te],Di);let Fg=class{constructor(e,t){this.label=e,this.documentation=t}};Fg=H([te],Fg);let Mg=class{constructor(e,t){this.label=e,this.documentation=t,this.parameters=[]}};Mg=H([te],Mg);let Hg=class{constructor(){this.activeSignature=0,this.activeParameter=0,this.signatures=[]}};Hg=H([te],Hg);var Ug;(function(r){r[r.Invoke=1]="Invoke",r[r.TriggerCharacter=2]="TriggerCharacter",r[r.ContentChange=3]="ContentChange"})(Ug||(Ug={}));var Bg;(function(r){r[r.Type=1]="Type",r[r.Parameter=2]="Parameter"})(Bg||(Bg={}));let Ld=class{constructor(e){this.value=e}};Ld=H([te],Ld);let Od=class{constructor(e,t,i){this.position=e,this.label=t,this.kind=i}};Od=H([te],Od);var Mo;(function(r){r[r.Invoke=0]="Invoke",r[r.TriggerCharacter=1]="TriggerCharacter",r[r.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(Mo||(Mo={}));var fe;(function(r){r[r.Text=0]="Text",r[r.Method=1]="Method",r[r.Function=2]="Function",r[r.Constructor=3]="Constructor",r[r.Field=4]="Field",r[r.Variable=5]="Variable",r[r.Class=6]="Class",r[r.Interface=7]="Interface",r[r.Module=8]="Module",r[r.Property=9]="Property",r[r.Unit=10]="Unit",r[r.Value=11]="Value",r[r.Enum=12]="Enum",r[r.Keyword=13]="Keyword",r[r.Snippet=14]="Snippet",r[r.Color=15]="Color",r[r.File=16]="File",r[r.Reference=17]="Reference",r[r.Folder=18]="Folder",r[r.EnumMember=19]="EnumMember",r[r.Constant=20]="Constant",r[r.Struct=21]="Struct",r[r.Event=22]="Event",r[r.Operator=23]="Operator",r[r.TypeParameter=24]="TypeParameter",r[r.User=25]="User",r[r.Issue=26]="Issue"})(fe||(fe={}));var Gc;(function(r){r[r.Deprecated=1]="Deprecated"})(Gc||(Gc={}));let $d=class{constructor(e,t){this.label=e,this.kind=t}toJSON(){return{label:this.label,kind:this.kind&&fe[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};$d=H([te],$d);let Ho=class{constructor(e=[],t=!1){this.items=e,this.isIncomplete=t}};Ho=H([te],Ho);let Wg=class{constructor(e,t,i){this.insertText=e,this.range=t,this.command=i}};Wg=H([te],Wg);let Vg=class{constructor(e){this.commands=void 0,this.suppressSuggestions=void 0,this.items=e}};Vg=H([te],Vg);var Qc;(function(r){r[r.Active=-1]="Active",r[r.Beside=-2]="Beside",r[r.One=1]="One",r[r.Two=2]="Two",r[r.Three=3]="Three",r[r.Four=4]="Four",r[r.Five=5]="Five",r[r.Six=6]="Six",r[r.Seven=7]="Seven",r[r.Eight=8]="Eight",r[r.Nine=9]="Nine"})(Qc||(Qc={}));var vr;(function(r){r[r.Left=1]="Left",r[r.Right=2]="Right"})(vr||(vr={}));function qD(r,e){return`${Xe.toKey(r)}.${e}`}var Hi;(function(r){r[r.Off=0]="Off",r[r.On=1]="On",r[r.Relative=2]="Relative",r[r.Interval=3]="Interval"})(Hi||(Hi={}));var Uo;(function(r){r[r.Manual=1]="Manual",r[r.AfterDelay=2]="AfterDelay",r[r.FocusOut=3]="FocusOut"})(Uo||(Uo={}));var Nd;(function(r){r[r.Default=0]="Default",r[r.InCenter=1]="InCenter",r[r.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",r[r.AtTop=3]="AtTop"})(Nd||(Nd={}));var Bo;(function(r){r[r.Keyboard=1]="Keyboard",r[r.Mouse=2]="Mouse",r[r.Command=3]="Command"})(Bo||(Bo={}));var Jc;(function(r){r[r.Undo=1]="Undo",r[r.Redo=2]="Redo"})(Jc||(Jc={}));var ws;(function(r){r[r.OpenOpen=0]="OpenOpen",r[r.ClosedClosed=1]="ClosedClosed",r[r.OpenClosed=2]="OpenClosed",r[r.ClosedOpen=3]="ClosedOpen"})(ws||(ws={})),function(r){function e(t){switch(t){case"keyboard":return r.Keyboard;case"mouse":return r.Mouse;case"api":return r.Command}}r.fromValue=e}(Bo||(Bo={}));var Wo;(function(r){r[r.Other=0]="Other",r[r.Comment=1]="Comment",r[r.String=2]="String",r[r.RegEx=3]="RegEx"})(Wo||(Wo={})),function(r){function e(t){switch(t){case r.Other:return"other";case r.Comment:return"comment";case r.String:return"string";case r.RegEx:return"regex"}return"other"}r.toString=e}(Wo||(Wo={}));let Fd=class{constructor(e,t){if(t&&!y.isUri(t))throw xe("target");if(!be.isRange(e)||e.isEmpty)throw xe("range");this.range=e,this.target=t}};Fd=H([te],Fd);let Vo=class{constructor(e,t,i,n){this.red=e,this.green=t,this.blue=i,this.alpha=n}};Vo=H([te],Vo);let Md=class{constructor(e,t){if(t&&!(t instanceof Vo))throw xe("color");if(!be.isRange(e)||e.isEmpty)throw xe("range");this.range=e,this.color=t}};Md=H([te],Md);let Hd=class{constructor(e){if(!e||typeof e!="string")throw xe("label");this.label=e}};Hd=H([te],Hd);var zg;(function(r){r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Information=2]="Information"})(zg||(zg={}));var jg;(function(r){r[r.Unknown=0]="Unknown",r[r.Shutdown=1]="Shutdown",r[r.Process=2]="Process",r[r.User=3]="User",r[r.Extension=4]="Extension"})(jg||(jg={}));class GD{constructor(e,t,i){if(this.startIndex=e,this.length=t,this.tooltip=i,typeof e!="number"||e<0)throw xe("startIndex");if(typeof t!="number"||t<1)throw xe("length");if(i!==void 0&&typeof i!="string")throw xe("tooltip")}}class QD{constructor(e){this.uri=e}}class JD{constructor(e){this.terminalCommand=e}}var qg;(function(r){r[r.Panel=1]="Panel",r[r.Editor=2]="Editor"})(qg||(qg={}));class KD{constructor(e){if(this.options=e,typeof e!="object")throw xe("options")}}var Gg;(function(r){r[r.Always=1]="Always",r[r.Silent=2]="Silent",r[r.Never=3]="Never"})(Gg||(Gg={}));var Qg;(function(r){r[r.Shared=1]="Shared",r[r.Dedicated=2]="Dedicated",r[r.New=3]="New"})(Qg||(Qg={}));let Kc=(Vn=class{static from(e){switch(e){case"clean":return en.Clean;case"build":return en.Build;case"rebuild":return en.Rebuild;case"test":return en.Test;default:return}}constructor(e,t){if(this.label=t,typeof e!="string"||typeof t!="string")throw xe("name");this._id=e}get id(){return this._id}},en=Vn,Vn.Clean=new en("clean","Clean"),Vn.Build=new en("build","Build"),Vn.Rebuild=new en("rebuild","Rebuild"),Vn.Test=new en("test","Test"),Vn);Kc=en=H([te],Kc);function ox(r){let e="";for(let t=0;t<r.length;t++)e+=r[t].replace(/,/g,",,")+",";return e}let zo=class{constructor(e,t,i){if(typeof e!="string")throw xe("process");this._args=[],this._process=e,t!==void 0&&(Array.isArray(t)?(this._args=t,this._options=i):this._options=t)}get process(){return this._process}set process(e){if(typeof e!="string")throw xe("process");this._process=e}get args(){return this._args}set args(e){Array.isArray(e)||(e=[]),this._args=e}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];if(e.push("process"),this._process!==void 0&&e.push(this._process),this._args&&this._args.length>0)for(const t of this._args)e.push(t);return ox(e)}};zo=H([te],zo);let bs=class{constructor(e,t,i){if(this._args=[],Array.isArray(t)){if(!e)throw xe("command can't be undefined or null");if(typeof e!="string"&&typeof e.value!="string")throw xe("command");this._command=e,this._args=t,this._options=i}else{if(typeof e!="string")throw xe("commandLine");this._commandLine=e,this._options=t}}get commandLine(){return this._commandLine}set commandLine(e){if(typeof e!="string")throw xe("commandLine");this._commandLine=e}get command(){return this._command?this._command:""}set command(e){if(typeof e!="string"&&typeof e.value!="string")throw xe("command");this._command=e}get args(){return this._args}set args(e){this._args=e||[]}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];if(e.push("shell"),this._commandLine!==void 0&&e.push(this._commandLine),this._command!==void 0&&e.push(typeof this._command=="string"?this._command:this._command.value),this._args&&this._args.length>0)for(const t of this._args)e.push(typeof t=="string"?t:t.value);return ox(e)}};bs=H([te],bs);var Jg;(function(r){r[r.Escape=1]="Escape",r[r.Strong=2]="Strong",r[r.Weak=3]="Weak"})(Jg||(Jg={}));var ys;(function(r){r[r.Global=1]="Global",r[r.Workspace=2]="Workspace"})(ys||(ys={}));class Kg{constructor(e){this._callback=e}computeId(){return"customExecution"+xn()}set callback(e){this._callback=e}get callback(){return this._callback}}let Ud=(zn=class{constructor(e,t,i,n,s,o){this.__deprecated=!1,this._definition=this.definition=e;let a;typeof t=="string"?(this._name=this.name=t,this._source=this.source=i,this.execution=n,a=s,this.__deprecated=!0):t===ys.Global||t===ys.Workspace?(this.target=t,this._name=this.name=i,this._source=this.source=n,this.execution=s,a=o):(this.target=t,this._name=this.name=i,this._source=this.source=n,this.execution=s,a=o),typeof a=="string"?(this._problemMatchers=[a],this._hasDefinedMatchers=!0):Array.isArray(a)?(this._problemMatchers=a,this._hasDefinedMatchers=!0):(this._problemMatchers=[],this._hasDefinedMatchers=!1),this._isBackground=!1,this._presentationOptions=Object.create(null),this._runOptions=Object.create(null)}get _id(){return this.__id}set _id(e){this.__id=e}get _deprecated(){return this.__deprecated}clear(){this.__id!==void 0&&(this.__id=void 0,this._scope=void 0,this.computeDefinitionBasedOnExecution())}computeDefinitionBasedOnExecution(){this._execution instanceof zo?this._definition={type:tn.ProcessType,id:this._execution.computeId()}:this._execution instanceof bs?this._definition={type:tn.ShellType,id:this._execution.computeId()}:this._execution instanceof Kg?this._definition={type:tn.ExtensionCallbackType,id:this._execution.computeId()}:this._definition={type:tn.EmptyType,id:xn()}}get definition(){return this._definition}set definition(e){if(e==null)throw xe("Kind can't be undefined or null");this.clear(),this._definition=e}get scope(){return this._scope}set target(e){this.clear(),this._scope=e}get name(){return this._name}set name(e){if(typeof e!="string")throw xe("name");this.clear(),this._name=e}get execution(){return this._execution}set execution(e){e===null&&(e=void 0),this.clear(),this._execution=e;const t=this._definition.type;(tn.EmptyType===t||tn.ProcessType===t||tn.ShellType===t||tn.ExtensionCallbackType===t)&&this.computeDefinitionBasedOnExecution()}get problemMatchers(){return this._problemMatchers}set problemMatchers(e){if(Array.isArray(e))this.clear(),this._problemMatchers=e,this._hasDefinedMatchers=!0;else{this.clear(),this._problemMatchers=[],this._hasDefinedMatchers=!1;return}}get hasDefinedMatchers(){return this._hasDefinedMatchers}get isBackground(){return this._isBackground}set isBackground(e){e!==!0&&e!==!1&&(e=!1),this.clear(),this._isBackground=e}get source(){return this._source}set source(e){if(typeof e!="string"||e.length===0)throw xe("source must be a string of length > 0");this.clear(),this._source=e}get group(){return this._group}set group(e){e===null&&(e=void 0),this.clear(),this._group=e}get detail(){return this._detail}set detail(e){e===null&&(e=void 0),this._detail=e}get presentationOptions(){return this._presentationOptions}set presentationOptions(e){e==null&&(e=Object.create(null)),this.clear(),this._presentationOptions=e}get runOptions(){return this._runOptions}set runOptions(e){e==null&&(e=Object.create(null)),this.clear(),this._runOptions=e}},tn=zn,zn.ExtensionCallbackType="customExecution",zn.ProcessType="process",zn.ShellType="shell",zn.EmptyType="$empty",zn);Ud=tn=H([te],Ud);var xs;(function(r){r[r.SourceControl=1]="SourceControl",r[r.Window=10]="Window",r[r.Notification=15]="Notification"})(xs||(xs={}));var Xg;(function(r){function e(t){const i=t;return or(i.value)?i.tooltip&&!Ne(i.tooltip)?(console.log("INVALID view badge, invalid tooltip",i.tooltip),!1):!0:(console.log("INVALID view badge, invalid value",i.value),!1)}r.isViewBadge=e})(Xg||(Xg={}));let Bd=Lg=class{static isTreeItem(e,t){var n,s;const i=e;if(i.checkboxState!==void 0){const o=or(i.checkboxState)?i.checkboxState:Ft(i.checkboxState)&&or(i.checkboxState.state)?i.checkboxState.state:void 0,a=!or(i.checkboxState)&&Ft(i.checkboxState)?i.checkboxState.tooltip:void 0;if(o===void 0||o!==rn.Checked&&o!==rn.Unchecked||a!==void 0&&!Ne(a))return console.log("INVALID tree item, invalid checkboxState",i.checkboxState),!1}if(e instanceof Lg)return!0;if(i.label!==void 0&&!Ne(i.label)&&!((n=i.label)!=null&&n.label))return console.log("INVALID tree item, invalid label",i.label),!1;if(i.id!==void 0&&!Ne(i.id))return console.log("INVALID tree item, invalid id",i.id),!1;if(i.iconPath!==void 0&&!Ne(i.iconPath)&&!y.isUri(i.iconPath)&&(!i.iconPath||!Ne(i.iconPath.id))){const o=i.iconPath;if(!o||!Ne(o.light)&&!y.isUri(o.light)&&!Ne(o.dark)&&!y.isUri(o.dark))return console.log("INVALID tree item, invalid iconPath",i.iconPath),!1}return i.description!==void 0&&!Ne(i.description)&&typeof i.description!="boolean"?(console.log("INVALID tree item, invalid description",i.description),!1):i.resourceUri!==void 0&&!y.isUri(i.resourceUri)?(console.log("INVALID tree item, invalid resourceUri",i.resourceUri),!1):i.tooltip!==void 0&&!Ne(i.tooltip)&&!(i.tooltip instanceof Di)?(console.log("INVALID tree item, invalid tooltip",i.tooltip),!1):i.command!==void 0&&!i.command.command?(console.log("INVALID tree item, invalid command",i.command),!1):i.collapsibleState!==void 0&&i.collapsibleState<Cs.None&&i.collapsibleState>Cs.Expanded?(console.log("INVALID tree item, invalid collapsibleState",i.collapsibleState),!1):i.contextValue!==void 0&&!Ne(i.contextValue)?(console.log("INVALID tree item, invalid contextValue",i.contextValue),!1):i.accessibilityInformation!==void 0&&!((s=i.accessibilityInformation)!=null&&s.label)?(console.log("INVALID tree item, invalid accessibilityInformation",i.accessibilityInformation),!1):!0}constructor(e,t=Cs.None){this.collapsibleState=t,y.isUri(e)?this.resourceUri=e:this.label=e}};Bd=Lg=H([te],Bd);var Cs;(function(r){r[r.None=0]="None",r[r.Collapsed=1]="Collapsed",r[r.Expanded=2]="Expanded"})(Cs||(Cs={}));var rn;(function(r){r[r.Unchecked=0]="Unchecked",r[r.Checked=1]="Checked"})(rn||(rn={}));let Wd=class{async asString(){return typeof this.value=="string"?this.value:JSON.stringify(this.value)}asFile(){}constructor(e){this.value=e}};Wd=H([te],Wd);class Vd extends Wd{}class XD extends Vd{constructor(t){super("");ae(this,iu,void 0);K(this,iu,t)}asFile(){return I(this,iu)}}iu=new WeakMap;class YD{constructor(e,t,i,n){this.name=e,this.uri=t,this._itemId=i,this._getData=n}data(){return this._getData()}}let Xc=(K0=class{constructor(e){ae(this,zs);ae(this,jn,new Map);for(const[t,i]of e??[]){const n=I(this,jn).get(Su(this,zs,Eu).call(this,t));n?n.push(i):I(this,jn).set(Su(this,zs,Eu).call(this,t),[i])}}get(e){var t;return(t=I(this,jn).get(Su(this,zs,Eu).call(this,e)))==null?void 0:t[0]}set(e,t){I(this,jn).set(Su(this,zs,Eu).call(this,e),[t])}forEach(e,t){for(const[i,n]of I(this,jn))for(const s of n)e.call(t,s,i,this)}*[Symbol.iterator](){for(const[e,t]of I(this,jn))for(const i of t)yield[e,i]}},jn=new WeakMap,zs=new WeakSet,Eu=function(e){return e.toLowerCase()},K0);Xc=H([te],Xc);let Yg=class{constructor(e){this.insertText=e}};Yg=H([te],Yg);let Zg=class{constructor(e,t){this.label=t,this.insertText=e}};Zg=H([te],Zg);let Gt=class{constructor(e,t){this.id=e,this.color=t}static isThemeIcon(e){return typeof e.id!="string"?(console.log("INVALID ThemeIcon, invalid id",e.id),!1):!0}};Gt=H([te],Gt),Gt.File=new Gt("file"),Gt.Folder=new Gt("folder");let Yc=class{constructor(e){this.id=e}};Yc=H([te],Yc);var jo;(function(r){r[r.Global=1]="Global",r[r.Workspace=2]="Workspace",r[r.WorkspaceFolder=3]="WorkspaceFolder"})(jo||(jo={}));let qo=class{get base(){return this._base}set base(e){this._base=e,this._baseUri=y.file(e)}get baseUri(){return this._baseUri}set baseUri(e){this._baseUri=e,this._base=e.fsPath}constructor(e,t){if(typeof e!="string"&&(!e||!y.isUri(e)&&!y.isUri(e.uri)))throw xe("base");if(typeof t!="string")throw xe("pattern");typeof e=="string"?this.baseUri=y.file(e):y.isUri(e)?this.baseUri=e:this.baseUri=e.uri,this.pattern=t}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};qo=H([te],qo);const ax=new WeakMap;function ZD(r,e){ax.set(r,e)}let Go=class{constructor(e,t,i,n,s){this.enabled=typeof e=="boolean"?e:!0,typeof t=="string"&&(this.condition=t),typeof i=="string"&&(this.hitCondition=i),typeof n=="string"&&(this.logMessage=n),typeof s=="string"&&(this.mode=s)}get id(){return this._id||(this._id=ax.get(this)??xn()),this._id}};Go=H([te],Go);let Ss=class extends Go{constructor(e,t,i,n,s,o){if(super(t,i,n,s,o),e===null)throw xe("location");this.location=e}};Ss=H([te],Ss);let Es=class extends Go{constructor(e,t,i,n,s,o){super(t,i,n,s,o),this.functionName=e}};Es=H([te],Es);let zd=class extends Go{constructor(e,t,i,n,s,o,a,c){if(super(n,s,o,a,c),!t)throw xe("dataId");this.label=e,this.dataId=t,this.canPersist=i}};zd=H([te],zd);let jd=class{constructor(e,t,i){this.command=e,this.args=t||[],this.options=i}};jd=H([te],jd);let Zc=class{constructor(e,t){this.port=e,this.host=t}};Zc=H([te],Zc);let qd=class{constructor(e){this.path=e}};qd=H([te],qd);let Gd=class{constructor(e){this.implementation=e}};Gd=H([te],Gd);let Qd=class{constructor(e,t,i){this.session=e,this.threadId=t,this.frameId=i}};Qd=H([te],Qd);let Jd=class{constructor(e,t){this.session=e,this.threadId=t}};Jd=H([te],Jd);let Kd=class{constructor(e,t){this.range=e,this.expression=t}};Kd=H([te],Kd);var el;(function(r){r[r.Invoke=0]="Invoke",r[r.Automatic=1]="Automatic"})(el||(el={}));let Xd=class{constructor(e,t){this.range=e,this.text=t}};Xd=H([te],Xd);let Yd=class{constructor(e,t,i=!0){this.range=e,this.variableName=t,this.caseSensitiveLookup=i}};Yd=H([te],Yd);let Zd=class{constructor(e,t){this.range=e,this.expression=t}};Zd=H([te],Zd);let em=class{constructor(e,t){this.frameId=e,this.stoppedLocation=t}};em=H([te],em);var tm;(function(r){r[r.AIGenerated=1]="AIGenerated"})(tm||(tm={}));class e4{constructor(e,t){this.newSymbolName=e,this.tags=t}}var Qo;(function(r){r[r.Changed=1]="Changed",r[r.Created=2]="Created",r[r.Deleted=3]="Deleted"})(Qo||(Qo={}));let wt=Zt=class extends Error{static FileExists(e){return new Zt(e,Ce.FileExists,Zt.FileExists)}static FileNotFound(e){return new Zt(e,Ce.FileNotFound,Zt.FileNotFound)}static FileNotADirectory(e){return new Zt(e,Ce.FileNotADirectory,Zt.FileNotADirectory)}static FileIsADirectory(e){return new Zt(e,Ce.FileIsADirectory,Zt.FileIsADirectory)}static NoPermissions(e){return new Zt(e,Ce.NoPermissions,Zt.NoPermissions)}static Unavailable(e){return new Zt(e,Ce.Unavailable,Zt.Unavailable)}constructor(e,t=Ce.Unknown,i){super(y.isUri(e)?e.toString(!0):e),this.code=(i==null?void 0:i.name)??"Unknown",b1(this,t),Object.setPrototypeOf(this,Zt.prototype),typeof Error.captureStackTrace=="function"&&typeof i=="function"&&Error.captureStackTrace(this,i)}};wt=Zt=H([te],wt);let im=class{constructor(e,t,i){this.start=e,this.end=t,this.kind=i}};im=H([te],im);var Dn;(function(r){r[r.Comment=1]="Comment",r[r.Imports=2]="Imports",r[r.Region=3]="Region"})(Dn||(Dn={}));var tl;(function(r){r[r.Collapsed=0]="Collapsed",r[r.Expanded=1]="Expanded"})(tl||(tl={}));var nm;(function(r){r[r.Editing=0]="Editing",r[r.Preview=1]="Preview"})(nm||(nm={}));var rm;(function(r){r[r.Published=0]="Published",r[r.Draft=1]="Draft"})(rm||(rm={}));var il;(function(r){r[r.Unresolved=0]="Unresolved",r[r.Resolved=1]="Resolved"})(il||(il={}));class sm{constructor(e,t=[]){this.tokenTypes=e,this.tokenModifiers=t}}function t4(r){return typeof r>"u"||EE(r)}class om{constructor(e){if(this._prevLine=0,this._prevChar=0,this._dataIsSortedAndDeltaEncoded=!0,this._data=[],this._dataLen=0,this._tokenTypeStrToInt=new Map,this._tokenModifierStrToInt=new Map,this._hasLegend=!1,e){this._hasLegend=!0;for(let t=0,i=e.tokenTypes.length;t<i;t++)this._tokenTypeStrToInt.set(e.tokenTypes[t],t);for(let t=0,i=e.tokenModifiers.length;t<i;t++)this._tokenModifierStrToInt.set(e.tokenModifiers[t],t)}}push(e,t,i,n,s){if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof n=="number"&&(typeof s=="number"||typeof s>"u"))return typeof s>"u"&&(s=0),this._pushEncoded(e,t,i,n,s);if(be.isRange(e)&&typeof t=="string"&&t4(i))return this._push(e,t,i);throw xe()}_push(e,t,i){if(!this._hasLegend)throw new Error("Legend must be provided in constructor");if(e.start.line!==e.end.line)throw new Error("`range` cannot span multiple lines");if(!this._tokenTypeStrToInt.has(t))throw new Error("`tokenType` is not in the provided legend");const n=e.start.line,s=e.start.character,o=e.end.character-e.start.character,a=this._tokenTypeStrToInt.get(t);let c=0;if(i)for(const l of i){if(!this._tokenModifierStrToInt.has(l))throw new Error("`tokenModifier` is not in the provided legend");const u=this._tokenModifierStrToInt.get(l);c|=1<<u>>>0}this._pushEncoded(n,s,o,a,c)}_pushEncoded(e,t,i,n,s){if(this._dataIsSortedAndDeltaEncoded&&(e<this._prevLine||e===this._prevLine&&t<this._prevChar)){this._dataIsSortedAndDeltaEncoded=!1;const c=this._data.length/5|0;let l=0,u=0;for(let d=0;d<c;d++){let h=this._data[5*d],g=this._data[5*d+1];h===0?(h=l,g+=u):h+=l,this._data[5*d]=h,this._data[5*d+1]=g,l=h,u=g}}let o=e,a=t;this._dataIsSortedAndDeltaEncoded&&this._dataLen>0&&(o-=this._prevLine,o===0&&(a-=this._prevChar)),this._data[this._dataLen++]=o,this._data[this._dataLen++]=a,this._data[this._dataLen++]=i,this._data[this._dataLen++]=n,this._data[this._dataLen++]=s,this._prevLine=e,this._prevChar=t}static _sortAndDeltaEncode(e){const t=[],i=e.length/5|0;for(let a=0;a<i;a++)t[a]=a;t.sort((a,c)=>{const l=e[5*a],u=e[5*c];if(l===u){const d=e[5*a+1],h=e[5*c+1];return d-h}return l-u});const n=new Uint32Array(e.length);let s=0,o=0;for(let a=0;a<i;a++){const c=5*t[a],l=e[c+0],u=e[c+1],d=e[c+2],h=e[c+3],g=e[c+4],w=l-s,p=w===0?u-o:u,b=5*a;n[b+0]=w,n[b+1]=p,n[b+2]=d,n[b+3]=h,n[b+4]=g,s=l,o=u}return n}build(e){return this._dataIsSortedAndDeltaEncoded?new Jo(new Uint32Array(this._data),e):new Jo(om._sortAndDeltaEncode(this._data),e)}}class Jo{constructor(e,t){this.resultId=t,this.data=e}}class cx{constructor(e,t,i){this.start=e,this.deleteCount=t,this.data=i}}class eh{constructor(e,t){this.resultId=t,this.edits=e}}var th;(function(r){r[r.Separate=0]="Separate",r[r.MergeWithParent=1]="MergeWithParent"})(th||(th={}));class i4{constructor(e){this.name=e}}let nl=(nu=class{constructor(){}},nu.Back={iconPath:new Gt("arrow-left")},nu);nl=H([te],nl);var rl;(function(r){r[r.Separator=-1]="Separator",r[r.Default=0]="Default"})(rl||(rl={}));var Ko;(function(r){r[r.Info=1]="Info",r[r.Warning=2]="Warning",r[r.Error=3]="Error"})(Ko||(Ko={}));var ks;(function(r){r[r.UI=1]="UI",r[r.Workspace=2]="Workspace"})(ks||(ks={}));class am{static validate(e){if(typeof e.badge=="string"){let t=Gb(e.badge,0);if(t<e.badge.length&&(t+=Gb(e.badge,t)),e.badge.length>t)throw new Error("The 'badge'-property must be undefined or a short character")}else if(e.badge&&!Gt.isThemeIcon(e.badge))throw new Error("The 'badge'-property is not a valid ThemeIcon");if(!e.color&&!e.badge&&!e.tooltip)throw new Error("The decoration is empty");return!0}constructor(e,t,i){this.badge=e,this.tooltip=t,this.color=i}}let ih=class{constructor(e){this.kind=e}};ih=H([te],ih);var _r;(function(r){r[r.Light=1]="Light",r[r.Dark=2]="Dark",r[r.HighContrast=3]="HighContrast",r[r.HighContrastLight=4]="HighContrastLight"})(_r||(_r={}));let In=class Kw{static isNotebookRange(e){return e instanceof Kw?!0:e?typeof e.start=="number"&&typeof e.end=="number":!1}get start(){return this._start}get end(){return this._end}get isEmpty(){return this._start===this._end}constructor(e,t){if(e<0)throw xe("start must be positive");if(t<0)throw xe("end must be positive");e<=t?(this._start=e,this._end=t):(this._start=t,this._end=e)}with(e){let t=this._start,i=this._end;return e.start!==void 0&&(t=e.start),e.end!==void 0&&(i=e.end),t===this._start&&i===this._end?this:new Kw(t,i)}},nh=class Xw{static validate(e){if(typeof e.kind!="number")throw new Error("NotebookCellData MUST have 'kind' property");if(typeof e.value!="string")throw new Error("NotebookCellData MUST have 'value' property");if(typeof e.languageId!="string")throw new Error("NotebookCellData MUST have 'languageId' property")}static isNotebookCellDataArray(e){return Array.isArray(e)&&e.every(t=>Xw.isNotebookCellData(t))}static isNotebookCellData(e){return!0}constructor(e,t,i,n,s,o,a){this.kind=e,this.value=t,this.languageId=i,this.mime=n,this.outputs=s??[],this.metadata=o,this.executionSummary=a,Xw.validate(this)}},lx=class{constructor(e){this.cells=e}},ux=(bi=class{static isNotebookCellOutputItem(e){return e instanceof bi?!0:e?typeof e.mime=="string"&&e.data instanceof Uint8Array:!1}static error(e){const t={name:e.name,message:e.message,stack:e.stack};return bi.json(t,"application/vnd.code.notebook.error")}static stdout(e){return bi.text(e,"application/vnd.code.notebook.stdout")}static stderr(e){return bi.text(e,"application/vnd.code.notebook.stderr")}static bytes(e,t="application/octet-stream"){return new bi(e,t)}static text(e,t=Cn.text){const i=I(bi,Hf).encode(String(e));return new bi(i,t)}static json(e,t="text/x-json"){const i=JSON.stringify(e,void 0,"	");return bi.text(i,t)}constructor(e,t){this.data=e,this.mime=t;const i=r1(t,!0);if(!i)throw new Error(`INVALID mime type: ${t}. Must be in the format "type/subtype[;optionalparameter]"`);this.mime=i}},Hf=new WeakMap,ae(bi,Hf,new TextEncoder),bi),rh=class Yw{static isNotebookCellOutput(e){return e instanceof Yw?!0:!e||typeof e!="object"?!1:typeof e.id=="string"&&Array.isArray(e.items)}static ensureUniqueMimeTypes(e,t=!1){const i=new Set,n=new Set;for(let s=0;s<e.length;s++){const o=e[s],a=r1(o.mime);if(!i.has(a)||j1(a)){i.add(a);continue}n.add(s),t&&console.warn(`DUPLICATED mime type '${o.mime}' will be dropped`)}return n.size===0?e:e.filter((s,o)=>!n.has(o))}constructor(e,t,i){this.items=Yw.ensureUniqueMimeTypes(e,!0),typeof t=="string"?(this.id=t,this.metadata=i):(this.id=xn(),this.metadata=t??i)}};var Ds;(function(r){r[r.Markup=1]="Markup",r[r.Code=2]="Code"})(Ds||(Ds={}));var Xo;(function(r){r[r.Idle=1]="Idle",r[r.Pending=2]="Pending",r[r.Executing=3]="Executing"})(Xo||(Xo={}));var sh;(function(r){r[r.Left=1]="Left",r[r.Right=2]="Right"})(sh||(sh={}));var oh;(function(r){r[r.Default=0]="Default",r[r.InCenter=1]="InCenter",r[r.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",r[r.AtTop=3]="AtTop"})(oh||(oh={}));class n4{constructor(e,t){this.text=e,this.alignment=t}}var cm;(function(r){r[r.Default=1]="Default",r[r.Preferred=2]="Preferred"})(cm||(cm={}));var ah;(function(r){r[r.Default=1]="Default",r[r.Preferred=2]="Preferred",r[r.Hidden=-1]="Hidden"})(ah||(ah={}));let dx=class{constructor(e,t=[]){this.uri=e,this.provides=uc(t)}},r4=class{constructor(e){this.label=e}};var sl;(function(r){r[r.Named=1]="Named",r[r.Indexed=2]="Indexed"})(sl||(sl={}));let lm=class{constructor(e,t){this.label=e,this.timestamp=t}};lm=H([te],lm);var Yo;(function(r){r[r.Production=1]="Production",r[r.Development=2]="Development",r[r.Test=3]="Test"})(Yo||(Yo={}));var ch;(function(r){r[r.Node=1]="Node",r[r.Webworker=2]="Webworker"})(ch||(ch={}));var wr;(function(r){r[r.Other=0]="Other",r[r.Comment=1]="Comment",r[r.String=2]="String",r[r.RegEx=3]="RegEx"})(wr||(wr={}));class s4{constructor(e,t){this.ranges=e,this.wordPattern=t}}class o4{constructor(e){this._autoForwardAction=e}get autoForwardAction(){return this._autoForwardAction}}var um;(function(r){r[r.Queued=1]="Queued",r[r.Running=2]="Running",r[r.Passed=3]="Passed",r[r.Failed=4]="Failed",r[r.Skipped=5]="Skipped",r[r.Errored=6]="Errored"})(um||(um={}));var Zo;(function(r){r[r.Run=1]="Run",r[r.Debug=2]="Debug",r[r.Coverage=3]="Coverage"})(Zo||(Zo={}));let lh=class{constructor(e=void 0,t=void 0,i=void 0,n=!1){this.include=e,this.exclude=t,this.profile=i,this.continuous=n}};lh=H([te],lh);let uh=Og=class{static diff(e,t,i){const n=new Og(e);return n.expectedOutput=t,n.actualOutput=i,n}constructor(e){this.message=e}};uh=Og=H([te],uh);let ol=class{constructor(e){this.id=e}};ol=H([te],ol);class dh{constructor(e,t){this.covered=e,this.total=t}}const dm=r=>{if(r&&r.covered>r.total)throw new Error(`The total number of covered items (${r.covered}) cannot be greater than the total (${r.total})`)};class hm{static fromDetails(e,t){const i=new dh(0,0),n=new dh(0,0),s=new dh(0,0);for(const a of t)if("branches"in a){i.total+=1,i.covered+=a.executed?1:0;for(const c of a.branches)n.total+=1,n.covered+=c.executed?1:0}else s.total+=1,s.covered+=a.executed?1:0;const o=new hm(e,i,n.total>0?n:void 0,s.total>0?s:void 0);return o.detailedCoverage=t,o}constructor(e,t,i,n){this.uri=e,this.statementCoverage=t,this.branchCoverage=i,this.declarationCoverage=n,dm(t),dm(i),dm(n)}}class a4{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i=[]){this.executed=e,this.location=t,this.branches=i}}class c4{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.executed=e,this.location=t,this.label=i}}class hx{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.name=e,this.executed=t,this.location=i}}var fm;(function(r){r[r.None=0]="None",r[r.Option=1]="Option",r[r.Default=2]="Default",r[r.Preferred=3]="Preferred"})(fm||(fm={}));var pm;(function(r){r[r.Untrusted=0]="Untrusted",r[r.Trusted=1]="Trusted",r[r.Unspecified=2]="Unspecified"})(pm||(pm={}));var gm;(function(r){r[r.Notify=1]="Notify",r[r.OpenBrowser=2]="OpenBrowser",r[r.OpenPreview=3]="OpenPreview",r[r.Silent=4]="Silent",r[r.Ignore=5]="Ignore",r[r.OpenBrowserOnce=6]="OpenBrowserOnce"})(gm||(gm={}));let mm=class{constructor(e,t,i,n,s,o){this.kind=e,this.name=t,this.detail=i,this.uri=n,this.range=s,this.selectionRange=o}};class vm{constructor(e){this.uri=e}}class _m{constructor(e,t){this.original=e,this.modified=t}}class fx{constructor(e,t,i,n){this.base=e,this.input1=t,this.input2=i,this.result=n}}class wm{constructor(e,t){this.uri=e,this.viewType=t}}class px{constructor(e){this.viewType=e}}class bm{constructor(e,t){this.uri=e,this.notebookType=t}}class ym{constructor(e,t,i){this.original=e,this.modified=t,this.notebookType=i}}class gx{constructor(){}}class mx{constructor(e,t){this.uri=e,this.inputBoxUri=t}}class vx{constructor(e){this.providerId=e}}var xm;(function(r){r[r.Down=0]="Down",r[r.Up=1]="Up"})(xm||(xm={}));var Cm;(function(r){r[r.Action=1]="Action",r[r.Toolbar=2]="Toolbar"})(Cm||(Cm={}));var Pn;(function(r){r[r.Short=1]="Short",r[r.Medium=2]="Medium",r[r.Full=3]="Full"})(Pn||(Pn={}));class l4{constructor(e,t){this.label=e,this.values=t}}var br;(function(r){r[r.Unhelpful=0]="Unhelpful",r[r.Helpful=1]="Helpful",r[r.Undone=2]="Undone",r[r.Accepted=3]="Accepted",r[r.Bug=4]="Bug"})(br||(br={}));var al;(function(r){r[r.Unhelpful=0]="Unhelpful",r[r.Helpful=1]="Helpful"})(al||(al={}));let hh=class{constructor(e){this.value=typeof e=="string"?new Di(e):e}};class fh{constructor(e,t){this.value=e,this.baseUri=t}}let ph=class{constructor(e,t){this.value=e,this.title=t}},cl=class{constructor(e){this.value=e}},Sm=class{constructor(e){this.value=e}},ll=class{constructor(e){this.value=e}};class _x{constructor(e,t,i,n){this.prompt=e,this.command=t,this.variables=i,this.participant=n}}class wx{constructor(e,t,i,n){this.response=e,this.result=t,this.participant=i,this.command=n}}class Em{constructor(e){this.content=e}}class km{constructor(e,t){this.content=e,this.name=t}}class Dm{constructor(e){this.content=e}}var Im;(function(r){r[r.SymbolInformation=1]="SymbolInformation",r[r.CommandInformation=2]="CommandInformation",r[r.SearchInformation=3]="SearchInformation",r[r.SettingInformation=4]="SettingInformation"})(Im||(Im={}));var Pm;(function(r){r[r.Started=1]="Started",r[r.Recognizing=2]="Recognizing",r[r.Recognized=3]="Recognized",r[r.Stopped=4]="Stopped"})(Pm||(Pm={}));var Tm;(function(r){r[r.Recognized=1]="Recognized",r[r.Stopped=2]="Stopped"})(Tm||(Tm={}));class u4{constructor(e,t){this.text=e,this.range=t}}var ul;(function(r){r[r.Invoke=0]="Invoke",r[r.Automatic=1]="Automatic"})(ul||(ul={}));var Ii;(function(r){function e(i){const{selectionStartLineNumber:n,selectionStartColumn:s,positionLineNumber:o,positionColumn:a}=i,c=new Se(n-1,s-1),l=new Se(o-1,a-1);return new kn(c,l)}r.to=e;function t(i){const{anchor:n,active:s}=i;return{selectionStartLineNumber:n.line+1,selectionStartColumn:n.character+1,positionLineNumber:s.line+1,positionColumn:s.character+1}}r.from=t})(Ii||(Ii={}));var F;(function(r){function e(i){if(!i)return;const{start:n,end:s}=i;return{startLineNumber:n.line+1,startColumn:n.character+1,endLineNumber:s.line+1,endColumn:s.character+1}}r.from=e;function t(i){if(!i)return;const{startLineNumber:n,startColumn:s,endLineNumber:o,endColumn:a}=i;return new be(n-1,s-1,o-1,a-1)}r.to=t})(F||(F={}));var yr;(function(r){function e(i){return{uri:i.uri,range:F.from(i.range)}}r.from=e;function t(i){return new vi(y.revive(i.uri),F.to(i.range))}r.to=t})(yr||(yr={}));var Am;(function(r){function e(t){switch(t){case 1:return wr.Comment;case 0:return wr.Other;case 3:return wr.RegEx;case 2:return wr.String}}r.to=e})(Am||(Am={}));var We;(function(r){function e(i){return new Se(i.lineNumber-1,i.column-1)}r.to=e;function t(i){return{lineNumber:i.line+1,column:i.character+1}}r.from=t})(We||(We={}));var ea;(function(r){function e(n,s,o){return Jt(uc(n).map(a=>t(a,s,o)))}r.from=e;function t(n,s,o){if(typeof n=="string")return{$serialized:!0,language:n,isBuiltin:o==null?void 0:o.isBuiltin};if(n)return{$serialized:!0,language:n.language,scheme:i(n.scheme,s),pattern:li.from(n.pattern)??void 0,exclusive:n.exclusive,notebookType:n.notebookType,isBuiltin:o==null?void 0:o.isBuiltin}}function i(n,s){return s&&typeof n=="string"?s.transformOutgoingScheme(n):n}})(ea||(ea={}));var gh;(function(r){function e(i){switch(i){case _s.Unnecessary:return 1;case _s.Deprecated:return 2}}r.from=e;function t(i){switch(i){case 1:return _s.Unnecessary;case 2:return _s.Deprecated;default:return}}r.to=t})(gh||(gh={}));var ta;(function(r){function e(i){let n;return i.code&&(Ne(i.code)||or(i.code)?n=String(i.code):n={value:String(i.code.value),target:i.code.target}),{...F.from(i.range),message:i.message,source:i.source,code:n,severity:vh.from(i.severity),relatedInformation:i.relatedInformation&&i.relatedInformation.map(mh.from),tags:Array.isArray(i.tags)?Jt(i.tags.map(gh.from)):void 0}}r.from=e;function t(i){var s;const n=new Dd(F.to(i),i.message,vh.to(i.severity));return n.source=i.source,n.code=Ne(i.code)?i.code:(s=i.code)==null?void 0:s.value,n.relatedInformation=i.relatedInformation&&i.relatedInformation.map(mh.to),n.tags=i.tags&&Jt(i.tags.map(gh.to)),n}r.to=t})(ta||(ta={}));var mh;(function(r){function e(i){return{...F.from(i.location.range),message:i.message,resource:i.location.uri}}r.from=e;function t(i){return new Uc(new vi(i.resource,F.to(i)),i.message)}r.to=t})(mh||(mh={}));var vh;(function(r){function e(i){switch(i){case $t.Error:return Yt.Error;case $t.Warning:return Yt.Warning;case $t.Information:return Yt.Info;case $t.Hint:return Yt.Hint}return Yt.Error}r.from=e;function t(i){switch(i){case Yt.Info:return $t.Information;case Yt.Warning:return $t.Warning;case Yt.Error:return $t.Error;case Yt.Hint:return $t.Hint;default:return $t.Error}}r.to=t})(vh||(vh={}));var bt;(function(r){function e(i){return typeof i=="number"&&i>=Qc.One?i-1:i===Qc.Beside?ND:$D}r.from=e;function t(i){if(typeof i=="number"&&i>=0)return i+1;throw new Error("invalid 'EditorGroupColumn'")}r.to=t})(bt||(bt={}));function d4(r){return typeof r.range<"u"}function bx(r){return r.length===0?!0:!!d4(r[0])}var Te;(function(r){function e(a){return a.map(r.from)}r.fromMany=e;function t(a){return a&&typeof a=="object"&&typeof a.language=="string"&&typeof a.value=="string"}function i(a){let c;if(t(a)){const{language:h,value:g}=a;c={value:"```"+h+`
`+g+"\n```\n"}}else Di.isMarkdownString(a)?c={value:a.value,isTrusted:a.isTrusted,supportThemeIcons:a.supportThemeIcons,supportHtml:a.supportHtml,baseUri:a.baseUri}:typeof a=="string"?c={value:a}:c={value:""};const l=Object.create(null);c.uris=l;const u=h=>{try{let g=y.parse(h,!0);g=g.with({query:n(g.query,l)}),l[h]=g}catch{}return""},d=new n1.Renderer;return d.link=u,d.image=h=>typeof h=="string"?u(Xk(h).href):"",n1(c.value,{renderer:d}),c}r.from=i;function n(a,c){if(!a)return a;let l;try{l=U2(a)}catch{}if(!l)return a;let u=!1;return l=ed(l,d=>{if(y.isUri(d)){const h=`__uri_${Math.random().toString(16).slice(2,8)}`;return c[h]=d,u=!0,h}else return}),u?JSON.stringify(l):a}function s(a){const c=new Di(a.value,a.supportThemeIcons);return c.isTrusted=a.isTrusted,c.supportHtml=a.supportHtml,c.baseUri=a.baseUri?y.from(a.baseUri):void 0,c}r.to=s;function o(a){if(a)return typeof a=="string"?a:r.from(a)}r.fromStrict=o})(Te||(Te={}));function h4(r){return bx(r)?r.map(e=>({range:F.from(e.range),hoverMessage:Array.isArray(e.hoverMessage)?Te.fromMany(e.hoverMessage):e.hoverMessage?Te.from(e.hoverMessage):void 0,renderOptions:e.renderOptions})):r.map(e=>({range:F.from(e)}))}function _h(r){return typeof r>"u"?r:typeof r=="string"?y.file(r):r}var ia;(function(r){function e(t){return typeof t>"u"?t:{contentText:t.contentText,contentIconPath:t.contentIconPath?_h(t.contentIconPath):void 0,border:t.border,borderColor:t.borderColor,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,color:t.color,backgroundColor:t.backgroundColor,margin:t.margin,width:t.width,height:t.height}}r.from=e})(ia||(ia={}));var wh;(function(r){function e(t){return typeof t>"u"?t:{backgroundColor:t.backgroundColor,outline:t.outline,outlineColor:t.outlineColor,outlineStyle:t.outlineStyle,outlineWidth:t.outlineWidth,border:t.border,borderColor:t.borderColor,borderRadius:t.borderRadius,borderSpacing:t.borderSpacing,borderStyle:t.borderStyle,borderWidth:t.borderWidth,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,cursor:t.cursor,color:t.color,opacity:t.opacity,letterSpacing:t.letterSpacing,gutterIconPath:t.gutterIconPath?_h(t.gutterIconPath):void 0,gutterIconSize:t.gutterIconSize,overviewRulerColor:t.overviewRulerColor,before:t.before?ia.from(t.before):void 0,after:t.after?ia.from(t.after):void 0}}r.from=e})(wh||(wh={}));var Rm;(function(r){function e(t){if(typeof t>"u")return t;switch(t){case ws.OpenOpen:return 0;case ws.ClosedClosed:return 1;case ws.OpenClosed:return 2;case ws.ClosedOpen:return 3}}r.from=e})(Rm||(Rm={}));var Lm;(function(r){function e(t){return{isWholeLine:t.isWholeLine,rangeBehavior:t.rangeBehavior?Rm.from(t.rangeBehavior):void 0,overviewRulerLane:t.overviewRulerLane,light:t.light?wh.from(t.light):void 0,dark:t.dark?wh.from(t.dark):void 0,backgroundColor:t.backgroundColor,outline:t.outline,outlineColor:t.outlineColor,outlineStyle:t.outlineStyle,outlineWidth:t.outlineWidth,border:t.border,borderColor:t.borderColor,borderRadius:t.borderRadius,borderSpacing:t.borderSpacing,borderStyle:t.borderStyle,borderWidth:t.borderWidth,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,cursor:t.cursor,color:t.color,opacity:t.opacity,letterSpacing:t.letterSpacing,gutterIconPath:t.gutterIconPath?_h(t.gutterIconPath):void 0,gutterIconSize:t.gutterIconSize,overviewRulerColor:t.overviewRulerColor,before:t.before?ia.from(t.before):void 0,after:t.after?ia.from(t.after):void 0}}r.from=e})(Lm||(Lm={}));var St;(function(r){function e(i){return{text:i.newText,eol:i.newEol&&oa.from(i.newEol),range:F.from(i.range)}}r.from=e;function t(i){const n=new gr(F.to(i.range),i.text);return n.newEol=typeof i.eol>"u"?void 0:oa.to(i.eol),n}r.to=t})(St||(St={}));var ei;(function(r){function e(i,n){var o;const s={edits:[]};if(i instanceof mr){const a=new ob;for(const c of i._allEntries())c._type===1&&y.isUri(c.to)&&c.from===void 0&&a.add(c.to);for(const c of i._allEntries())if(c._type===1){let l;(o=c.options)!=null&&o.contents&&(ArrayBuffer.isView(c.options.contents)?l={type:"base64",value:ub(me.wrap(c.options.contents))}:l={type:"dataTransferItem",id:c.options.contents._itemId}),s.edits.push({oldResource:c.from,newResource:c.to,options:{...c.options,contents:l},metadata:c.metadata})}else c._type===2?s.edits.push({resource:c.uri,textEdit:St.from(c.edit),versionId:a.has(c.uri)||n==null?void 0:n.getTextDocumentVersion(c.uri),metadata:c.metadata}):c._type===6?s.edits.push({resource:c.uri,textEdit:{range:F.from(c.range),text:c.edit.value,insertAsSnippet:!0},versionId:a.has(c.uri)||n==null?void 0:n.getTextDocumentVersion(c.uri),metadata:c.metadata}):c._type===3?s.edits.push({metadata:c.metadata,resource:c.uri,cellEdit:c.edit,notebookMetadata:c.notebookMetadata,notebookVersionId:n==null?void 0:n.getNotebookDocumentVersion(c.uri)}):c._type===5&&s.edits.push({metadata:c.metadata,resource:c.uri,notebookVersionId:n==null?void 0:n.getNotebookDocumentVersion(c.uri),cellEdit:{editType:1,index:c.index,count:c.count,cells:c.cells.map(ml.from)}})}return s}r.from=e;function t(i){const n=new mr,s=new pt;for(const o of i.edits)if(o.textEdit){const a=o,c=y.revive(a.resource),l=F.to(a.textEdit.range),u=a.textEdit.text,d=a.textEdit.insertAsSnippet;let h;d?h=ms.replace(l,new vs(u)):h=gr.replace(l,u);const g=s.get(c);g?g.push(h):s.set(c,[h])}else n.renameFile(y.revive(o.oldResource),y.revive(o.newResource),o.options);for(const[o,a]of s)n.set(o,a);return n}r.to=t})(ei||(ei={}));var Pi;(function(r){const e=Object.create(null);e[qe.File]=0,e[qe.Module]=1,e[qe.Namespace]=2,e[qe.Package]=3,e[qe.Class]=4,e[qe.Method]=5,e[qe.Property]=6,e[qe.Field]=7,e[qe.Constructor]=8,e[qe.Enum]=9,e[qe.Interface]=10,e[qe.Function]=11,e[qe.Variable]=12,e[qe.Constant]=13,e[qe.String]=14,e[qe.Number]=15,e[qe.Boolean]=16,e[qe.Array]=17,e[qe.Object]=18,e[qe.Key]=19,e[qe.Null]=20,e[qe.EnumMember]=21,e[qe.Struct]=22,e[qe.Event]=23,e[qe.Operator]=24,e[qe.TypeParameter]=25;function t(n){return typeof e[n]=="number"?e[n]:6}r.from=t;function i(n){for(const s in e)if(e[s]===n)return Number(s);return qe.Property}r.to=i})(Pi||(Pi={}));var Tn;(function(r){function e(i){switch(i){case Wc.Deprecated:return 1}}r.from=e;function t(i){switch(i){case 1:return Wc.Deprecated}}r.to=t})(Tn||(Tn={}));var dl;(function(r){function e(i){return{name:i.name,kind:Pi.from(i.kind),tags:i.tags&&i.tags.map(Tn.from),containerName:i.containerName,location:_i.from(i.location)}}r.from=e;function t(i){const n=new Vc(i.name,Pi.to(i.kind),i.containerName,_i.to(i.location));return n.tags=i.tags&&i.tags.map(Tn.to),n}r.to=t})(dl||(dl={}));var Om;(function(r){function e(i){var s;const n={name:i.name||"!!MISSING: name!!",detail:i.detail,range:F.from(i.range),selectionRange:F.from(i.selectionRange),kind:Pi.from(i.kind),tags:((s=i.tags)==null?void 0:s.map(Tn.from))??[]};return i.children&&(n.children=i.children.map(e)),n}r.from=e;function t(i){const n=new zc(i.name,i.detail,Pi.to(i.kind),F.to(i.range),F.to(i.selectionRange));return cc(i.tags)&&(n.tags=i.tags.map(Tn.to)),i.children&&(n.children=i.children.map(t)),n}r.to=t})(Om||(Om={}));var Is;(function(r){function e(i){const n=new Ng(Pi.to(i.kind),i.name,i.detail||"",y.revive(i.uri),F.to(i.range),F.to(i.selectionRange));return n._sessionId=i._sessionId,n._itemId=i._itemId,n}r.to=e;function t(i,n,s){var o;if(n=n??i._sessionId,s=s??i._itemId,n===void 0||s===void 0)throw new Error("invalid item");return{_sessionId:n,_itemId:s,name:i.name,detail:i.detail,kind:Pi.from(i.kind),uri:i.uri,range:F.from(i.range),selectionRange:F.from(i.selectionRange),tags:(o=i.tags)==null?void 0:o.map(Tn.from)}}r.from=t})(Is||(Is={}));var $m;(function(r){function e(t){return new rx(Is.to(t.from),t.fromRanges.map(i=>F.to(i)))}r.to=e})($m||($m={}));var Nm;(function(r){function e(t){return new sx(Is.to(t.to),t.fromRanges.map(i=>F.to(i)))}r.to=e})(Nm||(Nm={}));var _i;(function(r){function e(i){return{range:i.range&&F.from(i.range),uri:i.uri}}r.from=e;function t(i){return new vi(y.revive(i.uri),F.to(i.range))}r.to=t})(_i||(_i={}));var hl;(function(r){function e(i){const n=i,s=i;return{originSelectionRange:n.originSelectionRange?F.from(n.originSelectionRange):void 0,uri:n.targetUri?n.targetUri:s.uri,range:F.from(n.targetRange?n.targetRange:s.range),targetSelectionRange:n.targetSelectionRange?F.from(n.targetSelectionRange):void 0}}r.from=e;function t(i){return{targetUri:y.revive(i.uri),targetRange:F.to(i.range),targetSelectionRange:i.targetSelectionRange?F.to(i.targetSelectionRange):void 0,originSelectionRange:i.originSelectionRange?F.to(i.originSelectionRange):void 0}}r.to=t})(hl||(hl={}));var bh;(function(r){function e(i){return{range:F.from(i.range),contents:Te.fromMany(i.contents)}}r.from=e;function t(i){return new Id(i.contents.map(Te.to),F.to(i.range))}r.to=t})(bh||(bh={}));var Fm;(function(r){function e(i){return{range:F.from(i.range),expression:i.expression}}r.from=e;function t(i){return new Kd(F.to(i.range),i.expression)}r.to=t})(Fm||(Fm={}));var yh;(function(r){function e(i){if(i instanceof Xd)return{type:"text",range:F.from(i.range),text:i.text};if(i instanceof Yd)return{type:"variable",range:F.from(i.range),variableName:i.variableName,caseSensitiveLookup:i.caseSensitiveLookup};if(i instanceof Zd)return{type:"expression",range:F.from(i.range),expression:i.expression};throw new Error("Unknown 'InlineValue' type")}r.from=e;function t(i){switch(i.type){case"text":return{range:F.to(i.range),text:i.text};case"variable":return{range:F.to(i.range),variableName:i.variableName,caseSensitiveLookup:i.caseSensitiveLookup};case"expression":return{range:F.to(i.range),expression:i.expression}}}r.to=t})(yh||(yh={}));var xh;(function(r){function e(i){return{frameId:i.frameId,stoppedLocation:F.from(i.stoppedLocation)}}r.from=e;function t(i){return new em(i.frameId,F.to(i.stoppedLocation))}r.to=t})(xh||(xh={}));var na;(function(r){function e(i){return{range:F.from(i.range),kind:i.kind}}r.from=e;function t(i){return new Pd(F.to(i.range),i.kind)}r.to=t})(na||(na={}));var Mm;(function(r){function e(i){return{uri:i.uri,highlights:i.highlights.map(na.from)}}r.from=e;function t(i){return new Td(y.revive(i.uri),i.highlights.map(na.to))}r.to=t})(Mm||(Mm={}));var Hm;(function(r){function e(t){switch(t){case 1:return Mo.TriggerCharacter;case 2:return Mo.TriggerForIncompleteCompletions;case 0:default:return Mo.Invoke}}r.to=e})(Hm||(Hm={}));var Um;(function(r){function e(t){return{triggerKind:Hm.to(t.triggerKind),triggerCharacter:t.triggerCharacter}}r.to=e})(Um||(Um={}));var Ch;(function(r){function e(i){switch(i){case Gc.Deprecated:return 1}}r.from=e;function t(i){switch(i){case 1:return Gc.Deprecated}}r.to=t})(Ch||(Ch={}));var Sh;(function(r){const e=new Map([[fe.Method,0],[fe.Function,1],[fe.Constructor,2],[fe.Field,3],[fe.Variable,4],[fe.Class,5],[fe.Interface,7],[fe.Struct,6],[fe.Module,8],[fe.Property,9],[fe.Unit,12],[fe.Value,13],[fe.Constant,14],[fe.Enum,15],[fe.EnumMember,16],[fe.Keyword,17],[fe.Snippet,27],[fe.Text,18],[fe.Color,19],[fe.File,20],[fe.Reference,21],[fe.Folder,23],[fe.Event,10],[fe.Operator,11],[fe.TypeParameter,24],[fe.Issue,26],[fe.User,25]]);function t(s){return e.get(s)??9}r.from=t;const i=new Map([[0,fe.Method],[1,fe.Function],[2,fe.Constructor],[3,fe.Field],[4,fe.Variable],[5,fe.Class],[7,fe.Interface],[6,fe.Struct],[8,fe.Module],[9,fe.Property],[12,fe.Unit],[13,fe.Value],[14,fe.Constant],[15,fe.Enum],[16,fe.EnumMember],[17,fe.Keyword],[27,fe.Snippet],[18,fe.Text],[19,fe.Color],[20,fe.File],[21,fe.Reference],[23,fe.Folder],[10,fe.Event],[11,fe.Operator],[24,fe.TypeParameter],[25,fe.User],[26,fe.Issue]]);function n(s){return i.get(s)??fe.Property}r.to=n})(Sh||(Sh={}));var Bm;(function(r){function e(t,i){var s;const n=new $d(t.label);return n.insertText=t.insertText,n.kind=Sh.to(t.kind),n.tags=(s=t.tags)==null?void 0:s.map(Ch.to),n.detail=t.detail,n.documentation=ls(t.documentation)?Te.to(t.documentation):t.documentation,n.sortText=t.sortText,n.filterText=t.filterText,n.preselect=t.preselect,n.commitCharacters=t.commitCharacters,ze.isIRange(t.range)?n.range=F.to(t.range):typeof t.range=="object"&&(n.range={inserting:F.to(t.range.insert),replacing:F.to(t.range.replace)}),n.keepWhitespace=typeof t.insertTextRules>"u"?!1:!!(t.insertTextRules&1),typeof t.insertTextRules<"u"&&t.insertTextRules&4?n.insertText=new vs(t.insertText):(n.insertText=t.insertText,n.textEdit=n.range instanceof be?new gr(n.range,n.insertText):void 0),t.additionalTextEdits&&t.additionalTextEdits.length>0&&(n.additionalTextEdits=t.additionalTextEdits.map(o=>St.to(o))),n.command=i&&t.command?i.fromInternal(t.command):void 0,n}r.to=e})(Bm||(Bm={}));var Eh;(function(r){function e(i){if(typeof i.label!="string"&&!Array.isArray(i.label))throw new TypeError("Invalid label");return{label:i.label,documentation:Te.fromStrict(i.documentation)}}r.from=e;function t(i){return{label:i.label,documentation:ls(i.documentation)?Te.to(i.documentation):i.documentation}}r.to=t})(Eh||(Eh={}));var kh;(function(r){function e(i){return{label:i.label,documentation:Te.fromStrict(i.documentation),parameters:Array.isArray(i.parameters)?i.parameters.map(Eh.from):[],activeParameter:i.activeParameter}}r.from=e;function t(i){return{label:i.label,documentation:ls(i.documentation)?Te.to(i.documentation):i.documentation,parameters:Array.isArray(i.parameters)?i.parameters.map(Eh.to):[],activeParameter:i.activeParameter}}r.to=t})(kh||(kh={}));var fl;(function(r){function e(i){return{activeSignature:i.activeSignature,activeParameter:i.activeParameter,signatures:Array.isArray(i.signatures)?i.signatures.map(kh.from):[]}}r.from=e;function t(i){return{activeSignature:i.activeSignature,activeParameter:i.activeParameter,signatures:Array.isArray(i.signatures)?i.signatures.map(kh.to):[]}}r.to=t})(fl||(fl={}));var Wm;(function(r){function e(t,i){const n=new Od(We.to(i.position),typeof i.label=="string"?i.label:i.label.map(Vm.to.bind(void 0,t)),i.kind&&Dh.to(i.kind));return n.textEdits=i.textEdits&&i.textEdits.map(St.to),n.tooltip=ls(i.tooltip)?Te.to(i.tooltip):i.tooltip,n.paddingLeft=i.paddingLeft,n.paddingRight=i.paddingRight,n}r.to=e})(Wm||(Wm={}));var Vm;(function(r){function e(t,i){const n=new Ld(i.label);return n.tooltip=ls(i.tooltip)?Te.to(i.tooltip):i.tooltip,gg.is(i.command)&&(n.command=t.fromInternal(i.command)),i.location&&(n.location=_i.to(i.location)),n}r.to=e})(Vm||(Vm={}));var Dh;(function(r){function e(i){return i}r.from=e;function t(i){return i}r.to=t})(Dh||(Dh={}));var Ps;(function(r){function e(i){return{range:F.from(i.range),url:i.target,tooltip:i.tooltip}}r.from=e;function t(i){let n;if(i.url)try{n=typeof i.url=="string"?y.parse(i.url,!0):y.revive(i.url)}catch{}return new Fd(F.to(i.range),n)}r.to=t})(Ps||(Ps={}));var Ih;(function(r){function e(i){const n=new Hd(i.label);return i.textEdit&&(n.textEdit=St.to(i.textEdit)),i.additionalTextEdits&&(n.additionalTextEdits=i.additionalTextEdits.map(s=>St.to(s))),n}r.to=e;function t(i){return{label:i.label,textEdit:i.textEdit?St.from(i.textEdit):void 0,additionalTextEdits:i.additionalTextEdits?i.additionalTextEdits.map(n=>St.from(n)):void 0}}r.from=t})(Ih||(Ih={}));var ra;(function(r){function e(i){return new Vo(i[0],i[1],i[2],i[3])}r.to=e;function t(i){return[i.red,i.green,i.blue,i.alpha]}r.from=t})(ra||(ra={}));var zm;(function(r){function e(i){return{range:F.from(i.range)}}r.from=e;function t(i){return new qc(F.to(i.range))}r.to=t})(zm||(zm={}));var Ph;(function(r){function e(t){switch(t){case 2:return Uo.AfterDelay;case 1:return Uo.Manual;case 3:case 4:return Uo.FocusOut}}r.to=e})(Ph||(Ph={}));var sa;(function(r){function e(i){switch(i){case Hi.Off:return 0;case Hi.Relative:return 2;case Hi.Interval:return 3;case Hi.On:default:return 1}}r.from=e;function t(i){switch(i){case 0:return Hi.Off;case 2:return Hi.Relative;case 3:return Hi.Interval;case 1:default:return Hi.On}}r.to=t})(sa||(sa={}));var oa;(function(r){function e(i){if(i===Mi.CRLF)return 1;if(i===Mi.LF)return 0}r.from=e;function t(i){if(i===1)return Mi.CRLF;if(i===0)return Mi.LF}r.to=t})(oa||(oa={}));var jm;(function(r){function e(t){if(typeof t=="object")return t.viewId;switch(t){case xs.SourceControl:return 3;case xs.Window:return 10;case xs.Notification:return 15}throw new Error("Unknown 'ProgressLocation'")}r.from=e})(jm||(jm={}));var Th;(function(r){function e(i){const n={start:i.start+1,end:i.end+1};return i.kind&&(n.kind=Ah.from(i.kind)),n}r.from=e;function t(i){const n={start:i.start-1,end:i.end-1};return i.kind&&(n.kind=Ah.to(i.kind)),n}r.to=t})(Th||(Th={}));var Ah;(function(r){function e(i){if(i)switch(i){case Dn.Comment:return Po.Comment;case Dn.Imports:return Po.Imports;case Dn.Region:return Po.Region}}r.from=e;function t(i){if(i)switch(i.value){case Po.Comment.value:return Dn.Comment;case Po.Imports.value:return Dn.Imports;case Po.Region.value:return Dn.Region}}r.to=t})(Ah||(Ah={}));var pl;(function(r){function e(t){if(t)return{pinned:typeof t.preview=="boolean"?!t.preview:void 0,inactive:t.background,preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?F.from(t.selection):void 0,override:typeof t.override=="boolean"?oD.id:void 0}}r.from=e})(pl||(pl={}));var li;(function(r){function e(s){return s instanceof qo?s.toJSON():typeof s=="string"?s:t(s)||i(s)?new qo(s.baseUri??s.base,s.pattern).toJSON():s}r.from=e;function t(s){const o=s;return o?y.isUri(o.baseUri)&&typeof o.pattern=="string":!1}function i(s){const o=s;return o?typeof o.base=="string"&&typeof o.pattern=="string":!1}function n(s){return typeof s=="string"?s:new qo(y.revive(s.baseUri),s.pattern)}r.to=n})(li||(li={}));var qm;(function(r){function e(t){if(t){if(Array.isArray(t))return t.map(e);if(typeof t=="string")return t;{const i=t;return{language:i.language,scheme:i.scheme,pattern:li.from(i.pattern),exclusive:i.exclusive,notebookType:i.notebookType}}}else return}r.from=e})(qm||(qm={}));var Rh;(function(r){function e(i){return!!i&&typeof i=="object"&&"documents"in i&&Array.isArray(i.documents)&&i.documents.every(n=>Array.isArray(n)&&n.every(s=>s&&typeof s=="object"&&"uri"in s&&y.isUri(s.uri)&&"version"in s&&typeof s.version=="number"&&"ranges"in s&&Array.isArray(s.ranges)&&s.ranges.every(o=>o instanceof be)))}r.is=e;function t(i){return{documents:i.documents.map(n=>n.map(s=>({uri:y.from(s.uri),version:s.version,ranges:s.ranges.map(o=>F.from(o))})))}}r.from=t})(Rh||(Rh={}));var sn;(function(r){function e(i){return{start:i.start,end:i.end}}r.from=e;function t(i){return new In(i.start,i.end)}r.to=t})(sn||(sn={}));var aa;(function(r){function e(i){return{timing:typeof i.runStartTime=="number"&&typeof i.runEndTime=="number"?{startTime:i.runStartTime,endTime:i.runEndTime}:void 0,executionOrder:i.executionOrder,success:i.lastRunSuccess}}r.to=e;function t(i){var n,s;return{lastRunSuccess:i.success,runStartTime:(n=i.timing)==null?void 0:n.startTime,runEndTime:(s=i.timing)==null?void 0:s.endTime,executionOrder:i.executionOrder}}r.from=t})(aa||(aa={}));var Gm;(function(r){function e(t){if(t===Mc.Unconfirmed)return Xo.Pending;if(t===Mc.Pending)return;if(t===Mc.Executing)return Xo.Executing;throw new Error(`Unknown state: ${t}`)}r.to=e})(Gm||(Gm={}));var gl;(function(r){function e(i){switch(i){case Ds.Markup:return Oo.Markup;case Ds.Code:default:return Oo.Code}}r.from=e;function t(i){switch(i){case Oo.Markup:return Ds.Markup;case Oo.Code:default:return Ds.Code}}r.to=t})(gl||(gl={}));var xr;(function(r){function e(i){const n={metadata:i.metadata??Object.create(null),cells:[]};for(const s of i.cells)nh.validate(s),n.cells.push(ml.from(s));return n}r.from=e;function t(i){const n=new lx(i.cells.map(ml.to));return IE(i.metadata)||(n.metadata=i.metadata),n}r.to=t})(xr||(xr={}));var ml;(function(r){function e(i){return{cellKind:gl.from(i.kind),language:i.languageId,mime:i.mime,source:i.value,metadata:i.metadata,internalMetadata:aa.from(i.executionSummary??{}),outputs:i.outputs?i.outputs.map(Cr.from):[]}}r.from=e;function t(i){return new nh(gl.to(i.cellKind),i.source,i.language,i.mime,i.outputs?i.outputs.map(Cr.to):void 0,i.metadata,i.internalMetadata?aa.to(i.internalMetadata):void 0)}r.to=t})(ml||(ml={}));var ca;(function(r){function e(i){return{mime:i.mime,valueBytes:me.wrap(i.data)}}r.from=e;function t(i){return new ux(i.valueBytes.buffer,i.mime)}r.to=t})(ca||(ca={}));var Cr;(function(r){function e(i){return{outputId:i.id,items:i.items.map(ca.from),metadata:i.metadata}}r.from=e;function t(i){const n=i.items.map(ca.to);return new rh(n,i.outputId,i.metadata)}r.to=t})(Cr||(Cr={}));var Lh;(function(r){function e(n){return i(n)?{include:li.from(n.include)??void 0,exclude:li.from(n.exclude)??void 0}:li.from(n)??void 0}r.from=e;function t(n){return i(n)?{include:li.to(n.include),exclude:li.to(n.exclude)}:li.to(n)}r.to=t;function i(n){const s=n;return s?!jt(s.include)&&!jt(s.exclude):!1}})(Lh||(Lh={}));var Qm;(function(r){function e(t,i,n){const s=typeof t.command=="string"?{title:"",command:t.command}:t.command;return{alignment:t.alignment===sh.Left?1:2,command:i.toInternal(s,n),text:t.text,tooltip:t.tooltip,accessibilityInformation:t.accessibilityInformation,priority:t.priority}}r.from=e})(Qm||(Qm={}));var Jm;(function(r){function e(t,i,n){const s=typeof t.command=="string"?{title:"",command:t.command}:t.command;return{command:i.toInternal(s,n),label:t.label,description:t.description,detail:t.detail,documentation:t.documentation}}r.from=e})(Jm||(Jm={}));var Km;(function(r){function e(t){return{transientOutputs:(t==null?void 0:t.transientOutputs)??!1,transientCellMetadata:(t==null?void 0:t.transientCellMetadata)??{},transientDocumentMetadata:(t==null?void 0:t.transientDocumentMetadata)??{},cellContentMetadata:(t==null?void 0:t.cellContentMetadata)??{}}}r.from=e})(Km||(Km={}));var Oh;(function(r){function e(i){return{uri:i.uri,provides:i.provides}}r.from=e;function t(i){return new dx(y.revive(i.uri),i.provides)}r.to=t})(Oh||(Oh={}));var la;(function(r){function e(i){return{message:Te.fromStrict(i.message)||"",type:0,expected:i.expectedOutput,actual:i.actualOutput,contextValue:i.contextValue,location:i.location&&{range:F.from(i.location.range),uri:i.location.uri}}}r.from=e;function t(i){const n=new uh(typeof i.message=="string"?i.message:Te.to(i.message));return n.actualOutput=i.actual,n.expectedOutput=i.expected,n.contextValue=i.contextValue,n.location=i.location?_i.to(i.location):void 0,n}r.to=t})(la||(la={}));var Ui;(function(r){r.namespace=dd,r.denamespace=p1})(Ui||(Ui={}));var Sr;(function(r){function e(i){const n=wd(i).controllerId;return{extId:we.fromExtHostTestItem(i,n).toString(),label:i.label,uri:y.revive(i.uri),busy:i.busy,tags:i.tags.map(s=>Ui.namespace(n,s.id)),range:ze.lift(F.from(i.range)),description:i.description||null,sortText:i.sortText||null,error:i.error&&Te.fromStrict(i.error)||null}}r.from=e;function t(i){return{parent:void 0,error:void 0,id:we.fromString(i.extId).localId,label:i.label,uri:y.revive(i.uri),tags:(i.tags||[]).map(n=>{const{tagId:s}=Ui.denamespace(n);return new ol(s)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>{},replace:()=>{},size:0},range:F.to(i.range||void 0),canResolveChildren:!1,busy:i.busy,description:i.description||void 0,sortText:i.sortText||void 0}}r.toPlain=t})(Sr||(Sr={})),function(r){function e(i){return{id:i.id}}r.from=e;function t(i){return new ol(i.id)}r.to=t}(Ui||(Ui={}));var Xm;(function(r){const e=(i,n)=>{const s=[];for(const[a,c]of n)we.compare(c.item.extId,a)===2&&(n.delete(a),s.push(c));const o={...Sr.toPlain(i.item),parent:void 0,taskStates:i.tasks.map(a=>({state:a.state,duration:a.duration,messages:a.messages.filter(c=>c.type===0).map(la.to)})),children:s.map(a=>e(a,n))};for(const a of o.children)a.parent=o;return o};function t(i){const n=[],s=new Map;for(const o of i.items){s.set(o.item.extId,o);const a=we.root(o.item.extId);i.request.targets.some(c=>c.controllerId===a&&c.testIds.includes(o.item.extId))&&n.push(o)}return{completedAt:i.completedAt,results:n.map(o=>e(o,s))}}r.to=t})(Xm||(Xm={}));var $h;(function(r){function e(s){return{covered:s.covered,total:s.total}}function t(s){return"line"in s?We.from(s):F.from(s)}function i(s){return"branches"in s?{count:s.executed,location:t(s.location),type:1,branches:s.branches.length?s.branches.map(o=>({count:o.executed,location:o.location&&t(o.location),label:o.label})):void 0}:{type:0,name:s.name,count:s.executed,location:t(s.location)}}r.fromDetailed=i;function n(s){var o;return{uri:s.uri,statement:e(s.statementCoverage),branch:s.branchCoverage&&e(s.branchCoverage),declaration:s.declarationCoverage&&e(s.declarationCoverage),details:(o=s.detailedCoverage)==null?void 0:o.map(i)}}r.fromFile=n})($h||($h={}));var Ym;(function(r){function e(t){switch(t){case 1:return jc.Invoke;case 2:return jc.Automatic}}r.to=e})(Ym||(Ym={}));var Ts;(function(r){function e(i){const n=new mm(Pi.to(i.kind),i.name,i.detail||"",y.revive(i.uri),F.to(i.range),F.to(i.selectionRange));return n._sessionId=i._sessionId,n._itemId=i._itemId,n}r.to=e;function t(i,n,s){var o;if(n=n??i._sessionId,s=s??i._itemId,n===void 0||s===void 0)throw new Error("invalid item");return{_sessionId:n,_itemId:s,kind:Pi.from(i.kind),name:i.name,detail:i.detail??"",uri:i.uri,range:F.from(i.range),selectionRange:F.from(i.selectionRange),tags:(o=i.tags)==null?void 0:o.map(Tn.from)}}r.from=t})(Ts||(Ts={}));var Nh;(function(r){function e(t){if(t)return{value:t.value,tooltip:t.tooltip}}r.from=e})(Nh||(Nh={}));var Fh;(function(r){function e(s,o,a){const c=o.fileData;return c?new XD(new YD(c.name,y.revive(c.uri),c.id,yp(()=>a(c.id)))):s===Cn.uriList&&o.uriListData?new Vd(n(o.uriListData)):new Vd(o.asString)}r.to=e;async function t(s,o){const a=await o.asString();if(s===Cn.uriList)return{asString:a,fileData:void 0,uriListData:i(a)};const c=o.asFile();return{asString:a,fileData:c?{name:c.name,uri:c.uri,id:c._itemId??c.id}:void 0}}r.from=t;function i(s){return ug.split(s).map(o=>{if(o.startsWith("#"))return o;try{return y.parse(o)}catch{}return o})}function n(s){return ug.create(s.map(o=>typeof o=="string"?o:y.revive(o)))}})(Fh||(Fh={}));var Er;(function(r){function e(i,n){const s=i.items.map(([o,a])=>[o,Fh.to(o,a,n)]);return new Xc(s)}r.toDataTransfer=e;async function t(i){const n={items:[]},s=[];for(const[o,a]of i)s.push((async()=>{n.items.push([o,await Fh.from(o,a)])})());return await Promise.all(s),n}r.from=t})(Er||(Er={}));var vl;(function(r){function e(i,n){return{kind:"reply",agentId:i.participant??(n==null?void 0:n.agentId)??"",subCommand:i.command??(n==null?void 0:n.command),message:i.prompt,title:i.label}}r.from=e;function t(i){return{prompt:i.message,label:i.title,participant:i.agentId,command:i.subCommand}}r.to=t})(vl||(vl={}));var Zm;(function(r){function e(t){return"commandId"in t?{kind:"command",title:t.title??"",commandId:t.commandId??"",when:t.when??"",args:t.args}:{kind:"reply",message:t.message,title:t.title,tooltip:t.tooltip}}r.from=e})(Zm||(Zm={}));var Mh;(function(r){function e(i){switch(i.role){case 0:return new Em(i.content);case 1:return new km(i.content);case 2:return new Dm(i.content)}}r.to=e;function t(i){if(i instanceof Em)return{role:0,content:i.content};if(i instanceof km)return{role:1,content:i.content};if(i instanceof Dm)return{role:2,content:i.content};throw new Error("Invalid LanguageModelMessage")}r.from=t})(Mh||(Mh={}));var ua;(function(r){function e(n){const s={};for(const o of Object.keys(n))s[o]=n[o].map(r.to);return s}r.objectTo=e;function t(n){return{level:Hh.to(n.level),kind:n.kind,value:$p(n.value)?y.revive(n.value):n.value,description:n.description}}r.to=t;function i(n){return{level:Hh.from(n.level),kind:n.kind,value:n.value,description:n.description}}r.from=i})(ua||(ua={}));var Hh;(function(r){function e(i){switch(i){case"short":return Pn.Short;case"medium":return Pn.Medium;case"full":default:return Pn.Full}}r.to=e;function t(i){switch(i){case Pn.Short:return"short";case Pn.Medium:return"medium";case Pn.Full:default:return"full"}}r.from=t})(Hh||(Hh={}));var ev;(function(r){function e(t){switch(t){case 1:return br.Helpful;case 0:return br.Unhelpful;case 2:return br.Undone;case 3:return br.Accepted;case 4:return br.Bug}}r.to=e})(ev||(ev={}));var _l;(function(r){function e(i){return{kind:"markdownContent",content:Te.from(i.value)}}r.to=e;function t(i){return new hh(Te.to(i.content))}r.from=t})(_l||(_l={}));var wl;(function(r){function e(i){const{value:n,baseUri:s}=i;function o(a,c){return a.map(l=>{const u=y.joinPath(c,l.name);return{label:l.name,uri:u,children:l.children&&o(l.children,u)}})}return{kind:"treeData",treeData:{label:ns(s),uri:s,children:o(n,s)}}}r.to=e;function t(i){const n=Yi(i.treeData);function s(c){return c.map(l=>({name:l.label,children:l.children&&s(l.children)}))}const o=n.uri,a=n.children?s(n.children):[];return new fh(a,o)}r.from=t})(wl||(wl={}));var bl;(function(r){function e(i){return{kind:"inlineReference",name:i.title,inlineReference:y.isUri(i.value)?i.value:yr.from(i.value)}}r.to=e;function t(i){const n=Yi(i);return new ph(y.isUri(n.inlineReference)?n.inlineReference:yr.to(n.inlineReference),i.name)}r.from=t})(bl||(bl={}));var yl;(function(r){function e(i){return{kind:"progressMessage",content:Te.from(i.value)}}r.to=e;function t(i){return new cl(i.content.value)}r.from=t})(yl||(yl={}));var Uh;(function(r){function e(i,n,s){return{kind:"command",command:n.toInternal(i.value,s)??{command:i.value.command,title:i.value.title}}}r.to=e;function t(i,n){return new Sm(n.fromInternal(i.command)??{command:i.command.id,title:i.command.title})}r.from=t})(Uh||(Uh={}));var da;(function(r){function e(i){return{kind:"reference",reference:y.isUri(i.value)?i.value:yr.from(i.value)}}r.to=e;function t(i){const n=Yi(i);return new ll(y.isUri(n.reference)?n.reference:yr.to(n.reference))}r.from=t})(da||(da={}));var xl;(function(r){function e(n){return n instanceof hh?_l.to(n):n instanceof ph?bl.to(n):n instanceof ll?da.to(n):n instanceof cl?yl.to(n):n instanceof fh?wl.to(n):{kind:"content",content:""}}r.to=e;function t(n,s){switch(n.kind){case"reference":return da.from(n);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return i(n,s)}}r.from=t;function i(n,s){switch(n.kind){case"markdownContent":return _l.from(n);case"inlineReference":return bl.from(n);case"progressMessage":return;case"treeData":return wl.from(n);case"command":return Uh.from(n,s)}}r.fromContent=i})(xl||(xl={}));var Bh;(function(r){function e(n,s){return"markdownContent"in s?(M(n,"chatParticipantAdditions"),{content:Te.from(s.markdownContent),kind:"markdownContent"}):"content"in s?"vulnerabilities"in s&&s.vulnerabilities?(M(n,"chatParticipantAdditions"),{content:s.content,vulnerabilities:s.vulnerabilities,kind:"vulnerability"}):typeof s.content=="string"?{content:s.content,kind:"content"}:(M(n,"chatParticipantAdditions"),{content:Te.from(s.content),kind:"markdownContent"}):"documents"in s?{documents:s.documents.map(o=>({uri:o.uri,version:o.version,ranges:o.ranges.map(a=>F.from(a))})),kind:"usedContext"}:"reference"in s?{reference:"uri"in s.reference?{uri:s.reference.uri,range:F.from(s.reference.range)}:s.reference,kind:"reference"}:"inlineReference"in s?{inlineReference:"uri"in s.inlineReference?{uri:s.inlineReference.uri,range:F.from(s.inlineReference.range)}:s.inlineReference,name:s.title,kind:"inlineReference"}:"participant"in s?(M(n,"chatParticipantAdditions"),{agentName:s.participant,command:s.command,kind:"agentDetection"}):"message"in s?{content:Te.from(s.message),kind:"progressMessage"}:void 0}r.from=e;function t(n){switch(n.kind){case"markdownContent":case"inlineReference":case"treeData":return r.to(n);case"content":return{content:n.content};case"usedContext":return{documents:n.documents.map(s=>({uri:y.revive(s.uri),version:s.version,ranges:s.ranges.map(o=>F.to(o))}))};case"reference":return{reference:$p(n.reference)?y.revive(n.reference):yr.to(n.reference)};case"agentDetection":return;case"progressMessage":return{message:n.content.value};case"vulnerability":return{content:n.content,vulnerabilities:n.vulnerabilities};default:return}}r.to=t;function i(n,s){switch(n.kind){case"markdownContent":return{content:n.content.value};case"inlineReference":return{inlineReference:$p(n.inlineReference)?y.revive(n.inlineReference):yr.to(n.inlineReference),title:n.name};case"command":return{command:s.fromInternal(n.command)??{command:n.command.id,title:n.command.title}};default:return}}r.toProgressContent=i})(Bh||(Bh={}));var tv;(function(r){function e(t){return{prompt:t.message,command:t.command,variables:t.variables.variables.map(Wh.to)}}r.to=e})(tv||(tv={}));var Wh;(function(r){function e(t){return{name:t.name,range:[t.range.start,t.range.endExclusive],values:t.values.map(ua.to)}}r.to=e})(Wh||(Wh={}));var iv;(function(r){function e(t){return{label:t.label,values:t.values.map(ua.from),insertText:t.insertText,detail:t.detail,documentation:t.documentation}}r.from=e})(iv||(iv={}));var ha;(function(r){function e(t){return{errorDetails:t.errorDetails,metadata:t.metadata}}r.to=e})(ha||(ha={}));var nv;(function(r){function e(t,i,n){if(i.action.kind==="vote")return;const s=ha.to(t);return i.action.kind==="command"?{action:{kind:"command",commandButton:Bh.toProgressContent(i.action.commandButton,n)},result:s}:i.action.kind==="followUp"?{action:{kind:"followUp",followup:vl.to(i.action.followup)},result:s}:{action:i.action,result:s}}r.to=e})(nv||(nv={}));var Vh;(function(r){function e(t,i,n){return"terminalCommand"in t?{terminalCommand:t.terminalCommand,shouldExecute:t.shouldExecute}:"uri"in t?{uri:t.uri}:i.toInternal(t,n)}r.from=e})(Vh||(Vh={}));var rv;(function(r){function e(t,i){return{id:i,label:t.label,description:t.description,canEdit:t.canEdit,collapsibleState:t.collapsibleState||0,contextValue:t.contextValue}}r.from=e})(rv||(rv={}));const yx="⟪ ",xx=" characters skipped ⟫",f4=(yx.length+xx.length+5)*2;ne("searchService");function p4(r){return!!r.preview}class g4{constructor(e,t,i,n){this.ranges=t,this.webviewIndex=n;const s=Array.isArray(t)?t:[t];if(i&&i.matchLines===1&&m4(s)){e=CE(e,i.matchLines);let o="",a=0,c=0;const l=Math.floor(i.charsPerLine/5),u=[];for(const d of s){const h=Math.max(d.startColumn-l,0),g=d.startColumn+i.charsPerLine;if(h>c+l+f4){const w=yx+(h-c)+xx;o+=w+e.slice(h,g),a+=h-(c+w.length)}else o+=e.slice(c,g);u.push(new v4(0,d.startColumn-a,d.endColumn-a)),c=g}this.preview={text:o,matches:Array.isArray(this.ranges)?u:u[0]}}else{const o=Array.isArray(t)?t[0].startLineNumber:t.startLineNumber;this.preview={text:e,matches:lc(t,a=>new Cx(a.startLineNumber-o,a.startColumn,a.endLineNumber-o,a.endColumn))}}}}function m4(r){const e=r[0].startLineNumber;for(const t of r)if(t.startLineNumber!==e||t.endLineNumber!==e)return!1;return!0}class Cx{constructor(e,t,i,n){this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n}}class v4 extends Cx{constructor(e,t,i){super(e,t,e,i)}}function _4(r,e=!0){const t=r&&r.files&&r.files.exclude,i=e&&r&&r.search&&r.search.exclude;if(!t&&!i)return;if(!t||!i)return t||i;let n=Object.create(null);return n=cs(n,ht(t)),n=cs(n,ht(i),!0),n}function Sx(r,e){return r.excludePattern&&Fc(r.excludePattern,e)?!1:r.includePattern||r.usingSearchPaths?r.includePattern&&Fc(r.includePattern,e)?!0:r.usingSearchPaths?!!r.folderQueries&&r.folderQueries.some(t=>{const i=t.folder.fsPath;if(ju(e,i)){const n=gc(i,e);return!t.includePattern||!!Fc(t.includePattern,n)}else return!1}):!1:!0}var Ex;(function(r){r[r.unknownEncoding=1]="unknownEncoding",r[r.regexParseError=2]="regexParseError",r[r.globParseError=3]="globParseError",r[r.invalidLiteral=4]="invalidLiteral",r[r.rgProcessError=5]="rgProcessError",r[r.other=6]="other",r[r.canceled=7]="canceled"})(Ex||(Ex={}));function zh(r,e){const t={...r||{},...e||{}};return Object.keys(t).filter(i=>{const n=t[i];return typeof n=="boolean"&&n})}class kx{constructor(e,t){this._parsedIncludeExpression=null,this._excludeExpression={...e.excludePattern||{},...t.excludePattern||{}},this._parsedExcludeExpression=Lo(this._excludeExpression);let i=e.includePattern;t.includePattern&&(i?i={...i,...t.includePattern}:i=t.includePattern),i&&(this._parsedIncludeExpression=Lo(i))}matchesExcludesSync(e,t,i){return!!(this._parsedExcludeExpression&&this._parsedExcludeExpression(e,t,i))}includedInQuerySync(e,t,i){return!(this._parsedExcludeExpression&&this._parsedExcludeExpression(e,t,i)||this._parsedIncludeExpression&&!this._parsedIncludeExpression(e,t,i))}includedInQuery(e,t,i){const n=this._parsedExcludeExpression(e,t,i),s=()=>this._parsedIncludeExpression?!!this._parsedIncludeExpression(e,t,i):!0;return cr(n)?n.then(o=>o?!1:s()):s()}hasSiblingExcludeClauses(){return w4(this._excludeExpression)}}function w4(r){for(const e in r)if(typeof r[e]!="boolean")return!0;return!1}function b4(r){if(!r)return;let e;return t=>(e||(e=(r()||Promise.resolve([])).then(i=>i?Dx(i):{})),e.then(i=>!!i[t]))}function y4(r){if(!r)return;let e;return t=>{if(!e){const i=r();e=i?Dx(i):{}}return!!e[t]}}function Dx(r){const e={};for(const t of r)e[t]=!0;return e}function Cl(r,e,t){return new vc(i=>sv(i,t)).isEqual(r,e)}function x4(r,e,t){return Cl(r.uri,e.uri,t)?0:ts(r.uri.toString(),e.uri.toString())}function C4(r,e,t){return r.index!==e.index?r.index<e.index?-1:1:Cl(r.uri,e.uri,t)?ts(r.name,e.name):ts(r.uri.toString(),e.uri.toString())}function Ix(r,e,t,i){const n=r.slice(0).sort((o,a)=>t(o,a,i)),s=e.slice(0).sort((o,a)=>t(o,a,i));return tS(n,s,(o,a)=>t(o,a,i))}function sv(r,e){const t=e.getCapabilities(r.scheme);return!(t&&t&1024)}class fa extends Wk{static toExtHostWorkspace(e,t,i,n){if(!e)return{workspace:null,added:[],removed:[]};const{id:s,name:o,folders:a,configuration:c,transient:l,isUntitled:u}=e,d=[],h=t;t?a.forEach((b,k)=>{const D=y.revive(b.uri),C=fa._findFolder(i||t,D,n);C?(C.name=b.name,C.index=b.index,d.push(C)):d.push({uri:D,name:b.name,index:k})}):d.push(...a.map(({uri:b,name:k,index:D})=>({uri:y.revive(b),name:k,index:D}))),d.sort((b,k)=>b.index<k.index?-1:1);const g=new fa(s,o,d,!!l,c?y.revive(c):null,!!u,b=>sv(b,n)),{added:w,removed:p}=Ix(h?h.workspaceFolders:[],g.workspaceFolders,x4,n);return{workspace:g,added:w,removed:p}}static _findFolder(e,t,i){for(let n=0;n<e.folders.length;n++){const s=e.workspaceFolders[n];if(Cl(s.uri,t,i))return s}}constructor(e,t,i,n,s,o,a){super(e,i.map(c=>new Ly(c)),n,s,a),this._name=t,this._isUntitled=o,this._workspaceFolders=[],this._structure=yn.forUris(a),i.forEach(c=>{this._workspaceFolders.push(c),this._structure.set(c.uri,c)})}get name(){return this._name}get isUntitled(){return this._isUntitled}get workspaceFolders(){return this._workspaceFolders.slice(0)}getWorkspaceFolder(e,t){return t&&this._structure.get(e)&&(e=Gp(e)),this._structure.findSubstr(e)}resolveWorkspaceFolder(e){return this._structure.get(e)}}let ov=class{constructor(e,t,i,n,s){this._onDidChangeWorkspace=new T,this.onDidChangeWorkspace=this._onDidChangeWorkspace.event,this._onDidGrantWorkspaceTrust=new T,this.onDidGrantWorkspaceTrust=this._onDidGrantWorkspaceTrust.event,this._activeSearchCallbacks=[],this._trusted=!1,this._editSessionIdentityProviders=new Map,this._providerHandlePool=0,this._onWillCreateEditSessionIdentityEvent=new hc,this._canonicalUriProviders=new Map,this._logService=n,this._extHostFileSystemInfo=i,this._uriTransformerService=s,this._requestIdProvider=new Uk,this._barrier=new wn,this._proxy=e.getProxy(G.MainThreadWorkspace),this._messageService=e.getProxy(G.MainThreadMessageService);const o=t.workspace;this._confirmedWorkspace=o?new fa(o.id,o.name,[],!!o.transient,o.configuration?y.revive(o.configuration):null,!!o.isUntitled,a=>sv(a,i)):void 0}$initializeWorkspace(e,t){this._trusted=t,this.$acceptWorkspaceData(e),this._barrier.open()}waitForInitializeCall(){return this._barrier.wait()}get workspace(){return this._actualWorkspace}get name(){return this._actualWorkspace?this._actualWorkspace.name:void 0}get workspaceFile(){if(this._actualWorkspace&&this._actualWorkspace.configuration)return this._actualWorkspace.isUntitled?y.from({scheme:Z.untitled,path:ns(Gp(this._actualWorkspace.configuration))}):this._actualWorkspace.configuration}get _actualWorkspace(){return this._unconfirmedWorkspace||this._confirmedWorkspace}getWorkspaceFolders(){if(this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}async getWorkspaceFolders2(){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}updateWorkspaceFolders(e,t,i,...n){const s=[];if(Array.isArray(n)&&n.forEach(u=>{y.isUri(u.uri)&&!s.some(d=>Cl(d.uri,u.uri,this._extHostFileSystemInfo))&&s.push({uri:u.uri,name:u.name||qp(u.uri)})}),this._unconfirmedWorkspace||[t,i].some(u=>typeof u!="number"||u<0)||i===0&&s.length===0)return!1;const o=this._actualWorkspace?this._actualWorkspace.workspaceFolders:[];if(t+i>o.length)return!1;const a=o.slice(0);a.splice(t,i,...s.map(u=>({uri:u.uri,name:u.name||qp(u.uri),index:void 0})));for(let u=0;u<a.length;u++){const d=a[u];if(a.some((h,g)=>g!==u&&Cl(d.uri,h.uri,this._extHostFileSystemInfo)))return!1}a.forEach((u,d)=>u.index=d);const{added:c,removed:l}=Ix(o,a,C4,this._extHostFileSystemInfo);if(c.length===0&&l.length===0)return!1;if(this._proxy){const u=e.displayName||e.name;this._proxy.$updateWorkspaceFolders(u,t,i,s).then(void 0,d=>{this._unconfirmedWorkspace=void 0;const h={source:{identifier:e.identifier,label:e.displayName||e.name}};this._messageService.$showMessage(Bk.Error,m("vs/workbench/api/common/extHostWorkspace","updateerror","Extension '{0}' failed to update workspace folders: {1}",u,d.toString()),h,[])})}return this.trySetWorkspaceFolders(a),!0}getWorkspaceFolder(e,t){if(this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async getWorkspaceFolder2(e,t){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async resolveWorkspaceFolder(e){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.resolveWorkspaceFolder(e)}getPath(){if(!this._actualWorkspace)return;const{folders:e}=this._actualWorkspace;if(e.length!==0)return e[0].uri.fsPath}getRelativePath(e,t){let i,n="";if(typeof e=="string"?(i=y.file(e),n=e):typeof e<"u"&&(i=e,n=e.fsPath),!i)return n;const s=this.getWorkspaceFolder(i,!0);if(!s)return n;typeof t>"u"&&this._actualWorkspace&&(t=this._actualWorkspace.folders.length>1);let o=ry(s.uri,i);return t&&s.name&&(o=`${s.name}/${o}`),o}trySetWorkspaceFolders(e){this._actualWorkspace&&(this._unconfirmedWorkspace=fa.toExtHostWorkspace({id:this._actualWorkspace.id,name:this._actualWorkspace.name,configuration:this._actualWorkspace.configuration,folders:e,isUntitled:this._actualWorkspace.isUntitled},this._actualWorkspace,void 0,this._extHostFileSystemInfo).workspace||void 0)}$acceptWorkspaceData(e){const{workspace:t,added:i,removed:n}=fa.toExtHostWorkspace(e,this._confirmedWorkspace,this._unconfirmedWorkspace,this._extHostFileSystemInfo);this._confirmedWorkspace=t||void 0,this._unconfirmedWorkspace=void 0,this._onDidChangeWorkspace.fire(Object.freeze({added:i,removed:n}))}findFiles(e,t,i,n,s=It.None){this._logService.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${n.value}, entryPoint: findFiles`);let o="",a=!0;return t===null?a=!1:t!==void 0&&(typeof t=="string"?o=t:o=t.pattern),this._findFilesImpl(e,void 0,{exclude:o,maxResults:i,useDefaultExcludes:a,useDefaultSearchExcludes:!1,useIgnoreFiles:!1},s)}findFiles2(e,t={},i,n=It.None){return this._logService.trace(`extHostWorkspace#findFiles2: fileSearch, extension: ${i.value}, entryPoint: findFiles2`),this._findFilesImpl(void 0,e,t,n)}async _findFilesImpl(e,t,i,n=It.None){if(n&&n.isCancellationRequested)return Promise.resolve([]);const s=typeof i.exclude=="string"?i.exclude:i.exclude?i.exclude.pattern:void 0,o={ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles=="boolean"?!i.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof i.useGlobalIgnoreFiles=="boolean"?!i.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof i.useParentIgnoreFiles=="boolean"?!i.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof i.useDefaultExcludes=="boolean"?!i.useDefaultExcludes:!1,disregardSearchExcludeSettings:typeof i.useDefaultSearchExcludes=="boolean"?!i.useDefaultSearchExcludes:!1,maxResults:i.maxResults,excludePattern:s,shouldGlobSearch:typeof i.fuzzy=="boolean"?!i.fuzzy:!0,_reason:"startFileSearch"};let a;if(e){const{includePattern:c,folder:l}=av(li.from(e));a=l,o.includePattern=c}else{const{includePattern:c,folder:l}=av(li.from(t));a=l,o.filePattern=c}return this._proxy.$startFileSearch(a??null,o,n).then(c=>Array.isArray(c)?c.map(l=>y.revive(l)):[])}async findTextInFiles(e,t,i,n,s=It.None){this._logService.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${n.value}, entryPoint: findTextInFiles`);const o=this._requestIdProvider.getNext(),a=typeof t.previewOptions>"u"?{matchLines:100,charsPerLine:1e4}:t.previewOptions,{includePattern:c,folder:l}=av(li.from(t.include)),u=typeof t.exclude=="string"?t.exclude:t.exclude?t.exclude.pattern:void 0,d={ignoreSymlinks:typeof t.followSymlinks=="boolean"?!t.followSymlinks:void 0,disregardIgnoreFiles:typeof t.useIgnoreFiles=="boolean"?!t.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof t.useGlobalIgnoreFiles=="boolean"?!t.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof t.useParentIgnoreFiles=="boolean"?!t.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof t.useDefaultExcludes=="boolean"?!t.useDefaultExcludes:!0,fileEncoding:t.encoding,maxResults:t.maxResults,previewOptions:a,afterContext:t.afterContext,beforeContext:t.beforeContext,includePattern:c,excludePattern:u};if(this._activeSearchCallbacks[o]=h=>{const g=y.revive(h.resource);h.results.forEach(w=>{const p=Yi(w);p4(p)?i({uri:g,preview:{text:p.preview.text,matches:lc(p.preview.matches,b=>new be(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn))},ranges:lc(p.ranges,b=>new be(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn))}):i({uri:g,text:p.text,lineNumber:p.lineNumber})})},s.isCancellationRequested)return{};try{const h=await this._proxy.$startTextSearch(e,l??null,d,o,s);return delete this._activeSearchCallbacks[o],h||{}}catch(h){throw delete this._activeSearchCallbacks[o],h}}$handleTextSearchResult(e,t){var i,n;(n=(i=this._activeSearchCallbacks)[t])==null||n.call(i,e)}async save(e){const t=await this._proxy.$save(e,{saveAs:!1});return y.revive(t)}async saveAs(e){const t=await this._proxy.$save(e,{saveAs:!0});return y.revive(t)}saveAll(e){return this._proxy.$saveAll(e)}resolveProxy(e){return this._proxy.$resolveProxy(e)}loadCertificates(){return this._proxy.$loadCertificates()}get trusted(){return this._trusted}requestWorkspaceTrust(e){return this._proxy.$requestWorkspaceTrust(e)}$onDidGrantWorkspaceTrust(){this._trusted||(this._trusted=!0,this._onDidGrantWorkspaceTrust.fire())}registerEditSessionIdentityProvider(e,t){if(this._editSessionIdentityProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._editSessionIdentityProviders.set(e,t);const i=this._uriTransformerService.transformOutgoingScheme(e),n=this._providerHandlePool++;return this._proxy.$registerEditSessionIdentityProvider(n,i),Le(()=>{this._editSessionIdentityProviders.delete(e),this._proxy.$unregisterEditSessionIdentityProvider(n)})}async $getEditSessionIdentifier(e,t){this._logService.info("Getting edit session identifier for workspaceFolder",e);const i=await this.resolveWorkspaceFolder(y.revive(e));if(!i){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",i);const n=this._editSessionIdentityProviders.get(i.uri.scheme);if(this._logService.info(`Provider for scheme ${i.uri.scheme} is defined: `,!!n),!n)return;const s=await n.provideEditSessionIdentity(i,t);if(this._logService.info("Provider returned edit session identifier: ",s),!!s)return s}async $provideEditSessionIdentityMatch(e,t,i,n){var c;this._logService.info("Getting edit session identifier for workspaceFolder",e);const s=await this.resolveWorkspaceFolder(y.revive(e));if(!s){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",s);const o=this._editSessionIdentityProviders.get(s.uri.scheme);if(this._logService.info(`Provider for scheme ${s.uri.scheme} is defined: `,!!o),!o)return;const a=await((c=o.provideEditSessionIdentityMatch)==null?void 0:c.call(o,t,i,n));if(this._logService.info("Provider returned edit session identifier match result: ",a),!!a)return a}getOnWillCreateEditSessionIdentityEvent(e){return(t,i,n)=>{const s=function(a){t.call(i,a)};return s.extension=e,this._onWillCreateEditSessionIdentityEvent.event(s,void 0,n)}}async $onWillCreateEditSessionIdentity(e,t,i){const n=await this.resolveWorkspaceFolder(y.revive(e));if(n===void 0)throw new Error("Unable to resolve workspace folder");await this._onWillCreateEditSessionIdentityEvent.fireAsync({workspaceFolder:n},t,async(s,o)=>{const a=Date.now();await Promise.resolve(s),Date.now()-a>i&&this._logService.warn("SLOW edit session create-participant",o.extension.identifier)}),t.isCancellationRequested}registerCanonicalUriProvider(e,t){if(this._canonicalUriProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._canonicalUriProviders.set(e,t);const i=this._uriTransformerService.transformOutgoingScheme(e),n=this._providerHandlePool++;return this._proxy.$registerCanonicalUriProvider(n,i),Le(()=>{this._canonicalUriProviders.delete(e),this._proxy.$unregisterCanonicalUriProvider(n)})}async provideCanonicalUri(e,t,i){var o;const n=this._canonicalUriProviders.get(e.scheme);if(!n)return;const s=await((o=n.provideCanonicalUri)==null?void 0:o.call(n,y.revive(e),t,i));if(s)return s}async $provideCanonicalUri(e,t,i){return this.provideCanonicalUri(y.revive(e),{targetScheme:t},i)}};ov=H([N(0,Ve),N(1,Ut),N(2,ko),N(3,Ge),N(4,Yu)],ov);const An=ne("IExtHostWorkspace");function av(r){let e,t;return r&&(typeof r=="string"?e=r:(e=r.pattern,t=y.revive(r.baseUri))),{includePattern:e,folder:t}}var cv;(function(r){r.DEFAULT={allowTrailingComma:!0}})(cv||(cv={}));function S4(r,e=!1){let t=0;const i=r.length;let n="",s=0,o=16,a=0;function c(p){let b=0,k=0;for(;b<p;){const D=r.charCodeAt(t);if(D>=48&&D<=57)k=k*16+D-48;else if(D>=65&&D<=70)k=k*16+D-65+10;else if(D>=97&&D<=102)k=k*16+D-97+10;else break;t++,b++}return b<p&&(k=-1),k}function l(p){t=p,n="",s=0,o=16,a=0}function u(){const p=t;if(r.charCodeAt(t)===48)t++;else for(t++;t<r.length&&pa(r.charCodeAt(t));)t++;if(t<r.length&&r.charCodeAt(t)===46)if(t++,t<r.length&&pa(r.charCodeAt(t)))for(t++;t<r.length&&pa(r.charCodeAt(t));)t++;else return a=3,r.substring(p,t);let b=t;if(t<r.length&&(r.charCodeAt(t)===69||r.charCodeAt(t)===101))if(t++,(t<r.length&&r.charCodeAt(t)===43||r.charCodeAt(t)===45)&&t++,t<r.length&&pa(r.charCodeAt(t))){for(t++;t<r.length&&pa(r.charCodeAt(t));)t++;b=t}else a=3;return r.substring(p,b)}function d(){let p="",b=t;for(;;){if(t>=i){p+=r.substring(b,t),a=2;break}const k=r.charCodeAt(t);if(k===34){p+=r.substring(b,t),t++;break}if(k===92){if(p+=r.substring(b,t),t++,t>=i){a=2;break}switch(r.charCodeAt(t++)){case 34:p+='"';break;case 92:p+="\\";break;case 47:p+="/";break;case 98:p+="\b";break;case 102:p+="\f";break;case 110:p+=`
`;break;case 114:p+="\r";break;case 116:p+="	";break;case 117:{const C=c(4);C>=0?p+=String.fromCharCode(C):a=4;break}default:a=5}b=t;continue}if(k>=0&&k<=31)if(jh(k)){p+=r.substring(b,t),a=2;break}else a=6;t++}return p}function h(){if(n="",a=0,s=t,t>=i)return s=i,o=17;let p=r.charCodeAt(t);if(lv(p)){do t++,n+=String.fromCharCode(p),p=r.charCodeAt(t);while(lv(p));return o=15}if(jh(p))return t++,n+=String.fromCharCode(p),p===13&&r.charCodeAt(t)===10&&(t++,n+=`
`),o=14;switch(p){case 123:return t++,o=1;case 125:return t++,o=2;case 91:return t++,o=3;case 93:return t++,o=4;case 58:return t++,o=6;case 44:return t++,o=5;case 34:return t++,n=d(),o=10;case 47:{const b=t-1;if(r.charCodeAt(t+1)===47){for(t+=2;t<i&&!jh(r.charCodeAt(t));)t++;return n=r.substring(b,t),o=12}if(r.charCodeAt(t+1)===42){t+=2;const k=i-1;let D=!1;for(;t<k;){if(r.charCodeAt(t)===42&&r.charCodeAt(t+1)===47){t+=2,D=!0;break}t++}return D||(t++,a=1),n=r.substring(b,t),o=13}return n+=String.fromCharCode(p),t++,o=16}case 45:if(n+=String.fromCharCode(p),t++,t===i||!pa(r.charCodeAt(t)))return o=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return n+=u(),o=11;default:for(;t<i&&g(p);)t++,p=r.charCodeAt(t);if(s!==t){switch(n=r.substring(s,t),n){case"true":return o=8;case"false":return o=9;case"null":return o=7}return o=16}return n+=String.fromCharCode(p),t++,o=16}}function g(p){if(lv(p)||jh(p))return!1;switch(p){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function w(){let p;do p=h();while(p>=12&&p<=15);return p}return{setPosition:l,getPosition:()=>t,scan:e?w:h,getToken:()=>o,getTokenValue:()=>n,getTokenOffset:()=>s,getTokenLength:()=>t-s,getTokenError:()=>a}}function lv(r){return r===32||r===9||r===11||r===12||r===160||r===5760||r>=8192&&r<=8203||r===8239||r===8287||r===12288||r===65279}function jh(r){return r===10||r===13||r===8232||r===8233}function pa(r){return r>=48&&r<=57}function E4(r,e,t=cv.DEFAULT){const i=S4(r,!1);function n(ue){return ue?()=>ue(i.getTokenOffset(),i.getTokenLength()):()=>!0}function s(ue){return ue?Re=>ue(Re,i.getTokenOffset(),i.getTokenLength()):()=>!0}const o=n(e.onObjectBegin),a=s(e.onObjectProperty),c=n(e.onObjectEnd),l=n(e.onArrayBegin),u=n(e.onArrayEnd),d=s(e.onLiteralValue),h=s(e.onSeparator),g=n(e.onComment),w=s(e.onError),p=t&&t.disallowComments,b=t&&t.allowTrailingComma;function k(){for(;;){const ue=i.scan();switch(i.getTokenError()){case 4:D(14);break;case 5:D(15);break;case 3:D(13);break;case 1:p||D(11);break;case 2:D(12);break;case 6:D(16);break}switch(ue){case 12:case 13:p?D(10):g();break;case 16:D(1);break;case 15:case 14:break;default:return ue}}}function D(ue,Re=[],q=[]){if(w(ue),Re.length+q.length>0){let U=i.getToken();for(;U!==17;){if(Re.indexOf(U)!==-1){k();break}else if(q.indexOf(U)!==-1)break;U=k()}}}function C(ue){const Re=i.getTokenValue();return ue?d(Re):a(Re),k(),!0}function R(){switch(i.getToken()){case 11:{let ue=0;try{ue=JSON.parse(i.getTokenValue()),typeof ue!="number"&&(D(2),ue=0)}catch{D(2)}d(ue);break}case 7:d(null);break;case 8:d(!0);break;case 9:d(!1);break;default:return!1}return k(),!0}function A(){return i.getToken()!==10?(D(3,[],[2,5]),!1):(C(!1),i.getToken()===6?(h(":"),k(),ee()||D(4,[],[2,5])):D(5,[],[2,5]),!0)}function B(){o(),k();let ue=!1;for(;i.getToken()!==2&&i.getToken()!==17;){if(i.getToken()===5){if(ue||D(4,[],[]),h(","),k(),i.getToken()===2&&b)break}else ue&&D(6,[],[]);A()||D(4,[],[2,5]),ue=!0}return c(),i.getToken()!==2?D(7,[2],[]):k(),!0}function Q(){l(),k();let ue=!1;for(;i.getToken()!==4&&i.getToken()!==17;){if(i.getToken()===5){if(ue||D(4,[],[]),h(","),k(),i.getToken()===4&&b)break}else ue&&D(6,[],[]);ee()||D(4,[],[4,5]),ue=!0}return u(),i.getToken()!==4?D(8,[4],[]):k(),!0}function ee(){switch(i.getToken()){case 3:return Q();case 1:return B();case 10:return C(!0);default:return R()}}return k(),i.getToken()===17?t.allowEmptyContent?!0:(D(4,[],[]),!1):ee()?(i.getToken()!==17&&D(9,[],[]),!0):(D(4,[],[]),!1)}const uv=ne("configurationService");function dv(r,e){const t=Object.create(null);for(const i in r)Px(t,i,r[i],e);return t}function Px(r,e,t,i){const n=e.split("."),s=n.pop();let o=r;for(let a=0;a<n.length;a++){const c=n[a];let l=o[c];switch(typeof l){case"undefined":l=o[c]=Object.create(null);break;case"object":break;default:i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is ${JSON.stringify(l)}`);return}o=l}if(typeof o=="object"&&o!==null)try{o[s]=t}catch{i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(o)}`)}else i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(o)}`)}function k4(r,e){const t=e.split(".");Tx(r,t)}function Tx(r,e){const t=e.shift();if(e.length===0){delete r[t];return}if(Object.keys(r).indexOf(t)!==-1){const i=r[t];typeof i=="object"&&!Array.isArray(i)&&(Tx(i,e),Object.keys(i).length===0&&delete r[t])}}function qh(r,e,t){function i(o,a){let c=o;for(const l of a){if(typeof c!="object"||c===null)return;c=c[l]}return c}const n=e.split("."),s=i(r,n);return typeof s>"u"?t:s}function D4(r){return r.replace(/[\[\]]/g,"")}const hv={JSONContribution:"base.contributions.json"};function I4(r){return r.length>0&&r.charAt(r.length-1)==="#"?r.substring(0,r.length-1):r}class P4{constructor(){this._onDidChangeSchema=new T,this.onDidChangeSchema=this._onDidChangeSchema.event,this.schemasById={}}registerSchema(e,t){this.schemasById[I4(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}}const T4=new P4;mi.add(hv.JSONContribution,T4);var Ax;(function(r){r.Multiline="multilineText",r.Singleline="singlelineText"})(Ax||(Ax={}));const Gh={Configuration:"base.contributions.configuration"};var Rx;(function(r){r[r.APPLICATION=1]="APPLICATION",r[r.MACHINE=2]="MACHINE",r[r.WINDOW=3]="WINDOW",r[r.RESOURCE=4]="RESOURCE",r[r.LANGUAGE_OVERRIDABLE=5]="LANGUAGE_OVERRIDABLE",r[r.MACHINE_OVERRIDABLE=6]="MACHINE_OVERRIDABLE"})(Rx||(Rx={}));const As="vscode://schemas/settings/resourceLanguage",Qh=mi.as(hv.JSONContribution);class A4{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new T,this.onDidSchemaChange=this._onDidSchemaChange.event,this._onDidUpdateConfiguration=new T,this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:m("vs/platform/configuration/common/configurationRegistry","defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},Qh.registerSchema(As,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),Qh.registerSchema(As,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}deregisterConfigurations(e){const t=new Set;this.doDeregisterConfigurations(e,t),Qh.registerSchema(As,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){const i=new Set;this.doDeregisterConfigurations(t,i),this.doRegisterConfigurations(e,!1,i),Qh.registerSchema(As,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){const i=[];for(const{overrides:n,source:s}of e)for(const o in n)if(t.add(o),on.test(o)){const a=this.configurationDefaultsOverrides.get(o),c=(a==null?void 0:a.valuesSources)??new Map;if(s)for(const h of Object.keys(n[o]))c.set(h,s);const l={...(a==null?void 0:a.value)||{},...n[o]};this.configurationDefaultsOverrides.set(o,{source:s,value:l,valuesSources:c});const u=D4(o),d={type:"object",default:l,description:m("vs/platform/configuration/common/configurationRegistry","defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",u),$ref:As,defaultDefaultValue:l,source:Ne(s)?void 0:s,defaultValueSource:s};i.push(...Sl(o)),this.configurationProperties[o]=d,this.defaultLanguageConfigurationOverridesNode.properties[o]=d}else{this.configurationDefaultsOverrides.set(o,{value:n[o],source:s});const a=this.configurationProperties[o];a&&(this.updatePropertyDefaultValue(o,a),this.updateSchema(o,a))}this.doRegisterOverrideIdentifiers(i)}deregisterDefaultConfigurations(e){const t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){var i;for(const{overrides:n,source:s}of e)for(const o in n){const a=this.configurationDefaultsOverrides.get(o),c=Ne(s)?s:s==null?void 0:s.id,l=Ne(a==null?void 0:a.source)?a==null?void 0:a.source:(i=a==null?void 0:a.source)==null?void 0:i.id;if(c===l)if(t.add(o),this.configurationDefaultsOverrides.delete(o),on.test(o))delete this.configurationProperties[o],delete this.defaultLanguageConfigurationOverridesNode.properties[o];else{const u=this.configurationProperties[o];u&&(this.updatePropertyDefaultValue(o,u),this.updateSchema(o,u))}}this.updateOverridePropertyPatternKey()}deltaConfiguration(e){let t=!1;const i=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,i),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,i),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,i),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,i),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(n=>{this.validateAndRegisterProperties(n,t,n.extensionInfo,n.restrictedProperties,void 0,i),this.configurationContributors.push(n),this.registerJSONConfiguration(n)})}doDeregisterConfigurations(e,t){const i=n=>{var s,o;if(n.properties)for(const a in n.properties){t.add(a);const c=this.configurationProperties[a];(s=c==null?void 0:c.policy)!=null&&s.name&&this.policyConfigurations.delete(c.policy.name),delete this.configurationProperties[a],this.removeFromSchema(a,n.properties[a])}(o=n.allOf)==null||o.forEach(a=>i(a))};for(const n of e){i(n);const s=this.configurationContributors.indexOf(n);s!==-1&&this.configurationContributors.splice(s,1)}}validateAndRegisterProperties(e,t=!0,i,n,s=3,o){var l;s=jt(e.scope)?s:e.scope;const a=e.properties;if(a)for(const u in a){const d=a[u];if(t&&O4(u,d)){delete a[u];continue}if(d.source=i,d.defaultDefaultValue=a[u].default,this.updatePropertyDefaultValue(u,d),on.test(u)?d.scope=void 0:(d.scope=jt(d.scope)?s:d.scope,d.restricted=jt(d.restricted)?!!(n!=null&&n.includes(u)):d.restricted),a[u].hasOwnProperty("included")&&!a[u].included){this.excludedConfigurationProperties[u]=a[u],delete a[u];continue}else this.configurationProperties[u]=a[u],(l=a[u].policy)!=null&&l.name&&this.policyConfigurations.set(a[u].policy.name,u);!a[u].deprecationMessage&&a[u].markdownDeprecationMessage&&(a[u].deprecationMessage=a[u].markdownDeprecationMessage),o.add(u)}const c=e.allOf;if(c)for(const u of c)this.validateAndRegisterProperties(u,t,i,n,s,o)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getConfigurationDefaultsOverrides(){return this.configurationDefaultsOverrides}registerJSONConfiguration(e){const t=i=>{const n=i.properties;if(n)for(const o in n)this.updateSchema(o,n[o]);const s=i.allOf;s==null||s.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:case 5:delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:m("vs/platform/configuration/common/configurationRegistry","overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:m("vs/platform/configuration/common/configurationRegistry","overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:As};this.updatePropertyDefaultValue(t,i)}}registerOverridePropertyPatternKey(){m("vs/platform/configuration/common/configurationRegistry","overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),m("vs/platform/configuration/common/configurationRegistry","overrideSettings.errorMessage","This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){const i=this.configurationDefaultsOverrides.get(e);let n=i==null?void 0:i.value,s=i==null?void 0:i.source;Vp(n)&&(n=t.defaultDefaultValue,s=void 0),Vp(n)&&(n=L4(t.type)),t.default=n,t.defaultValueSource=s}}const Lx="\\[([^\\]]+)\\]",Ox=new RegExp(Lx,"g"),R4=`^(${Lx})+$`,on=new RegExp(R4);function Sl(r){const e=[];if(on.test(r)){let t=Ox.exec(r);for(;t!=null&&t.length;){const i=t[1].trim();i&&e.push(i),t=Ox.exec(r)}}return po(e)}function L4(r){switch(Array.isArray(r)?r[0]:r){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const Jh=new A4;mi.add(Gh.Configuration,Jh);function O4(r,e){var t,i,n,s;return r.trim()?on.test(r)?m("vs/platform/configuration/common/configurationRegistry","config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",r):Jh.getConfigurationProperties()[r]!==void 0?m("vs/platform/configuration/common/configurationRegistry","config.property.duplicate","Cannot register '{0}'. This property is already registered.",r):(t=e.policy)!=null&&t.name&&Jh.getPolicyConfigurations().get((i=e.policy)==null?void 0:i.name)!==void 0?m("vs/platform/configuration/common/configurationRegistry","config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",r,(n=e.policy)==null?void 0:n.name,Jh.getPolicyConfigurations().get((s=e.policy)==null?void 0:s.name)):null:m("vs/platform/configuration/common/configurationRegistry","config.property.empty","Cannot register an empty property")}function El(r){return Object.isFrozen(r)?r:ag(r)}class ti{constructor(e={},t=[],i=[],n){this._contents=e,this._keys=t,this._overrides=i,this.raw=n,this.overrideConfigurations=new Map}get rawConfiguration(){var e;if(!this._rawConfiguration)if((e=this.raw)!=null&&e.length){const t=this.raw.map(i=>{if(i instanceof ti)return i;const n=new $4("");return n.parseRaw(i),n.configurationModel});this._rawConfiguration=t.reduce((i,n)=>n===i?n:i.merge(n),t[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?qh(this.contents,e):this.contents}inspect(e,t){const i=this;return{get value(){return El(i.rawConfiguration.getValue(e))},get override(){return t?El(i.rawConfiguration.getOverrideValue(e,t)):void 0},get merged(){return El(t?i.rawConfiguration.override(t).getValue(e):i.rawConfiguration.getValue(e))},get overrides(){const n=[];for(const{contents:s,identifiers:o,keys:a}of i.rawConfiguration.overrides){const c=new ti(s,a).getValue(e);c!==void 0&&n.push({identifiers:o,value:c})}return n.length?El(n):void 0}}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?qh(i,e):i:void 0}getKeysForOverrideIdentifier(e){const t=[];for(const i of this.overrides)i.identifiers.includes(e)&&t.push(...i.keys);return po(t)}getAllOverrideIdentifiers(){const e=[];for(const t of this.overrides)e.push(...t.identifiers);return po(e)}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){var o,a;const t=ht(this.contents),i=ht(this.overrides),n=[...this.keys],s=(o=this.raw)!=null&&o.length?[...this.raw]:[this];for(const c of e)if(s.push(...(a=c.raw)!=null&&a.length?c.raw:[c]),!c.isEmpty()){this.mergeContents(t,c.contents);for(const l of c.overrides){const[u]=i.filter(d=>er(d.identifiers,l.identifiers));u?(this.mergeContents(u.contents,l.contents),u.keys.push(...l.keys),u.keys=po(u.keys)):i.push(ht(l))}for(const l of c.keys)n.indexOf(l)===-1&&n.push(l)}return new ti(t,n,i,s.every(c=>c instanceof ti)?void 0:s)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const n of po([...Object.keys(this.contents),...Object.keys(t)])){let s=this.contents[n];const o=t[n];o&&(typeof s=="object"&&typeof o=="object"?(s=ht(s),this.mergeContents(s,o)):s=o),i[n]=s}return new ti(i,this.keys,this.overrides)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&Ft(e[i])&&Ft(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=ht(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const n=s=>{s&&(i?this.mergeContents(i,s):i=ht(s))};for(const s of this.overrides)s.identifiers.length===1&&s.identifiers[0]===e?t=s.contents:s.identifiers.includes(e)&&n(s.contents);return n(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(e,t){this.updateValue(e,t,!0)}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),k4(this.contents,e),on.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>er(i.identifiers,Sl(e))),1))}updateValue(e,t,i){Px(this.contents,e,t,n=>console.error(n)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),on.test(e)&&this.overrides.push({identifiers:Sl(e),keys:Object.keys(this.contents[e]),contents:dv(this.contents[e],n=>console.error(n))})}}class $4{constructor(e){this._name=e,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[],this._parseErrors=[]}get configurationModel(){return this._configurationModel||new ti}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(e,t){if(!jt(e)){const i=this.doParseContent(e);this.parseRaw(i,t)}}reparse(e){this._raw&&this.parseRaw(this._raw,e)}parseRaw(e,t){this._raw=e;const{contents:i,keys:n,overrides:s,restricted:o,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new ti(i,n,s,a?[e]:void 0),this._restrictedConfigurations=o||[]}doParseContent(e){let t={},i=null,n=[];const s=[];function o(c){Array.isArray(n)?n.push(c):i!==null&&(n[i]=c)}const a={onObjectBegin:()=>{const c={};o(c),s.push(n),n=c,i=null},onObjectProperty:c=>{i=c},onObjectEnd:()=>{n=s.pop()},onArrayBegin:()=>{const c=[];o(c),s.push(n),n=c,i=null},onArrayEnd:()=>{n=s.pop()},onLiteralValue:o,onError:(c,l,u)=>{}};if(e)try{E4(e,a),t=n[0]||{}}catch(c){console.error(`Error while parsing settings file ${this._name}: ${c}`),this._parseErrors=[c]}return t}doParseRaw(e,t){const i=mi.as(Gh.Configuration).getConfigurationProperties(),n=this.filter(e,i,!0,t);e=n.raw;const s=dv(e,c=>console.error(`Conflict in settings file ${this._name}: ${c}`)),o=Object.keys(e),a=this.toOverrides(e,c=>console.error(`Conflict in settings file ${this._name}: ${c}`));return{contents:s,keys:o,overrides:a,restricted:n.restricted,hasExcludedProperties:n.hasExcludedProperties}}filter(e,t,i,n){var c,l,u;let s=!1;if(!(n!=null&&n.scopes)&&!(n!=null&&n.skipRestricted)&&!((c=n==null?void 0:n.exclude)!=null&&c.length))return{raw:e,restricted:[],hasExcludedProperties:s};const o={},a=[];for(const d in e)if(on.test(d)&&i){const h=this.filter(e[d],t,!1,n);o[d]=h.raw,s=s||h.hasExcludedProperties,a.push(...h.restricted)}else{const h=t[d],g=h?typeof h.scope<"u"?h.scope:3:void 0;h!=null&&h.restricted&&a.push(d),!((l=n.exclude)!=null&&l.includes(d))&&((u=n.include)!=null&&u.includes(d)||(g===void 0||n.scopes===void 0||n.scopes.includes(g))&&!(n.skipRestricted&&(h!=null&&h.restricted)))?o[d]=e[d]:s=!0}return{raw:o,restricted:a,hasExcludedProperties:s}}toOverrides(e,t){const i=[];for(const n of Object.keys(e))if(on.test(n)){const s={};for(const o in e[n])s[o]=e[n][o];i.push({identifiers:Sl(n),keys:Object.keys(s),contents:dv(s,t)})}return i}}class N4{constructor(e,t,i,n,s,o,a,c,l,u,d,h,g){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=n,this.defaultConfiguration=s,this.policyConfiguration=o,this.applicationConfiguration=a,this.userConfiguration=c,this.localUserConfiguration=l,this.remoteUserConfiguration=u,this.workspaceConfiguration=d,this.folderConfigurationModel=h,this.memoryConfigurationModel=g}get value(){return El(this._value)}toInspectValue(e){return(e==null?void 0:e.value)!==void 0||(e==null?void 0:e.override)!==void 0||(e==null?void 0:e.overrides)!==void 0?e:void 0}get defaultInspectValue(){return this._defaultInspectValue||(this._defaultInspectValue=this.defaultConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._defaultInspectValue}get defaultValue(){return this.defaultInspectValue.merged}get default(){return this.toInspectValue(this.defaultInspectValue)}get policyInspectValue(){return this._policyInspectValue===void 0&&(this._policyInspectValue=this.policyConfiguration?this.policyConfiguration.inspect(this.key):null),this._policyInspectValue}get policyValue(){var e;return(e=this.policyInspectValue)==null?void 0:e.merged}get policy(){var e;return((e=this.policyInspectValue)==null?void 0:e.value)!==void 0?{value:this.policyInspectValue.value}:void 0}get applicationInspectValue(){return this._applicationInspectValue===void 0&&(this._applicationInspectValue=this.applicationConfiguration?this.applicationConfiguration.inspect(this.key):null),this._applicationInspectValue}get applicationValue(){var e;return(e=this.applicationInspectValue)==null?void 0:e.merged}get application(){return this.toInspectValue(this.applicationInspectValue)}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get userValue(){return this.userInspectValue.merged}get user(){return this.toInspectValue(this.userInspectValue)}get userLocalInspectValue(){return this._userLocalInspectValue||(this._userLocalInspectValue=this.localUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userLocalInspectValue}get userLocalValue(){return this.userLocalInspectValue.merged}get userLocal(){return this.toInspectValue(this.userLocalInspectValue)}get userRemoteInspectValue(){return this._userRemoteInspectValue||(this._userRemoteInspectValue=this.remoteUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userRemoteInspectValue}get userRemoteValue(){return this.userRemoteInspectValue.merged}get userRemote(){return this.toInspectValue(this.userRemoteInspectValue)}get workspaceInspectValue(){return this._workspaceInspectValue===void 0&&(this._workspaceInspectValue=this.workspaceConfiguration?this.workspaceConfiguration.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceInspectValue}get workspaceValue(){var e;return(e=this.workspaceInspectValue)==null?void 0:e.merged}get workspace(){return this.toInspectValue(this.workspaceInspectValue)}get workspaceFolderInspectValue(){return this._workspaceFolderInspectValue===void 0&&(this._workspaceFolderInspectValue=this.folderConfigurationModel?this.folderConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceFolderInspectValue}get workspaceFolderValue(){var e;return(e=this.workspaceFolderInspectValue)==null?void 0:e.merged}get workspaceFolder(){return this.toInspectValue(this.workspaceFolderInspectValue)}get memoryInspectValue(){return this._memoryInspectValue===void 0&&(this._memoryInspectValue=this.memoryConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier)),this._memoryInspectValue}get memoryValue(){return this.memoryInspectValue.merged}get memory(){return this.toInspectValue(this.memoryInspectValue)}}let fv=class Y0{constructor(e,t,i,n,s=new ti,o=new ti,a=new pt,c=new ti,l=new pt){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=n,this._remoteUserConfiguration=s,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=c,this._memoryConfigurationByResource=l,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new pt,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource),n||(n=new ti,this._memoryConfigurationByResource.set(i.resource,n))):n=this._memoryConfiguration,t===void 0?n.removeValue(e):n.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const n=this.getConsolidatedConfigurationModel(e,t,i),s=this.getFolderConfigurationModelForResource(t.resource,i),o=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const c of n.overrides)for(const l of c.identifiers)n.getOverrideValue(e,l)!==void 0&&a.add(l);return new N4(e,t,n.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,s||void 0,o)}keys(e){const t=this.getFolderConfigurationModelForResource(void 0,e);return{default:this._defaultConfiguration.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this._workspaceConfiguration.keys.slice(0),workspaceFolder:t?t.keys.slice(0):[]}}updateDefaultConfiguration(e){this._defaultConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updatePolicyConfiguration(e){this._policyConfiguration=e}updateApplicationConfiguration(e){this._applicationConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(e){this._localUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(e){this._remoteUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(e){this._workspaceConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(e,t){this._folderConfigurations.set(e,t),this._foldersConsolidatedConfigurations.delete(e)}deleteFolderConfiguration(e){this.folderConfigurations.delete(e),this._foldersConsolidatedConfigurations.delete(e)}compareAndUpdateDefaultConfiguration(e,t){const i=[];if(!t){const{added:n,updated:s,removed:o}=kr(this._defaultConfiguration,e);t=[...n,...s,...o]}for(const n of t)for(const s of Sl(n)){const o=this._defaultConfiguration.getKeysForOverrideIdentifier(s),a=e.getKeysForOverrideIdentifier(s),c=[...a.filter(l=>o.indexOf(l)===-1),...o.filter(l=>a.indexOf(l)===-1),...o.filter(l=>!Ni(this._defaultConfiguration.override(s).getValue(l),e.override(s).getValue(l)))];i.push([s,c])}return this.updateDefaultConfiguration(e),{keys:t,overrides:i}}compareAndUpdatePolicyConfiguration(e){const{added:t,updated:i,removed:n}=kr(this._policyConfiguration,e),s=[...t,...i,...n];return s.length&&this.updatePolicyConfiguration(e),{keys:s,overrides:[]}}compareAndUpdateApplicationConfiguration(e){const{added:t,updated:i,removed:n,overrides:s}=kr(this.applicationConfiguration,e),o=[...t,...i,...n];return o.length&&this.updateApplicationConfiguration(e),{keys:o,overrides:s}}compareAndUpdateLocalUserConfiguration(e){const{added:t,updated:i,removed:n,overrides:s}=kr(this.localUserConfiguration,e),o=[...t,...i,...n];return o.length&&this.updateLocalUserConfiguration(e),{keys:o,overrides:s}}compareAndUpdateRemoteUserConfiguration(e){const{added:t,updated:i,removed:n,overrides:s}=kr(this.remoteUserConfiguration,e),o=[...t,...i,...n];return o.length&&this.updateRemoteUserConfiguration(e),{keys:o,overrides:s}}compareAndUpdateWorkspaceConfiguration(e){const{added:t,updated:i,removed:n,overrides:s}=kr(this.workspaceConfiguration,e),o=[...t,...i,...n];return o.length&&this.updateWorkspaceConfiguration(e),{keys:o,overrides:s}}compareAndUpdateFolderConfiguration(e,t){const i=this.folderConfigurations.get(e),{added:n,updated:s,removed:o,overrides:a}=kr(i,t),c=[...n,...s,...o];return(c.length||!i)&&this.updateFolderConfiguration(e,t),{keys:c,overrides:a}}compareAndDeleteFolderConfiguration(e){const t=this.folderConfigurations.get(e);if(!t)throw new Error("Unknown folder");this.deleteFolderConfiguration(e);const{added:i,updated:n,removed:s,overrides:o}=kr(t,void 0);return{keys:[...i,...n,...s],overrides:o}}get defaults(){return this._defaultConfiguration}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidatedConfigurationModel(e,t,i){let n=this.getConsolidatedConfigurationModelForResource(t,i);return t.overrideIdentifier&&(n=n.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0&&(n=n.merge(this._policyConfiguration)),n}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const n=t.getFolder(e);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);const s=this._memoryConfigurationByResource.get(e);s&&(i=i.merge(s))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(t=i.merge(n),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:n,keys:s}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:n,keys:s}]),e},[])}}allKeys(){const e=new Set;return this._defaultConfiguration.keys.forEach(t=>e.add(t)),this.userConfiguration.keys.forEach(t=>e.add(t)),this._workspaceConfiguration.keys.forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.keys.forEach(i=>e.add(i))),[...e.values()]}allOverrideIdentifiers(){const e=new Set;return this._defaultConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this.userConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this._workspaceConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.getAllOverrideIdentifiers().forEach(i=>e.add(i))),[...e.values()]}getAllKeysForOverrideIdentifier(e){const t=new Set;return this._defaultConfiguration.getKeysForOverrideIdentifier(e).forEach(i=>t.add(i)),this.userConfiguration.getKeysForOverrideIdentifier(e).forEach(i=>t.add(i)),this._workspaceConfiguration.getKeysForOverrideIdentifier(e).forEach(i=>t.add(i)),this._folderConfigurations.forEach(i=>i.getKeysForOverrideIdentifier(e).forEach(n=>t.add(n))),[...t.values()]}static parse(e){const t=this.parseConfigurationModel(e.defaults),i=this.parseConfigurationModel(e.policy),n=this.parseConfigurationModel(e.application),s=this.parseConfigurationModel(e.user),o=this.parseConfigurationModel(e.workspace),a=e.folders.reduce((c,l)=>(c.set(y.revive(l[0]),this.parseConfigurationModel(l[1])),c),new pt);return new Y0(t,i,n,s,new ti,o,a,new ti,new pt)}static parseConfigurationModel(e){return new ti(e.contents,e.keys,e.overrides)}};class F4{constructor(e,t,i,n){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=n,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const s of e.keys)this.affectedKeys.add(s);for(const[,s]of e.overrides)for(const o of s)this.affectedKeys.add(o);this._affectsConfigStr=this._marker;for(const s of this.affectedKeys)this._affectsConfigStr+=s+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=fv.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(e,t){var a;const i=this._marker+e,n=this._affectsConfigStr.indexOf(i);if(n<0)return!1;const s=n+i.length;if(s>=this._affectsConfigStr.length)return!1;const o=this._affectsConfigStr.charCodeAt(s);if(o!==this._markerCode1&&o!==this._markerCode2)return!1;if(t){const c=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(a=this.previous)==null?void 0:a.workspace):void 0,l=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!Ni(c,l)}return!0}}function kr(r,e){const{added:t,removed:i,updated:n}=$x(e==null?void 0:e.rawConfiguration,r==null?void 0:r.rawConfiguration),s=[],o=(r==null?void 0:r.getAllOverrideIdentifiers())||[],a=(e==null?void 0:e.getAllOverrideIdentifiers())||[];if(e){const c=a.filter(l=>!o.includes(l));for(const l of c)s.push([l,e.getKeysForOverrideIdentifier(l)])}if(r){const c=o.filter(l=>!a.includes(l));for(const l of c)s.push([l,r.getKeysForOverrideIdentifier(l)])}if(e&&r){for(const c of o)if(a.includes(c)){const l=$x({contents:r.getOverrideValue(void 0,c)||{},keys:r.getKeysForOverrideIdentifier(c)},{contents:e.getOverrideValue(void 0,c)||{},keys:e.getKeysForOverrideIdentifier(c)});s.push([c,[...l.added,...l.removed,...l.updated]])}}return{added:t,removed:i,updated:n,overrides:s}}function $x(r,e){const t=r?e?r.keys.filter(s=>e.keys.indexOf(s)===-1):[...r.keys]:[],i=e?r?e.keys.filter(s=>r.keys.indexOf(s)===-1):[...e.keys]:[],n=[];if(r&&e){for(const s of e.keys)if(r.keys.indexOf(s)!==-1){const o=qh(e.contents,s),a=qh(r.contents,s);Ni(o,a)||n.push(s)}}return{added:t,removed:i,updated:n}}function kl(r,e){if(e){const t=e.split(".");let i=r;for(let n=0;i&&n<t.length;n++)i=i[t[n]];return i}}function M4(r){return r instanceof y}function H4(r){return r&&r.uri instanceof y&&r.languageId&&typeof r.languageId=="string"}function U4(r){return r&&!r.uri&&r.languageId&&typeof r.languageId=="string"}function B4(r){return r&&r.uri instanceof y&&(!r.name||typeof r.name=="string")&&(!r.index||typeof r.index=="number")}function Nx(r){if(M4(r))return{resource:r};if(H4(r))return{resource:r.uri,overrideIdentifier:r.languageId};if(U4(r))return{overrideIdentifier:r.languageId};if(B4(r))return{resource:r.uri};if(r===null)return{resource:null}}let pv=class{constructor(e,t,i){this._proxy=e.getProxy(G.MainThreadConfiguration),this._extHostWorkspace=t,this._logService=i,this._barrier=new wn,this._actual=null}getConfigProvider(){return this._barrier.wait().then(e=>this._actual)}$initializeConfiguration(e){this._actual=new W4(this._proxy,this._extHostWorkspace,e,this._logService),this._barrier.open()}$acceptConfigurationChanged(e,t){this.getConfigProvider().then(i=>i.$acceptConfigurationChanged(e,t))}};pv=H([N(0,Ve),N(1,An),N(2,Ge)],pv);class W4{constructor(e,t,i,n){this._onDidChangeConfiguration=new T,this._proxy=e,this._logService=n,this._extHostWorkspace=t,this._configuration=fv.parse(i),this._configurationScopes=this._toMap(i.configurationScopes)}get onDidChangeConfiguration(){return this._onDidChangeConfiguration&&this._onDidChangeConfiguration.event}$acceptConfigurationChanged(e,t){const i={data:this._configuration.toData(),workspace:this._extHostWorkspace.workspace};this._configuration=fv.parse(e),this._configurationScopes=this._toMap(e.configurationScopes),this._onDidChangeConfiguration.fire(this._toConfigurationChangeEvent(t,i))}getConfiguration(e,t,i){const n=Nx(t)||{},s=this._toReadonlyValue(e?kl(this._configuration.getValue(void 0,n,this._extHostWorkspace.workspace),e):this._configuration.getValue(void 0,n,this._extHostWorkspace.workspace));e&&this._validateConfigurationAccess(e,n,i==null?void 0:i.identifier);function o(c){if(c==null)return null;if(typeof c=="boolean")return c?2:5;switch(c){case jo.Global:return 2;case jo.Workspace:return 5;case jo.WorkspaceFolder:return 6}}const a={has(c){return typeof kl(s,c)<"u"},get:(c,l)=>{this._validateConfigurationAccess(e?`${e}.${c}`:c,n,i==null?void 0:i.identifier);let u=kl(s,c);if(typeof u>"u")u=l;else{let d;const h=(g,w)=>{if(Ft(g)){let p;const b=()=>{d=d||ht(s),p=p||kl(d,w)};return new Proxy(g,{get:(k,D)=>{if(typeof D=="string"&&D.toLowerCase()==="tojson")return b(),()=>p;if(d)return p=p||kl(d,w),p[D];const C=k[D];return typeof D=="string"?h(C,`${w}.${D}`):C},set:(k,D,C)=>(b(),p&&(p[D]=C),!0),deleteProperty:(k,D)=>(b(),p&&delete p[D],!0),defineProperty:(k,D,C)=>(b(),p&&Object.defineProperty(p,D,C),!0)})}return Array.isArray(g)?ht(g):g};u=h(u,c)}return u},update:(c,l,u,d)=>{c=e?`${e}.${c}`:c;const h=o(u);return l!==void 0?this._proxy.$updateConfigurationOption(h,c,l,n,d):this._proxy.$removeConfigurationOption(h,c,n,d)},inspect:c=>{var u,d,h,g,w,p,b,k,D,C,R;c=e?`${e}.${c}`:c;const l=this._configuration.inspect(c,n,this._extHostWorkspace.workspace);if(l)return{key:c,defaultValue:ht(((u=l.policy)==null?void 0:u.value)??((d=l.default)==null?void 0:d.value)),globalValue:ht(((h=l.user)==null?void 0:h.value)??((g=l.application)==null?void 0:g.value)),workspaceValue:ht((w=l.workspace)==null?void 0:w.value),workspaceFolderValue:ht((p=l.workspaceFolder)==null?void 0:p.value),defaultLanguageValue:ht((b=l.default)==null?void 0:b.override),globalLanguageValue:ht(((k=l.user)==null?void 0:k.override)??((D=l.application)==null?void 0:D.override)),workspaceLanguageValue:ht((C=l.workspace)==null?void 0:C.override),workspaceFolderLanguageValue:ht((R=l.workspaceFolder)==null?void 0:R.override),languageIds:ht(l.overrideIdentifiers)}}};return typeof s=="object"&&cs(a,s,!1),Object.freeze(a)}_toReadonlyValue(e){const t=i=>Ft(i)?new Proxy(i,{get:(n,s)=>t(n[s]),set:(n,s,o)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(s)}' of object`)},deleteProperty:(n,s)=>{throw new Error(`TypeError: Cannot delete read only property '${String(s)}' of object`)},defineProperty:(n,s)=>{throw new Error(`TypeError: Cannot define property '${String(s)}' for a readonly object`)},setPrototypeOf:n=>{throw new Error("TypeError: Cannot set prototype for a readonly object")},isExtensible:()=>!1,preventExtensions:()=>!0}):i;return t(e)}_validateConfigurationAccess(e,t,i){const n=on.test(e)?4:this._configurationScopes.get(e),s=i?`[${i.value}] `:"";if(n===4){typeof(t==null?void 0:t.resource)>"u"&&this._logService.warn(`${s}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`);return}if(n===3){t!=null&&t.resource&&this._logService.warn(`${s}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`);return}}_toConfigurationChangeEvent(e,t){const i=new F4(e,t,this._configuration,this._extHostWorkspace.workspace);return Object.freeze({affectsConfiguration:(n,s)=>i.affectsConfiguration(n,Nx(s))})}_toMap(e){return e.reduce((t,i)=>(t.set(i[0],i[1]),t),new Map)}}const Rn=ne("IExtHostConfiguration");class V4{constructor(e,t){this.versionId=e,this.removedDueToLooping=t}}class Rs{static isHostExtension(e,t,i){if(t.getExtensionDescription(e))return!1;const n=i.getExtensionDescription(e);return n?!!((n.main||n.browser)&&n.api==="none"):!1}constructor(e,t){this._activationEventsReader=e,this._onDidChange=new T,this.onDidChange=this._onDidChange.event,this._versionId=0,this._extensionDescriptions=t,this._initialize()}_initialize(){this._extensionDescriptions.sort(j4),this._extensionsMap=new fr,this._extensionsArr=[],this._activationMap=new Map;for(const e of this._extensionDescriptions){if(this._extensionsMap.has(e.identifier)){console.error("Extension `"+e.identifier.value+"` is already registered");continue}this._extensionsMap.set(e.identifier,e),this._extensionsArr.push(e);const t=this._activationEventsReader.readActivationEvents(e);for(const i of t)this._activationMap.has(i)||this._activationMap.set(i,[]),this._activationMap.get(i).push(e)}}set(e){return this._extensionDescriptions=e,this._initialize(),this._versionId++,this._onDidChange.fire(void 0),{versionId:this._versionId}}deltaExtensions(e,t){this._extensionDescriptions=Fx(this._extensionDescriptions,t),this._extensionDescriptions=this._extensionDescriptions.concat(e);const i=Rs._findLoopingExtensions(this._extensionDescriptions);return this._extensionDescriptions=Fx(this._extensionDescriptions,i.map(n=>n.identifier)),this._initialize(),this._versionId++,this._onDidChange.fire(void 0),new V4(this._versionId,i)}static _findLoopingExtensions(e){const t=new class{constructor(){this._arcs=new Map,this._nodesSet=new Set,this._nodesArr=[]}addNode(a){this._nodesSet.has(a)||(this._nodesSet.add(a),this._nodesArr.push(a))}addArc(a,c){this.addNode(a),this.addNode(c),this._arcs.has(a)?this._arcs.get(a).push(c):this._arcs.set(a,[c])}getArcs(a){return this._arcs.has(a)?this._arcs.get(a):[]}hasOnlyGoodArcs(a,c){const l=t.getArcs(a);for(let u=0;u<l.length;u++)if(!c.has(l[u]))return!1;return!0}getNodes(){return this._nodesArr}},i=new fr;for(const a of e)if(i.set(a.identifier,a),a.extensionDependencies)for(const c of a.extensionDependencies)t.addArc(Xe.toKey(a.identifier),Xe.toKey(c));const n=new Set;t.getNodes().filter(a=>t.getArcs(a).length===0).forEach(a=>n.add(a));const s=t.getNodes().filter(a=>!n.has(a));let o;do{o=!1;for(let a=0;a<s.length;a++){const c=s[a];t.hasOnlyGoodArcs(c,n)&&(s.splice(a,1),a--,n.add(c),o=!0)}}while(o);return s.map(a=>i.get(a))}containsActivationEvent(e){return this._activationMap.has(e)}containsExtension(e){return this._extensionsMap.has(e)}getExtensionDescriptionsForActivationEvent(e){const t=this._activationMap.get(e);return t?t.slice(0):[]}getAllExtensionDescriptions(){return this._extensionsArr.slice(0)}getSnapshot(){return new z4(this._versionId,this.getAllExtensionDescriptions())}getExtensionDescription(e){const t=this._extensionsMap.get(e);return t||void 0}getExtensionDescriptionByUUID(e){for(const t of this._extensionsArr)if(t.uuid===e)return t}getExtensionDescriptionByIdOrUUID(e,t){return this.getExtensionDescription(e)??(t?this.getExtensionDescriptionByUUID(t):void 0)}}class z4{constructor(e,t){this.versionId=e,this.extensions=t}}function j4(r,e){const t=r.isBuiltin?0:r.isUnderDevelopment?2:1,i=e.isBuiltin?0:e.isUnderDevelopment?2:1;if(t!==i)return t-i;const n=Me.basename(r.extensionLocation.path),s=Me.basename(e.extensionLocation.path);return n<s?-1:n>s?1:0}function Fx(r,e){const t=new $o(e);return r.filter(i=>!t.has(i.identifier))}const Uf=class Uf{constructor(e,t,i,n){this.startup=e,this.codeLoadingTime=t,this.activateCallTime=i,this.activateResolvedTime=n}};Uf.NONE=new Uf(!1,-1,-1,-1);let ga=Uf;class Mx{constructor(e){this._startup=e,this._codeLoadingStart=-1,this._codeLoadingStop=-1,this._activateCallStart=-1,this._activateCallStop=-1,this._activateResolveStart=-1,this._activateResolveStop=-1}_delta(e,t){return e===-1||t===-1?-1:t-e}build(){return new ga(this._startup,this._delta(this._codeLoadingStart,this._codeLoadingStop),this._delta(this._activateCallStart,this._activateCallStop),this._delta(this._activateResolveStart,this._activateResolveStop))}codeLoadingStart(){this._codeLoadingStart=Date.now()}codeLoadingStop(){this._codeLoadingStop=Date.now()}activateCallStart(){this._activateCallStart=Date.now()}activateCallStop(){this._activateCallStop=Date.now()}activateResolveStart(){this._activateResolveStart=Date.now()}activateResolveStop(){this._activateResolveStop=Date.now()}}class Kh{constructor(e,t,i,n,s,o){this.activationFailed=e,this.activationFailedError=t,this.activationTimes=i,this.module=n,this.exports=s,this.subscriptions=o}}class q4 extends Kh{constructor(e){super(!1,null,e,{activate:void 0,deactivate:void 0},void 0,[])}}class G4 extends Kh{constructor(){super(!1,null,ga.NONE,{activate:void 0,deactivate:void 0},void 0,[])}}class Xh extends Kh{constructor(e){super(!0,e,ga.NONE,{activate:void 0,deactivate:void 0},void 0,[])}}let gv=class{constructor(e,t,i,n){this._logService=n,this._registry=e,this._globalRegistry=t,this._host=i,this._operations=new fr,this._alreadyActivatedEvents=Object.create(null)}dispose(){for(const[e,t]of this._operations)t.dispose()}async waitForActivatingExtensions(){const e=[];for(const[t,i]of this._operations)e.push(i.wait());await Promise.all(e)}isActivated(e){const t=this._operations.get(e);return!!(t&&t.value)}getActivatedExtension(e){const t=this._operations.get(e);if(!t||!t.value)throw new Error(`Extension '${e.value}' is not known or not activated`);return t.value}async activateByEvent(e,t){if(this._alreadyActivatedEvents[e])return;const i=this._registry.getExtensionDescriptionsForActivationEvent(e);await this._activateExtensions(i.map(n=>({id:n.identifier,reason:{startup:t,extensionId:n.identifier,activationEvent:e}}))),this._alreadyActivatedEvents[e]=!0}activateById(e,t){const i=this._registry.getExtensionDescription(e);if(!i)throw new Error(`Extension '${e}' is not known`);return this._activateExtensions([{id:i.identifier,reason:t}])}async _activateExtensions(e){const t=e.filter(i=>!this.isActivated(i.id)).map(i=>this._handleActivationRequest(i));await Promise.all(t.map(i=>i.wait()))}_handleActivationRequest(e){if(this._operations.has(e.id))return this._operations.get(e.id);if(this._isHostExtension(e.id))return this._createAndSaveOperation(e,null,[],null);const t=this._registry.getExtensionDescription(e.id);if(!t){const s=new Error(`Cannot activate unknown extension '${e.id.value}'`),o=this._createAndSaveOperation(e,null,[],new Xh(s));return this._host.onExtensionActivationError(e.id,s,new tx(e.id.value)),o}const i=[],n=typeof t.extensionDependencies>"u"?[]:t.extensionDependencies;for(const s of n){if(this._isResolvedExtension(s))continue;const o=this._operations.get(s);if(o){i.push(o);continue}if(this._isHostExtension(s)){i.push(this._handleActivationRequest({id:this._globalRegistry.getExtensionDescription(s).identifier,reason:e.reason}));continue}const a=this._registry.getExtensionDescription(s);if(a){if(!a.main&&!a.browser)continue;i.push(this._handleActivationRequest({id:a.identifier,reason:e.reason}));continue}const c=t.displayName||t.identifier.value,l=new Error(`Cannot activate the '${c}' extension because it depends on unknown extension '${s}'`),u=this._createAndSaveOperation(e,t.displayName,[],new Xh(l));return this._host.onExtensionActivationError(t.identifier,l,new tx(s)),u}return this._createAndSaveOperation(e,t.displayName,i,null)}_createAndSaveOperation(e,t,i,n){const s=new mv(e.id,t,e.reason,i,n,this._host,this._logService);return this._operations.set(e.id,s),s}_isHostExtension(e){return Rs.isHostExtension(e,this._registry,this._globalRegistry)}_isResolvedExtension(e){const t=this._globalRegistry.getExtensionDescription(e);return t?!t.main&&!t.browser:!1}};gv=H([N(3,Ge)],gv);let mv=class{get value(){return this._value}get friendlyName(){return this._displayName||this._id.value}constructor(e,t,i,n,s,o,a){this._id=e,this._displayName=t,this._reason=i,this._deps=n,this._value=s,this._host=o,this._logService=a,this._barrier=new wn,this._isDisposed=!1,this._initialize()}dispose(){this._isDisposed=!0}wait(){return this._barrier.wait()}async _initialize(){await this._waitForDepsThenActivate(),this._barrier.open()}async _waitForDepsThenActivate(){if(!this._value){for(;this._deps.length>0;){for(let e=0;e<this._deps.length;e++){const t=this._deps[e];if(t.value&&!t.value.activationFailed){this._deps.splice(e,1),e--;continue}if(t.value&&t.value.activationFailed){const i=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${t.friendlyName}' failed to activate`);i.detail=t.value.activationFailedError,this._value=new Xh(i),this._host.onExtensionActivationError(this._id,i,null);return}}this._deps.length>0&&await Promise.race(this._deps.map(e=>e.wait()))}await this._activate()}}async _activate(){try{this._value=await this._host.actualActivateExtension(this._id,this._reason)}catch(e){const t=new Error;if(e&&e.name&&(t.name=e.name),e&&e.message?t.message=`Activating extension '${this._id.value}' failed: ${e.message}.`:t.message=`Activating extension '${this._id.value}' failed: ${e}.`,e&&e.stack&&(t.stack=e.stack),this._value=new Xh(t),this._isDisposed&&qr(e))return;this._host.onExtensionActivationError(this._id,t,null),this._logService.error(`Activating extension ${this._id.value} failed due to an error:`),this._logService.error(e)}}};mv=H([N(6,Ge)],mv);class Hx{constructor(e,t){this._logService=t,this._onDidChangeStorage=new T,this.onDidChangeStorage=this._onDidChangeStorage.event,this._proxy=e.getProxy(G.MainThreadStorage)}registerExtensionStorageKeysToSync(e,t){this._proxy.$registerExtensionStorageKeysToSync(e,t)}async initializeExtensionStorage(e,t,i){const n=await this._proxy.$initializeExtensionStorage(e,t);let s;return n&&(s=this.safeParseValue(e,t,n)),s||i}setValue(e,t,i){return this._proxy.$setValue(e,t,i)}$acceptValue(e,t,i){const n=this.safeParseValue(e,t,i);n&&this._onDidChangeStorage.fire({shared:e,key:t,value:n})}safeParseValue(e,t,i){try{return JSON.parse(i)}catch(n){this._logService.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${t}, global: ${e}): ${n}`)}}}const vv=ne("IExtHostStorage");class Ux{constructor(e,t,i){this._deferredPromises=new Map,this._id=e,this._shared=t,this._storage=i,this._init=this._storage.initializeExtensionStorage(this._shared,this._id,Object.create(null)).then(n=>(this._value=n,this)),this._storageListener=this._storage.onDidChangeStorage(n=>{n.shared===this._shared&&n.key===this._id&&(this._value=n.value)}),this._scheduler=new _c(()=>{const n=this._deferredPromises;this._deferredPromises=new Map,(async()=>{try{await this._storage.setValue(this._shared,this._id,this._value);for(const s of n.values())s.complete()}catch(s){for(const o of n.values())o.error(s)}})()},0)}keys(){return Object.entries(this._value??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this._init}get(e,t){let i=this._value[e];return typeof i>"u"&&(i=t),i}update(e,t){this._value[e]=t;const i=this._deferredPromises.get(e);if(i!==void 0)return i.p;const n=new Co;return this._deferredPromises.set(e,n),this._scheduler.isScheduled()||this._scheduler.schedule(),n.p}dispose(){this._storageListener.dispose()}}class Q4 extends Ux{setKeysForSync(e){this._storage.registerExtensionStorageKeysToSync({id:this._id,version:this._extension.version},e)}constructor(e,t){super(e.identifier.value,!0,t),this._extension=e}}var an;let _v=an=class{constructor(e,t){this._fileSystemProvider=new Map,this._writeQueue=new XE,this._proxy=e.getProxy(G.MainThreadFileSystem);const i=this;this.value=Object.freeze({async stat(n){try{let s;const o=i._fileSystemProvider.get(n.scheme);return o?(await i._proxy.$ensureActivation(n.scheme),s=await o.impl.stat(n)):s=await i._proxy.$stat(n),{type:s.type,ctime:s.ctime,mtime:s.mtime,size:s.size,permissions:s.permissions===Ro.Readonly?1:void 0}}catch(s){an._handleError(s)}},async readDirectory(n){try{const s=i._fileSystemProvider.get(n.scheme);return s?(await i._proxy.$ensureActivation(n.scheme),(await s.impl.readDirectory(n)).slice()):await i._proxy.$readdir(n)}catch(s){return an._handleError(s)}},async createDirectory(n){try{const s=i._fileSystemProvider.get(n.scheme);return s&&!s.isReadonly?(await i._proxy.$ensureActivation(n.scheme),await i.mkdirp(s.impl,s.extUri,n)):await i._proxy.$mkdir(n)}catch(s){return an._handleError(s)}},async readFile(n){try{const s=i._fileSystemProvider.get(n.scheme);return s?(await i._proxy.$ensureActivation(n.scheme),(await s.impl.readFile(n)).slice()):(await i._proxy.$readFile(n)).buffer}catch(s){return an._handleError(s)}},async writeFile(n,s){try{const o=i._fileSystemProvider.get(n.scheme);return o&&!o.isReadonly?(await i._proxy.$ensureActivation(n.scheme),await i.mkdirp(o.impl,o.extUri,o.extUri.dirname(n)),await i._writeQueue.queueFor(n,()=>Promise.resolve(o.impl.writeFile(n,s,{create:!0,overwrite:!0})))):await i._proxy.$writeFile(n,me.wrap(s))}catch(o){return an._handleError(o)}},async delete(n,s){try{const o=i._fileSystemProvider.get(n.scheme);return o&&!o.isReadonly&&!(s!=null&&s.useTrash)?(await i._proxy.$ensureActivation(n.scheme),await o.impl.delete(n,{recursive:!1,...s})):await i._proxy.$delete(n,{recursive:!1,useTrash:!1,atomic:!1,...s})}catch(o){return an._handleError(o)}},async rename(n,s,o){try{return await i._proxy.$rename(n,s,{overwrite:!1,...o})}catch(a){return an._handleError(a)}},async copy(n,s,o){try{return await i._proxy.$copy(n,s,{overwrite:!1,...o})}catch(a){return an._handleError(a)}},isWritableFileSystem(n){const s=t.getCapabilities(n);if(typeof s=="number")return!(s&2048)}})}async mkdirp(e,t,i){const n=[];for(;!t.isEqual(i,t.dirname(i));)try{if(!((await e.stat(i)).type&hs.Directory))throw wt.FileExists(`Unable to create folder '${i.scheme===Z.file?i.fsPath:i.toString(!0)}' that already exists but is not a directory`);break}catch(s){if(wg(s)!==Ce.FileNotFound)throw s;n.push(t.basename(i)),i=t.dirname(i)}for(let s=n.length-1;s>=0;s--){i=t.joinPath(i,n[s]);try{await e.createDirectory(i)}catch(o){if(wg(o)!==Ce.FileExists)throw o}}}static _handleError(e){if(e instanceof wt)throw e;if(e instanceof bd)switch(e.code){case Ce.FileExists:throw wt.FileExists(e.message);case Ce.FileNotFound:throw wt.FileNotFound(e.message);case Ce.FileNotADirectory:throw wt.FileNotADirectory(e.message);case Ce.FileIsADirectory:throw wt.FileIsADirectory(e.message);case Ce.NoPermissions:throw wt.NoPermissions(e.message);case Ce.Unavailable:throw wt.Unavailable(e.message);default:throw new wt(e.message,e.name)}if(!(e instanceof Error))throw new wt(String(e));if(e.name==="ENOPRO"||e.message.includes("ENOPRO"))throw wt.Unavailable(e.message);switch(e.name){case Ce.FileExists:throw wt.FileExists(e.message);case Ce.FileNotFound:throw wt.FileNotFound(e.message);case Ce.FileNotADirectory:throw wt.FileNotADirectory(e.message);case Ce.FileIsADirectory:throw wt.FileIsADirectory(e.message);case Ce.NoPermissions:throw wt.NoPermissions(e.message);case Ce.Unavailable:throw wt.Unavailable(e.message);default:throw new wt(e.message,e.name)}}addFileSystemProvider(e,t,i){return this._fileSystemProvider.set(e,{impl:t,extUri:i!=null&&i.isCaseSensitive?Fe:VE,isReadonly:!!(i!=null&&i.isReadonly)}),Le(()=>this._fileSystemProvider.delete(e))}getFileSystemProviderExtUri(e){var t;return((t=this._fileSystemProvider.get(e))==null?void 0:t.extUri)??Fe}};_v=an=H([N(0,Ve),N(1,ko)],_v);const Yh=ne("IExtHostConsumerFileSystem"),wv=ne("IExtensionStoragePaths");let bv=class{constructor(e,t,i){this._logService=t,this._extHostFileSystem=i,this._workspace=e.workspace??void 0,this._environment=e.environment,this.whenReady=this._getOrCreateWorkspaceStoragePath().then(n=>this._value=n)}async _getWorkspaceStorageURI(e){return y.joinPath(this._environment.workspaceStorageHome,e)}async _getOrCreateWorkspaceStoragePath(){var i;if(!this._workspace)return Promise.resolve(void 0);const e=this._workspace.id,t=await this._getWorkspaceStorageURI(e);try{return await this._extHostFileSystem.value.stat(t),this._logService.trace("[ExtHostStorage] storage dir already exists",t),t}catch{}try{return this._logService.trace("[ExtHostStorage] creating dir and metadata-file",t),await this._extHostFileSystem.value.createDirectory(t),await this._extHostFileSystem.value.writeFile(y.joinPath(t,"meta.json"),new TextEncoder().encode(JSON.stringify({id:this._workspace.id,configuration:(i=y.revive(this._workspace.configuration))==null?void 0:i.toString(),name:this._workspace.name},void 0,2))),t}catch(n){this._logService.error("[ExtHostStorage]",n);return}}workspaceValue(e){if(this._value)return y.joinPath(this._value,e.identifier.value)}globalValue(e){return y.joinPath(this._environment.globalStorageHome,e.identifier.value.toLowerCase())}onWillDeactivateAll(){}};bv=H([N(0,Ut),N(1,Ge),N(2,Yh)],bv),ne("tunnelService");var Bx;(function(r){r.Http="http",r.Https="https"})(Bx||(Bx={}));var Ls;(function(r){r.ConstantPrivate="constantPrivate",r.Private="private",r.Public="public"})(Ls||(Ls={}));var Wx;(function(r){r[r.Notify=1]="Notify",r[r.OpenBrowser=2]="OpenBrowser",r[r.OpenPreview=3]="OpenPreview",r[r.Silent=4]="Silent",r[r.Ignore=5]="Ignore",r[r.OpenBrowserOnce=6]="OpenBrowserOnce"})(Wx||(Wx={}));function J4(r){if(r.scheme!=="http"&&r.scheme!=="https")return;const e=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(r.authority);if(e)return{address:e[1],port:+e[2]}}const yv=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function Vx(r){return yv.indexOf(r)>=0}const xv=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function zx(r){return xv.indexOf(r)>=0}class K4{constructor(e,t,i){this.remoteAddress=e,this.localAddress=t,this._dispose=i,this._onDispose=new T,this.onDidDispose=this._onDispose.event}dispose(){return this._onDispose.fire(),this._dispose()}}let jx=class{constructor(e,t){this.logService=e,this.configurationService=t,this._onTunnelOpened=new T,this.onTunnelOpened=this._onTunnelOpened.event,this._onTunnelClosed=new T,this.onTunnelClosed=this._onTunnelClosed.event,this._onAddedTunnelProvider=new T,this.onAddedTunnelProvider=this._onAddedTunnelProvider.event,this._tunnels=new Map,this._canElevate=!1,this._canChangeProtocol=!0,this._privacyOptions=[],this._factoryInProgress=new Set}get hasTunnelProvider(){return!!this._tunnelProvider}get defaultTunnelHost(){const e=this.configurationService.getValue("remote.localPortHost");return!e||e==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(e){return this._tunnelProvider=e,e?(this._onAddedTunnelProvider.fire(),{dispose:()=>{this._tunnelProvider=void 0,this._canElevate=!1,this._privacyOptions=[]}}):(this._canElevate=!1,this._privacyOptions=[],this._onAddedTunnelProvider.fire(),{dispose:()=>{}})}setTunnelFeatures(e){this._canElevate=e.elevation,this._privacyOptions=e.privacyOptions,this._canChangeProtocol=e.protocol}get canChangeProtocol(){return this._canChangeProtocol}get canElevate(){return this._canElevate}get canChangePrivacy(){return this._privacyOptions.length>0}get privacyOptions(){return this._privacyOptions}get tunnels(){return this.getTunnels()}async getTunnels(){const e=[],t=Array.from(this._tunnels.values());for(const i of t){const n=Array.from(i.values());for(const s of n){const o=await s.value;o&&typeof o!="string"&&e.push(o)}}return e}async dispose(){for(const e of this._tunnels.values()){for(const{value:t}of e.values())await t.then(i=>typeof i!="string"?i==null?void 0:i.dispose():void 0);e.clear()}this._tunnels.clear()}setEnvironmentTunnel(e,t,i,n,s){this.addTunnelToMap(e,t,Promise.resolve({tunnelRemoteHost:e,tunnelRemotePort:t,localAddress:i,privacy:n,protocol:s,dispose:()=>Promise.resolve()}))}async getExistingTunnel(e,t){(zx(e)||Vx(e))&&(e=yv[0]);const i=this.getTunnelFromMap(e,t);if(i)return++i.refcount,i.value}openTunnel(e,t,i,n,s,o=!1,a,c){this.logService.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${t}:${i} on local port ${s}.`);const l=this._tunnelProvider??e;if(!l)return;if(t||(t="localhost"),n||(n=this.defaultTunnelHost),this._tunnelProvider&&this._factoryInProgress.has(i)){this.logService.debug("ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.");return}const u=this.retainOrCreateTunnel(l,t,i,n,s,o,a,c);return u?u.then(d=>{if(d){if(typeof d=="string")return this.logService.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel."),this.removeEmptyOrErrorTunnelFromMap(t,i),d}else{this.logService.trace("ForwardedPorts: (TunnelService) New tunnel is undefined."),this.removeEmptyOrErrorTunnelFromMap(t,i);return}this.logService.trace("ForwardedPorts: (TunnelService) New tunnel established.");const h=this.makeTunnel(d);return(d.tunnelRemoteHost!==t||d.tunnelRemotePort!==i)&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch."),a&&d.privacy!==a&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch."),this._onTunnelOpened.fire(h),h}):(this.logService.trace("ForwardedPorts: (TunnelService) Tunnel was not created."),u)}makeTunnel(e){return{tunnelRemotePort:e.tunnelRemotePort,tunnelRemoteHost:e.tunnelRemoteHost,tunnelLocalPort:e.tunnelLocalPort,localAddress:e.localAddress,privacy:e.privacy,protocol:e.protocol,dispose:async()=>{this.logService.trace(`ForwardedPorts: (TunnelService) dispose request for ${e.tunnelRemoteHost}:${e.tunnelRemotePort} `);const t=this._tunnels.get(e.tunnelRemoteHost);if(t){const i=t.get(e.tunnelRemotePort);i&&(i.refcount--,await this.tryDisposeTunnel(e.tunnelRemoteHost,e.tunnelRemotePort,i))}}}}async tryDisposeTunnel(e,t,i){if(i.refcount<=0){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${e}:${t}.`);const n=i.value.then(async s=>{s&&typeof s!="string"&&(await s.dispose(!0),this._onTunnelClosed.fire({host:s.tunnelRemoteHost,port:s.tunnelRemotePort}))});return this._tunnels.has(e)&&this._tunnels.get(e).delete(t),n}}async closeTunnel(e,t){this.logService.trace(`ForwardedPorts: (TunnelService) close request for ${e}:${t} `);const i=this._tunnels.get(e);if(i&&i.has(t)){const n=i.get(t);n.refcount=0,await this.tryDisposeTunnel(e,t,n)}}addTunnelToMap(e,t,i){this._tunnels.has(e)||this._tunnels.set(e,new Map),this._tunnels.get(e).set(t,{refcount:1,value:i})}async removeEmptyOrErrorTunnelFromMap(e,t){const i=this._tunnels.get(e);if(i){const n=i.get(t),s=n?await n.value:void 0;(!s||typeof s=="string")&&i.delete(t),i.size===0&&this._tunnels.delete(e)}}getTunnelFromMap(e,t){const i=[e];Vx(e)?(i.push(...yv),i.push(...xv)):zx(e)&&i.push(...xv);const n=i.map(s=>this._tunnels.get(s));for(const s of n){const o=s==null?void 0:s.get(t);if(o)return o}}canTunnel(e){return!!J4(e)}createWithProvider(e,t,i,n,s,o,a){this.logService.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${t}:${i} on local port ${n}.`);const c=i;this._factoryInProgress.add(c);const l=n===void 0?i:n,u={elevationRequired:s?this.isPortPrivileged(l):!1},d={remoteAddress:{host:t,port:i},localAddressPort:n,privacy:o,public:o?o!==Ls.Private:void 0,protocol:a},h=e.forwardPort(d,u);return h?(this.addTunnelToMap(t,i,h),h.finally(()=>{this.logService.trace("ForwardedPorts: (TunnelService) Tunnel created by provider."),this._factoryInProgress.delete(c)})):this._factoryInProgress.delete(c),h}};jx=H([N(0,Ge),N(1,uv)],jx);class X4 extends K4{}var Cv;(function(r){function e(i){return{remoteAddress:i.remoteAddress,localAddress:i.localAddress,public:!!i.public,privacy:i.privacy??(i.public?Ls.Public:Ls.Private),protocol:i.protocol}}r.fromApiTunnel=e;function t(i){return{remoteAddress:{host:i.tunnelRemoteHost,port:i.tunnelRemotePort},localAddress:i.localAddress,public:i.privacy!==Ls.ConstantPrivate&&i.privacy!==Ls.ConstantPrivate,privacy:i.privacy,protocol:i.protocol}}r.fromServiceTunnel=t})(Cv||(Cv={}));const Sv=ne("IExtHostTunnelService");let Ev=class extends Be{constructor(e,t,i){super(),this.logService=i,this._showCandidatePort=()=>Promise.resolve(!0),this._extensionTunnels=new Map,this._onDidChangeTunnels=new T,this.onDidChangeTunnels=this._onDidChangeTunnels.event,this._providerHandleCounter=0,this._portAttributesProviders=new Map,this._proxy=e.getProxy(G.MainThreadTunnelService)}async openTunnel(e,t){this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) ${e.identifier.value} called openTunnel API for ${t.remoteAddress.host}:${t.remoteAddress.port}.`);const i=await this._proxy.$openTunnel(t,e.displayName);if(i){const n=new X4(i.remoteAddress,i.localAddress,()=>this._proxy.$closeTunnel(i.remoteAddress));return this._register(n),n}}async getTunnels(){return this._proxy.$getTunnels()}nextPortAttributesProviderHandle(){return this._providerHandleCounter++}registerPortsAttributesProvider(e,t){const i=this.nextPortAttributesProviderHandle();return this._portAttributesProviders.set(i,{selector:e,provider:t}),this._proxy.$registerPortsAttributesProvider(e,i),new Pe(()=>{this._portAttributesProviders.delete(i),this._proxy.$unregisterPortsAttributesProvider(i)})}async $providePortAttributes(e,t,i,n,s){const o=[];for(const c of e){const l=this._portAttributesProviders.get(c);if(!l)return[];o.push(...await Promise.all(t.map(async u=>{let d;try{d=await l.provider.providePortAttributes({port:u,pid:i,commandLine:n},s)}catch{d=await l.provider.providePortAttributes(u,i,n,s)}return{providedAttributes:d,port:u}})))}const a=o.filter(c=>!!c.providedAttributes);return a.length>0?a.map(c=>({autoForwardAction:c.providedAttributes.autoForwardAction,port:c.port})):[]}async $registerCandidateFinder(e){}registerTunnelProvider(e,t){var n,s;if(this._forwardPortProvider)throw new Error("A tunnel provider has already been registered. Only the first tunnel provider to be registered will be used.");this._forwardPortProvider=async(o,a)=>await e.provideTunnel(o,a,new mt().token)??void 0;const i=t.tunnelFeatures?{elevation:!!((n=t.tunnelFeatures)!=null&&n.elevation),privacyOptions:(s=t.tunnelFeatures)==null?void 0:s.privacyOptions,protocol:t.tunnelFeatures.protocol===void 0?!0:t.tunnelFeatures.protocol}:void 0;return this._proxy.$setTunnelProvider(i),Promise.resolve(Le(()=>{this._forwardPortProvider=void 0,this._proxy.$setTunnelProvider(void 0)}))}async setTunnelFactory(e,t){var i,n,s,o;if(e){e.candidatePortSource!==void 0&&this._proxy.$setCandidatePortSource(e.candidatePortSource),e.showCandidatePort&&(this._showCandidatePort=e.showCandidatePort,this._proxy.$setCandidateFilter());const a=e.tunnelFactory??(t?this.makeManagedTunnelFactory(t):void 0);if(a){this._forwardPortProvider=a;let c=((i=e.tunnelFeatures)==null?void 0:i.privacyOptions)??[];(n=e.tunnelFeatures)!=null&&n.public&&c.length===0&&(c=[{id:"private",label:m("vs/workbench/api/common/extHostTunnelService","tunnelPrivacy.private","Private"),themeIcon:"lock"},{id:"public",label:m("vs/workbench/api/common/extHostTunnelService","tunnelPrivacy.public","Public"),themeIcon:"eye"}]);const l=e.tunnelFeatures?{elevation:!!((s=e.tunnelFeatures)!=null&&s.elevation),public:!!((o=e.tunnelFeatures)!=null&&o.public),privacyOptions:c,protocol:!0}:void 0;this._proxy.$setTunnelProvider(l)}}else this._forwardPortProvider=void 0;return Le(()=>{this._forwardPortProvider=void 0})}makeManagedTunnelFactory(e){}async $closeTunnel(e,t){if(this._extensionTunnels.has(e.host)){const i=this._extensionTunnels.get(e.host);i.has(e.port)&&(t&&i.get(e.port).disposeListener.dispose(),await i.get(e.port).tunnel.dispose(),i.delete(e.port))}}async $onDidTunnelsChange(){this._onDidChangeTunnels.fire()}async $forwardPort(e,t){if(this._forwardPortProvider)try{this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Getting tunnel from provider.");const i=this._forwardPortProvider(e,t);if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Got tunnel promise from provider."),i!==void 0){const n=await i;if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Successfully awaited tunnel from provider."),n===void 0){this.logService.error("ForwardedPorts: (ExtHostTunnelService) Resolved tunnel is undefined");return}this._extensionTunnels.has(e.remoteAddress.host)||this._extensionTunnels.set(e.remoteAddress.host,new Map);const s=this._register(n.onDidDispose(()=>(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Extension fired tunnel's onDidDispose."),this._proxy.$closeTunnel(n.remoteAddress))));return this._extensionTunnels.get(e.remoteAddress.host).set(e.remoteAddress.port,{tunnel:n,disposeListener:s}),Cv.fromApiTunnel(n)}else this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Tunnel is undefined")}catch(i){if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) tunnel provider error"),i instanceof Error)return i.message}}async $applyCandidateFilter(e){const t=await Promise.all(e.map(n=>this._showCandidatePort(n.host,n.port,n.detail??""))),i=e.filter((n,s)=>t[s]);return this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) filtered from ${e.map(n=>n.port).join(", ")} to ${i.map(n=>n.port).join(", ")}`),i}};Ev=H([N(0,Ve),N(1,Ut),N(2,Ge)],Ev);function Y4(r){return[...r.entries()]}function Z4(r){return r?[...r.entries()]:[]}class eI{constructor(e){this._callback=e,this._terminalBufferMap=new Map}dispose(){for(const e of this._terminalBufferMap.values())e.dispose()}startBuffering(e,t,i=5){const n=t(s=>{const o=typeof s=="string"?s:s.data;let a=this._terminalBufferMap.get(e);if(a){a.data.push(o);return}const c=setTimeout(()=>this.flushBuffer(e),i);a={data:[o],timeoutId:c,dispose:()=>{clearTimeout(c),this.flushBuffer(e),n.dispose()}},this._terminalBufferMap.set(e,a)});return n}stopBuffering(e){const t=this._terminalBufferMap.get(e);t==null||t.dispose()}flushBuffer(e){const t=this._terminalBufferMap.get(e);t&&(this._terminalBufferMap.delete(e),this._callback(e,t.data.join("")))}}const Os=(r,e,t,i)=>{let n=e;return{enumerable:!0,configurable:!1,get(){return n},set(s){var o;if(!t(n,s)){const a=n;n=s,(o=r.listener)==null||o.call(r,i(s,a))}}}},ma=(r,e)=>r===e,Dr={range:(r,e)=>r===e?!0:!r||!e?!1:r.isEqual(e),label:ma,description:ma,sortText:ma,busy:ma,error:ma,canResolveChildren:ma,tags:(r,e)=>!(r.length!==e.length||r.some(t=>!e.find(i=>t.id===i.id)))},va=r=>e=>({op:4,update:r(e)}),tI=(r,e)=>({range:(()=>{let t;const i=va(n=>({range:ze.lift(F.from(n))}));return{enumerable:!0,configurable:!1,get(){return t},set(n){var s,o;(s=r.listener)==null||s.call(r,{op:6}),Dr.range(t,n)||(t=n,(o=r.listener)==null||o.call(r,i(n)))}}})(),label:Os(r,e,Dr.label,va(t=>({label:t}))),description:Os(r,void 0,Dr.description,va(t=>({description:t}))),sortText:Os(r,void 0,Dr.sortText,va(t=>({sortText:t}))),canResolveChildren:Os(r,!1,Dr.canResolveChildren,t=>({op:2,state:t})),busy:Os(r,!1,Dr.busy,va(t=>({busy:t}))),error:Os(r,void 0,Dr.error,va(t=>({error:Te.fromStrict(t)||null}))),tags:Os(r,[],Dr.tags,(t,i)=>({op:1,new:t.map(Ui.from),old:i.map(Ui.from)}))}),iI=r=>{const e=we.fromString(r.extId),t=new $s(e.controllerId,e.localId,r.label,y.revive(r.uri)||void 0);return t.range=F.to(r.range||void 0),t.description=r.description||void 0,t.sortText=r.sortText||void 0,t.tags=r.tags.map(i=>Ui.to({id:p1(i).tagId})),t},nI=r=>{let e;for(const t of r.tests){const i=iI(t.item);wd(i).parent=e,e=i}return e};class $s{constructor(e,t,i,n){if(t.includes("\0"))throw new Error(`Test IDs may not include the ${JSON.stringify(t)} symbol`);const s=tD(this,e);Object.defineProperties(this,{id:{value:t,enumerable:!0,writable:!1},uri:{value:n,enumerable:!0,writable:!1},parent:{enumerable:!1,get(){return s.parent instanceof kv?void 0:s.parent}},children:{value:eD(s,wd,$s),enumerable:!0,writable:!1},...tI(s,i)})}}class kv extends $s{constructor(e,t){super(e,e,t,void 0),this._isRoot=!0}}class rI extends X2{constructor(e,t,i){super({controllerId:e,getDocumentVersion:n=>{var s;return n&&((s=i.getDocument(n))==null?void 0:s.version)},getApiFor:wd,getChildren:n=>n.children,root:new kv(e,t),toITestItem:Sr.from})}}let Dv=class extends Be{constructor(e,t){super(),this.initData=e,this.loggerService=t,this._onDidChangeTelemetryEnabled=this._register(new T),this.onDidChangeTelemetryEnabled=this._onDidChangeTelemetryEnabled.event,this._onDidChangeTelemetryConfiguration=this._register(new T),this.onDidChangeTelemetryConfiguration=this._onDidChangeTelemetryConfiguration.event,this._productConfig={usage:!0,error:!0},this._level=0,this._telemetryIsSupported=!1,this._inLoggingOnlyMode=!1,this._telemetryLoggers=new Map,this.extHostTelemetryLogFile=y.revive(this.initData.environment.extensionTelemetryLogResource),this._inLoggingOnlyMode=this.initData.environment.isExtensionTelemetryLoggingOnly,this._outputLogger=t.createLogger(this.extHostTelemetryLogFile,{id:FD,name:m("vs/workbench/api/common/extHostTelemetry","extensionTelemetryLog","Extension Telemetry{0}",this._inLoggingOnlyMode?" (Not Sent)":""),hidden:!0}),this._register(this._outputLogger),this._register(t.onDidChangeLogLevel(i=>{Sk(i)&&this.updateLoggerVisibility()})),this._outputLogger.info("Below are logs for extension telemetry events sent to the telemetry output channel API once the log level is set to trace."),this._outputLogger.info("===========================================================")}updateLoggerVisibility(){this.loggerService.setVisibility(this.extHostTelemetryLogFile,this._telemetryIsSupported&&this.loggerService.getLogLevel()===Oe.Trace)}getTelemetryConfiguration(){return this._level===3}getTelemetryDetails(){return{isCrashEnabled:this._level>=1,isErrorsEnabled:this._productConfig.error?this._level>=2:!1,isUsageEnabled:this._productConfig.usage?this._level>=3:!1}}instantiateLogger(e,t,i){const n=this.getTelemetryDetails(),s=new qx(t,i,e,this._outputLogger,this._inLoggingOnlyMode,this.getBuiltInCommonProperties(e),{isUsageEnabled:n.isUsageEnabled,isErrorsEnabled:n.isErrorsEnabled}),o=this._telemetryLoggers.get(e.identifier.value)??[];return this._telemetryLoggers.set(e.identifier.value,[...o,s]),s.apiTelemetryLogger}$initializeTelemetryLevel(e,t,i){this._level=e,this._telemetryIsSupported=t,this._productConfig=i??{usage:!0,error:!0},this.updateLoggerVisibility()}getBuiltInCommonProperties(e){const t=Object.create(null);switch(t["common.extname"]=`${e.publisher}.${e.name}`,t["common.extversion"]=e.version,t["common.vscodemachineid"]=this.initData.telemetryInfo.machineId,t["common.vscodesessionid"]=this.initData.telemetryInfo.sessionId,t["common.sqmid"]=this.initData.telemetryInfo.sqmId,t["common.vscodeversion"]=this.initData.version,t["common.isnewappinstall"]=Gx(this.initData.telemetryInfo.firstSessionDate),t["common.product"]=this.initData.environment.appHost,this.initData.uiKind){case fc.Web:t["common.uikind"]="web";break;case fc.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}return t["common.remotename"]=kg(HD(this.initData.remote.authority)),t}$onDidChangeTelemetryLevel(e){this._oldTelemetryEnablement=this.getTelemetryConfiguration(),this._level=e;const t=this.getTelemetryDetails();this._telemetryLoggers.forEach((i,n)=>{const s=i.filter(o=>!o.isDisposed);s.length===0?this._telemetryLoggers.delete(n):this._telemetryLoggers.set(n,s)}),this._telemetryLoggers.forEach(i=>{for(const n of i)n.updateTelemetryEnablements(t.isUsageEnabled,t.isErrorsEnabled)}),this._oldTelemetryEnablement!==this.getTelemetryConfiguration()&&this._onDidChangeTelemetryEnabled.fire(this.getTelemetryConfiguration()),this._onDidChangeTelemetryConfiguration.fire(this.getTelemetryDetails()),this.updateLoggerVisibility()}onExtensionError(e,t){const i=this._telemetryLoggers.get(e.value),n=i==null?void 0:i.filter(o=>!o.isDisposed);if(!n)return this._telemetryLoggers.delete(e.value),!1;let s=!1;for(const o of n)o.ignoreUnhandledExtHostErrors||(o.logError(t),s=!0);return s}};Dv=H([N(0,Ut),N(1,So)],Dv);class qx{static validateSender(e){if(typeof e!="object")throw new TypeError("TelemetrySender argument is invalid");if(typeof e.sendEventData!="function")throw new TypeError("TelemetrySender.sendEventData must be a function");if(typeof e.sendErrorData!="function")throw new TypeError("TelemetrySender.sendErrorData must be a function");if(typeof e.flush<"u"&&typeof e.flush!="function")throw new TypeError("TelemetrySender.flush must be a function or undefined")}constructor(e,t,i,n,s,o,a){this._extension=i,this._logger=n,this._inLoggingOnlyMode=s,this._commonProperties=o,this._onDidChangeEnableStates=new T,this.ignoreUnhandledExtHostErrors=(t==null?void 0:t.ignoreUnhandledErrors)??!1,this._ignoreBuiltinCommonProperties=(t==null?void 0:t.ignoreBuiltInCommonProperties)??!1,this._additionalCommonProperties=t==null?void 0:t.additionalCommonProperties,this._sender=e,this._telemetryEnablements={isUsageEnabled:a.isUsageEnabled,isErrorsEnabled:a.isErrorsEnabled}}updateTelemetryEnablements(e,t){this._apiObject&&(this._telemetryEnablements={isUsageEnabled:e,isErrorsEnabled:t},this._onDidChangeEnableStates.fire(this._apiObject))}mixInCommonPropsAndCleanData(e){let t="properties"in e?e.properties??{}:e;return t=ex(t,[]),this._additionalCommonProperties&&(t=cs(t,this._additionalCommonProperties)),this._ignoreBuiltinCommonProperties||(t=cs(t,this._commonProperties)),"properties"in e?e.properties=t:e=t,e}logEvent(e,t){var i;this._sender&&(this._extension.publisher==="vscode"?e=this._extension.name+"/"+e:e=this._extension.identifier.value+"/"+e,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||(i=this._sender)==null||i.sendEventData(e,t),this._logger.trace(e,t))}logUsage(e,t){this._telemetryEnablements.isUsageEnabled&&this.logEvent(e,t)}logError(e,t){if(!(!this._telemetryEnablements.isErrorsEnabled||!this._sender))if(typeof e=="string")this.logEvent(e,t);else{const i={name:e.name,message:e.message,stack:e.stack,cause:e.cause},n=ex(i,[]),s=new Error(n.message,{cause:n.cause});s.stack=n.stack,s.name=n.name,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender.sendErrorData(s,t),this._logger.trace("exception",t)}}get apiTelemetryLogger(){if(!this._apiObject){const e=this,t={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e._telemetryEnablements.isUsageEnabled},get isErrorsEnabled(){return e._telemetryEnablements.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e._onDidChangeEnableStates.event.bind(e)};this._apiObject=Object.freeze(t)}return this._apiObject}get isDisposed(){return!this._sender}dispose(){var e;if((e=this._sender)!=null&&e.flush){let t=this._sender;this._sender=void 0,Promise.resolve(t.flush()).then(t=void 0),this._apiObject=void 0}else this._sender=void 0}}function Gx(r){const e=Date.now()-new Date(r).getTime();return isNaN(e)?!1:e<1e3*60*60*24}const Zh=ne("IExtHostTelemetry");let Iv=(X0=class{constructor(e,t,i){ae(this,qn,void 0);ae(this,ru,void 0);ae(this,su,void 0);this._commands=new Map,this._apiCommands=new Map,K(this,qn,e.getProxy(G.MainThreadCommands)),this._logService=t,K(this,su,i),K(this,ru,e.getProxy(G.MainThreadTelemetry)),this.converter=new sI(this,n=>{const s=this._apiCommands.get(n);return(s==null?void 0:s.result)===pe.Void?s:void 0},t),this._argumentProcessors=[{processArgument(n){return Yi(n)}},{processArgument(n){return ed(n,function(s){if(ze.isIRange(s))return F.to(s);if(ki.isIPosition(s))return We.to(s);if(ze.isIRange(s.range)&&y.isUri(s.uri))return _i.to(s);if(s instanceof me)return s.buffer.buffer;if(!Array.isArray(s))return s})}}]}registerArgumentProcessor(e){this._argumentProcessors.push(e)}registerApiCommand(e){const t=this.registerCommand(!1,e.id,async(...i)=>{const n=e.args.map((o,a)=>{if(!o.validate(i[a]))throw new Error(`Invalid argument '${o.name}' when running '${e.id}', received: ${typeof i[a]=="object"?JSON.stringify(i[a],null,"	"):i[a]} `);return o.convert(i[a])}),s=await this.executeCommand(e.internalId,...n);return e.result.convert(s,i,this.converter)},void 0,{description:e.description,args:e.args,returns:e.result.description});return this._apiCommands.set(e.id,e),new Pe(()=>{t.dispose(),this._apiCommands.delete(e.id)})}registerCommand(e,t,i,n,s,o){if(this._logService.trace("ExtHostCommands#registerCommand",t),!t.trim().length)throw new Error("invalid id");if(this._commands.has(t))throw new Error(`command '${t}' already exists`);return this._commands.set(t,{callback:i,thisArg:n,metadata:s,extension:o}),e&&I(this,qn).$registerCommand(t),new Pe(()=>{this._commands.delete(t)&&e&&I(this,qn).$unregisterCommand(t)})}executeCommand(e,...t){return this._logService.trace("ExtHostCommands#executeCommand",e),this._doExecuteCommand(e,t,!0)}async _doExecuteCommand(e,t,i){if(this._commands.has(e))return I(this,qn).$fireCommandActivationEvent(e),this._executeContributedCommand(e,t,!1);{let n=!1;const s=ed(t,function(o){if(o instanceof Se)return We.from(o);if(o instanceof be)return F.from(o);if(o instanceof vi)return _i.from(o);if(In.isNotebookRange(o))return sn.from(o);if(o instanceof ArrayBuffer)return n=!0,me.wrap(new Uint8Array(o));if(o instanceof Uint8Array)return n=!0,me.wrap(o);if(o instanceof me)return n=!0,o;if(!Array.isArray(o))return o});try{const o=await I(this,qn).$executeCommand(e,n?new Ji(s):s,i);return Yi(o)}catch(o){if(o instanceof Error&&o.message==="$executeCommand:retry")return this._doExecuteCommand(e,t,!1);throw o}}}async _executeContributedCommand(e,t,i){var l,u,d;const n=this._commands.get(e);if(!n)throw new Error("Unknown command");const{callback:s,thisArg:o,metadata:a}=n;if(a!=null&&a.args)for(let h=0;h<a.args.length;h++)try{TE(t[h],a.args[h].constraint)}catch{throw new Error(`Running the contributed command: '${e}' failed. Illegal argument '${a.args[h].name}' - ${a.args[h].description}`)}const c=vn.create();try{return await s.apply(o,t)}catch(h){if(e===this.converter.delegatingCommandId){const g=this.converter.getActualCommand(...t);g&&(e=g.command)}if(this._logService.error(h,e,(l=n.extension)==null?void 0:l.identifier),!i)throw h;if((u=n.extension)!=null&&u.identifier){const g=I(this,su).onExtensionError(n.extension.identifier,h);this._logService.trace("forwarded error to extension?",g,(d=n.extension)==null?void 0:d.identifier)}throw new class extends Error{constructor(){var w,p;super(ur(h)),this.id=e,this.source=((w=n.extension)==null?void 0:w.displayName)??((p=n.extension)==null?void 0:p.name)}}}finally{this._reportTelemetry(n,e,c.elapsed())}}_reportTelemetry(e,t,i){e.extension&&I(this,ru).$publicLog2("Extension:ActionExecuted",{extensionId:e.extension.identifier.value,id:new Dg(t),duration:i})}$executeContributedCommand(e,...t){this._logService.trace("ExtHostCommands#$executeContributedCommand",e);const i=this._commands.get(e);return i?(t=t.map(n=>this._argumentProcessors.reduce((s,o)=>{var a;return o.processArgument(s,(a=i.extension)==null?void 0:a.identifier)},n)),this._executeContributedCommand(e,t,!0)):Promise.reject(new Error(`Contributed command '${e}' does not exist.`))}getCommands(e=!1){return this._logService.trace("ExtHostCommands#getCommands",e),I(this,qn).$getCommands().then(t=>(e&&(t=t.filter(i=>i[0]!=="_")),t))}$getContributedCommandMetadata(){const e=Object.create(null);for(const[t,i]of this._commands){const{metadata:n}=i;n&&(e[t]=n)}return Promise.resolve(e)}},qn=new WeakMap,ru=new WeakMap,su=new WeakMap,X0);Iv=H([N(0,Ve),N(1,Ge),N(2,Zh)],Iv);const _a=ne("IExtHostCommands");class sI{constructor(e,t,i){this._commands=e,this._lookupApiCommand=t,this._logService=i,this.delegatingCommandId=`__vsc${xn()}`,this._cache=new Map,this._cachIdPool=0,this._commands.registerCommand(!0,this.delegatingCommandId,this._executeConvertedCommand,this)}toInternal(e,t){if(!e)return;const i={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command)return i;const n=this._lookupApiCommand(e.command);if(n)i.id=n.internalId,i.arguments=n.args.map((s,o)=>s.convert(e.arguments&&e.arguments[o]));else if(cc(e.arguments)){const s=`${e.command} /${++this._cachIdPool}`;this._cache.set(s,e),t.add(Le(()=>{this._cache.delete(s),this._logService.trace("CommandsConverter#DISPOSE",s)})),i.$ident=s,i.id=this.delegatingCommandId,i.arguments=[s],this._logService.trace("CommandsConverter#CREATE",e.command,s)}return i}fromInternal(e){return typeof e.$ident=="string"?this._cache.get(e.$ident):{command:e.id,title:e.title,arguments:e.arguments}}getActualCommand(...e){return this._cache.get(e[0])}_executeConvertedCommand(...e){const t=this.getActualCommand(...e);return this._logService.trace("CommandsConverter#EXECUTE",e[0],t?t.command:"MISSING"),t?this._commands.executeCommand(t.command,...t.arguments||[]):Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}}const rt=class rt{static Arr(e){return new rt(`${e.name}_array`,`Array of ${e.name}, ${e.description}`,t=>Array.isArray(t)&&t.every(i=>e.validate(i)),t=>t.map(i=>e.convert(i)))}constructor(e,t,i,n){this.name=e,this.description=t,this.validate=i,this.convert=n}optional(){return new rt(this.name,`(optional) ${this.description}`,e=>e==null||this.validate(e),e=>e===void 0?void 0:e===null?null:this.convert(e))}with(e,t){return new rt(e??this.name,t??this.description,this.validate,this.convert)}};rt.Uri=new rt("uri","Uri of a text document",e=>y.isUri(e),e=>e),rt.Position=new rt("position","A position in a text document",e=>Se.isPosition(e),We.from),rt.Range=new rt("range","A range in a text document",e=>be.isRange(e),F.from),rt.Selection=new rt("selection","A selection in a text document",e=>kn.isSelection(e),Ii.from),rt.Number=new rt("number","",e=>typeof e=="number",e=>e),rt.String=new rt("string","",e=>typeof e=="string",e=>e),rt.StringArray=rt.Arr(rt.String),rt.CallHierarchyItem=new rt("item","A call hierarchy item",e=>e instanceof Ng,Is.from),rt.TypeHierarchyItem=new rt("item","A type hierarchy item",e=>e instanceof mm,Ts.from),rt.TestItem=new rt("testItem","A VS Code TestItem",e=>e instanceof $s,Sr.from);let W=rt;const Bf=class Bf{constructor(e,t){this.description=e,this.convert=t}};Bf.Void=new Bf("no result",e=>e);let pe=Bf;class ve{constructor(e,t,i,n,s){this.id=e,this.internalId=t,this.description=i,this.args=n,this.result=s}}const Dl=ne("IExtHostTerminalService");class Qx{constructor(e,t,i,n){this._proxy=e,this._id=t,this._creationOptions=i,this._name=n,this._disposed=!1,this._state={isInteractedWith:!1},this.isOpen=!1,this._creationOptions=Object.freeze(this._creationOptions),this._pidPromise=new Promise(o=>this._pidPromiseComplete=o);const s=this;this.value={get name(){return s._name||""},get processId(){return s._pidPromise},get creationOptions(){return s._creationOptions},get exitStatus(){return s._exitStatus},get state(){return s._state},get selection(){return s._selection},sendText(o,a=!0){s._checkDisposed(),s._proxy.$sendText(s._id,o,a)},show(o){s._checkDisposed(),s._proxy.$show(s._id,o)},hide(){s._checkDisposed(),s._proxy.$hide(s._id)},dispose(){s._disposed||(s._disposed=!0,s._proxy.$dispose(s._id))},get dimensions(){if(!(s._cols===void 0||s._rows===void 0))return{columns:s._cols,rows:s._rows}}}}async create(e,t){if(typeof this._id!="string")throw new Error("Terminal has already been created");await this._proxy.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??(t==null?void 0:t.cwd)??void 0,env:e.env??void 0,icon:Kx(e.iconPath)??void 0,color:Do.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,isFeatureTerminal:(t==null?void 0:t.isFeatureTerminal)??void 0,isExtensionOwnedTerminal:!0,useShellEnvironment:(t==null?void 0:t.useShellEnvironment)??void 0,location:(t==null?void 0:t.location)||this._serializeParentTerminal(e.location,t==null?void 0:t.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0})}async createExtensionTerminal(e,t,i,n,s){if(typeof this._id!="string")throw new Error("Terminal has already been created");if(await this._proxy.$createTerminal(this._id,{name:this._name,isExtensionCustomPtyTerminal:!0,icon:n,color:Do.isThemeColor(s)?s.id:void 0,location:(t==null?void 0:t.location)||this._serializeParentTerminal(e,i),isTransient:!0}),typeof this._id=="string")throw new Error("Terminal creation failed");return this._id}_serializeParentTerminal(e,t){return typeof e=="object"?"parentTerminal"in e&&e.parentTerminal&&t?{parentTerminal:t}:"viewColumn"in e?{viewColumn:bt.from(e.viewColumn),preserveFocus:e.preserveFocus}:void 0:e}_checkDisposed(){if(this._disposed)throw new Error("Terminal has already been disposed")}set name(e){this._name=e}setExitStatus(e,t){this._exitStatus=Object.freeze({code:e,reason:t})}setDimensions(e,t){return e===this._cols&&t===this._rows||e===0||t===0?!1:(this._cols=e,this._rows=t,!0)}setInteractedWith(){return this._state.isInteractedWith?!1:(this._state={isInteractedWith:!0},!0)}setSelection(e){this._selection=e}_setProcessId(e){this._pidPromiseComplete?(this._pidPromiseComplete(e),this._pidPromiseComplete=void 0):this._pidPromise.then(t=>{t!==e&&(this._pidPromise=Promise.resolve(e))})}}class Pv{get onProcessReady(){return this._onProcessReady.event}constructor(e){this._pty=e,this.id=0,this.shouldPersist=!1,this._onProcessData=new T,this.onProcessData=this._onProcessData.event,this._onProcessReady=new T,this._onDidChangeProperty=new T,this.onDidChangeProperty=this._onDidChangeProperty.event,this._onProcessExit=new T,this.onProcessExit=this._onProcessExit.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,t){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${t}`)}async start(){}shutdown(){this._pty.close()}input(e){var t,i;(i=(t=this._pty).handleInput)==null||i.call(t,e)}resize(e,t){var i,n;(n=(i=this._pty).setDimensions)==null||n.call(i,{columns:e,rows:t})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){var t,i,n,s,o,a,c,l;this._pty.onDidWrite(u=>this._onProcessData.fire(u)),(i=(t=this._pty).onDidClose)==null||i.call(t,(u=void 0)=>{this._onProcessExit.fire(u===void 0?void 0:u)}),(s=(n=this._pty).onDidOverrideDimensions)==null||s.call(n,u=>{u&&this._onDidChangeProperty.fire({type:"overrideDimensions",value:{cols:u.columns,rows:u.rows}})}),(a=(o=this._pty).onDidChangeName)==null||a.call(o,u=>{this._onDidChangeProperty.fire({type:"title",value:u})}),this._pty.open(e||void 0),e&&((l=(c=this._pty).setDimensions)==null||l.call(c,e)),this._onProcessReady.fire({pid:-1,cwd:"",windowsPty:void 0})}}let oI=1,Tv=class extends Be{get activeTerminal(){var e;return(e=this._activeTerminal)==null?void 0:e.value}get terminals(){return this._terminals.map(e=>e.value)}constructor(e,t,i){super(),this._extHostCommands=t,this._terminals=[],this._terminalProcesses=new Map,this._terminalProcessDisposables={},this._extensionTerminalAwaitingStart={},this._getTerminalPromises={},this._environmentVariableCollections=new Map,this._lastQuickFixCommands=this._register(new go),this._linkProviders=new Set,this._profileProviders=new Map,this._quickFixProviders=new Map,this._terminalLinkCache=new Map,this._terminalLinkCancellationSource=new Map,this._onDidCloseTerminal=new T,this.onDidCloseTerminal=this._onDidCloseTerminal.event,this._onDidOpenTerminal=new T,this.onDidOpenTerminal=this._onDidOpenTerminal.event,this._onDidChangeActiveTerminal=new T,this.onDidChangeActiveTerminal=this._onDidChangeActiveTerminal.event,this._onDidChangeTerminalDimensions=new T,this.onDidChangeTerminalDimensions=this._onDidChangeTerminalDimensions.event,this._onDidChangeTerminalState=new T,this.onDidChangeTerminalState=this._onDidChangeTerminalState.event,this._onDidChangeShell=new T,this.onDidChangeShell=this._onDidChangeShell.event,this._onDidWriteTerminalData=new T({onWillAddFirstListener:()=>this._proxy.$startSendingDataEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingDataEvents()}),this.onDidWriteTerminalData=this._onDidWriteTerminalData.event,this._onDidExecuteCommand=new T({onWillAddFirstListener:()=>this._proxy.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingCommandEvents()}),this.onDidExecuteTerminalCommand=this._onDidExecuteCommand.event,this._proxy=i.getProxy(G.MainThreadTerminalService),this._bufferer=new eI(this._proxy.$sendProcessData),this._proxy.$registerProcessSupport(e),this._extHostCommands.registerArgumentProcessor({processArgument:n=>{const s=o=>{var c;const a=o;return(c=this._getTerminalById(a.instanceId))==null?void 0:c.value};switch(n==null?void 0:n.$mid){case 15:return s(n);default:{if(Array.isArray(n))for(let o=0;o<n.length&&n[o].$mid===15;o++)n[o]=s(n[o]);return n}}}}),this._register({dispose:()=>{for(const[n,s]of this._terminalProcesses)s.shutdown(!0)}})}getDefaultShell(e){const t=e?this._defaultAutomationProfile:this._defaultProfile;return(t==null?void 0:t.path)||""}getDefaultShellArgs(e){const t=e?this._defaultAutomationProfile:this._defaultProfile;return(t==null?void 0:t.args)||[]}createExtensionTerminal(e,t){const i=new Qx(this._proxy,xn(),e,e.name),n=new Pv(e.pty);return i.createExtensionTerminal(e.location,t,this._serializeParentTerminal(e,t).resolvedExtHostIdentifier,Kx(e.iconPath),cI(e.color)).then(s=>{const o=this._setupExtHostProcessListeners(s,n);this._terminalProcessDisposables[s]=o}),this._terminals.push(i),i.value}_serializeParentTerminal(e,t){if(t=t||{},e.location&&typeof e.location=="object"&&"parentTerminal"in e.location){const i=e.location.parentTerminal;if(i){const n=this._terminals.find(s=>s.value===i);n&&(t.resolvedExtHostIdentifier=n._id)}}else e.location&&typeof e.location!="object"?t.location=e.location:t.location&&typeof t.location=="object"&&"splitActiveTerminal"in t.location&&(t.location={splitActiveTerminal:!0});return t}attachPtyToTerminal(e,t){if(!this._getTerminalById(e))throw new Error(`Cannot resolve terminal with id ${e} for virtual process`);const n=new Pv(t),s=this._setupExtHostProcessListeners(e,n);this._terminalProcessDisposables[e]=s}async $acceptActiveTerminalChanged(e){const t=this._activeTerminal;if(e===null){this._activeTerminal=void 0,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal);return}const i=this._getTerminalById(e);i&&(this._activeTerminal=i,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal.value))}async $acceptTerminalProcessData(e,t){const i=this._getTerminalById(e);i&&this._onDidWriteTerminalData.fire({terminal:i.value,data:t})}async $acceptTerminalDimensions(e,t,i){const n=this._getTerminalById(e);n&&n.setDimensions(t,i)&&this._onDidChangeTerminalDimensions.fire({terminal:n.value,dimensions:n.value.dimensions})}async $acceptDidExecuteCommand(e,t){const i=this._getTerminalById(e);i&&this._onDidExecuteCommand.fire({terminal:i.value,...t})}async $acceptTerminalMaximumDimensions(e,t,i){var n;(n=this._terminalProcesses.get(e))==null||n.resize(t,i)}async $acceptTerminalTitleChange(e,t){const i=this._getTerminalById(e);i&&(i.name=t)}async $acceptTerminalClosed(e,t,i){const n=this._getTerminalObjectIndexById(this._terminals,e);if(n!==null){const s=this._terminals.splice(n,1)[0];s.setExitStatus(t,i),this._onDidCloseTerminal.fire(s.value)}}$acceptTerminalOpened(e,t,i,n){if(t){const a=this._getTerminalObjectIndexById(this._terminals,t);if(a!==null){this._terminals[a]._id=e,this._onDidOpenTerminal.fire(this.terminals[a]),this._terminals[a].isOpen=!0;return}}const s={name:n.name,shellPath:n.executable,shellArgs:n.args,cwd:typeof n.cwd=="string"?n.cwd:y.revive(n.cwd),env:n.env,hideFromUser:n.hideFromUser},o=new Qx(this._proxy,e,s,i);this._terminals.push(o),this._onDidOpenTerminal.fire(o.value),o.isOpen=!0}async $acceptTerminalProcessId(e,t){const i=this._getTerminalById(e);i==null||i._setProcessId(t)}async $startExtensionTerminal(e,t){const i=this._getTerminalById(e);if(!i)return{message:m("vs/workbench/api/common/extHostTerminalService","launchFail.idMissingOnExtHost","Could not find the terminal with id {0} on the extension host",e)};i.isOpen||await new Promise(s=>{const o=this.onDidOpenTerminal(async a=>{a===i.value&&(o.dispose(),s())})});const n=this._terminalProcesses.get(e);n?n.startSendingEvents(t):this._extensionTerminalAwaitingStart[e]={initialDimensions:t}}_setupExtHostProcessListeners(e,t){const i=new Ae;i.add(t.onProcessReady(s=>this._proxy.$sendProcessReady(e,s.pid,s.cwd,s.windowsPty))),i.add(t.onDidChangeProperty(s=>this._proxy.$sendProcessProperty(e,s))),this._bufferer.startBuffering(e,t.onProcessData),i.add(t.onProcessExit(s=>this._onProcessExit(e,s))),this._terminalProcesses.set(e,t);const n=this._extensionTerminalAwaitingStart[e];return n&&t instanceof Pv&&(t.startSendingEvents(n.initialDimensions),delete this._extensionTerminalAwaitingStart[e]),i}$acceptProcessAckDataEvent(e,t){var i;(i=this._terminalProcesses.get(e))==null||i.acknowledgeDataEvent(t)}$acceptProcessInput(e,t){var i;(i=this._terminalProcesses.get(e))==null||i.input(t)}$acceptTerminalInteraction(e){const t=this._getTerminalById(e);t!=null&&t.setInteractedWith()&&this._onDidChangeTerminalState.fire(t.value)}$acceptTerminalSelection(e,t){var i;(i=this._getTerminalById(e))==null||i.setSelection(t)}$acceptProcessResize(e,t,i){var n;try{(n=this._terminalProcesses.get(e))==null||n.resize(t,i)}catch(s){if(s.code!=="EPIPE"&&s.code!=="ERR_IPC_CHANNEL_CLOSED")throw s}}$acceptProcessShutdown(e,t){var i;(i=this._terminalProcesses.get(e))==null||i.shutdown(t)}$acceptProcessRequestInitialCwd(e){var t;(t=this._terminalProcesses.get(e))==null||t.getInitialCwd().then(i=>this._proxy.$sendProcessProperty(e,{type:"initialCwd",value:i}))}$acceptProcessRequestCwd(e){var t;(t=this._terminalProcesses.get(e))==null||t.getCwd().then(i=>this._proxy.$sendProcessProperty(e,{type:"cwd",value:i}))}$acceptProcessRequestLatency(e){return Promise.resolve(e)}registerLinkProvider(e){return this._linkProviders.add(e),this._linkProviders.size===1&&this._proxy.$startLinkProvider(),new Pe(()=>{this._linkProviders.delete(e),this._linkProviders.size===0&&this._proxy.$stopLinkProvider()})}registerProfileProvider(e,t,i){if(this._profileProviders.has(t))throw new Error(`Terminal profile provider "${t}" already registered`);return this._profileProviders.set(t,i),this._proxy.$registerProfileProvider(t,e.identifier.value),new Pe(()=>{this._profileProviders.delete(t),this._proxy.$unregisterProfileProvider(t)})}registerTerminalQuickFixProvider(e,t,i){if(this._quickFixProviders.has(e))throw new Error(`Terminal quick fix provider "${e}" is already registered`);return this._quickFixProviders.set(e,i),this._proxy.$registerQuickFixProvider(e,t),new Pe(()=>{this._quickFixProviders.delete(e),this._proxy.$unregisterQuickFixProvider(e)})}async $provideTerminalQuickFixes(e,t){const i=new mt().token;if(i.isCancellationRequested)return;const n=this._quickFixProviders.get(e);if(!n)return;const s=await n.provideTerminalQuickFixes(t,i);if(s===null||Array.isArray(s)&&s.length===0)return;const o=new Ae;if(this._lastQuickFixCommands.value=o,!Array.isArray(s))return s?Vh.from(s,this._extHostCommands.converter,o):void 0;const a=[];for(const c of s){const l=Vh.from(c,this._extHostCommands.converter,o);l&&a.push(l)}return a}async $createContributedProfileTerminal(e,t){var s;const i=new mt().token;let n=await((s=this._profileProviders.get(e))==null?void 0:s.provideTerminalProfile(i));if(!i.isCancellationRequested){if(n&&!("options"in n)&&(n={options:n}),!n||!("options"in n))throw new Error(`No terminal profile options provided for id "${e}"`);if("pty"in n.options){this.createExtensionTerminal(n.options,t);return}this.createTerminalFromOptions(n.options,t)}}async $provideLinks(e,t){const i=this._getTerminalById(e);if(!i)return[];this._terminalLinkCache.delete(e);const n=this._terminalLinkCancellationSource.get(e);n==null||n.dispose(!0);const s=new mt;this._terminalLinkCancellationSource.set(e,s);const o=[],a={terminal:i.value,line:t},c=[];for(const d of this._linkProviders)c.push(Kp.withAsyncBody(async h=>{s.token.onCancellationRequested(()=>h({provider:d,links:[]}));const g=await d.provideTerminalLinks(a,s.token)||[];s.token.isCancellationRequested||h({provider:d,links:g})}));const l=await Promise.all(c);if(s.token.isCancellationRequested)return[];const u=new Map;for(const d of l)d&&d.links.length>0&&o.push(...d.links.map(h=>{const g={id:oI++,startIndex:h.startIndex,length:h.length,label:h.tooltip};return u.set(g.id,{provider:d.provider,link:h}),g}));return this._terminalLinkCache.set(e,u),o}$activateLink(e,t){var n;const i=(n=this._terminalLinkCache.get(e))==null?void 0:n.get(t);i&&i.provider.handleTerminalLink(i.link)}_onProcessExit(e,t){this._bufferer.stopBuffering(e),this._terminalProcesses.delete(e),delete this._extensionTerminalAwaitingStart[e];const i=this._terminalProcessDisposables[e];i&&(i.dispose(),delete this._terminalProcessDisposables[e]),this._proxy.$sendProcessExit(e,t)}_getTerminalById(e){return this._getTerminalObjectById(this._terminals,e)}_getTerminalObjectById(e,t){const i=this._getTerminalObjectIndexById(e,t);return i!==null?e[i]:null}_getTerminalObjectIndexById(e,t){const i=e.findIndex(n=>n._id===t);return i===-1?null:i}getEnvironmentVariableCollection(e){let t=this._environmentVariableCollections.get(e.identifier.value);return t||(t=new Jx,this._setEnvironmentVariableCollection(e.identifier.value,t)),t.getScopedEnvironmentVariableCollection(void 0)}_syncEnvironmentVariableCollection(e,t){const i=Y4(t.map),n=Z4(t.descriptionMap);this._proxy.$setEnvironmentVariableCollection(e,t.persistent,i.length===0?void 0:i,n)}$initEnvironmentVariableCollections(e){e.forEach(t=>{const i=t[0],n=new Jx(t[1]);this._setEnvironmentVariableCollection(i,n)})}$acceptDefaultProfile(e,t){const i=this._defaultProfile;this._defaultProfile=e,this._defaultAutomationProfile=t,(i==null?void 0:i.path)!==e.path&&this._onDidChangeShell.fire(e.path)}_setEnvironmentVariableCollection(e,t){this._environmentVariableCollections.set(e,t),t.onDidChangeCollection(()=>{this._syncEnvironmentVariableCollection(e,t)})}};Tv=H([N(1,_a),N(2,Ve)],Tv);class Jx{get persistent(){return this._persistent}set persistent(e){this._persistent=e,this._onDidChangeCollection.fire()}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e){this.map=new Map,this.scopedCollections=new Map,this.descriptionMap=new Map,this._persistent=!0,this._onDidChangeCollection=new T,this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const t=this.getScopeKey(e);let i=this.scopedCollections.get(t);return i||(i=new aI(this,e),this.scopedCollections.set(t,i),i.onDidChangeCollection(()=>this._onDidChangeCollection.fire())),i}replace(e,t,i,n){this._setIfDiffers(e,{value:t,type:No.Replace,options:i??{applyAtProcessCreation:!0},scope:n})}append(e,t,i,n){this._setIfDiffers(e,{value:t,type:No.Append,options:i??{applyAtProcessCreation:!0},scope:n})}prepend(e,t,i,n){this._setIfDiffers(e,{value:t,type:No.Prepend,options:i??{applyAtProcessCreation:!0},scope:n})}_setIfDiffers(e,t){var o,a,c,l,u,d;if(t.options&&t.options.applyAtProcessCreation===!1&&!t.options.applyAtShellIntegration)throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration");const i=this.getKey(e,t.scope),n=this.map.get(i),s=t.options?{applyAtProcessCreation:t.options.applyAtProcessCreation??!1,applyAtShellIntegration:t.options.applyAtShellIntegration??!1}:{applyAtProcessCreation:!0};if(!n||n.value!==t.value||n.type!==t.type||((o=n.options)==null?void 0:o.applyAtProcessCreation)!==s.applyAtProcessCreation||((a=n.options)==null?void 0:a.applyAtShellIntegration)!==s.applyAtShellIntegration||((l=(c=n.scope)==null?void 0:c.workspaceFolder)==null?void 0:l.index)!==((d=(u=t.scope)==null?void 0:u.workspaceFolder)==null?void 0:d.index)){const h=this.getKey(e,t.scope),g={variable:e,...t,options:s};this.map.set(h,g),this._onDidChangeCollection.fire()}}get(e,t){const i=this.getKey(e,t),n=this.map.get(i);return n?Xx(n):void 0}getKey(e,t){const i=this.getScopeKey(t);return i.length?`${e}:::${i}`:e}getScopeKey(e){return this.getWorkspaceKey(e==null?void 0:e.workspaceFolder)??""}getWorkspaceKey(e){return e?e.uri.toString():void 0}getVariableMap(e){const t=new Map;for(const[i,n]of this.map)this.getScopeKey(n.scope)===this.getScopeKey(e)&&t.set(n.variable,Xx(n));return t}delete(e,t){const i=this.getKey(e,t);this.map.delete(i),this._onDidChangeCollection.fire()}clear(e){var t,i;if(e!=null&&e.workspaceFolder){for(const[n,s]of this.map)((i=(t=s.scope)==null?void 0:t.workspaceFolder)==null?void 0:i.index)===e.workspaceFolder.index&&this.map.delete(n);this.clearDescription(e)}else this.map.clear(),this.descriptionMap.clear();this._onDidChangeCollection.fire()}setDescription(e,t){const i=this.getScopeKey(t),n=this.descriptionMap.get(i);if(!n||n.description!==e){let s;typeof e=="string"?s=e:s=e==null?void 0:e.value.split(`

`)[0];const o={description:s,scope:t};this.descriptionMap.set(i,o),this._onDidChangeCollection.fire()}}getDescription(e){var i;const t=this.getScopeKey(e);return(i=this.descriptionMap.get(t))==null?void 0:i.description}clearDescription(e){const t=this.getScopeKey(e);this.descriptionMap.delete(t)}}class aI{get persistent(){return this.collection.persistent}set persistent(e){this.collection.persistent=e}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e,t){this.collection=e,this.scope=t,this._onDidChangeCollection=new T}getScoped(e){return this.collection.getScopedEnvironmentVariableCollection(e)}replace(e,t,i){this.collection.replace(e,t,i,this.scope)}append(e,t,i){this.collection.append(e,t,i,this.scope)}prepend(e,t,i){this.collection.prepend(e,t,i,this.scope)}get(e){return this.collection.get(e,this.scope)}forEach(e,t){this.collection.getVariableMap(this.scope).forEach((i,n)=>e.call(t,n,i,this),this.scope)}[Symbol.iterator](){return this.collection.getVariableMap(this.scope).entries()}delete(e){this.collection.delete(e,this.scope),this._onDidChangeCollection.fire(void 0)}clear(){this.collection.clear(this.scope)}set description(e){this.collection.setDescription(e,this.scope)}get description(){return this.collection.getDescription(this.scope)}}let Av=class extends Tv{constructor(e,t){super(!1,e,t)}createTerminal(e,t,i){throw new _p}createTerminalFromOptions(e,t){throw new _p}};Av=H([N(0,_a),N(1,Ve)],Av);function Kx(r){if(!(!r||typeof r=="string"))return"id"in r?{id:r.id,color:r.color}:r}function cI(r){return Do.isThemeColor(r)?r:void 0}function Xx(r){const e={...r};return delete e.scope,e.options=e.options??void 0,delete e.variable,e}function Il(r,e=si){return NE(r,e)?r.charAt(0).toUpperCase()+r.slice(1):r}function lI(r,e){return r.replace(/^~($|\/|\\)/,`${e}$1`)}var Yx;(function(r){r[r.TEXT=0]="TEXT",r[r.VARIABLE=1]="VARIABLE",r[r.SEPARATOR=2]="SEPARATOR"})(Yx||(Yx={}));function Zx(r){return r<0?0:r>255?255:r|0}function wa(r){return r<0?0:r>4294967295?4294967295:r|0}class ef{constructor(e){const t=Zx(e);this._defaultValue=t,this._asciiMap=ef._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const i=Zx(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class uI extends ef{constructor(e){super(0);for(let t=0,i=e.length;t<i;t++)this.set(e.charCodeAt(t),2);this.set(32,1),this.set(9,1)}}function dI(r){const e={};return t=>(e.hasOwnProperty(t)||(e[t]=r(t)),e[t])}const hI=dI(r=>new uI(r));var Rv;(function(r){r[r.Left=1]="Left",r[r.Center=2]="Center",r[r.Right=4]="Right",r[r.Full=7]="Full"})(Rv||(Rv={}));var eC;(function(r){r[r.Left=1]="Left",r[r.Center=2]="Center",r[r.Right=3]="Right"})(eC||(eC={}));var tC;(function(r){r[r.Inline=1]="Inline",r[r.Gutter=2]="Gutter"})(tC||(tC={}));var iC;(function(r){r[r.Both=0]="Both",r[r.Right=1]="Right",r[r.Left=2]="Left",r[r.None=3]="None"})(iC||(iC={}));class Lv{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}class fI{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class pI{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}class nC{constructor(e,t,i,n){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=rC(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=uE(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new fI(t,this.wordSeparators?hI(this.wordSeparators):null,i?this.searchString:null)}}function rC(r){if(!r||r.length===0)return!1;for(let e=0,t=r.length;e<t;e++){const i=r.charCodeAt(e);if(i===10)return!0;if(i===92){if(e++,e>=t)break;const n=r.charCodeAt(e);if(n===110||n===114||n===87)return!0}}return!1}function sC(r,e,t){if(!t)return new Lv(r,null);const i=[];for(let n=0,s=e.length;n<s;n++)i[n]=e[n];return new Lv(r,i)}function gI(r,e,t,i,n){if(i===0)return!0;const s=e.charCodeAt(i-1);if(r.get(s)!==0||s===13||s===10)return!0;if(n>0){const o=e.charCodeAt(i);if(r.get(o)!==0)return!0}return!1}function mI(r,e,t,i,n){if(i+n===t)return!0;const s=e.charCodeAt(i+n);if(r.get(s)!==0||s===13||s===10)return!0;if(n>0){const o=e.charCodeAt(i+n-1);if(r.get(o)!==0)return!0}return!1}function oC(r,e,t,i,n){return gI(r,e,t,i,n)&&mI(r,e,t,i,n)}class vI{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const n=i.index,s=i[0].length;if(n===this._prevMatchStartIndex&&s===this._prevMatchLength){if(s===0){qb(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=s,!this._wordSeparators||oC(this._wordSeparators,e,t,n,s))return i}while(i);return null}}function aC(r){return r.scheme!==Z.file&&r.scheme!==Z.vscodeRemote}function _I(r){if(r.folders.length)return r.folders.every(e=>aC(e.uri))?r.folders[0].uri:void 0;if(r.configuration&&aC(r.configuration))return r.configuration}function wI(r){var e;return(e=_I(r))==null?void 0:e.scheme}const bI=ne("environmentService"),yI=bI,cC=ne("remoteAgentService");var Ov;const xI=ne("pathService");let lC=Ov=class{constructor(e,t,i,n){this.localUserHome=e,this.remoteAgentService=t,this.environmentService=i,this.contextService=n,this.resolveOS=(async()=>{const s=await this.remoteAgentService.getEnvironment();return(s==null?void 0:s.os)||US})(),this.resolveUserHome=(async()=>{const s=await this.remoteAgentService.getEnvironment();return this.maybeUnresolvedUserHome=(s==null?void 0:s.userHome)??e})()}hasValidBasename(e,t,i){return typeof t=="string"||typeof t>"u"?this.resolveOS.then(n=>this.doHasValidBasename(e,n,t)):this.doHasValidBasename(e,t,i)}doHasValidBasename(e,t,i){return e.scheme===Z.file||e.scheme===Z.vscodeRemote?$E(i??ns(e),t===1):!0}get defaultUriScheme(){return Ov.findDefaultUriScheme(this.environmentService,this.contextService)}static findDefaultUriScheme(e,t){if(e.remoteAuthority)return Z.vscodeRemote;const i=wI(t.getWorkspace());if(i)return i;const n=t.getWorkspace().folders[0];if(n)return n.uri.scheme;const s=t.getWorkspace().configuration;return s?s.scheme:Z.file}userHome(e){return e!=null&&e.preferLocal?this.localUserHome:this.resolveUserHome}get resolvedUserHome(){return this.maybeUnresolvedUserHome}get path(){return this.resolveOS.then(e=>e===1?Ct:Me)}async fileURI(e){let t="";if(await this.resolveOS===1&&(e=e.replace(/\\/g,"/")),e[0]==="/"&&e[1]==="/"){const n=e.indexOf("/",2);n===-1?(t=e.substring(2),e="/"):(t=e.substring(2,n),e=e.substring(n)||"/")}return y.from({scheme:Z.file,authority:t,path:e,query:"",fragment:""})}};lC=Ov=H([N(1,cC),N(2,yI),N(3,lg)],lC);let uC=class{constructor(e,t,i,n,s){this.configurationService=e,this.workspaceContextService=t,this.editorGroupsService=i,this.logService=n,this.pathService=s}text(e,t,i={}){e=this.getContentPattern(e,i);const n=this.configurationService.getValue(),s=t&&t.some(a=>!this.configurationService.getValue({resource:a}).search.useRipgrep);return{...this.commonQuery(t==null?void 0:t.map(Oy),i),type:2,contentPattern:e,previewOptions:i.previewOptions,maxFileSize:i.maxFileSize,usePCRE2:n.search.usePCRE2||s||!1,beforeContext:i.beforeContext,afterContext:i.afterContext,userDisabledExcludesAndIgnoreFiles:i.disregardExcludeSettings&&i.disregardIgnoreFiles}}getContentPattern(e,t){var s,o,a,c;const i=this.configurationService.getValue();e.isRegExp&&(e.pattern=e.pattern.replace(/\r?\n/g,"\\n"));const n={...e,wordSeparators:i.editor.wordSeparators};return this.isCaseSensitive(e,t)&&(n.isCaseSensitive=!0),this.isMultiline(e)&&(n.isMultiline=!0),(s=t.notebookSearchConfig)!=null&&s.includeMarkupInput&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookMarkdownInput=t.notebookSearchConfig.includeMarkupInput),(o=t.notebookSearchConfig)!=null&&o.includeMarkupPreview&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookMarkdownPreview=t.notebookSearchConfig.includeMarkupPreview),(a=t.notebookSearchConfig)!=null&&a.includeCodeInput&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookCellInput=t.notebookSearchConfig.includeCodeInput),(c=t.notebookSearchConfig)!=null&&c.includeOutput&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookCellOutput=t.notebookSearchConfig.includeOutput),n}file(e,t={}){return{...this.commonQuery(e,t),type:1,filePattern:t.filePattern?t.filePattern.trim():t.filePattern,exists:t.exists,sortByScore:t.sortByScore,cacheKey:t.cacheKey,shouldGlobMatchFilePattern:t.shouldGlobSearch}}handleIncludeExclude(e,t){return e?(e=Array.isArray(e)?e.map(tf):tf(e),t?this.parseSearchPaths(e):{pattern:$v(...Array.isArray(e)?e:[e])}):{}}commonQuery(e=[],t={}){const i=this.handleIncludeExclude(t.includePattern,t.expandPatterns),n=this.handleIncludeExclude(t.excludePattern,t.expandPatterns),s=e.length>1,o=(i.searchPaths&&i.searchPaths.length?i.searchPaths.map(l=>this.getFolderQueryForSearchPath(l,t,n)):e.map(l=>this.getFolderQueryForRoot(l,t,n,s))).filter(l=>!!l),a={_reason:t._reason,folderQueries:o,usingSearchPaths:!!(i.searchPaths&&i.searchPaths.length),extraFileResources:t.extraFileResources,excludePattern:n.pattern,includePattern:i.pattern,onlyOpenEditors:t.onlyOpenEditors,maxResults:t.maxResults};if(t.onlyOpenEditors){const l=Jt(Iu(this.editorGroupsService.groups.map(h=>h.editors.map(g=>g.resource))));this.logService.trace("QueryBuilder#commonQuery - openEditor URIs",JSON.stringify(l));const u=l.filter(h=>Sx(a,h.fsPath)),d=this.commonQueryFromFileList(u);return this.logService.trace("QueryBuilder#commonQuery - openEditor Query",JSON.stringify(d)),{...a,...d}}const c=t.extraFileResources&&t.extraFileResources.filter(l=>Sx(a,l.fsPath));return a.extraFileResources=c&&c.length?c:void 0,a}commonQueryFromFileList(e){const t=[],i=new pt,n={};let s=!1;return e.forEach(o=>{var c;if(o.scheme===Z.walkThrough)return;if(zE(o)){const l=((c=this.workspaceContextService.getWorkspaceFolder(o))==null?void 0:c.uri)??o.with({path:es(o.fsPath)});let u=i.get(l);u||(s=!0,u={folder:l,includePattern:{}},t.push(u),i.set(l,u));const d=gc(l.fsPath,o.fsPath);yo(u.includePattern)[d.replace(/\\/g,"/")]=!0}else o.fsPath&&(s=!0,n[o.fsPath]=!0)}),{folderQueries:t,includePattern:n,usingSearchPaths:!0,excludePattern:s?void 0:{"**/*":!0}}}isCaseSensitive(e,t){if(t.isSmartCase){if(e.isRegExp){if(Kb(e.pattern,!0))return!0}else if(Kb(e.pattern))return!0}return!!e.isCaseSensitive}isMultiline(e){return e.isMultiline||e.isRegExp&&rC(e.pattern)||e.pattern.indexOf(`
`)>=0?!0:!!e.isMultiline}parseSearchPaths(e){const t=d=>Lp(d)||/^\.\.?([\/\\]|$)/.test(d),n=(Array.isArray(e)?e:SI(e)).map(d=>{const h=this.pathService.resolvedUserHome;return h?lI(d,h.scheme===Z.file?h.fsPath:h.path):d}),s=nS(n,d=>t(d)?"searchPaths":"exprSegments"),o=(s.exprSegments||[]).map(d=>Hb(d,"/")).map(d=>Hb(d,"\\")).map(d=>(d[0]==="."&&(d="*"+d),EI(d))),a={},c=this.expandSearchPathPatterns(s.searchPaths||[]);c&&c.length&&(a.searchPaths=c);const l=Iu(o),u=$v(...l);return u&&(a.pattern=u),a}getExcludesForFolder(e,t){return t.disregardExcludeSettings?void 0:_4(e,!t.disregardSearchExcludeSettings)}expandSearchPathPatterns(e){if(!e||!e.length)return[];const t=e.flatMap(n=>{let{pathPortion:s,globPortion:o}=CI(n);return o&&(o=Nv(o)),this.expandOneSearchPath(s).flatMap(c=>this.resolveOneSearchPathPattern(c,o))}),i=new Map;return t.forEach(n=>{const s=n.searchPath.toString(),o=i.get(s);o?n.pattern&&(o.pattern=o.pattern||{},o.pattern[n.pattern]=!0):i.set(s,{searchPath:n.searchPath,pattern:n.pattern?$v(n.pattern):void 0})}),Array.from(i.values())}expandOneSearchPath(e){if(Lp(e)){const t=this.workspaceContextService.getWorkspace().folders;return t[0]&&t[0].uri.scheme!==Z.file?[{searchPath:t[0].uri.with({path:e})}]:[{searchPath:y.file(vo(e))}]}if(this.workspaceContextService.getWorkbenchState()===2){const t=this.workspaceContextService.getWorkspace().folders[0].uri;if(e=tf(e),e.startsWith("../")||e===".."){const n=Me.resolve(t.path,e);return[{searchPath:t.with({path:n})}]}const i=Nv(e);return[{searchPath:t,pattern:i}]}else{if(e==="./"||e===".\\")return[];{const t=e.replace(/^\.[\/\\]/,""),n=this.workspaceContextService.getWorkspace().folders.map(s=>{const o=t.match(new RegExp(`^${wo(s.name)}(?:/(.*)|$)`));return o?{match:o,folder:s}:null}).filter(bo);if(n.length)return n.map(s=>{const o=s.match[1];return{searchPath:s.folder.uri,pattern:o&&Nv(o)}});{const s=e.match(/\.[\/\\](.+)[\/\\]?/),o=s?s[1]:e,a=m("vs/workbench/services/search/common/queryBuilder","search.noWorkspaceWithName","Workspace folder does not exist: {0}",o);throw new Error(a)}}}}resolveOneSearchPathPattern(e,t){const i=e.pattern&&t?`${e.pattern}/${t}`:e.pattern||t,n=[{searchPath:e.searchPath,pattern:i}];return i&&!i.endsWith("**")&&n.push({searchPath:e.searchPath,pattern:i+"/**"}),n}getFolderQueryForSearchPath(e,t,i){const n=this.getFolderQueryForRoot(Oy(e.searchPath),t,i,!1);return n?{...n,includePattern:e.pattern}:null}getFolderQueryForRoot(e,t,i,n){var d,h,g,w;let s;const o=y.isUri(e)?e:e.uri;if(i.searchPaths){const p=i.searchPaths.filter(b=>ny(b.searchPath,o))[0];if(p&&!p.pattern)return null;p&&(s=p.pattern)}const a=this.configurationService.getValue({resource:o}),l={...this.getExcludesForFolder(a,t)||{},...s||{}},u=y.isUri(e)?ns(e):e.name;return{folder:o,folderName:n?u:void 0,excludePattern:Object.keys(l).length>0?l:void 0,fileEncoding:a.files&&a.files.encoding,disregardIgnoreFiles:typeof t.disregardIgnoreFiles=="boolean"?t.disregardIgnoreFiles:!((d=a.search)!=null&&d.useIgnoreFiles),disregardGlobalIgnoreFiles:typeof t.disregardGlobalIgnoreFiles=="boolean"?t.disregardGlobalIgnoreFiles:!((h=a.search)!=null&&h.useGlobalIgnoreFiles),disregardParentIgnoreFiles:typeof t.disregardParentIgnoreFiles=="boolean"?t.disregardParentIgnoreFiles:!((g=a.search)!=null&&g.useParentIgnoreFiles),ignoreSymlinks:typeof t.ignoreSymlinks=="boolean"?t.ignoreSymlinks:!((w=a.search)!=null&&w.followSymlinks)}}};uC=H([N(0,uv),N(1,lg),N(2,OD),N(3,Ge),N(4,xI)],uC);function CI(r){const e=r.match(/[\*\{\}\(\)\[\]\?]/);if(e){const t=e.index,i=r.substr(0,t).match(/[/|\\][^/\\]*$/);if(i){let n=r.substr(0,i.index);return n.match(/[/\\]/)||(n+="/"),{pathPortion:n,globPortion:r.substr((i.index||0)+1)}}}return{pathPortion:r}}function $v(...r){return r.length?r.reduce((e,t)=>(e[t]=!0,e),Object.create(null)):void 0}function SI(r){return yg(r,",").map(e=>e.trim()).filter(e=>!!e.length)}function EI(r){return[`**/${r}/**`,`**/${r}`].map(t=>t.replace(/\*\*\/\*\*/g,"**"))}function tf(r){return r.replace(/\\/g,"/")}function Nv(r){return tf(r).replace(/^\.\//,"").replace(/\/+$/g,"")}const kI=7e3;function DI(r,e){const t=e.activationEvents;if(!t)return Promise.resolve(void 0);const i=[],n=[];for(const u of t)if(/^workspaceContains:/.test(u)){const d=u.substr(18);d.indexOf("*")>=0||d.indexOf("?")>=0||r.forceUsingSearch?n.push(d):i.push(d)}if(i.length===0&&n.length===0)return Promise.resolve(void 0);const{promise:s,resolve:o}=GE(),a=u=>o({activationEvent:u}),c=Promise.all(i.map(u=>II(r,u,a))).then(()=>{}),l=PI(r,e.identifier,n,a);return Promise.all([c,l]).then(()=>{o(void 0)}),s}async function II(r,e,t){for(const i of r.folders)if(await r.exists(xo(y.revive(i),e))){t(`workspaceContains:${e}`);return}}async function PI(r,e,t,i){if(t.length===0)return Promise.resolve(void 0);const n=new mt,s=r.checkExists(r.folders,t,n.token),o=setTimeout(async()=>{n.cancel(),r.logService.info(`Not activating extension '${e.value}': Timed out while searching for 'workspaceContains' pattern ${t.join(",")}`)},kI);let a=!1;try{a=await s}catch(c){qr(c)||mn(c)}n.dispose(),clearTimeout(o),a&&i(`workspaceContains:${t.join(",")}`)}class dC{constructor(e){this._onDidChangePassword=new T,this.onDidChangePassword=this._onDidChangePassword.event,this._proxy=e.getProxy(G.MainThreadSecretState)}async $onDidChangePassword(e){this._onDidChangePassword.fire(e)}get(e,t){return this._proxy.$getPassword(e,t)}store(e,t,i){return this._proxy.$setPassword(e,t,i)}delete(e,t){return this._proxy.$deletePassword(e,t)}}const Fv=ne("IExtHostSecretState");class TI{constructor(e,t){ae(this,Lr,void 0);this._onDidChange=new T,this.onDidChange=this._onDidChange.event,this._id=Xe.toKey(e.identifier),K(this,Lr,t),I(this,Lr).onDidChangePassword(i=>{i.extensionId===this._id&&this._onDidChange.fire({key:i.key})})}get(e){return I(this,Lr).get(this._id,e)}store(e,t){return I(this,Lr).store(this._id,e,t)}delete(e){return I(this,Lr).delete(this._id,e)}}Lr=new WeakMap;let Mv=class{constructor(e,t,i){this.logService=i,this.bundleCache=new Map,this._proxy=t.getProxy(G.MainThreadLocalization),this.currentLanguage=e.environment.appLanguage,this.isDefaultLanguage=this.currentLanguage===Xr}getMessage(e,t){var c;const{message:i,args:n,comment:s}=t;if(this.isDefaultLanguage)return Mb(i,n??{});let o=i;s&&s.length>0&&(o+=`/${Array.isArray(s)?s.join(""):s}`);const a=(c=this.bundleCache.get(e))==null?void 0:c.contents[o];return a||this.logService.warn(`Using default string since no string found in i18n bundle that has the key: ${o}`),Mb(a??i,n??{})}getBundle(e){var t;return(t=this.bundleCache.get(e))==null?void 0:t.contents}getBundleUri(e){var t;return(t=this.bundleCache.get(e))==null?void 0:t.uri}async initializeLocalizedMessages(e){var n;if(this.isDefaultLanguage||!e.l10n&&!e.isBuiltin||this.bundleCache.has(e.identifier.value))return;let t;const i=await this.getBundleLocation(e);if(!i){this.logService.error(`No bundle location found for extension ${e.identifier.value}`);return}try{const s=await this._proxy.$fetchBundleContents(i),o=JSON.parse(s);t=e.isBuiltin?(n=o.contents)==null?void 0:n.bundle:o}catch(s){this.logService.error(`Failed to load translations for ${e.identifier.value} from ${i}: ${s.message}`);return}t&&this.bundleCache.set(e.identifier.value,{contents:t,uri:i})}async getBundleLocation(e){if(e.isBuiltin){const t=await this._proxy.$fetchBuiltInBundleUri(e.identifier.value,this.currentLanguage);return y.revive(t)}return e.l10n?y.joinPath(e.extensionLocation,e.l10n,`bundle.l10n.${this.currentLanguage}.json`):void 0}};Mv=H([N(0,Ut),N(1,Ve),N(2,Ge)],Mv);const Hv=ne("IExtHostLocalizationService"),Uv=ne("IExtHostManagedSockets");let Bv=class{constructor(e){this._remoteSocketIdCounter=0,this._factory=null,this._managedRemoteSockets=new Map,this._proxy=e.getProxy(G.MainThreadManagedSockets)}setFactory(e,t){for(const i of this._managedRemoteSockets.values())i.dispose();this._factory&&this._proxy.$unregisterSocketFactory(this._factory.socketFactoryId),this._factory=new AI(e,t),this._proxy.$registerSocketFactory(this._factory.socketFactoryId)}async $openRemoteSocket(e){if(!this._factory||this._factory.socketFactoryId!==e)throw new Error(`No socket factory with id ${e}`);const t=++this._remoteSocketIdCounter,i=await this._factory.makeConnection(),n=new Ae;return this._managedRemoteSockets.set(t,new RI(t,i,n)),n.add(Le(()=>this._managedRemoteSockets.delete(t))),n.add(i.onDidEnd(()=>{this._proxy.$onDidManagedSocketEnd(t),n.dispose()})),n.add(i.onDidClose(s=>{this._proxy.$onDidManagedSocketClose(t,(s==null?void 0:s.stack)??(s==null?void 0:s.message)),n.dispose()})),n.add(i.onDidReceiveMessage(s=>this._proxy.$onDidManagedSocketHaveData(t,me.wrap(s)))),t}$remoteSocketWrite(e,t){var i;(i=this._managedRemoteSockets.get(e))==null||i.actual.send(t.buffer)}$remoteSocketEnd(e){const t=this._managedRemoteSockets.get(e);t&&(t.actual.end(),t.dispose())}async $remoteSocketDrain(e){var t,i,n;await((n=(t=this._managedRemoteSockets.get(e))==null?void 0:(i=t.actual).drain)==null?void 0:n.call(i))}};Bv=H([N(0,Ve)],Bv);class AI{constructor(e,t){this.socketFactoryId=e,this.makeConnection=t}}class RI extends Be{constructor(e,t,i){super(),this.socketId=e,this.actual=t,this._register(i)}}var Wv;const hC=ne("IHostUtils");let Vv=Wv=class extends Be{constructor(e,t,i,n,s,o,a,c,l,u,d,h){super(),this._extHostManagedSockets=h,this._onDidChangeRemoteConnectionData=this._register(new T),this.onDidChangeRemoteConnectionData=this._onDidChangeRemoteConnectionData.event,this._isTerminating=!1,this._hostUtils=t,this._extHostContext=i,this._initData=a,this._extHostWorkspace=n,this._extHostConfiguration=s,this._logService=o,this._extHostTunnelService=l,this._extHostTerminalService=u,this._extHostLocalizationService=d,this._mainThreadWorkspaceProxy=this._extHostContext.getProxy(G.MainThreadWorkspace),this._mainThreadTelemetryProxy=this._extHostContext.getProxy(G.MainThreadTelemetry),this._mainThreadExtensionsProxy=this._extHostContext.getProxy(G.MainThreadExtensionService),this._almostReadyToRunExtensions=new wn,this._readyToStartExtensionHost=new wn,this._readyToRunExtensions=new wn,this._eagerExtensionsActivated=new wn,this._activationEventsReader=new OI(this._initData.extensions.activationEvents),this._globalRegistry=new Rs(this._activationEventsReader,this._initData.extensions.allExtensions);const g=new $o(this._initData.extensions.myExtensions);this._myRegistry=new Rs(this._activationEventsReader,gC(this._globalRegistry,g)),Yr&&(this._logService.info(`Creating extension host with the following global extensions: ${ba(this._globalRegistry)}`),this._logService.info(`Creating extension host with the following local extensions: ${ba(this._myRegistry)}`)),this._storage=new Hx(this._extHostContext,this._logService),this._secretState=new dC(this._extHostContext),this._storagePath=c,this._instaService=e.createChild(new og([vv,this._storage],[Fv,this._secretState])),this._activator=this._register(new gv(this._myRegistry,this._globalRegistry,{onExtensionActivationError:(w,p,b)=>{this._mainThreadExtensionsProxy.$onExtensionActivationError(w,ku(p),b)},actualActivateExtension:async(w,p)=>{if(Rs.isHostExtension(w,this._myRegistry,this._globalRegistry))return await this._mainThreadExtensionsProxy.$activateExtension(w,p),new G4;const b=this._myRegistry.getExtensionDescription(w);return this._activateExtension(b,p)}},this._logService)),this._extensionPathIndex=null,this._resolvers=Object.create(null),this._started=!1,this._remoteConnectionData=this._initData.remote.connectionData}getRemoteConnectionData(){return this._remoteConnectionData}async initialize(){try{await this._beforeAlmostReadyToRunExtensions(),this._almostReadyToRunExtensions.open(),await this._extHostWorkspace.waitForInitializeCall(),pi("code/extHost/ready"),this._readyToStartExtensionHost.open(),this._initData.autoStart&&this._startExtensionHost()}catch(e){mn(e)}}async _deactivateAll(){this._storagePath.onWillDeactivateAll();let e=[];try{e=this._myRegistry.getAllExtensionDescriptions().map(s=>s.identifier).filter(s=>this.isActivated(s)).map(s=>this._deactivate(s))}catch{}await Promise.all(e)}terminate(e,t=0){if(this._isTerminating)return;this._isTerminating=!0,this._logService.info(`Extension host terminating: ${e}`),this._logService.flush(),this._extHostTerminalService.dispose(),this._activator.dispose(),pc&&fo(n=>{this._logService.error(n)}),this._extHostContext.dispose();const i=this._deactivateAll();Promise.race([lr(5e3),i]).finally(()=>{this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} exiting with code ${t}`):this._logService.info(`Extension host exiting with code ${t}`),this._logService.flush(),this._logService.dispose(),this._hostUtils.exit(t)})}isActivated(e){return this._readyToRunExtensions.isOpen()?this._activator.isActivated(e):!1}async getExtension(e){const t=await this._mainThreadExtensionsProxy.$getExtension(e);return t&&{...t,identifier:new Xe(t.identifier.value),extensionLocation:y.revive(t.extensionLocation)}}_activateByEvent(e,t){return this._activator.activateByEvent(e,t)}_activateById(e,t){return this._activator.activateById(e,t)}activateByIdWithErrors(e,t){return this._activateById(e,t).then(()=>{const i=this._activator.getActivatedExtension(e);if(i.activationFailed)return Promise.reject(i.activationFailedError)})}getExtensionRegistry(){return this._readyToRunExtensions.wait().then(e=>this._myRegistry)}getExtensionExports(e){if(this._readyToRunExtensions.isOpen())return this._activator.getActivatedExtension(e).exports;try{return this._activator.getActivatedExtension(e).exports}catch{return null}}async _realPathExtensionUri(e){if(e.scheme===Z.file&&this._hostUtils.fsRealpath){const t=await this._hostUtils.fsRealpath(e.fsPath);return y.file(t)}return e}async getExtensionPathIndex(){return this._extensionPathIndex||(this._extensionPathIndex=this._createExtensionPathIndex(this._myRegistry.getAllExtensionDescriptions()).then(e=>new LI(e))),this._extensionPathIndex}async _createExtensionPathIndex(e){const t=yn.forUris(i=>WE.ignorePathCasing(i));return await Promise.all(e.map(async i=>{if(this._getEntryPoint(i)){const n=await this._realPathExtensionUri(i.extensionLocation);t.set(n,i)}})),t}_deactivate(e){let t=Promise.resolve(void 0);if(!this._readyToRunExtensions.isOpen()||!this._activator.isActivated(e))return t;const i=this._activator.getActivatedExtension(e);if(!i)return t;try{typeof i.module.deactivate=="function"&&(t=Promise.resolve(i.module.deactivate()).then(void 0,n=>(this._logService.error(n),Promise.resolve(void 0))))}catch(n){this._logService.error(`An error occurred when deactivating the extension '${e.value}':`),this._logService.error(n)}try{Kr(i.subscriptions)}catch(n){this._logService.error(`An error occurred when deactivating the subscriptions for extension '${e.value}':`),this._logService.error(n)}return t}async _activateExtension(e,t){return this._initData.remote.isRemote?this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier):await this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier),this._doActivateExtension(e,t).then(i=>{const n=i.activationTimes;return this._mainThreadExtensionsProxy.$onDidActivateExtension(e.identifier,n.codeLoadingTime,n.activateCallTime,n.activateResolvedTime,t),this._logExtensionActivationTimes(e,t,"success",n),i},i=>{throw this._logExtensionActivationTimes(e,t,"failure"),i})}_logExtensionActivationTimes(e,t,i,n){const s=pC(e,t);this._mainThreadTelemetryProxy.$publicLog2("extensionActivationTimes",{...s,...n||{},outcome:i})}_doActivateExtension(e,t){const i=pC(e,t);this._mainThreadTelemetryProxy.$publicLog2("activatePlugin",i);const n=this._getEntryPoint(e);if(!n)return Promise.resolve(new q4(ga.NONE));this._logService.info(`ExtensionService#_doActivateExtension ${e.identifier.value}, startup: ${t.startup}, activationEvent: '${t.activationEvent}'${e.identifier.value!==t.extensionId.value?`, root cause: ${t.extensionId.value}`:""}`),this._logService.flush();const s=new Mx(t.startup);return Promise.all([this._loadCommonJSModule(e,xo(e.extensionLocation,n),s),this._loadExtensionContext(e)]).then(o=>(pi(`code/extHost/willActivateExtension/${e.identifier.value}`),Wv._callActivate(this._logService,e.identifier,o[0],o[1],s))).then(o=>(pi(`code/extHost/didActivateExtension/${e.identifier.value}`),o))}_loadExtensionContext(e){const t=new Q4(e,this._storage),i=new Ux(e.identifier.value,!1,this._storage),n=new TI(e,this._secretState),s=e.isUnderDevelopment?this._initData.environment.extensionTestsLocationURI?Yo.Test:Yo.Development:Yo.Production,o=this._initData.remote.isRemote?ks.Workspace:ks.UI;return this._logService.trace(`ExtensionService#loadExtensionContext ${e.identifier.value}`),Promise.all([t.whenReady,i.whenReady,this._storagePath.whenReady]).then(()=>{var d;const a=this;let c,l;const u=Tt(e,"ipc")?(d=this._initData.messagePorts)==null?void 0:d.get(Xe.toKey(e.identifier)):void 0;return Object.freeze({globalState:t,workspaceState:i,secrets:n,subscriptions:[],get extensionUri(){return e.extensionLocation},get extensionPath(){return e.extensionLocation.fsPath},asAbsolutePath(h){return Ib(e.extensionLocation.fsPath,h)},get storagePath(){var h;return(h=a._storagePath.workspaceValue(e))==null?void 0:h.fsPath},get globalStoragePath(){return a._storagePath.globalValue(e).fsPath},get logPath(){return Ib(a._initData.logsLocation.fsPath,e.identifier.value)},get logUri(){return y.joinPath(a._initData.logsLocation,e.identifier.value)},get storageUri(){return a._storagePath.workspaceValue(e)},get globalStorageUri(){return a._storagePath.globalValue(e)},get extensionMode(){return s},get extension(){return c===void 0&&(c=new Pl(a,e.identifier,e,o,!1)),c},get extensionRuntime(){return M(e,"extensionRuntime"),a.extensionRuntime},get environmentVariableCollection(){return a._extHostTerminalService.getEnvironmentVariableCollection(e)},get messagePassingProtocol(){if(!l){if(!u)return;const h=_t.buffer(_t.fromDOMEventEmitter(u,"message",g=>g.data));u.start(),l={onDidReceiveMessage:h,postMessage:u.postMessage.bind(u)}}return l}})})}static _callActivate(e,t,i,n,s){return i=i||{activate:void 0,deactivate:void 0},this._callActivateOptional(e,t,i,n,s).then(o=>new Kh(!1,null,s.build(),i,o,n.subscriptions))}static _callActivateOptional(e,t,i,n,s){if(typeof i.activate=="function")try{s.activateCallStart(),e.trace(`ExtensionService#_callActivateOptional ${t.value}`);const o=typeof global=="object"?global:self,a=i.activate.apply(o,[n]);return s.activateCallStop(),s.activateResolveStart(),Promise.resolve(a).then(c=>(s.activateResolveStop(),c))}catch(o){return Promise.reject(o)}else return Promise.resolve(i)}_activateOneStartupFinished(e,t){this._activateById(e.identifier,{startup:!1,extensionId:e.identifier,activationEvent:t}).then(void 0,i=>{this._logService.error(i)})}_activateAllStartupFinishedDeferred(e,t=0){const n=Date.now();bb(()=>{for(let s=t;s<e.length;s+=1){const o=e[s];for(const a of o.activationEvents??[])if(a==="onStartupFinished")if(Date.now()-n>50){this._activateAllStartupFinishedDeferred(e,s);break}else this._activateOneStartupFinished(o,a)}})}_activateAllStartupFinished(){this._mainThreadExtensionsProxy.$setPerformanceMarks(AS()),this._extHostConfiguration.getConfigProvider().then(e=>{const t=e.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation"),i=this._myRegistry.getAllExtensionDescriptions();if(t)this._activateAllStartupFinishedDeferred(i);else for(const n of i)if(n.activationEvents)for(const s of n.activationEvents)s==="onStartupFinished"&&this._activateOneStartupFinished(n,s)})}_handleEagerExtensions(){const e=this._activateByEvent("*",!0).then(void 0,o=>{this._logService.error(o)});this._register(this._extHostWorkspace.onDidChangeWorkspace(o=>this._handleWorkspaceContainsEagerExtensions(o.added)));const t=this._extHostWorkspace.workspace?this._extHostWorkspace.workspace.folders:[],i=this._handleWorkspaceContainsEagerExtensions(t),n=this._handleRemoteResolverEagerExtensions(),s=Promise.all([n,e,i]).then(()=>{});return Promise.race([s,lr(1e4)]).then(()=>{this._activateAllStartupFinished()}),s}_handleWorkspaceContainsEagerExtensions(e){return e.length===0?Promise.resolve(void 0):Promise.all(this._myRegistry.getAllExtensionDescriptions().map(t=>this._handleWorkspaceContainsEagerExtension(e,t))).then(()=>{})}async _handleWorkspaceContainsEagerExtension(e,t){if(this.isActivated(t.identifier))return;const i=!this._initData.remote.isRemote&&!!this._initData.remote.authority,n={logService:this._logService,folders:e.map(o=>o.uri),forceUsingSearch:i||!this._hostUtils.fsExists,exists:o=>this._hostUtils.fsExists(o.fsPath),checkExists:(o,a,c)=>this._mainThreadWorkspaceProxy.$checkExists(o,a,c)},s=await DI(n,t);if(s)return this._activateById(t.identifier,{startup:!0,extensionId:t.identifier,activationEvent:s.activationEvent}).then(void 0,o=>this._logService.error(o))}async _handleRemoteResolverEagerExtensions(){if(this._initData.remote.authority)return this._activateByEvent(`onResolveRemoteAuthority:${this._initData.remote.authority}`,!1)}async $extensionTestsExecute(){await this._eagerExtensionsActivated.wait();try{return await this._doHandleExtensionTests()}catch(e){throw console.error(e),e}}async _doHandleExtensionTests(){const{extensionDevelopmentLocationURI:e,extensionTestsLocationURI:t}=this._initData.environment;if(!e||!t)throw new Error(m("vs/workbench/api/common/extHostExtensionService","extensionTestError1","Cannot load test runner."));const i=await this._loadCommonJSModule(null,t,new Mx(!1));if(!i||typeof i.run!="function")throw new Error(m("vs/workbench/api/common/extHostExtensionService","extensionTestError","Path {0} does not point to a valid extension test runner.",t.toString()));return new Promise((n,s)=>{const o=(l,u)=>{l?(Yr&&this._logService.error("Test runner called back with error",l),s(l)):(Yr&&(u?this._logService.info(`Test runner called back with ${u} failures.`):this._logService.info("Test runner called back with successful outcome.")),n(typeof u=="number"&&u>0?1:0))},a=Oi(t),c=i.run(a,o);c&&c.then&&c.then(()=>{Yr&&this._logService.info("Test runner finished successfully."),n(0)}).catch(l=>{Yr&&this._logService.error("Test runner finished with error",l),s(l instanceof Error&&l.stack?l.stack:String(l))})})}_startExtensionHost(){if(this._started)throw new Error("Extension host is already started!");return this._started=!0,this._readyToStartExtensionHost.wait().then(()=>this._readyToRunExtensions.open()).then(()=>Promise.race([this._activator.waitForActivatingExtensions(),lr(1e3)])).then(()=>this._handleEagerExtensions()).then(()=>{this._eagerExtensionsActivated.open(),this._logService.info("Eager extensions activated")})}registerRemoteAuthorityResolver(e,t){return this._resolvers[e]=t,Le(()=>{delete this._resolvers[e]})}async getRemoteExecServer(e){var i;const{resolver:t}=await this._activateAndGetResolver(e);return(i=t==null?void 0:t.resolveExecServer)==null?void 0:i.call(t,e,{resolveAttempt:0})}async _activateAndGetResolver(e){const t=e.indexOf("+");if(t===-1)throw new nn("Not an authority that can be resolved!",Sn.InvalidAuthority);const i=e.substr(0,t);return await this._almostReadyToRunExtensions.wait(),await this._activateByEvent(`onResolveRemoteAuthority:${i}`,!1),{authorityPrefix:i,resolver:this._resolvers[i]}}async $resolveAuthority(e,t){var D;const i=vn.create(!1),n=()=>`[resolveAuthority(${ix(e)},${t})][${i.elapsed()}ms] `,s=C=>this._logService.info(`${n()}${C}`),o=C=>this._logService.warn(`${n()}${C}`),a=(C,R=void 0)=>this._logService.error(`${n()}${C}`,R),c=C=>{if(C instanceof nn)return{type:"error",error:{code:C._code,message:C._message,detail:C._detail}};throw C},l=async C=>{s(`activating resolver for ${C}...`);const{resolver:R,authorityPrefix:A}=await this._activateAndGetResolver(C);if(!R)throw a(`no resolver for ${A}`),new nn(`No remote extension installed to resolve ${A}.`,Sn.NoResolverFound);return{resolver:R,authorityPrefix:A,remoteAuthority:C}},u=e.split(/@|%40/g).reverse();s(`activating remote resolvers ${u.join(" -> ")}`);let d;try{d=await Promise.all(u.map(l)).catch(async C=>{if(!(C instanceof nn)||C._code!==Sn.InvalidAuthority)throw C;return o(`resolving nested authorities failed: ${C.message}`),[await l(e)]})}catch(C){return c(C)}const h=new YE;h.cancelAndSet(()=>s("waiting..."),1e3);let g,w;for(const[C,{authorityPrefix:R,resolver:A,remoteAuthority:B}]of d.entries())try{if(C===d.length-1)s("invoking final resolve()..."),pi(`code/extHost/willResolveAuthority/${R}`),g=await A.resolve(B,{resolveAttempt:t,execServer:w}),pi(`code/extHost/didResolveAuthorityOK/${R}`),s("setting tunnel factory..."),this._register(await this._extHostTunnelService.setTunnelFactory(A,Ed.isManagedResolvedAuthority(g)?g:void 0));else{if(s(`invoking resolveExecServer() for ${B}`),pi(`code/extHost/willResolveExecServer/${R}`),w=await((D=A.resolveExecServer)==null?void 0:D.call(A,B,{resolveAttempt:t,execServer:w})),!w)throw new nn(`Exec server was not available for ${B}`,Sn.NoResolverFound);pi(`code/extHost/didResolveExecServerOK/${R}`)}}catch(Q){return pi(`code/extHost/didResolveAuthorityError/${R}`),a("returned an error",Q),h.dispose(),c(Q)}h.dispose();const p={environmentTunnels:g.environmentTunnels,features:g.tunnelFeatures?{elevation:g.tunnelFeatures.elevation,privacyOptions:g.tunnelFeatures.privacyOptions,protocol:g.tunnelFeatures.protocol===void 0?!0:g.tunnelFeatures.protocol}:void 0},b={extensionHostEnv:g.extensionHostEnv,isTrusted:g.isTrusted,authenticationSession:g.authenticationSessionForInitializingExtensions?{id:g.authenticationSessionForInitializingExtensions.id,providerId:g.authenticationSessionForInitializingExtensions.providerId}:void 0};s(`returned ${Ed.isManagedResolvedAuthority(g)?"managed authority":`${g.host}:${g.port}`}`);let k;if(Ed.isManagedResolvedAuthority(g)){const C=t;this._extHostManagedSockets.setFactory(C,g.makeConnection),k={authority:e,connectTo:new VD(C),connectionToken:g.connectionToken}}else k={authority:e,connectTo:new zD(g.host,g.port),connectionToken:g.connectionToken};return{type:"ok",value:{authority:k,options:b,tunnelInformation:p}}}async $getCanonicalURI(e,t){this._logService.info(`$getCanonicalURI invoked for authority (${ix(e)})`);const{resolver:i}=await this._activateAndGetResolver(e);if(!i)return null;const n=y.revive(t);if(typeof i.getCanonicalURI>"u")return n;const s=await Mt(()=>i.getCanonicalURI(n));return s||n}$startExtensionHost(e){e.toAdd.forEach(n=>n.extensionLocation=y.revive(n.extensionLocation));const{globalRegistry:t,myExtensions:i}=fC(this._activationEventsReader,this._globalRegistry,this._myRegistry,e);return this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(i),Yr&&(this._logService.info(`$startExtensionHost: global extensions: ${ba(this._globalRegistry)}`),this._logService.info(`$startExtensionHost: local extensions: ${ba(this._myRegistry)}`)),this._startExtensionHost()}$activateByEvent(e,t){return t===1?this._almostReadyToRunExtensions.wait().then(i=>this._activateByEvent(e,!1)):this._readyToRunExtensions.wait().then(i=>this._activateByEvent(e,!1))}async $activate(e,t){return await this._readyToRunExtensions.wait(),this._myRegistry.getExtensionDescription(e)?(await this._activateById(e,t),!0):!1}async $deltaExtensions(e){e.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:t,myExtensions:i}=fC(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),n=await this._createExtensionPathIndex(i);return(await this.getExtensionPathIndex()).setSearchTree(n),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(i),Yr&&(this._logService.info(`$deltaExtensions: global extensions: ${ba(this._globalRegistry)}`),this._logService.info(`$deltaExtensions: local extensions: ${ba(this._myRegistry)}`)),Promise.resolve(void 0)}async $test_latency(e){return e}async $test_up(e){return e.byteLength}async $test_down(e){const t=me.alloc(e),i=Math.random()%256;for(let n=0;n<e;n++)t.writeUInt8(i,n);return t}async $updateRemoteConnectionData(e){this._remoteConnectionData=e,this._onDidChangeRemoteConnectionData.fire()}};Vv=Wv=H([N(0,qu),N(1,hC),N(2,Ve),N(3,An),N(4,Rn),N(5,Ge),N(6,Ut),N(7,wv),N(8,Sv),N(9,Dl),N(10,Hv),N(11,Uv)],Vv);function fC(r,e,t,i){r.addActivationEvents(i.addActivationEvents);const n=new Rs(r,e.getAllExtensionDescriptions());n.deltaExtensions(i.toAdd,i.toRemove);const s=new $o(t.getAllExtensionDescriptions().map(a=>a.identifier));for(const a of i.myToRemove)s.delete(a);for(const a of i.myToAdd)s.add(a);const o=gC(n,s);return{globalRegistry:n,myExtensions:o}}function pC(r,e){return{id:r.identifier.value,name:r.name,extensionVersion:r.version,publisherDisplayName:r.publisher,activationEvents:r.activationEvents?r.activationEvents.join(","):null,isBuiltin:r.isBuiltin,reason:e.activationEvent,reasonId:e.extensionId.value}}function ba(r){return r.getAllExtensionDescriptions().map(e=>e.identifier.value).join(",")}const Ir=ne("IExtHostExtensionService");class Pl{constructor(e,t,i,n,s){ae(this,js,void 0);ae(this,ou,void 0);ae(this,qs,void 0);K(this,js,e),K(this,ou,t),K(this,qs,i.identifier),this.id=i.identifier.value,this.extensionUri=i.extensionLocation,this.extensionPath=vo(Oi(i.extensionLocation)),this.packageJSON=i,this.extensionKind=n,this.isFromDifferentExtensionHost=s}get isActive(){return I(this,js).isActivated(I(this,qs))}get exports(){if(!(this.packageJSON.api==="none"||this.isFromDifferentExtensionHost))return I(this,js).getExtensionExports(I(this,qs))}async activate(){if(this.isFromDifferentExtensionHost)throw new Error("Cannot activate foreign extension");return await I(this,js).activateByIdWithErrors(I(this,qs),{startup:!1,extensionId:I(this,ou),activationEvent:"api"}),this.exports}}js=new WeakMap,ou=new WeakMap,qs=new WeakMap;function gC(r,e){return r.getAllExtensionDescriptions().filter(t=>e.has(t.identifier))}class LI{constructor(e){this._searchTree=e}setSearchTree(e){this._searchTree=e}findSubstr(e){return this._searchTree.findSubstr(e)}forEach(e){return this._searchTree.forEach(e)}}class OI{constructor(e){this._map=new fr,this.addActivationEvents(e)}readActivationEvents(e){return this._map.get(e.identifier)??[]}addActivationEvents(e){for(const t of Object.keys(e))this._map.set(t,e[t])}}class $I extends Be{constructor(e,t=[]){super(),this.logger=new Dk([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}flush(){this.logger.flush()}}let zv=class extends $I{constructor(e,t,i){const n=i.remote.isRemote?"remoteexthost":e?"workerexthost":"exthost",s=i.remote.isRemote?m("vs/workbench/api/common/extHostLogService","remote","Extension Host (Remote)"):e?m("vs/workbench/api/common/extHostLogService","worker","Extension Host (Worker)"):m("vs/workbench/api/common/extHostLogService","local","Extension Host");super(t.createLogger(n,{name:s}))}};zv=H([N(1,So),N(2,Ut)],zv);let nf=class extends Ik{constructor(e,t){super(t.logLevel,t.logsLocation,t.loggers.map(i=>Yi(i))),this._proxy=e.getProxy(G.MainThreadLogger)}$setLogLevel(e,t){t?this.setLogLevel(y.revive(t),e):this.setLogLevel(e)}setVisibility(e,t){super.setVisibility(e,t),this._proxy.$setVisibility(e,t)}doCreateLogger(e,t,i){return new NI(this._proxy,e,t,i)}};nf=H([N(0,Ve),N(1,Ut)],nf);class NI extends Cy{constructor(e,t,i,n){super((n==null?void 0:n.logLevel)==="always"),this.proxy=e,this.file=t,this.isLoggerCreated=!1,this.buffer=[],this.setLevel(i),this.proxy.$createLogger(t,n).then(()=>{this.doLog(this.buffer),this.isLoggerCreated=!0})}log(e,t){const i=[[e,t]];this.isLoggerCreated?this.doLog(i):this.buffer.push(...i)}doLog(e){this.proxy.$log(this.file,e)}flush(){this.proxy.$flush(this.file)}}class mC{static async installEarlyHandler(e){Error.stackTraceLimit=100;const t=e.get(Ge),n=e.get(Ve).getProxy(G.MainThreadErrors);fo(s=>{t.error(s);const o=ku(s);n.$onUnexpectedError(o)})}static async installFullHandler(e){const t=e.get(Ge),i=e.get(Ve),n=e.get(Ir),s=e.get(Zh),o=i.getProxy(G.MainThreadExtensionService),a=i.getProxy(G.MainThreadErrors),c=await n.getExtensionPathIndex(),l=new WeakMap;function u(g,w){if(l.has(g))return l.get(g).stack;let p="",b,k;for(const C of w)p+=`
	at ${C.toString()}`,k=C.getFileName(),!b&&k&&(b=c.findSubstr(y.file(k)));const D=`${g.name||"Error"}: ${g.message||""}${p}`;return l.set(g,{extensionIdentifier:b==null?void 0:b.identifier,stack:D}),D}const d=Symbol("prepareStackTrace wrapped");let h=u;Object.defineProperty(Error,"prepareStackTrace",{configurable:!1,get(){return h},set(g){if(g===u||!g||g[d]){h=g||u;return}h=function(w,p){return u(w,p),g.call(Error,w,p)},Object.assign(h,{[d]:!0})}}),fo(g=>{t.error(g);const w=ku(g),p=l.get(g);if(!(p!=null&&p.extensionIdentifier)){a.$onUnexpectedError(w);return}o.$onExtensionRuntimeError(p.extensionIdentifier,w);const b=s.onExtensionError(p.extensionIdentifier,g);t.trace("forwarded error to extension?",b,p)})}}class jv{constructor(e,t,i,n,s){this._hostUtils=i,this._rpcProtocol=new tg(e,null,n),t=jv._transform(t,this._rpcProtocol);const o=new og(...Ak());o.set(Ut,{_serviceBrand:void 0,...t,messagePorts:s}),o.set(Ve,new Ok(this._rpcProtocol)),o.set(Yu,new $k(n)),o.set(hC,i),o.set(Ge,new Xi(zv,[!0],!0)),o.set(So,new Xi(nf,[],!0));const a=new Xu(o,!0);pc&&a.invokeFunction(mC.installEarlyHandler),this._logService=a.invokeFunction(c=>c.get(Ge)),pi("code/extHost/didCreateServices"),this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} started`):this._logService.info("Extension host started"),this._logService.trace("initData",t),this._extensionService=a.invokeFunction(c=>c.get(Ir)),this._extensionService.initialize(),pc&&a.invokeFunction(mC.installFullHandler)}async asBrowserUri(e){const t=this._rpcProtocol.getProxy(G.MainThreadExtensionService);return y.revive(await t.$asBrowserUri(e))}async getAllStaticBrowserUris(){return(await this._rpcProtocol.getProxy(G.MainThreadExtensionService).$getAllStaticBrowserUris()).map(([t,i])=>[y.revive(t),y.revive(i)])}terminate(e){this._extensionService.terminate(e)}getExtHostExtensionService(){return this._extensionService}static _transform(e,t){e.extensions.allExtensions.forEach(n=>{n.extensionLocation=y.revive(t.transformIncomingURIs(n.extensionLocation))}),e.environment.appRoot=y.revive(t.transformIncomingURIs(e.environment.appRoot));const i=e.environment.extensionDevelopmentLocationURI;return i&&(e.environment.extensionDevelopmentLocationURI=i.map(n=>y.revive(t.transformIncomingURIs(n)))),e.environment.extensionTestsLocationURI=y.revive(t.transformIncomingURIs(e.environment.extensionTestsLocationURI)),e.environment.globalStorageHome=y.revive(t.transformIncomingURIs(e.environment.globalStorageHome)),e.environment.workspaceStorageHome=y.revive(t.transformIncomingURIs(e.environment.workspaceStorageHome)),e.environment.extensionTelemetryLogResource=y.revive(t.transformIncomingURIs(e.environment.extensionTelemetryLogResource)),e.nlsBaseUrl=y.revive(t.transformIncomingURIs(e.nlsBaseUrl)),e.logsLocation=y.revive(t.transformIncomingURIs(e.logsLocation)),e.workspace=t.transformIncomingURIs(e.workspace),e}}const FI=(function(e){const t=i=>{globalThis.removeEventListener("message",t);const n=i.data;Object.defineProperties(globalThis,{postMessage:{value(s,o){n.postMessage(s,o)}},onmessage:{get(){return n.onmessage},set(s){n.onmessage=s}}}),n.addEventListener("message",s=>{globalThis.dispatchEvent(new MessageEvent("message",{data:s.data,ports:s.ports?[...s.ports]:void 0}))}),n.start(),globalThis.Worker=class{constructor(){throw new TypeError("Nested workers from within nested worker are NOT supported.")}},importScripts(e)};globalThis.addEventListener("message",t)}).toString();class MI extends EventTarget{constructor(e,t,i){super(),this.onmessage=null,this.onmessageerror=null,this.onerror=null;const n=`((${FI})('${t}'))`,s=new Blob([n],{type:"application/javascript"}),o=URL.createObjectURL(s),a=new MessageChannel,c=o,l={type:"_newWorker",id:c,port:a.port2,url:o,options:i};e(l,[a.port2]),this.postMessage=a.port1.postMessage.bind(a.port1),this.terminate=()=>{e({type:"_terminateWorker",id:c}),URL.revokeObjectURL(o),a.port1.close(),a.port2.close()},Object.defineProperties(this,{onmessage:{get(){return a.port1.onmessage},set(u){a.port1.onmessage=u}},onmessageerror:{get(){return a.port1.onmessageerror},set(u){a.port1.onmessageerror=u}}}),a.port1.addEventListener("messageerror",u=>{const d=new MessageEvent("messageerror",{data:u.data});this.dispatchEvent(d)}),a.port1.addEventListener("message",u=>{const d=new MessageEvent("message",{data:u.data});this.dispatchEvent(d)}),a.port1.start()}}new re("inOutput",!1),new re("activeLogOutput",!1),new re("outputView.scrollLock",!1),ne("outputService");var Tl;(function(r){r[r.Append=1]="Append",r[r.Replace=2]="Replace",r[r.Clear=3]="Clear"})(Tl||(Tl={}));const HI={OutputChannels:"workbench.contributions.outputChannels"};class UI{constructor(){this.channels=new Map,this._onDidRegisterChannel=new T,this.onDidRegisterChannel=this._onDidRegisterChannel.event,this._onDidRemoveChannel=new T,this.onDidRemoveChannel=this._onDidRemoveChannel.event}registerChannel(e){this.channels.has(e.id)||(this.channels.set(e.id,e),this._onDidRegisterChannel.fire(e.id))}getChannels(){const e=[];return this.channels.forEach(t=>e.push(t)),e}getChannel(e){return this.channels.get(e)}removeChannel(e){this.channels.delete(e),this._onDidRemoveChannel.fire(e)}}mi.add(HI.OutputChannels,new UI),new re("activeOutputChannel","");function BI(r){return r.getFullYear()+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0")+"T"+String(r.getHours()).padStart(2,"0")+":"+String(r.getMinutes()).padStart(2,"0")+":"+String(r.getSeconds()).padStart(2,"0")+"."+(r.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}class vC extends Cy{get disposed(){return this._disposed}constructor(e,t,i,n,s){super(),this.id=e,this.name=t,this.logger=i,this.proxy=n,this.extension=s,this.offset=0,this._disposed=!1,this.visible=!1,this.setLevel(i.getLevel()),this._register(i.onDidChangeLogLevel(o=>this.setLevel(o)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+`
`)}append(e){this.info(e)}clear(){const e=this.offset;this.logger.flush(),this.proxy.$update(this.id,Tl.Clear,e)}replace(e){const t=this.offset;this.info(e),this.proxy.$update(this.id,Tl.Replace,t),this.visible&&this.logger.flush()}show(e,t){this.logger.flush(),this.proxy.$reveal(this.id,!!(typeof e=="boolean"?e:t))}hide(){this.proxy.$close(this.id)}log(e,t){this.offset+=me.fromString(t).byteLength,kk(this.logger,e,t),this.visible&&(this.logger.flush(),this.proxy.$update(this.id,Tl.Append))}dispose(){super.dispose(),this._disposed||(this.proxy.$dispose(this.id),this._disposed=!0)}}class WI extends vC{appendLine(e){this.append(e)}}let qv=class{constructor(e,t,i,n,s,o){this.initData=t,this.extHostFileSystem=i,this.extHostFileSystemInfo=n,this.loggerService=s,this.logService=o,this.extensionLogDirectoryPromise=new Map,this.namePool=1,this.channels=new Map,this.visibleChannelId=null,this.proxy=e.getProxy(G.MainThreadOutputService),this.outputsLocation=this.extHostFileSystemInfo.extUri.joinPath(t.logsLocation,`output_logging_${BI(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(e){this.visibleChannelId=e;for(const[t,i]of this.channels)i.visible=t===this.visibleChannelId}createOutputChannel(e,t,i){var l,u;if(e=e.trim(),!e)throw new Error("illegal argument `name`. must not be falsy");const n=typeof t=="object"&&t.log,s=Ne(t)?t:void 0;if(Ne(s)&&!s.trim())throw new Error("illegal argument `languageId`. must not be empty");let o;const a=(u=(l=this.initData.environment.extensionLogLevel)==null?void 0:l.find(([d])=>Xe.equals(i.identifier,d)))==null?void 0:u[1];a&&(o=Tk(a));const c=n?this.doCreateLogOutputChannel(e,o,i):this.doCreateOutputChannel(e,s,i);return c.then(d=>{this.channels.set(d.id,d),d.visible=d.id===this.visibleChannelId}),n?this.createExtHostLogOutputChannel(e,o??this.logService.getLevel(),c):this.createExtHostOutputChannel(e,c)}async doCreateOutputChannel(e,t,i){this.outputDirectoryPromise||(this.outputDirectoryPromise=this.extHostFileSystem.value.createDirectory(this.outputsLocation).then(()=>this.outputsLocation));const n=await this.outputDirectoryPromise,s=this.extHostFileSystemInfo.extUri.joinPath(n,`${this.namePool++}-${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`),o=this.loggerService.createLogger(s,{logLevel:"always",donotRotate:!0,donotUseFormatters:!0,hidden:!0}),a=await this.proxy.$register(e,s,t,i.identifier.value);return new vC(a,e,o,this.proxy,i)}async doCreateLogOutputChannel(e,t,i){const n=await this.createExtensionLogDirectory(i),s=e.replace(/[\\/:\*\?"<>\|]/g,""),o=this.extHostFileSystemInfo.extUri.joinPath(n,`${s}.log`),a=`${i.identifier.value}.${s}`,c=this.loggerService.createLogger(o,{id:a,name:e,logLevel:t,extensionId:i.identifier.value});return new WI(a,e,c,this.proxy,i)}createExtensionLogDirectory(e){let t=this.extensionLogDirectoryPromise.get(e.identifier.value);if(!t){const i=this.extHostFileSystemInfo.extUri.joinPath(this.initData.logsLocation,e.identifier.value);this.extensionLogDirectoryPromise.set(e.identifier.value,t=(async()=>{try{await this.extHostFileSystem.value.createDirectory(i)}catch(n){if(wg(n)!==Ce.FileExists)throw n}return i})())}return t}createExtHostOutputChannel(e,t){let i=!1;const n=()=>{if(i)throw new Error("Channel has been closed")};return{get name(){return e},append(s){n(),t.then(o=>o.append(s))},appendLine(s){n(),t.then(o=>o.appendLine(s))},clear(){n(),t.then(s=>s.clear())},replace(s){n(),t.then(o=>o.replace(s))},show(s,o){n(),t.then(a=>a.show(s,o))},hide(){n(),t.then(s=>s.hide())},dispose(){i=!0,t.then(s=>s.dispose())}}}createExtHostLogOutputChannel(e,t,i){const n=new Ae,s=()=>{if(n.isDisposed)throw new Error("Channel has been closed")},o=n.add(new T);function a(c){t=c,o.fire(c)}return i.then(c=>{n.add(c),c.logLevel!==t&&a(c.logLevel),n.add(c.onDidChangeLogLevel(l=>a(l)))}),{...this.createExtHostOutputChannel(e,i),get logLevel(){return t},onDidChangeLogLevel:o.event,trace(c,...l){s(),i.then(u=>u.trace(c,...l))},debug(c,...l){s(),i.then(u=>u.debug(c,...l))},info(c,...l){s(),i.then(u=>u.info(c,...l))},warn(c,...l){s(),i.then(u=>u.warn(c,...l))},error(c,...l){s(),i.then(u=>u.error(c,...l))},dispose(){n.dispose()}}}};qv=H([N(0,Ve),N(1,Ut),N(2,Yh),N(3,ko),N(4,So),N(5,Ge)],qv);const _C=ne("IExtHostOutputService");var Al;let Gv=(Gs=class{constructor(e,t){this._logService=t,this._provider=new Map,this._proxy=e.getProxy(G.MainThreadDecorations)}registerFileDecorationProvider(e,t){const i=Al._handlePool++;this._provider.set(i,{provider:e,extensionDescription:t}),this._proxy.$registerDecorationProvider(i,t.identifier.value);const n=e.onDidChangeFileDecorations&&e.onDidChangeFileDecorations(s=>{if(!s){this._proxy.$onDidChange(i,null);return}const o=uc(s);if(o.length<=Al._maxEventSize){this._proxy.$onDidChange(i,o);return}this._logService.warn("[Decorations] CAPPING events from decorations provider",t.identifier.value,o.length);const a=o.map(u=>({uri:u,rank:cE(u.path,"/")})),c=eS(a,(u,d)=>u.rank-d.rank||ts(u.uri.path,d.uri.path)),l=[];e:for(const u of c){let d;for(const h of u){const g=es(h.uri.path);if(d!==g&&(d=g,l.push(h.uri)>=Al._maxEventSize))break e}}this._proxy.$onDidChange(i,l)});return new Pe(()=>{n==null||n.dispose(),this._proxy.$unregisterDecorationProvider(i),this._provider.delete(i)})}async $provideDecorations(e,t,i){if(!this._provider.has(e))return Object.create(null);const n=Object.create(null),{provider:s,extensionDescription:o}=this._provider.get(e);return await Promise.all(t.map(async a=>{try{const{uri:c,id:l}=a,u=await Promise.resolve(s.provideFileDecoration(y.revive(c),i));if(!u)return;try{am.validate(u),u.badge&&typeof u.badge!="string"&&M(o,"codiconDecoration"),n[l]=[u.propagate,u.tooltip,u.badge,u.color]}catch(d){this._logService.warn(`INVALID decoration from extension '${o.identifier.value}': ${d}`)}}catch(c){this._logService.error(c)}})),n}},Al=Gs,Gs._handlePool=0,Gs._maxEventSize=250,Gs);Gv=Al=H([N(0,Ve),N(1,Ge)],Gv);const wC=ne("IExtHostDecorations");class VI{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,t){e=wa(e);const i=this.values,n=this.prefixSum,s=t.length;return s===0?!1:(this.values=new Uint32Array(i.length+s),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+s),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=wa(e),t=wa(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=wa(e),t=wa(t);const i=this.values,n=this.prefixSum;if(e>=i.length)return!1;const s=i.length-e;return t>=s&&(t=s),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=wa(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,n=0,s=0,o=0;for(;t<=i;)if(n=t+(i-t)/2|0,s=this.prefixSum[n],o=s-this.values[n],e<o)i=n-1;else if(e>=s)t=n+1;else break;return new zI(n,e-o)}}class zI{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class jI{constructor(e,t,i,n){this._uri=e,this._lines=t,this._eol=i,this._versionId=n,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new ki(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let n=0;n<t;n++)i[n]=this._lines[n].length+e;this._lineStarts=new VI(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=Bb(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const n=new Uint32Array(i.length-1);for(let s=1;s<i.length;s++)this._lines.splice(e.lineNumber+s-1,0,i[s]),n[s-1]=i[s].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}const bC="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function qI(r=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of bC)r.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const GI=qI();function yC(r){let e=GI;if(r&&r instanceof RegExp)if(r.global)e=r;else{let t="g";r.ignoreCase&&(t+="i"),r.multiline&&(t+="m"),r.unicode&&(t+="u"),e=new RegExp(r.source,t)}return e.lastIndex=0,e}const xC=new dc;xC.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function CC(r,e,t,i,n){if(e=yC(e),n||(n=Jr.first(xC)),t.length>n.maxLen){let l=r-n.maxLen/2;return l<0?l=0:i+=l,t=t.substring(l,r+n.maxLen/2),CC(r,e,t,i,n)}const s=Date.now(),o=r-1-i;let a=-1,c=null;for(let l=1;!(Date.now()-s>=n.timeBudget);l++){const u=o-n.windowSize*l;e.lastIndex=Math.max(0,u);const d=QI(e,t,o,a);if(!d&&c||(c=d,u<=0))break;a=u}if(c){const l={word:c[0],startColumn:i+1+c.index,endColumn:i+1+c.index+c[0].length};return e.lastIndex=0,l}return null}function QI(r,e,t,i){let n;for(;n=r.exec(e);){const s=n.index||0;if(s<=t&&r.lastIndex>=t)return n;if(i>0&&s>i)return null}return null}const Qv=new Map;function JI(r,e){e?Qv.set(r,e):Qv.delete(r)}function KI(r){return Qv.get(r)}class XI extends jI{constructor(e,t,i,n,s,o,a){super(t,i,n,s),this._proxy=e,this._languageId=o,this._isDirty=a,this._isDisposed=!1}dispose(){ci(!this._isDisposed),this._isDisposed=!0,this._isDirty=!1}equalLines(e){return er(this._lines,e)}get document(){if(!this._document){const e=this;this._document={get uri(){return e._uri},get fileName(){return e._uri.fsPath},get isUntitled(){return e._uri.scheme===Z.untitled},get languageId(){return e._languageId},get version(){return e._versionId},get isClosed(){return e._isDisposed},get isDirty(){return e._isDirty},save(){return e._save()},getText(t){return t?e._getTextInRange(t):e.getText()},get eol(){return e._eol===`
`?Mi.LF:Mi.CRLF},get lineCount(){return e._lines.length},lineAt(t){return e._lineAt(t)},offsetAt(t){return e._offsetAt(t)},positionAt(t){return e._positionAt(t)},validateRange(t){return e._validateRange(t)},validatePosition(t){return e._validatePosition(t)},getWordRangeAtPosition(t,i){return e._getWordRangeAtPosition(t,i)}}}return Object.freeze(this._document)}_acceptLanguageId(e){ci(!this._isDisposed),this._languageId=e}_acceptIsDirty(e){ci(!this._isDisposed),this._isDirty=e}_save(){return this._isDisposed?Promise.reject(new Error("Document has been closed")):this._proxy.$trySaveDocument(this._uri)}_getTextInRange(e){const t=this._validateRange(e);if(t.isEmpty)return"";if(t.isSingleLine)return this._lines[t.start.line].substring(t.start.character,t.end.character);const i=this._eol,n=t.start.line,s=t.end.line,o=[];o.push(this._lines[n].substring(t.start.character));for(let a=n+1;a<s;a++)o.push(this._lines[a]);return o.push(this._lines[s].substring(0,t.end.character)),o.join(i)}_lineAt(e){let t;if(e instanceof Se?t=e.line:typeof e=="number"&&(t=e),typeof t!="number"||t<0||t>=this._lines.length||Math.floor(t)!==t)throw new Error("Illegal value for `line`");return new YI(t,this._lines[t],t===this._lines.length-1)}_offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.line-1)+e.character}_positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return new Se(t.index,Math.min(t.remainder,i))}_validateRange(e){if(!(e instanceof be))throw new Error("Invalid argument");const t=this._validatePosition(e.start),i=this._validatePosition(e.end);return t===e.start&&i===e.end?e:new be(t.line,t.character,i.line,i.character)}_validatePosition(e){if(!(e instanceof Se))throw new Error("Invalid argument");if(this._lines.length===0)return e.with(0,0);let{line:t,character:i}=e,n=!1;if(t<0)t=0,i=0,n=!0;else if(t>=this._lines.length)t=this._lines.length-1,i=this._lines[t].length,n=!0;else{const s=this._lines[t].length;i<0?(i=0,n=!0):i>s&&(i=s,n=!0)}return n?new Se(t,i):e}_getWordRangeAtPosition(e,t){const i=this._validatePosition(e);if(!t)t=KI(this._languageId);else if(Ub(t))throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${t.source}' because it matches the empty string.`);const n=CC(i.character+1,yC(t),this._lines[i.line],0);if(n)return new be(i.line,n.startColumn-1,i.line,n.endColumn-1)}}class YI{constructor(e,t,i){this._line=e,this._text=t,this._isLastLine=i}get lineNumber(){return this._line}get text(){return this._text}get range(){return new be(this._line,0,this._line,this._text.length)}get rangeIncludingLineBreak(){return this._isLastLine?this.range:new be(this._line,0,this._line+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this._text)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this._text.length}}class Jv{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const Wf=class Wf{constructor(e,t,i){const n=Wf._Keys.nextId();e.$registerTextEditorDecorationType(t.identifier,n,Lm.from(i)),this.value=Object.freeze({key:n,dispose(){e.$removeTextEditorDecorationType(n)}})}};Wf._Keys=new Jv("TextEditorDecorationType");let Kv=Wf;class ZI{constructor(e,t){this._collectedEdits=[],this._setEndOfLine=void 0,this._finalized=!1,this._document=e,this._documentVersionId=e.version,this._undoStopBefore=t.undoStopBefore,this._undoStopAfter=t.undoStopAfter}finalize(){return this._finalized=!0,{documentVersionId:this._documentVersionId,edits:this._collectedEdits,setEndOfLine:this._setEndOfLine,undoStopBefore:this._undoStopBefore,undoStopAfter:this._undoStopAfter}}_throwIfFinalized(){if(this._finalized)throw new Error("Edit is only valid while callback runs")}replace(e,t){this._throwIfFinalized();let i=null;if(e instanceof Se)i=new be(e,e);else if(e instanceof be)i=e;else throw new Error("Unrecognized location");this._pushEdit(i,t,!1)}insert(e,t){this._throwIfFinalized(),this._pushEdit(new be(e,e),t,!0)}delete(e){this._throwIfFinalized();let t=null;if(e instanceof be)t=e;else throw new Error("Unrecognized location");this._pushEdit(t,null,!0)}_pushEdit(e,t,i){const n=this._document.validateRange(e);this._collectedEdits.push({range:n,text:t,forceMoveMarkers:i})}setEndOfLine(e){if(this._throwIfFinalized(),e!==Mi.LF&&e!==Mi.CRLF)throw xe("endOfLine");this._setEndOfLine=e}}class eP{constructor(e,t,i,n){this._proxy=e,this._id=t,this._accept(i),this._logService=n;const s=this;this.value={get tabSize(){return s._tabSize},set tabSize(o){s._setTabSize(o)},get indentSize(){return s._indentSize},set indentSize(o){s._setIndentSize(o)},get insertSpaces(){return s._insertSpaces},set insertSpaces(o){s._setInsertSpaces(o)},get cursorStyle(){return s._cursorStyle},set cursorStyle(o){s._setCursorStyle(o)},get lineNumbers(){return s._lineNumbers},set lineNumbers(o){s._setLineNumbers(o)}}}_accept(e){this._tabSize=e.tabSize,this._indentSize=e.indentSize,this._originalIndentSize=e.originalIndentSize,this._insertSpaces=e.insertSpaces,this._cursorStyle=e.cursorStyle,this._lineNumbers=sa.to(e.lineNumbers)}_validateTabSize(e){if(e==="auto")return"auto";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setTabSize(e){const t=this._validateTabSize(e);if(t!==null){if(typeof t=="number"){if(this._tabSize===t)return;this._tabSize=t}this._warnOnError("setTabSize",this._proxy.$trySetOptions(this._id,{tabSize:t}))}}_validateIndentSize(e){if(e==="tabSize")return"tabSize";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setIndentSize(e){const t=this._validateIndentSize(e);if(t!==null){if(typeof t=="number"){if(this._originalIndentSize===t)return;this._indentSize=t,this._originalIndentSize=t}this._warnOnError("setIndentSize",this._proxy.$trySetOptions(this._id,{indentSize:t}))}}_validateInsertSpaces(e){return e==="auto"?"auto":e==="false"?!1:!!e}_setInsertSpaces(e){const t=this._validateInsertSpaces(e);if(typeof t=="boolean"){if(this._insertSpaces===t)return;this._insertSpaces=t}this._warnOnError("setInsertSpaces",this._proxy.$trySetOptions(this._id,{insertSpaces:t}))}_setCursorStyle(e){this._cursorStyle!==e&&(this._cursorStyle=e,this._warnOnError("setCursorStyle",this._proxy.$trySetOptions(this._id,{cursorStyle:e})))}_setLineNumbers(e){this._lineNumbers!==e&&(this._lineNumbers=e,this._warnOnError("setLineNumbers",this._proxy.$trySetOptions(this._id,{lineNumbers:sa.from(e)})))}assign(e){const t={};let i=!1;if(typeof e.tabSize<"u"){const n=this._validateTabSize(e.tabSize);n==="auto"?(i=!0,t.tabSize=n):typeof n=="number"&&this._tabSize!==n&&(this._tabSize=n,i=!0,t.tabSize=n)}if(typeof e.indentSize<"u"){const n=this._validateIndentSize(e.indentSize);n==="tabSize"?(i=!0,t.indentSize=n):typeof n=="number"&&this._originalIndentSize!==n&&(this._indentSize=n,this._originalIndentSize=n,i=!0,t.indentSize=n)}if(typeof e.insertSpaces<"u"){const n=this._validateInsertSpaces(e.insertSpaces);n==="auto"?(i=!0,t.insertSpaces=n):this._insertSpaces!==n&&(this._insertSpaces=n,i=!0,t.insertSpaces=n)}typeof e.cursorStyle<"u"&&this._cursorStyle!==e.cursorStyle&&(this._cursorStyle=e.cursorStyle,i=!0,t.cursorStyle=e.cursorStyle),typeof e.lineNumbers<"u"&&this._lineNumbers!==e.lineNumbers&&(this._lineNumbers=e.lineNumbers,i=!0,t.lineNumbers=sa.from(e.lineNumbers)),i&&this._warnOnError("setOptions",this._proxy.$trySetOptions(this._id,t))}_warnOnError(e,t){t.catch(i=>{this._logService.warn(`ExtHostTextEditorOptions '${e}' failed:'`),this._logService.warn(i)})}}class tP{constructor(e,t,i,n,s,o,a,c){this.id=e,this._proxy=t,this._logService=i,this._disposed=!1,this._hasDecorationsForKey=new Set,this._selections=s,this._options=new eP(this._proxy,this.id,o,i),this._visibleRanges=a,this._viewColumn=c;const l=this;this.value=Object.freeze({get document(){return n.value},set document(u){throw new Qr("document")},get selection(){return l._selections&&l._selections[0]},set selection(u){if(!(u instanceof kn))throw xe("selection");l._selections=[u],l._trySetSelection()},get selections(){return l._selections},set selections(u){if(!Array.isArray(u)||u.some(d=>!(d instanceof kn)))throw xe("selections");l._selections=u,l._trySetSelection()},get visibleRanges(){return l._visibleRanges},set visibleRanges(u){throw new Qr("visibleRanges")},get options(){return l._options.value},set options(u){l._disposed||l._options.assign(u)},get viewColumn(){return l._viewColumn},set viewColumn(u){throw new Qr("viewColumn")},edit(u,d={undoStopBefore:!0,undoStopAfter:!0}){if(l._disposed)return Promise.reject(new Error("TextEditor#edit not possible on closed editors"));const h=new ZI(n.value,d);return u(h),l._applyEdit(h)},insertSnippet(u,d,h={undoStopBefore:!0,undoStopAfter:!0}){if(l._disposed)return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"));let g;if(!d||Array.isArray(d)&&d.length===0)g=l._selections.map(w=>F.from(w));else if(d instanceof Se){const{lineNumber:w,column:p}=We.from(d);g=[{startLineNumber:w,startColumn:p,endLineNumber:w,endColumn:p}]}else if(d instanceof be)g=[F.from(d)];else{g=[];for(const w of d)if(w instanceof be)g.push(F.from(w));else{const{lineNumber:p,column:b}=We.from(w);g.push({startLineNumber:p,startColumn:b,endLineNumber:p,endColumn:b})}}return t.$tryInsertSnippet(e,n.value.version,u.value,g,h)},setDecorations(u,d){const h=d.length===0;h&&!l._hasDecorationsForKey.has(u.key)||(h?l._hasDecorationsForKey.delete(u.key):l._hasDecorationsForKey.add(u.key),l._runOnProxy(()=>{if(bx(d))return t.$trySetDecorations(e,u.key,h4(d));{const g=new Array(4*d.length);for(let w=0,p=d.length;w<p;w++){const b=d[w];g[4*w]=b.start.line+1,g[4*w+1]=b.start.character+1,g[4*w+2]=b.end.line+1,g[4*w+3]=b.end.character+1}return t.$trySetDecorationsFast(e,u.key,g)}}))},revealRange(u,d){l._runOnProxy(()=>t.$tryRevealRange(e,F.from(u),d||Nd.Default))},show(u){t.$tryShowEditor(e,bt.from(u))},hide(){t.$tryHideEditor(e)}})}dispose(){ci(!this._disposed),this._disposed=!0}_acceptOptions(e){ci(!this._disposed),this._options._accept(e)}_acceptVisibleRanges(e){ci(!this._disposed),this._visibleRanges=e}_acceptViewColumn(e){ci(!this._disposed),this._viewColumn=e}_acceptSelections(e){ci(!this._disposed),this._selections=e}async _trySetSelection(){const e=this._selections.map(Ii.from);return await this._runOnProxy(()=>this._proxy.$trySetSelections(this.id,e)),this.value}_applyEdit(e){const t=e.finalize();if(t.edits.length===0&&!t.setEndOfLine)return Promise.resolve(!0);const i=t.edits.map(s=>s.range);i.sort((s,o)=>s.end.line===o.end.line?s.end.character===o.end.character?s.start.line===o.start.line?s.start.character-o.start.character:s.start.line-o.start.line:s.end.character-o.end.character:s.end.line-o.end.line);for(let s=0,o=i.length-1;s<o;s++){const a=i[s].end;if(i[s+1].start.isBefore(a))return Promise.reject(new Error("Overlapping ranges are not allowed!"))}const n=t.edits.map(s=>({range:F.from(s.range),text:s.text,forceMoveMarkers:s.forceMoveMarkers}));return this._proxy.$tryApplyEdits(this.id,t.documentVersionId,n,{setEndOfLine:typeof t.setEndOfLine=="number"?oa.from(t.setEndOfLine):void 0,undoStopBefore:t.undoStopBefore,undoStopAfter:t.undoStopAfter})}_runOnProxy(e){return this._disposed?(this._logService.warn("TextEditor is closed/disposed"),Promise.resolve(void 0)):e().then(()=>this,t=>(t instanceof Error&&t.name==="DISPOSED"||this._logService.warn(t),null))}}class iP{constructor(e){this.value=e,this._count=0}ref(){this._count++}unref(){return--this._count===0}}let Xv=class{constructor(e,t){this._extHostRpc=e,this._logService=t,this._activeEditorId=null,this._editors=new Map,this._documents=new pt,this._onDidAddDocuments=new T,this._onDidRemoveDocuments=new T,this._onDidChangeVisibleTextEditors=new T,this._onDidChangeActiveTextEditor=new T,this.onDidAddDocuments=this._onDidAddDocuments.event,this.onDidRemoveDocuments=this._onDidRemoveDocuments.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event}$acceptDocumentsAndEditorsDelta(e){this.acceptDocumentsAndEditorsDelta(e)}acceptDocumentsAndEditorsDelta(e){const t=[],i=[],n=[];if(e.removedDocuments)for(const s of e.removedDocuments){const o=y.revive(s),a=this._documents.get(o);a!=null&&a.unref()&&(this._documents.delete(o),t.push(a.value))}if(e.addedDocuments)for(const s of e.addedDocuments){const o=y.revive(s.uri);let a=this._documents.get(o);if(a&&o.scheme!==Z.vscodeNotebookCell&&o.scheme!==Z.vscodeInteractiveInput)throw new Error(`document '${o} already exists!'`);a||(a=new iP(new XI(this._extHostRpc.getProxy(G.MainThreadDocuments),o,s.lines,s.EOL,s.versionId,s.languageId,s.isDirty)),this._documents.set(o,a),i.push(a.value)),a.ref()}if(e.removedEditors)for(const s of e.removedEditors){const o=this._editors.get(s);this._editors.delete(s),o&&n.push(o)}if(e.addedEditors)for(const s of e.addedEditors){const o=y.revive(s.documentUri);ci(this._documents.has(o),`document '${o}' does not exist`),ci(!this._editors.has(s.id),`editor '${s.id}' already exists!`);const a=this._documents.get(o).value,c=new tP(s.id,this._extHostRpc.getProxy(G.MainThreadTextEditors),this._logService,new ut(()=>a.document),s.selections.map(Ii.to),s.options,s.visibleRanges.map(l=>F.to(l)),typeof s.editorPosition=="number"?bt.to(s.editorPosition):void 0);this._editors.set(s.id,c)}e.newActiveEditor!==void 0&&(ci(e.newActiveEditor===null||this._editors.has(e.newActiveEditor),`active editor '${e.newActiveEditor}' does not exist`),this._activeEditorId=e.newActiveEditor),Kr(t),Kr(n),e.removedDocuments&&this._onDidRemoveDocuments.fire(t),e.addedDocuments&&this._onDidAddDocuments.fire(i),(e.removedEditors||e.addedEditors)&&this._onDidChangeVisibleTextEditors.fire(this.allEditors().map(s=>s.value)),e.newActiveEditor!==void 0&&this._onDidChangeActiveTextEditor.fire(this.activeEditor())}getDocument(e){var t;return(t=this._documents.get(e))==null?void 0:t.value}allDocuments(){return Jr.map(this._documents.values(),e=>e.value)}getEditor(e){return this._editors.get(e)}activeEditor(e){if(!this._activeEditorId)return;const t=this._editors.get(this._activeEditorId);return e?t:t==null?void 0:t.value}allEditors(){return[...this._editors.values()]}};Xv=H([N(0,Ve),N(1,Ge)],Xv);const Rl=ne("IExtHostDocumentsAndEditors"),rf=ne("IExtHostApiDeprecationService");let Yv=class{constructor(e,t){this._extHostLogService=t,this._reportedUsages=new Set,this._telemetryShape=e.getProxy(G.MainThreadTelemetry)}report(e,t,i){const n=this.getUsageKey(e,t);this._reportedUsages.has(n)||(this._reportedUsages.add(n),t.isUnderDevelopment&&this._extHostLogService.warn(`[Deprecation Warning] '${e}' is deprecated. ${i}`),this._telemetryShape.$publicLog2("extHostDeprecatedApiUsage",{extensionId:t.identifier.value,apiId:e}))}getUsageKey(e,t){return`${e}-${t.identifier.value}`}};Yv=H([N(0,Ve),N(1,Ge)],Yv);var sf;(function(r){function e(i){if(i!=null)return i}r.from=e;function t(i){if(i!=null)return i}r.to=t})(sf||(sf={}));var of;(function(r){function e(i){if(i!=null)return i}r.from=e;function t(i){if(i!=null)return i}r.to=t})(of||(of={}));var Zv;(function(r){function e(i){if(i!=null)return i}r.from=e;function t(i){if(i!=null)return i}r.to=t})(Zv||(Zv={}));var Ll;(function(r){function e(n){if(n){const s=n;return s&&!!s.process}else return!1}r.is=e;function t(n){if(n==null)return;const s={process:n.process,args:n.args};return n.options&&(s.options=Zv.from(n.options)),s}r.from=t;function i(n){if(n!=null)return new zo(n.process,n.args,n.options)}r.to=i})(Ll||(Ll={}));var e_;(function(r){function e(i){if(i!=null)return i}r.from=e;function t(i){if(i!=null)return i}r.to=t})(e_||(e_={}));var Ol;(function(r){function e(n){if(n){const s=n;return s&&(!!s.commandLine||!!s.command)}else return!1}r.is=e;function t(n){if(n==null)return;const s={};return n.commandLine!==void 0?s.commandLine=n.commandLine:(s.command=n.command,s.args=n.args),n.options&&(s.options=e_.from(n.options)),s}r.from=t;function i(n){if(!(n==null||n.command===void 0&&n.commandLine===void 0))return n.commandLine?new bs(n.commandLine,n.options):new bs(n.command,n.args?n.args:[],n.options)}r.to=i})(Ol||(Ol={}));var Ln;(function(r){function e(n){if(n){const s=n;return s&&s.customExecution==="customExecution"}else return!1}r.is=e;function t(n){return{customExecution:"customExecution"}}r.from=t;function i(n,s){return s.get(n)}r.to=i})(Ln||(Ln={}));var t_;(function(r){function e(t){if(t!=null)return{_id:t.id,isDefault:t.isDefault}}r.from=e})(t_||(t_={}));var Pr;(function(r){function e(n,s){if(n==null)return[];const o=[];for(const a of n){const c=t(a,s);c&&o.push(c)}return o}r.fromMany=e;function t(n,s){if(n==null)return;let o;n.execution instanceof zo?o=Ll.from(n.execution):n.execution instanceof bs?o=Ol.from(n.execution):n.execution&&n.execution instanceof Kg&&(o=Ln.from(n.execution));const a=sf.from(n.definition);let c;return n.scope?typeof n.scope=="number"?c=n.scope:c=n.scope.uri:c=ys.Workspace,!a||!c?void 0:{_id:n._id,definition:a,name:n.name,source:{extensionId:s.identifier.value,label:n.source,scope:c},execution:o,isBackground:n.isBackground,group:t_.from(n.group),presentationOptions:of.from(n.presentationOptions),problemMatchers:n.problemMatchers,hasDefinedMatchers:n.hasDefinedMatchers,runOptions:n.runOptions?n.runOptions:{reevaluateOnRerun:!0},detail:n.detail}}r.from=t;async function i(n,s,o){if(n==null)return;let a;Ll.is(n.execution)?a=Ll.to(n.execution):Ol.is(n.execution)?a=Ol.to(n.execution):Ln.is(n.execution)&&(a=Ln.to(n._id,o));const c=sf.to(n.definition);let l;if(n.source&&(n.source.scope!==void 0?typeof n.source.scope=="number"?l=n.source.scope:l=await s.resolveWorkspaceFolder(y.revive(n.source.scope)):l=ys.Workspace),!c||!l)return;const u=new Ud(c,l,n.name,n.source.label,a,n.problemMatchers);return n.isBackground!==void 0&&(u.isBackground=n.isBackground),n.group!==void 0&&(u.group=Kc.from(n.group._id),u.group&&n.group.isDefault&&(u.group=new Kc(u.group.id,u.group.label),n.group.isDefault===!0&&(u.group.isDefault=n.group.isDefault))),n.presentationOptions&&(u.presentationOptions=of.to(n.presentationOptions)),n._id&&(u._id=n._id),n.detail&&(u.detail=n.detail),u}r.to=i})(Pr||(Pr={}));var i_;(function(r){function e(i){return i}r.from=e;function t(i){if(i)return Object.assign(Object.create(null),i)}r.to=t})(i_||(i_={}));class n_{constructor(e,t,i){ae(this,au,void 0);this._id=t,this._task=i,K(this,au,e)}get task(){return this._task}terminate(){I(this,au).terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}}au=new WeakMap;let r_=class{constructor(e,t,i,n,s,o,a,c){this._onDidExecuteTask=new T,this._onDidTerminateTask=new T,this._onDidTaskProcessStarted=new T,this._onDidTaskProcessEnded=new T,this._proxy=e.getProxy(G.MainThreadTask),this._workspaceProvider=i,this._editorService=n,this._configurationService=s,this._terminalService=o,this._handleCounter=0,this._handlers=new Map,this._taskExecutions=new Map,this._taskExecutionPromises=new Map,this._providedCustomExecutions2=new Map,this._notProvidedCustomExecutions=new Set,this._activeCustomExecutions2=new Map,this._logService=a,this._deprecationService=c,this._proxy.$registerSupportedExecutions(!0)}registerTaskProvider(e,t,i){if(!i)return new Pe(()=>{});const n=this.nextHandle();return this._handlers.set(n,{type:t,provider:i,extension:e}),this._proxy.$registerTaskProvider(n,t),new Pe(()=>{this._handlers.delete(n),this._proxy.$unregisterTaskProvider(n)})}registerTaskSystem(e,t){this._proxy.$registerTaskSystem(e,t)}fetchTasks(e){return this._proxy.$fetchTasks(i_.from(e)).then(async t=>{const i=[];for(const n of t){const s=await Pr.to(n,this._workspaceProvider,this._providedCustomExecutions2);s&&i.push(s)}return i})}get taskExecutions(){const e=[];return this._taskExecutions.forEach(t=>e.push(t)),e}terminateTask(e){if(!(e instanceof n_))throw new Error("No valid task execution provided");return this._proxy.$terminateTask(e._id)}get onDidStartTask(){return this._onDidExecuteTask.event}async $onDidStartTask(e,t,i){const n=this._providedCustomExecutions2.get(e.id);n&&(this._activeCustomExecutions2.set(e.id,n),this._terminalService.attachPtyToTerminal(t,await n.callback(i))),this._lastStartedTask=e.id,this._onDidExecuteTask.fire({execution:await this.getTaskExecution(e)})}get onDidEndTask(){return this._onDidTerminateTask.event}async $OnDidEndTask(e){if(!this._taskExecutionPromises.has(e.id))return;const t=await this.getTaskExecution(e);this._taskExecutionPromises.delete(e.id),this._taskExecutions.delete(e.id),this.customExecutionComplete(e),this._onDidTerminateTask.fire({execution:t})}get onDidStartTaskProcess(){return this._onDidTaskProcessStarted.event}async $onDidStartTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessStarted.fire({execution:t,processId:e.processId})}get onDidEndTaskProcess(){return this._onDidTaskProcessEnded.event}async $onDidEndTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessEnded.fire({execution:t,exitCode:e.exitCode})}$provideTasks(e,t){const i=this._handlers.get(e);if(!i)return Promise.reject(new Error("no handler found"));const n=[],s=Mt(()=>i.provider.provideTasks(It.None)).then(o=>this.provideTasksInternal(t,n,i,o));return new Promise(o=>{s.then(a=>{Promise.all(n).then(()=>{o(a)})})})}async $resolveTask(e,t){const i=this._handlers.get(e);if(!i)return Promise.reject(new Error("no handler found"));if(t.definition.type!==i.type)throw new Error(`Unexpected: Task of type [${t.definition.type}] cannot be resolved by provider of type [${i.type}].`);const n=await Pr.to(t,this._workspaceProvider,this._providedCustomExecutions2);if(!n)throw new Error("Unexpected: Task cannot be resolved.");const s=await i.provider.resolveTask(n,It.None);if(!s)return;this.checkDeprecation(s,i);const o=Pr.from(s,i.extension);if(!o)throw new Error("Unexpected: Task cannot be resolved.");if(s.definition!==n.definition)throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.");return Ln.is(o.execution)&&await this.addCustomExecution(o,s,!0),await this.resolveTaskInternal(o)}nextHandle(){return this._handleCounter++}async addCustomExecution(e,t,i){const n=await this._proxy.$createTaskId(e);!i&&!this._providedCustomExecutions2.has(n)&&(this._notProvidedCustomExecutions.add(n),this._activeCustomExecutions2.set(n,t.execution)),this._providedCustomExecutions2.set(n,t.execution)}async getTaskExecution(e,t){if(typeof e=="string"){const s=this._taskExecutionPromises.get(e);if(!s)throw new Zn("Unexpected: The specified task is missing an execution");return s}const i=this._taskExecutionPromises.get(e.id);if(i)return i;let n;return t?n=Promise.resolve(new n_(this,e.id,t)):n=Pr.to(e.task,this._workspaceProvider,this._providedCustomExecutions2).then(s=>{if(!s)throw new Zn("Unexpected: Task does not exist.");return new n_(this,e.id,s)}),this._taskExecutionPromises.set(e.id,n),n.then(s=>(this._taskExecutions.set(e.id,s),s))}checkDeprecation(e,t){e._deprecated&&this._deprecationService.report("Task.constructor",t.extension,"Use the Task constructor that takes a `scope` instead.")}customExecutionComplete(e){this._activeCustomExecutions2.get(e.id)&&this._activeCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.has(e.id)&&this._lastStartedTask!==e.id&&(this._providedCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.delete(e.id));const i=this._notProvidedCustomExecutions.values();let n=i.next();for(;!n.done;)!this._activeCustomExecutions2.has(n.value)&&this._lastStartedTask!==n.value&&(this._providedCustomExecutions2.delete(n.value),this._notProvidedCustomExecutions.delete(n.value)),n=i.next()}};r_=H([N(0,Ve),N(1,Ut),N(2,An),N(3,Rl),N(4,Rn),N(5,Dl),N(6,Ge),N(7,rf)],r_);let s_=class extends r_{constructor(e,t,i,n,s,o,a,c){super(e,t,i,n,s,o,a,c),this.registerTaskSystem(Z.vscodeRemote,{scheme:Z.vscodeRemote,authority:"",platform:NS(0)})}async executeTask(e,t){if(!t.execution)throw new Error("Tasks to execute must include an execution");const i=Pr.from(t,e);if(i===void 0)throw new Error("Task is not valid");if(Ln.is(i.execution))await this.addCustomExecution(i,t,!1);else throw new _p;const n=await this.getTaskExecution(await this._proxy.$getTaskExecution(i),t);return this._proxy.$executeTask(i).catch(s=>{throw new Error(s)}),n}provideTasksInternal(e,t,i,n){const s=[];if(n)for(const o of n){if(this.checkDeprecation(o,i),!o.definition||!e[o.definition.type]){const c=o.source?o.source:"No task source";this._logService.warn(`The task [${c}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`)}const a=Pr.from(o,i.extension);a&&Ln.is(a.execution)?(s.push(a),t.push(this.addCustomExecution(a,o,!0))):this._logService.warn("Only custom execution tasks supported.")}return{tasks:s,extension:i.extension}}async resolveTaskInternal(e){if(Ln.is(e.execution))return e;this._logService.warn("Only custom execution tasks supported.")}async $resolveVariables(e,t){return{process:void 0,variables:Object.create(null)}}async $jsonTasksSupported(){return!1}async $findExecutable(e,t,i){}};s_=H([N(0,Ve),N(1,Ut),N(2,An),N(3,Rl),N(4,Rn),N(5,Dl),N(6,Ge),N(7,rf)],s_);const SC=ne("IExtHostTask"),$l=ne("IExtHostEditorTabs");class EC{constructor(e,t,i){this._activeTabIdGetter=i,this._parentGroup=t,this.acceptDtoUpdate(e)}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.id===e._activeTabIdGetter()},get label(){return e._dto.label},get input(){return e._input},get isDirty(){return e._dto.isDirty},get isPinned(){return e._dto.isPinned},get isPreview(){return e._dto.isPreview},get group(){return e._parentGroup.apiObject}};this._apiObject=Object.freeze(t)}return this._apiObject}get tabId(){return this._dto.id}acceptDtoUpdate(e){this._dto=e,this._input=this._initInput()}_initInput(){switch(this._dto.input.kind){case 1:return new vm(y.revive(this._dto.input.uri));case 2:return new _m(y.revive(this._dto.input.original),y.revive(this._dto.input.modified));case 3:return new fx(y.revive(this._dto.input.base),y.revive(this._dto.input.input1),y.revive(this._dto.input.input2),y.revive(this._dto.input.result));case 6:return new wm(y.revive(this._dto.input.uri),this._dto.input.viewType);case 7:return new px(this._dto.input.viewType);case 4:return new bm(y.revive(this._dto.input.uri),this._dto.input.notebookType);case 5:return new ym(y.revive(this._dto.input.original),y.revive(this._dto.input.modified),this._dto.input.notebookType);case 8:return new gx;case 9:return new mx(y.revive(this._dto.input.uri),y.revive(this._dto.input.inputBoxUri));case 10:return new vx(this._dto.input.providerId);default:return}}}class nP{constructor(e,t){this._tabs=[],this._activeTabId="",this._dto=e,this._activeGroupIdGetter=t;for(const i of e.tabs)i.isActive&&(this._activeTabId=i.id),this._tabs.push(new EC(i,this,()=>this.activeTabId()))}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.groupId===e._activeGroupIdGetter()},get viewColumn(){return bt.to(e._dto.viewColumn)},get activeTab(){var i;return(i=e._tabs.find(n=>n.tabId===e._activeTabId))==null?void 0:i.apiObject},get tabs(){return Object.freeze(e._tabs.map(i=>i.apiObject))}};this._apiObject=Object.freeze(t)}return this._apiObject}get groupId(){return this._dto.groupId}get tabs(){return this._tabs}acceptGroupDtoUpdate(e){this._dto=e}acceptTabOperation(e){if(e.kind===0){const i=new EC(e.tabDto,this,()=>this.activeTabId());return this._tabs.splice(e.index,0,i),e.tabDto.isActive&&(this._activeTabId=i.tabId),i}else if(e.kind===1){const i=this._tabs.splice(e.index,1)[0];if(!i)throw new Error(`Tab close updated received for index ${e.index} which does not exist`);return i.tabId===this._activeTabId&&(this._activeTabId=""),i}else if(e.kind===3){if(e.oldIndex===void 0)throw new Error("Invalid old index on move IPC");const i=this._tabs.splice(e.oldIndex,1)[0];if(!i)throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`);return this._tabs.splice(e.index,0,i),i}const t=this._tabs.find(i=>i.tabId===e.tabDto.id);if(!t)throw new Error("INVALID tab");return e.tabDto.isActive?this._activeTabId=e.tabDto.id:this._activeTabId===e.tabDto.id&&!e.tabDto.isActive&&(this._activeTabId=""),t.acceptDtoUpdate(e.tabDto),t}activeTabId(){return this._activeTabId}}let o_=class{constructor(e){this._onDidChangeTabs=new T,this._onDidChangeTabGroups=new T,this._extHostTabGroups=[],this._proxy=e.getProxy(G.MainThreadEditorTabs)}get tabGroups(){if(!this._apiObject){const e=this,t={onDidChangeTabGroups:e._onDidChangeTabGroups.event,onDidChangeTabs:e._onDidChangeTabs.event,get all(){return Object.freeze(e._extHostTabGroups.map(i=>i.apiObject))},get activeTabGroup(){var s;const i=e._activeGroupId;return yo((s=e._extHostTabGroups.find(o=>o.groupId===i))==null?void 0:s.apiObject)},close:async(i,n)=>{const s=Array.isArray(i)?i:[i];return s.length?rP(s[0])?this._closeGroups(s,n):this._closeTabs(s,n):!0}};this._apiObject=Object.freeze(t)}return this._apiObject}$acceptEditorTabModel(e){var l;const t=new Set(this._extHostTabGroups.map(u=>u.groupId)),i=new Set(e.map(u=>u.groupId)),n=rS(t,i),s=this._extHostTabGroups.filter(u=>n.removed.includes(u.groupId)).map(u=>u.apiObject),o=[],a=[];this._extHostTabGroups=e.map(u=>{const d=new nP(u,()=>this._activeGroupId);return n.added.includes(d.groupId)?o.push(d.apiObject):a.push(d.apiObject),d});const c=yo((l=e.find(u=>u.isActive===!0))==null?void 0:l.groupId);c!==void 0&&this._activeGroupId!==c&&(this._activeGroupId=c),this._onDidChangeTabGroups.fire(Object.freeze({opened:o,closed:s,changed:a}))}$acceptTabGroupUpdate(e){const t=this._extHostTabGroups.find(i=>i.groupId===e.groupId);if(!t)throw new Error("Update Group IPC call received before group creation.");t.acceptGroupDtoUpdate(e),e.isActive&&(this._activeGroupId=e.groupId),this._onDidChangeTabGroups.fire(Object.freeze({changed:[t.apiObject],opened:[],closed:[]}))}$acceptTabOperation(e){const t=this._extHostTabGroups.find(n=>n.groupId===e.groupId);if(!t)throw new Error("Update Tabs IPC call received before group creation.");const i=t.acceptTabOperation(e);switch(e.kind){case 0:this._onDidChangeTabs.fire(Object.freeze({opened:[i.apiObject],closed:[],changed:[]}));return;case 1:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[i.apiObject],changed:[]}));return;case 3:case 2:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[],changed:[i.apiObject]}));return}}_findExtHostTabFromApi(e){for(const t of this._extHostTabGroups)for(const i of t.tabs)if(i.apiObject===e)return i}_findExtHostTabGroupFromApi(e){return this._extHostTabGroups.find(t=>t.apiObject===e)}async _closeTabs(e,t){const i=[];for(const n of e){const s=this._findExtHostTabFromApi(n);if(!s)throw new Error("Tab close: Invalid tab not found!");i.push(s.tabId)}return this._proxy.$closeTab(i,t)}async _closeGroups(e,t){const i=[];for(const n of e){const s=this._findExtHostTabGroupFromApi(n);if(!s)throw new Error("Group close: Invalid group not found!");i.push(s.groupId)}return this._proxy.$closeGroup(i,t)}};o_=H([N(0,Ve)],o_);function rP(r){return r.tabs!==void 0}class sP{constructor(){this.pendingRequests=new Map,this.queue=[],this._onError=new T,this._onExit=new T,this.sequence=1}get onError(){return this._onError.event}get onExit(){return this._onExit.event}onMessage(e){this.messageCallback&&this._onError.fire(new Error("attempt to set more than one 'Message' callback")),this.messageCallback=e}onEvent(e){this.eventCallback&&this._onError.fire(new Error("attempt to set more than one 'Event' callback")),this.eventCallback=e}onRequest(e){this.requestCallback&&this._onError.fire(new Error("attempt to set more than one 'Request' callback")),this.requestCallback=e}sendResponse(e){e.seq>0?this._onError.fire(new Error(`attempt to send more than one response for command ${e.command}`)):this.internalSend("response",e)}sendRequest(e,t,i,n){const s={command:e};if(t&&Object.keys(t).length>0&&(s.arguments=t),this.internalSend("request",s),typeof n=="number"){const o=setTimeout(()=>{clearTimeout(o);const a=this.pendingRequests.get(s.seq);if(a){this.pendingRequests.delete(s.seq);const c={type:"response",seq:0,request_seq:s.seq,success:!1,command:e,message:m("vs/workbench/contrib/debug/common/abstractDebugAdapter","timeout","Timeout after {0} ms for '{1}'",n,e)};a(c)}},n)}return i&&this.pendingRequests.set(s.seq,i),s.seq}acceptMessage(e){this.messageCallback?this.messageCallback(e):(this.queue.push(e),this.queue.length===1&&this.processQueue())}needsTaskBoundaryBetween(e,t){return e.type!=="event"||t.type!=="event"}async processQueue(){var t,i;let e;for(;this.queue.length;){if((!e||this.needsTaskBoundaryBetween(this.queue[0],e))&&await lr(0),e=this.queue.shift(),!e)return;switch(e.type){case"event":(t=this.eventCallback)==null||t.call(this,e);break;case"request":(i=this.requestCallback)==null||i.call(this,e);break;case"response":{const n=e,s=this.pendingRequests.get(n.request_seq);s&&(this.pendingRequests.delete(n.request_seq),s(n));break}}}}internalSend(e,t){t.type=e,t.seq=this.sequence++,this.sendMessage(t)}async cancelPendingRequests(){if(this.pendingRequests.size===0)return Promise.resolve();const e=new Map;this.pendingRequests.forEach((t,i)=>e.set(i,t)),await lr(500),e.forEach((t,i)=>{t({type:"response",seq:0,request_seq:i,success:!1,command:"canceled",message:"canceled"}),this.pendingRequests.delete(i)})}getPendingRequestIds(){return Array.from(this.pendingRequests.keys())}dispose(){this.queue=[]}}function oP(r){return r.type&&(r.label||r.program||r.runtime)}const aP=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function cP(r){return!!(r&&r.match(aP))}function kC(r){if(typeof r.path=="string"&&!(typeof r.sourceReference=="number"&&r.sourceReference>0)){if(cP(r.path))return y.parse(r.path);if(Lp(r.path))return y.file(r.path)}return r.path}function DC(r){if(typeof r.path=="object"){const e=y.revive(r.path);if(e)return e.scheme===Z.file?e.fsPath:e.toString()}return r.path}function lP(r,e){const t=e?kC:DC,i=ht(r);return IC(i,(n,s)=>{n&&s&&(s.path=t(s))}),i}function uP(r,e){const t=e?kC:DC,i=ht(r);return IC(i,(n,s)=>{!n&&s&&(s.path=t(s))}),i}function IC(r,e){var t;switch(r.type){case"event":{const i=r;switch(i.event){case"output":e(!1,i.body.source);break;case"loadedSource":e(!1,i.body.source);break;case"breakpoint":e(!1,i.body.breakpoint.source);break}break}case"request":{const i=r;switch(i.command){case"setBreakpoints":e(!0,i.arguments.source);break;case"breakpointLocations":e(!0,i.arguments.source);break;case"source":e(!0,i.arguments.source);break;case"gotoTargets":e(!0,i.arguments.source);break;case"launchVSCode":i.arguments.args.forEach(n=>e(!1,n));break}break}case"response":{const i=r;if(i.success&&i.body)switch(i.command){case"stackTrace":i.body.stackFrames.forEach(n=>e(!1,n.source));break;case"loadedSources":i.body.sources.forEach(n=>e(!1,n));break;case"scopes":i.body.scopes.forEach(n=>e(!1,n.source));break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(n=>e(!1,n.source));break;case"setBreakpoints":i.body.breakpoints.forEach(n=>e(!1,n.source));break;case"disassemble":(t=i.body)==null||t.instructions.forEach(s=>e(!1,s.location));break}break}}}ne("configurationResolverService");var Qe;(function(r){r.Unknown="unknown",r.Env="env",r.Config="config",r.Command="command",r.Input="input",r.ExtensionInstallFolder="extensionInstallFolder",r.WorkspaceFolder="workspaceFolder",r.Cwd="cwd",r.WorkspaceFolderBasename="workspaceFolderBasename",r.UserHome="userHome",r.LineNumber="lineNumber",r.SelectedText="selectedText",r.File="file",r.FileWorkspaceFolder="fileWorkspaceFolder",r.FileWorkspaceFolderBasename="fileWorkspaceFolderBasename",r.RelativeFile="relativeFile",r.RelativeFileDirname="relativeFileDirname",r.FileDirname="fileDirname",r.FileExtname="fileExtname",r.FileBasename="fileBasename",r.FileBasenameNoExtension="fileBasenameNoExtension",r.FileDirnameBasename="fileDirnameBasename",r.ExecPath="execPath",r.ExecInstallFolder="execInstallFolder",r.PathSeparator="pathSeparator",r.PathSeparatorAlias="/"})(Qe||(Qe={}));class ii extends Error{constructor(e,t){super(t),this.variable=e}}const Qs=class Qs{constructor(e,t,i,n){this._contributedVariables=new Map,this._context=e,this._labelService=t,this._userHomePromise=i,n&&(this._envVariablesPromise=n.then(s=>this.prepareEnv(s)))}prepareEnv(e){if(si){const t=Object.create(null);return Object.keys(e).forEach(i=>{t[i.toLowerCase()]=e[i]}),t}return e}resolveWithEnvironment(e,t,i){return this.recursiveResolve({env:this.prepareEnv(e),userHome:void 0},t?t.uri:void 0,i)}async resolveAsync(e,t){const i={env:await this._envVariablesPromise,userHome:await this._userHomePromise};return this.recursiveResolve(i,e?e.uri:void 0,t)}async resolveAnyBase(e,t,i,n){const s=ht(t);si&&s.windows?Object.keys(s.windows).forEach(a=>s[a]=s.windows[a]):Ai&&s.osx?Object.keys(s.osx).forEach(a=>s[a]=s.osx[a]):tr&&s.linux&&Object.keys(s.linux).forEach(a=>s[a]=s.linux[a]),delete s.windows,delete s.osx,delete s.linux;const o={env:await this._envVariablesPromise,userHome:await this._userHomePromise};return this.recursiveResolve(o,e?e.uri:void 0,s,i,n)}async resolveAnyAsync(e,t,i){return this.resolveAnyBase(e,t,i)}async resolveAnyMap(e,t,i){const n=new Map;return{newConfig:await this.resolveAnyBase(e,t,i,n),resolvedVariables:n}}resolveWithInteractionReplace(e,t,i,n){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,t,i,n){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,t){if(this._contributedVariables.has(e))throw new Error("Variable "+e+" is contributed twice.");this._contributedVariables.set(e,t)}async recursiveResolve(e,t,i,n,s){if(Ne(i))return this.resolveString(e,t,i,n,s);if(Array.isArray(i))return Promise.all(i.map(o=>this.recursiveResolve(e,t,o,n,s)));if(Ft(i)){const o=Object.create(null),a=await Promise.all(Object.keys(i).map(async c=>[await this.resolveString(e,t,c,n,s),await this.recursiveResolve(e,t,i[c],n,s)]));for(const[c,l]of a)o[c]=l;return o}return i}resolveString(e,t,i,n,s){return hE(i,Qs.VARIABLE_REGEXP,async(o,a)=>{if(a.includes(Qs.VARIABLE_LHS))return o;let c=await this.evaluateSingleVariable(e,o,a,t,n);return s==null||s.set(a,c),c!==o&&Ne(c)&&c.match(Qs.VARIABLE_REGEXP)&&(c=await this.resolveString(e,t,c,n,s)),c})}fsPath(e){return this._labelService?this._labelService.getUriLabel(e,{noPrefix:!0}):e.fsPath}async evaluateSingleVariable(e,t,i,n,s){let o;const a=i.split(":");a.length>1&&(i=a[0],o=a[1]);const c=d=>{const h=this._context.getFilePath();if(h)return Il(h);throw new ii(d,m("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveFile","Variable {0} can not be resolved. Please open an editor.",t))},l=d=>{const h=c(d);if(this._context.getWorkspaceFolderPathForFile){const g=this._context.getWorkspaceFolderPathForFile();if(g)return Il(g)}throw new ii(d,m("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveFolderForFile","Variable {0}: can not find workspace folder of '{1}'.",t,ai(h)))},u=d=>{if(o){const h=this._context.getFolderUri(o);if(h)return h;throw new ii(d,m("vs/workbench/services/configurationResolver/common/variableResolver","canNotFindFolder","Variable {0} can not be resolved. No such folder '{1}'.",t,o))}if(n)return n;throw this._context.getWorkspaceFolderCount()>1?new ii(d,m("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveWorkspaceFolderMultiRoot","Variable {0} can not be resolved in a multi folder workspace. Scope this variable using ':' and a workspace folder name.",t)):new ii(d,m("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveWorkspaceFolder","Variable {0} can not be resolved. Please open a folder.",t))};switch(i){case"env":if(o){if(e.env){const d=e.env[si?o.toLowerCase():o];if(Ne(d))return d}return""}throw new ii(Qe.Env,m("vs/workbench/services/configurationResolver/common/variableResolver","missingEnvVarName","Variable {0} can not be resolved because no environment variable name is given.",t));case"config":if(o){const d=this._context.getConfigurationValue(n,o);if(jt(d))throw new ii(Qe.Config,m("vs/workbench/services/configurationResolver/common/variableResolver","configNotFound","Variable {0} can not be resolved because setting '{1}' not found.",t,o));if(Ft(d))throw new ii(Qe.Config,m("vs/workbench/services/configurationResolver/common/variableResolver","configNoString","Variable {0} can not be resolved because '{1}' is a structured value.",t,o));return d}throw new ii(Qe.Config,m("vs/workbench/services/configurationResolver/common/variableResolver","missingConfigName","Variable {0} can not be resolved because no settings name is given.",t));case"command":return this.resolveFromMap(Qe.Command,t,o,s,"command");case"input":return this.resolveFromMap(Qe.Input,t,o,s,"input");case"extensionInstallFolder":if(o){const d=await this._context.getExtension(o);if(!d)throw new ii(Qe.ExtensionInstallFolder,m("vs/workbench/services/configurationResolver/common/variableResolver","extensionNotInstalled","Variable {0} can not be resolved because the extension {1} is not installed.",t,o));return this.fsPath(d.extensionLocation)}throw new ii(Qe.ExtensionInstallFolder,m("vs/workbench/services/configurationResolver/common/variableResolver","missingExtensionName","Variable {0} can not be resolved because no extension name is given.",t));default:switch(i){case"workspaceRoot":case"workspaceFolder":return Il(this.fsPath(u(Qe.WorkspaceFolder)));case"cwd":return n||o?Il(this.fsPath(u(Qe.Cwd))):mo();case"workspaceRootFolderName":case"workspaceFolderBasename":return Il(ai(this.fsPath(u(Qe.WorkspaceFolderBasename))));case"userHome":{if(e.userHome)return e.userHome;throw new ii(Qe.UserHome,m("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveUserHome","Variable {0} can not be resolved. UserHome path is not defined",t))}case"lineNumber":{const d=this._context.getLineNumber();if(d)return d;throw new ii(Qe.LineNumber,m("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveLineNumber","Variable {0} can not be resolved. Make sure to have a line selected in the active editor.",t))}case"selectedText":{const d=this._context.getSelectedText();if(d)return d;throw new ii(Qe.SelectedText,m("vs/workbench/services/configurationResolver/common/variableResolver","canNotResolveSelectedText","Variable {0} can not be resolved. Make sure to have some text selected in the active editor.",t))}case"file":return c(Qe.File);case"fileWorkspaceFolder":return l(Qe.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return ai(l(Qe.FileWorkspaceFolderBasename));case"relativeFile":return n||o?gc(this.fsPath(u(Qe.RelativeFile)),c(Qe.RelativeFile)):c(Qe.RelativeFile);case"relativeFileDirname":{const d=es(c(Qe.RelativeFileDirname));if(n||o){const h=gc(this.fsPath(u(Qe.RelativeFileDirname)),d);return h.length===0?".":h}return d}case"fileDirname":return es(c(Qe.FileDirname));case"fileExtname":return Op(c(Qe.FileExtname));case"fileBasename":return ai(c(Qe.FileBasename));case"fileBasenameNoExtension":{const d=ai(c(Qe.FileBasenameNoExtension));return d.slice(0,d.length-Op(d).length)}case"fileDirnameBasename":return ai(es(c(Qe.FileDirnameBasename)));case"execPath":{const d=this._context.getExecPath();return d||t}case"execInstallFolder":{const d=this._context.getAppRoot();return d||t}case"pathSeparator":case"/":return Ri;default:try{const d=o?`${i}:${o}`:i;return this.resolveFromMap(Qe.Unknown,t,d,s,void 0)}catch{return t}}}}resolveFromMap(e,t,i,n,s){if(i&&n){const o=s===void 0?n[i]:n[s+":"+i];if(typeof o=="string")return o;throw new ii(e,m("vs/workbench/services/configurationResolver/common/variableResolver","noValueForCommand","Variable {0} can not be resolved because the command has no value.",t))}return t}};Qs.VARIABLE_LHS="${",Qs.VARIABLE_REGEXP=/\$\{(.*?)\}/g;let a_=Qs;const c_=ne("IExtHostVariableResolverProvider");class dP extends a_{constructor(e,t,i,n,s,o,a){function c(){var l;if(i){const u=i.activeEditor();if(u)return u.document.uri;const d=(l=n.tabGroups.all.find(h=>h.isActive))==null?void 0:l.activeTab;if(d!==void 0){if(d.input instanceof _m||d.input instanceof ym)return d.input.modified;if(d.input instanceof vm||d.input instanceof bm||d.input instanceof wm)return d.input.uri}}}super({getFolderUri:l=>{const u=o.folders.filter(d=>d.name===l);if(u&&u.length>0)return u[0].uri},getWorkspaceFolderCount:()=>o.folders.length,getConfigurationValue:(l,u)=>s.getConfiguration(void 0,l).get(u),getAppRoot:()=>mo(),getExecPath:()=>Ap.VSCODE_EXEC_PATH,getFilePath:()=>{const l=c();if(l)return vo(l.fsPath)},getWorkspaceFolderPathForFile:()=>{if(t){const l=c();if(l){const u=t.getWorkspaceFolder(l);if(u)return vo(u.uri.fsPath)}}},getSelectedText:()=>{if(i){const l=i.activeEditor();if(l&&!l.selection.isEmpty)return l.document.getText(l.selection)}},getLineNumber:()=>{if(i){const l=i.activeEditor();if(l)return String(l.selection.end.line+1)}},getExtension:l=>e.getExtension(l)},void 0,a?Promise.resolve(a):void 0,Promise.resolve(Ap))}}let l_=class extends Be{constructor(e,t,i,n,s){super(),this.extensionService=e,this.workspaceService=t,this.editorService=i,this.configurationService=n,this.editorTabs=s,this._resolver=new ut(async()=>{const o=await this.configurationService.getConfigProvider(),c={folders:await this.workspaceService.getWorkspaceFolders2()||[]};return this._register(this.workspaceService.onDidChangeWorkspace(async l=>{c.folders=await this.workspaceService.getWorkspaceFolders2()||[]})),new dP(this.extensionService,this.workspaceService,this.editorService,this.editorTabs,o,c,this.homeDir())})}getResolver(){return this._resolver.value}homeDir(){}};l_=H([N(0,Ir),N(1,An),N(2,Rl),N(3,Rn),N(4,$l)],l_);const PC=ne("IExtHostDebugService");let u_=class{get onDidStartDebugSession(){return this._onDidStartDebugSession.event}get onDidTerminateDebugSession(){return this._onDidTerminateDebugSession.event}get onDidChangeActiveDebugSession(){return this._onDidChangeActiveDebugSession.event}get activeDebugSession(){var e;return(e=this._activeDebugSession)==null?void 0:e.api}get onDidReceiveDebugSessionCustomEvent(){return this._onDidReceiveDebugSessionCustomEvent.event}get activeDebugConsole(){return this._activeDebugConsole.value}constructor(e,t,i,n,s,o,a){this._workspaceService=t,this._extensionService=i,this._configurationService=n,this._editorTabs=s,this._variableResolver=o,this._commands=a,this._debugSessions=new Map,this._debugVisualizationTreeItemIdsCounter=0,this._debugVisualizationProviders=new Map,this._debugVisualizationTrees=new Map,this._debugVisualizationTreeItemIds=new WeakMap,this._debugVisualizationElements=new Map,this._visualizers=new Map,this._visualizerIdCounter=0,this._configProviderHandleCounter=0,this._configProviders=[],this._adapterFactoryHandleCounter=0,this._adapterFactories=[],this._trackerFactoryHandleCounter=0,this._trackerFactories=[],this._debugAdapters=new Map,this._debugAdaptersTrackers=new Map,this._onDidStartDebugSession=new T,this._onDidTerminateDebugSession=new T,this._onDidChangeActiveDebugSession=new T,this._onDidReceiveDebugSessionCustomEvent=new T,this._debugServiceProxy=e.getProxy(G.MainThreadDebugService),this._onDidChangeBreakpoints=new T,this._onDidChangeStackFrameFocus=new T,this._activeDebugConsole=new fP(this._debugServiceProxy),this._breakpoints=new Map,this._extensionService.getExtensionRegistry().then(c=>{c.onDidChange(l=>{this.registerAllDebugTypes(c)}),this.registerAllDebugTypes(c)})}async $getVisualizerTreeItem(e,t){var s,o;const i=this.hydrateVisualizationContext(t);if(!i)return;const n=await((o=(s=this._debugVisualizationTrees.get(e))==null?void 0:s.getTreeItem)==null?void 0:o.call(s,i));return n?this.convertVisualizerTreeItem(e,n):void 0}registerDebugVisualizationTree(e,t,i){const n=Xe.toKey(e.identifier),s=this.extensionVisKey(n,t);if(this._debugVisualizationProviders.has(s))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationTrees.set(s,i),this._debugServiceProxy.$registerDebugVisualizerTree(s,!!i.editItem),Le(()=>{this._debugServiceProxy.$unregisterDebugVisualizerTree(s),this._debugVisualizationTrees.delete(t)})}async $getVisualizerTreeItemChildren(e,t){var s,o,a;const i=(s=this._debugVisualizationElements.get(t))==null?void 0:s.item;if(!i)return[];const n=await((a=(o=this._debugVisualizationTrees.get(e))==null?void 0:o.getChildren)==null?void 0:a.call(o,i));return(n==null?void 0:n.map(c=>this.convertVisualizerTreeItem(e,c)))||[]}async $editVisualizerTreeItem(e,t){var s,o;const i=this._debugVisualizationElements.get(e);if(!i)return;const n=await((o=(s=this._debugVisualizationTrees.get(i.provider))==null?void 0:s.editItem)==null?void 0:o.call(s,i.item,t));return this.convertVisualizerTreeItem(i.provider,n||i.item)}$disposeVisualizedTree(e){var n;const t=this._debugVisualizationElements.get(e);if(!t)return;const i=[t.children];for(const s of i)if(s)for(const o of s)i.push((n=this._debugVisualizationElements.get(o))==null?void 0:n.children),this._debugVisualizationElements.delete(o)}convertVisualizerTreeItem(e,t){let i=this._debugVisualizationTreeItemIds.get(t);return i||(i=this._debugVisualizationTreeItemIdsCounter++,this._debugVisualizationTreeItemIds.set(t,i),this._debugVisualizationElements.set(i,{provider:e,item:t})),rv.from(t,i)}asDebugSourceUri(e,t){const i=e;if(typeof i.sourceReference=="number"&&i.sourceReference>0){let n=`debug:${encodeURIComponent(i.path||"")}`,s="?";return t&&(n+=`${s}session=${encodeURIComponent(t.id)}`,s="&"),n+=`${s}ref=${i.sourceReference}`,y.parse(n)}else{if(i.path)return y.file(i.path);throw new Error("cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.")}}registerAllDebugTypes(e){const t=[];for(const i of e.getAllExtensionDescriptions())if(i.contributes){const n=i.contributes.debuggers;if(n&&n.length>0)for(const s of n)oP(s)&&t.push(s.type)}this._debugServiceProxy.$registerDebugTypes(t)}get stackFrameFocus(){return this._stackFrameFocus}get onDidChangeStackFrameFocus(){return this._onDidChangeStackFrameFocus.event}get onDidChangeBreakpoints(){return this._onDidChangeBreakpoints.event}get breakpoints(){const e=[];return this._breakpoints.forEach(t=>e.push(t)),e}async $resolveDebugVisualizer(e,t){var a;const i=this._visualizers.get(e);if(!i)throw new Error(`No debug visualizer found with id '${e}'`);let{v:n,provider:s,extensionId:o}=i;if(n.visualization||(n=await((a=s.resolveDebugVisualization)==null?void 0:a.call(s,n,t))||n,i.v=n),!n.visualization)throw new Error(`No visualization returned from resolveDebugVisualization in '${s}'`);return this.serializeVisualization(o,n.visualization)}async $executeDebugVisualizerCommand(e){const t=this._visualizers.get(e);if(!t)throw new Error(`No debug visualizer found with id '${e}'`);const i=t.v.visualization;i&&"command"in i&&this._commands.executeCommand(i.command,...i.arguments||[])}hydrateVisualizationContext(e){const t=this._debugSessions.get(e.sessionId);return t&&{session:t.api,variable:e.variable,containerId:e.containerId,frameId:e.frameId,threadId:e.threadId}}async $provideDebugVisualizers(e,t,i,n){const s=this.hydrateVisualizationContext(i),o=this.extensionVisKey(e,t),a=this._debugVisualizationProviders.get(o);if(!s||!a)return[];const c=await a.provideDebugVisualization(s,n);return c?c.map(l=>{const u=++this._visualizerIdCounter;this._visualizers.set(u,{v:l,provider:a,extensionId:e});const d=l.iconPath?this.getIconPathOrClass(l.iconPath):void 0;return{id:u,name:l.name,iconClass:d==null?void 0:d.iconClass,iconPath:d==null?void 0:d.iconPath,visualization:this.serializeVisualization(e,l.visualization)}}):[]}$disposeDebugVisualizers(e){for(const t of e)this._visualizers.delete(t)}registerDebugVisualizationProvider(e,t,i){var o,a;if(!((a=(o=e.contributes)==null?void 0:o.debugVisualizers)!=null&&a.some(c=>c.id===t)))throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${t})`);const n=Xe.toKey(e.identifier),s=this.extensionVisKey(n,t);if(this._debugVisualizationProviders.has(s))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationProviders.set(s,i),this._debugServiceProxy.$registerDebugVisualizer(n,t),Le(()=>{this._debugServiceProxy.$unregisterDebugVisualizer(n,t),this._debugVisualizationProviders.delete(t)})}addBreakpoints(e){const t=e.filter(s=>{const o=s.id;return this._breakpoints.has(o)?!1:(this._breakpoints.set(o,s),!0)});this.fireBreakpointChanges(t,[],[]);const i=[],n=new Map;for(const s of t)if(s instanceof Ss){let o=n.get(s.location.uri.toString());o||(o={type:"sourceMulti",uri:s.location.uri,lines:[]},n.set(s.location.uri.toString(),o),i.push(o)),o.lines.push({id:s.id,enabled:s.enabled,condition:s.condition,hitCondition:s.hitCondition,logMessage:s.logMessage,line:s.location.range.start.line,character:s.location.range.start.character,mode:s.mode})}else s instanceof Es&&i.push({type:"function",id:s.id,enabled:s.enabled,hitCondition:s.hitCondition,logMessage:s.logMessage,condition:s.condition,functionName:s.functionName,mode:s.mode});return this._debugServiceProxy.$registerBreakpoints(i)}removeBreakpoints(e){const t=e.filter(o=>this._breakpoints.delete(o.id));this.fireBreakpointChanges([],t,[]);const i=t.filter(o=>o instanceof Ss).map(o=>o.id),n=t.filter(o=>o instanceof Es).map(o=>o.id),s=t.filter(o=>o instanceof zd).map(o=>o.id);return this._debugServiceProxy.$unregisterBreakpoints(i,n,s)}startDebugging(e,t,i){var n,s,o;return this._debugServiceProxy.$startDebugging(e?e.uri:void 0,t,{parentSessionID:i.parentSession?i.parentSession.id:void 0,lifecycleManagedByParent:i.lifecycleManagedByParent,repl:i.consoleMode===th.MergeWithParent?"mergeWithParent":"separate",noDebug:i.noDebug,compact:i.compact,suppressSaveBeforeStart:i.suppressSaveBeforeStart,suppressDebugStatusbar:i.suppressDebugStatusbar??((n=i.debugUI)==null?void 0:n.simple),suppressDebugToolbar:i.suppressDebugToolbar??((s=i.debugUI)==null?void 0:s.simple),suppressDebugView:i.suppressDebugView??((o=i.debugUI)==null?void 0:o.simple)})}stopDebugging(e){return this._debugServiceProxy.$stopDebugging(e?e.id:void 0)}registerDebugConfigurationProvider(e,t,i){if(!t)return new Pe(()=>{});const n=this._configProviderHandleCounter++;return this._configProviders.push({type:e,handle:n,provider:t}),this._debugServiceProxy.$registerDebugConfigurationProvider(e,i,!!t.provideDebugConfigurations,!!t.resolveDebugConfiguration,!!t.resolveDebugConfigurationWithSubstitutedVariables,n),new Pe(()=>{this._configProviders=this._configProviders.filter(s=>s.provider!==t),this._debugServiceProxy.$unregisterDebugConfigurationProvider(n)})}registerDebugAdapterDescriptorFactory(e,t,i){if(!i)return new Pe(()=>{});if(!this.definesDebugType(e,t))throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${t}' debugger.`);if(this.getAdapterDescriptorFactoryByType(t))throw new Error("a DebugAdapterDescriptorFactory can only be registered once per a type.");const n=this._adapterFactoryHandleCounter++;return this._adapterFactories.push({type:t,handle:n,factory:i}),this._debugServiceProxy.$registerDebugAdapterDescriptorFactory(t,n),new Pe(()=>{this._adapterFactories=this._adapterFactories.filter(s=>s.factory!==i),this._debugServiceProxy.$unregisterDebugAdapterDescriptorFactory(n)})}registerDebugAdapterTrackerFactory(e,t){if(!t)return new Pe(()=>{});const i=this._trackerFactoryHandleCounter++;return this._trackerFactories.push({type:e,handle:i,factory:t}),new Pe(()=>{this._trackerFactories=this._trackerFactories.filter(n=>n.factory!==t)})}async $runInTerminal(e,t){return Promise.resolve(void 0)}async $substituteVariables(e,t){let i;const n=await this.getFolder(e);return n&&(i={uri:n.uri,name:n.name,index:n.index,toResource:()=>{throw new Error("Not implemented")}}),(await this._variableResolver.getResolver()).resolveAnyAsync(i,t)}createDebugAdapter(e,t){if(e.type==="implementation")return new gP(e.implementation)}createSignService(){}async $startDASession(e,t){const i=this,n=await this.getSession(t);return this.getAdapterDescriptor(this.getAdapterDescriptorFactoryByType(n.type),n).then(s=>{if(!s)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${n.type}' (extension might have failed to activate)`);const o=this.convertToDto(s),a=this.createDebugAdapter(o,n);if(!a)throw new Error(`Couldn't create a debug adapter for type '${n.type}'.`);const c=a;return this._debugAdapters.set(e,c),this.getDebugAdapterTrackers(n).then(l=>(l&&this._debugAdaptersTrackers.set(e,l),c.onMessage(async u=>{if(u.type==="request"&&u.command==="handshake"){const d=u,h={type:"response",seq:0,command:d.command,request_seq:d.seq,success:!0};this._signService||(this._signService=this.createSignService());try{if(this._signService){const g=await this._signService.sign(d.arguments.value);h.body={signature:g},c.sendResponse(h)}else throw new Error("no signer")}catch(g){h.success=!1,h.message=g.message,c.sendResponse(h)}}else l&&l.onDidSendMessage&&l.onDidSendMessage(u),u=uP(u,!0),i._debugServiceProxy.$acceptDAMessage(e,u)}),c.onError(u=>{l&&l.onError&&l.onError(u),this._debugServiceProxy.$acceptDAError(e,u.name,u.message,u.stack)}),c.onExit(u=>{l&&l.onExit&&l.onExit(u??void 0,void 0),this._debugServiceProxy.$acceptDAExit(e,u??void 0,void 0)}),l&&l.onWillStartSession&&l.onWillStartSession(),c.startSession()))})}$sendDAMessage(e,t){t=lP(t,!1);const i=this._debugAdaptersTrackers.get(e);i&&i.onWillReceiveMessage&&i.onWillReceiveMessage(t);const n=this._debugAdapters.get(e);n==null||n.sendMessage(t)}$stopDASession(e){const t=this._debugAdaptersTrackers.get(e);this._debugAdaptersTrackers.delete(e),t&&t.onWillStopSession&&t.onWillStopSession();const i=this._debugAdapters.get(e);return this._debugAdapters.delete(e),i?i.stopSession():Promise.resolve(void 0)}$acceptBreakpointsDelta(e){const t=[],i=[],n=[];if(e.added)for(const s of e.added){const o=s.id;if(o&&!this._breakpoints.has(o)){let a;if(s.type==="function")a=new Es(s.functionName,s.enabled,s.condition,s.hitCondition,s.logMessage,s.mode);else if(s.type==="data")a=new zd(s.label,s.dataId,s.canPersist,s.enabled,s.hitCondition,s.condition,s.logMessage,s.mode);else{const c=y.revive(s.uri);a=new Ss(new vi(c,new Se(s.line,s.character)),s.enabled,s.condition,s.hitCondition,s.logMessage,s.mode)}ZD(a,o),this._breakpoints.set(o,a),t.push(a)}}if(e.removed)for(const s of e.removed){const o=this._breakpoints.get(s);o&&(this._breakpoints.delete(s),i.push(o))}if(e.changed){for(const s of e.changed)if(s.id){const o=this._breakpoints.get(s.id);if(o){if(o instanceof Es&&s.type==="function"){const a=o;a.enabled=s.enabled,a.condition=s.condition,a.hitCondition=s.hitCondition,a.logMessage=s.logMessage,a.functionName=s.functionName}else if(o instanceof Ss&&s.type==="source"){const a=o;a.enabled=s.enabled,a.condition=s.condition,a.hitCondition=s.hitCondition,a.logMessage=s.logMessage,a.location=new vi(y.revive(s.uri),new Se(s.line,s.character))}n.push(o)}}}this.fireBreakpointChanges(t,i,n)}async $acceptStackFrameFocus(e){let t;const i=e.sessionId?await this.getSession(e.sessionId):void 0;if(!i)throw new Error("no DebugSession found for debug focus context");e.kind==="thread"?t=new Jd(i.api,e.threadId):t=new Qd(i.api,e.threadId,e.frameId),this._stackFrameFocus=t,this._onDidChangeStackFrameFocus.fire(this._stackFrameFocus)}$provideDebugConfigurations(e,t,i){return Mt(async()=>{const n=this.getConfigProviderByHandle(e);if(!n)throw new Error("no DebugConfigurationProvider found");if(!n.provideDebugConfigurations)throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations");const s=await this.getFolder(t);return n.provideDebugConfigurations(s,i)}).then(n=>{if(!n)throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations");return n})}$resolveDebugConfiguration(e,t,i,n){return Mt(async()=>{const s=this.getConfigProviderByHandle(e);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.resolveDebugConfiguration)throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration");const o=await this.getFolder(t);return s.resolveDebugConfiguration(o,i,n)})}$resolveDebugConfigurationWithSubstitutedVariables(e,t,i,n){return Mt(async()=>{const s=this.getConfigProviderByHandle(e);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.resolveDebugConfigurationWithSubstitutedVariables)throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables");const o=await this.getFolder(t);return s.resolveDebugConfigurationWithSubstitutedVariables(o,i,n)})}async $provideDebugAdapter(e,t){const i=this.getAdapterDescriptorFactoryByHandle(e);if(!i)return Promise.reject(new Error("no adapter descriptor factory found for handle"));const n=await this.getSession(t);return this.getAdapterDescriptor(i,n).then(s=>{if(!s)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${n.type}'`);return this.convertToDto(s)})}async $acceptDebugSessionStarted(e){const t=await this.getSession(e);this._onDidStartDebugSession.fire(t.api)}async $acceptDebugSessionTerminated(e){const t=await this.getSession(e);t&&(this._onDidTerminateDebugSession.fire(t.api),this._debugSessions.delete(t.id))}async $acceptDebugSessionActiveChanged(e){var t;this._activeDebugSession=e?await this.getSession(e):void 0,this._onDidChangeActiveDebugSession.fire((t=this._activeDebugSession)==null?void 0:t.api)}async $acceptDebugSessionNameChanged(e,t){const i=await this.getSession(e);i==null||i._acceptNameChanged(t)}async $acceptDebugSessionCustomEvent(e,t){const n={session:(await this.getSession(e)).api,event:t.event,body:t.body};this._onDidReceiveDebugSessionCustomEvent.fire(n)}convertToDto(e){if(e instanceof jd)return{type:"executable",command:e.command,args:e.args,options:e.options};if(e instanceof Zc)return{type:"server",port:e.port,host:e.host};if(e instanceof qd)return{type:"pipeServer",path:e.path};if(e instanceof Gd)return{type:"implementation",implementation:e.implementation};throw new Error("convertToDto unexpected type")}getAdapterDescriptorFactoryByType(e){const t=this._adapterFactories.filter(i=>i.type===e);if(t.length>0)return t[0].factory}getAdapterDescriptorFactoryByHandle(e){const t=this._adapterFactories.filter(i=>i.handle===e);if(t.length>0)return t[0].factory}getConfigProviderByHandle(e){const t=this._configProviders.filter(i=>i.handle===e);if(t.length>0)return t[0].provider}definesDebugType(e,t){if(e.contributes){const i=e.contributes.debuggers;if(i&&i.length>0){for(const n of i)if(n.label&&n.type&&n.type===t)return!0}}return!1}getDebugAdapterTrackers(e){const i=e.configuration.type,n=this._trackerFactories.filter(s=>s.type===i||s.type==="*").map(s=>Mt(()=>s.factory.createDebugAdapterTracker(e.api)).then(o=>o,o=>null));return Promise.race([Promise.all(n).then(s=>{const o=s.filter(a=>!!a);if(o.length>0)return new pP(o)}),new Promise(s=>setTimeout(()=>s(void 0),1e3))]).catch(s=>{})}async getAdapterDescriptor(e,t){const i=t.configuration.debugServer;if(typeof i=="number")return Promise.resolve(new Zc(i));if(e){const s=await this._extensionService.getExtensionRegistry();return Mt(()=>e.createDebugAdapterDescriptor(t.api,this.daExecutableFromPackage(t,s))).then(o=>{if(o)return o})}const n=await this._extensionService.getExtensionRegistry();return Promise.resolve(this.daExecutableFromPackage(t,n))}daExecutableFromPackage(e,t){}fireBreakpointChanges(e,t,i){(e.length>0||t.length>0||i.length>0)&&this._onDidChangeBreakpoints.fire(Object.freeze({added:e,removed:t,changed:i}))}async getSession(e){if(e)if(typeof e=="string"){const t=this._debugSessions.get(e);if(t)return t}else{let t=this._debugSessions.get(e.id);if(!t){const i=await this.getFolder(e.folderUri),n=e.parent?this._debugSessions.get(e.parent):void 0;t=new hP(this._debugServiceProxy,e.id,e.type,e.name,i,e.configuration,n==null?void 0:n.api),this._debugSessions.set(t.id,t),this._debugServiceProxy.$sessionCached(t.id)}return t}throw new Error("cannot find session")}getFolder(e){if(e){const t=y.revive(e);return this._workspaceService.resolveWorkspaceFolder(t)}return Promise.resolve(void 0)}extensionVisKey(e,t){return`${e}\0${t}`}serializeVisualization(e,t){if(t){if("title"in t&&"command"in t)return{type:0};if("treeId"in t)return{type:1,id:`${e}\0${t.treeId}`};throw new Error("Unsupported debug visualization type")}}getIconPathOrClass(e){const t=this.getIconUris(e);let i,n;return"id"in t?n=Xt.asClassName(t):i=t,{iconPath:i,iconClass:n}}getIconUris(e){if(e instanceof Gt)return{id:e.id};const t=typeof e=="object"&&"dark"in e?e.dark:e,i=typeof e=="object"&&"light"in e?e.light:e;return{dark:typeof t=="string"?y.file(t):t,light:typeof i=="string"?y.file(i):i}}};u_=H([N(0,Ve),N(1,An),N(2,Ir),N(3,Rn),N(4,$l),N(5,c_),N(6,_a)],u_);class hP{constructor(e,t,i,n,s,o,a){this._debugServiceProxy=e,this._id=t,this._type=i,this._name=n,this._workspaceFolder=s,this._configuration=o,this._parentSession=a}get api(){const e=this;return this.apiSession??(this.apiSession=Object.freeze({id:e._id,type:e._type,get name(){return e._name},set name(t){e._name=t,e._debugServiceProxy.$setDebugSessionName(e._id,t)},parentSession:e._parentSession,workspaceFolder:e._workspaceFolder,configuration:e._configuration,customRequest(t,i){return e._debugServiceProxy.$customDebugAdapterRequest(e._id,t,i)},getDebugProtocolBreakpoint(t){return e._debugServiceProxy.$getDebugProtocolBreakpoint(e._id,t.id)}}))}get id(){return this._id}get type(){return this._type}_acceptNameChanged(e){this._name=e}get configuration(){return this._configuration}}class fP{constructor(e){this.value=Object.freeze({append(t){e.$appendDebugConsole(t)},appendLine(t){this.append(t+`
`)}})}}class pP{constructor(e){this.trackers=e}onWillStartSession(){this.trackers.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.trackers.forEach(t=>t.onWillReceiveMessage?t.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.trackers.forEach(t=>t.onDidSendMessage?t.onDidSendMessage(e):void 0)}onWillStopSession(){this.trackers.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.trackers.forEach(t=>t.onError?t.onError(e):void 0)}onExit(e,t){this.trackers.forEach(i=>i.onExit?i.onExit(e,t):void 0)}}class gP extends sP{constructor(e){super(),this.implementation=e,e.onDidSendMessage(t=>{this.acceptMessage(t)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.implementation.handleMessage(e)}stopSession(){return this.implementation.dispose(),Promise.resolve(void 0)}}let d_=class extends u_{constructor(e,t,i,n,s,o,a){super(e,t,i,n,s,o,a)}};d_=H([N(0,Ve),N(1,An),N(2,Ir),N(3,Rn),N(4,$l),N(5,c_),N(6,_a)],d_);class mP{constructor(e,t,i){this.config=e,this.provider=t,this.sessionToken=i,this.isLimitHit=!1,this.resultCount=0,this.isCanceled=!1,this.filePattern=e.filePattern,this.includePattern=e.includePattern&&Lo(e.includePattern),this.maxResults=e.maxResults||void 0,this.exists=e.exists,this.activeCancellationTokens=new Set,this.globalExcludePattern=e.excludePattern&&Lo(e.excludePattern)}cancel(){this.isCanceled=!0,this.activeCancellationTokens.forEach(e=>e.cancel()),this.activeCancellationTokens=new Set}search(e){const t=this.config.folderQueries||[];return new Promise((i,n)=>{const s=o=>{this.resultCount++,e(o)};if(this.isCanceled)return i({limitHit:this.isLimitHit});this.config.extraFileResources&&this.config.extraFileResources.forEach(o=>{const a=o.toString(),c=ai(a);this.globalExcludePattern&&this.globalExcludePattern(a,c)||this.matchFile(s,{base:o,basename:c})}),Promise.all(t.map(o=>this.searchInFolder(o,s))).then(o=>{i({limitHit:this.isLimitHit,stats:o[0]||void 0})},o=>{n(new Error(ur(o)))})})}async searchInFolder(e,t){const i=new mt,n=this.getSearchOptionsForFolder(e),s=this.initDirectoryTree(),o=new kx(this.config,e),a=!o.hasSiblingExcludeClauses();let c;try{this.activeCancellationTokens.add(i),c=vn.create();const l=await this.provider.provideFileSearchResults({pattern:this.config.filePattern||""},n,i.token),u=c.elapsed(),d=vn.create();return this.isCanceled&&!this.isLimitHit||(l&&l.forEach(h=>{const g=Me.relative(e.folder.path,h.path);if(a){const w=ai(h.path);this.matchFile(t,{base:e.folder,relativePath:g,basename:w});return}this.addDirectoryEntries(s,e.folder,g,t)}),this.isCanceled&&!this.isLimitHit)?null:(this.matchDirectoryTree(s,o,t),{providerTime:u,postProcessTime:d.elapsed()})}finally{i.dispose(),this.activeCancellationTokens.delete(i)}}getSearchOptionsForFolder(e){const t=zh(this.config.includePattern,e.includePattern),i=zh(this.config.excludePattern,e.excludePattern);return{folder:e.folder,excludes:i,includes:t,useIgnoreFiles:!e.disregardIgnoreFiles,useGlobalIgnoreFiles:!e.disregardGlobalIgnoreFiles,useParentIgnoreFiles:!e.disregardParentIgnoreFiles,followSymlinks:!e.ignoreSymlinks,maxResults:this.config.maxResults,session:this.sessionToken}}initDirectoryTree(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}addDirectoryEntries({pathToEntries:e},t,i,n){if(i===this.filePattern){const o=ai(this.filePattern);this.matchFile(n,{base:t,relativePath:this.filePattern,basename:o})}function s(o){const a=ai(o),c=es(o);let l=e[c];l||(l=e[c]=[],s(c)),l.push({base:t,relativePath:o,basename:a})}s(i)}matchDirectoryTree({rootEntries:e,pathToEntries:t},i,n){const s=this,o=this.filePattern;function a(c){const l=y4(()=>c.map(u=>u.basename));for(let u=0,d=c.length;u<d;u++){const h=c[u],{relativePath:g,basename:w}=h;if(i.matchesExcludesSync(g,w,o!==w?l:void 0))continue;const p=t[g];if(p)a(p);else{if(g===o)continue;s.matchFile(n,h)}if(s.isLimitHit)break}}a(e)}matchFile(e,t){(!this.includePattern||t.relativePath&&this.includePattern(t.relativePath,t.basename))&&((this.exists||this.maxResults&&this.resultCount>=this.maxResults)&&(this.isLimitHit=!0,this.cancel()),this.isLimitHit||e(t))}}const Vf=class Vf{constructor(){this.sessions=new Map}fileSearch(e,t,i,n){const s=this.getSessionTokenSource(e.cacheKey),o=new mP(e,t,s&&s.token);let a=0;const c=l=>{a+=l.length,i(l.map(u=>this.rawMatchToSearchItem(u)))};return this.doSearch(o,Vf.BATCH_SIZE,c,n).then(l=>({limitHit:l.limitHit,stats:{fromCache:!1,type:"fileSearchProvider",resultCount:a,detailStats:l.stats}}))}clearCache(e){const t=this.getSessionTokenSource(e);t==null||t.cancel()}getSessionTokenSource(e){if(e)return this.sessions.has(e)||this.sessions.set(e,new mt),this.sessions.get(e)}rawMatchToSearchItem(e){return e.relativePath?{resource:xo(e.base,e.relativePath)}:{resource:e.base}}doSearch(e,t,i,n){const s=n.onCancellationRequested(()=>{e.cancel()}),o=c=>{c&&(a.push(c),t>0&&a.length>=t&&(i(a),a=[]))};let a=[];return e.search(o).then(c=>(a.length&&i(a),s.dispose(),c),c=>(a.length&&i(a),s.dispose(),Promise.reject(c)))}};Vf.BATCH_SIZE=512;let h_=Vf;class vP{constructor(e,t,i,n){this.query=e,this.provider=t,this.fileUtils=i,this.processType=n,this.collector=null,this.isLimitHit=!1,this.resultCount=0}search(e,t){const i=this.query.folderQueries||[],n=new mt(t);return new Promise((s,o)=>{this.collector=new wP(e);let a=!1;const c=(l,u)=>{if(!a&&!this.isLimitHit){const d=this.resultSize(l);Nl(l)&&typeof this.query.maxResults=="number"&&this.resultCount+d>this.query.maxResults&&(this.isLimitHit=!0,a=!0,n.cancel(),l=this.trimResultToSize(l,this.query.maxResults-this.resultCount));const h=this.resultSize(l);this.resultCount+=h,(h>0||!Nl(l))&&this.collector.add(l,u)}};Promise.all(i.map((l,u)=>this.searchInFolder(l,d=>c(d,u),n.token))).then(l=>{n.dispose(),this.collector.flush();const u=l.some(d=>!!d&&!!d.limitHit);s({limitHit:this.isLimitHit||u,messages:Iu(l.map(d=>d!=null&&d.message?Array.isArray(d.message)?d.message:[d.message]:[])),stats:{type:this.processType}})},l=>{n.dispose();const u=ur(l);o(new Error(u))})})}resultSize(e){return Nl(e)?Array.isArray(e.ranges)?e.ranges.length:1:0}trimResultToSize(e,t){const i=Array.isArray(e.ranges)?e.ranges:[e.ranges],n=Array.isArray(e.preview.matches)?e.preview.matches:[e.preview.matches];return{ranges:i.slice(0,t),preview:{matches:n.slice(0,t),text:e.preview.text},uri:e.uri}}async searchInFolder(e,t,i){const n=new kx(this.query,e),s=[],o={report:l=>{if(!this.validateProviderResult(l))return;const u=e.folder.scheme===Z.file?b4(()=>this.fileUtils.readdir(Gp(l.uri))):void 0,d=ry(e.folder,l.uri);if(d){const h=n.includedInQuery(d,ai(d),u);cr(h)?s.push(h.then(g=>{g&&t(l)})):h&&t(l)}}},a=this.getSearchOptionsForFolder(e),c=await this.provider.provideTextSearchResults(_P(this.query.contentPattern),a,o,i);return s.length&&await Promise.all(s),c}validateProviderResult(e){if(Nl(e)){if(Array.isArray(e.ranges)){if(!Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type."),!1;if(e.preview.matches.length!==e.ranges.length)return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}else if(Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}return!0}getSearchOptionsForFolder(e){const t=zh(this.query.includePattern,e.includePattern),i=zh(this.query.excludePattern,e.excludePattern),n={folder:y.from(e.folder),excludes:i,includes:t,useIgnoreFiles:!e.disregardIgnoreFiles,useGlobalIgnoreFiles:!e.disregardGlobalIgnoreFiles,useParentIgnoreFiles:!e.disregardParentIgnoreFiles,followSymlinks:!e.ignoreSymlinks,encoding:e.fileEncoding&&this.fileUtils.toCanonicalName(e.fileEncoding),maxFileSize:this.query.maxFileSize,maxResults:this.query.maxResults,previewOptions:this.query.previewOptions,afterContext:this.query.afterContext,beforeContext:this.query.beforeContext};return n.usePCRE2=this.query.usePCRE2,n}}function _P(r){return{isCaseSensitive:r.isCaseSensitive||!1,isRegExp:r.isRegExp||!1,isWordMatch:r.isWordMatch||!1,isMultiline:r.isMultiline||!1,pattern:r.pattern}}class wP{constructor(e){this._onResult=e,this._currentFolderIdx=-1,this._currentFileMatch=null,this._batchedCollector=new f_(512,t=>this.sendItems(t))}add(e,t){this._currentFileMatch&&(this._currentFolderIdx!==t||!ny(this._currentUri,e.uri))&&(this.pushToCollector(),this._currentFileMatch=null),this._currentFileMatch||(this._currentFolderIdx=t,this._currentFileMatch={resource:e.uri,results:[]}),this._currentFileMatch.results.push(bP(e))}pushToCollector(){const e=this._currentFileMatch&&this._currentFileMatch.results?this._currentFileMatch.results.length:0;this._batchedCollector.addItem(this._currentFileMatch,e)}flush(){this.pushToCollector(),this._batchedCollector.flush()}sendItems(e){this._onResult(e)}}function bP(r){return Nl(r)?{preview:{matches:lc(r.preview.matches,e=>({startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character})),text:r.preview.text},ranges:lc(r.ranges,e=>({startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character}))}:{text:r.text,lineNumber:r.lineNumber}}function Nl(r){return!!r.preview}const Oa=class Oa{constructor(e,t){this.maxBatchSize=e,this.cb=t,this.totalNumberCompleted=0,this.batch=[],this.batchSize=0}addItem(e,t){e&&this.addItemToBatch(e,t)}addItems(e,t){e&&this.addItemsToBatch(e,t)}addItemToBatch(e,t){this.batch.push(e),this.batchSize+=t,this.onUpdate()}addItemsToBatch(e,t){this.batch=this.batch.concat(e),this.batchSize+=t,this.onUpdate()}onUpdate(){this.totalNumberCompleted<Oa.START_BATCH_AFTER_COUNT?this.flush():this.batchSize>=this.maxBatchSize?this.flush():this.timeoutHandle||(this.timeoutHandle=setTimeout(()=>{this.flush()},Oa.TIMEOUT))}flush(){this.batchSize&&(this.totalNumberCompleted+=this.batchSize,this.cb(this.batch),this.batch=[],this.batchSize=0,this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=0))}};Oa.TIMEOUT=4e3,Oa.START_BATCH_AFTER_COUNT=50;let f_=Oa;const TC=ne("IExtHostSearch");let p_=class{constructor(e,t,i){this.extHostRpc=e,this._uriTransformer=t,this._logService=i,this._proxy=this.extHostRpc.getProxy(G.MainThreadSearch),this._handlePool=0,this._textSearchProvider=new Map,this._textSearchUsedSchemes=new Set,this._fileSearchProvider=new Map,this._fileSearchUsedSchemes=new Set,this._fileSearchManager=new h_}_transformScheme(e){return this._uriTransformer.transformOutgoingScheme(e)}registerTextSearchProvider(e,t){if(this._textSearchUsedSchemes.has(e))throw new Error(`a text search provider for the scheme '${e}' is already registered`);this._textSearchUsedSchemes.add(e);const i=this._handlePool++;return this._textSearchProvider.set(i,t),this._proxy.$registerTextSearchProvider(i,this._transformScheme(e)),Le(()=>{this._textSearchUsedSchemes.delete(e),this._textSearchProvider.delete(i),this._proxy.$unregisterProvider(i)})}registerFileSearchProvider(e,t){if(this._fileSearchUsedSchemes.has(e))throw new Error(`a file search provider for the scheme '${e}' is already registered`);this._fileSearchUsedSchemes.add(e);const i=this._handlePool++;return this._fileSearchProvider.set(i,t),this._proxy.$registerFileSearchProvider(i,this._transformScheme(e)),Le(()=>{this._fileSearchUsedSchemes.delete(e),this._fileSearchProvider.delete(i),this._proxy.$unregisterProvider(i)})}$provideFileSearchResults(e,t,i,n){const s=AC(i),o=this._fileSearchProvider.get(e);if(o)return this._fileSearchManager.fileSearch(s,o,a=>{this._proxy.$handleFileMatch(e,t,a.map(c=>c.resource))},n);throw new Error("unknown provider: "+e)}async doInternalFileSearchWithCustomCallback(e,t,i){return{messages:[]}}$clearCache(e){return this._fileSearchManager.clearCache(e),Promise.resolve(void 0)}$provideTextSearchResults(e,t,i,n){const s=this._textSearchProvider.get(e);if(!s||!s.provideTextSearchResults)throw new Error(`Unknown provider ${e}`);const o=AC(i);return this.createTextSearchManager(o,s).search(c=>this._proxy.$handleTextMatch(e,t,c),n)}$enableExtensionHostSearch(){}createTextSearchManager(e,t){return new vP(e,t,{readdir:i=>Promise.resolve([]),toCanonicalName:i=>i},"textSearchProvider")}};p_=H([N(0,Ve),N(1,Yu),N(2,Ge)],p_);function AC(r){return{...r,folderQueries:r.folderQueries&&r.folderQueries.map(yP),extraFileResources:r.extraFileResources&&r.extraFileResources.map(e=>y.revive(e))}}function yP(r){return{...r,folder:y.revive(r.folder)}}var g_;let m_=($a=class{getState(e){const t=this._state;return{get focused(){return t.focused},get active(){return M(e,"windowActivity"),t.active}}}constructor(e){this._onDidChangeWindowState=new T,this.onDidChangeWindowState=this._onDidChangeWindowState.event,this._state=g_.InitialState,this._proxy=e.getProxy(G.MainThreadWindow),this._proxy.$getInitialState().then(({isFocused:t,isActive:i})=>{this.onDidChangeWindowProperty("focused",t),this.onDidChangeWindowProperty("active",i)})}$onDidChangeWindowFocus(e){this.onDidChangeWindowProperty("focused",e)}$onDidChangeWindowActive(e){this.onDidChangeWindowProperty("active",e)}onDidChangeWindowProperty(e,t){t!==this._state[e]&&(this._state={...this._state,[e]:t},this._onDidChangeWindowState.fire(this._state))}openUri(e,t){let i;if(typeof e=="string"){i=e;try{e=y.parse(e)}catch{return Promise.reject(`Invalid uri - '${e}'`)}}return Vu(e.scheme)?Promise.reject("Invalid scheme - cannot be empty"):e.scheme===Z.command?Promise.reject(`Invalid scheme '${e.scheme}'`):this._proxy.$openUri(e,i,t)}async asExternalUri(e,t){if(Vu(e.scheme))return Promise.reject("Invalid scheme - cannot be empty");const i=await this._proxy.$asExternalUri(e,t);return y.from(i)}},g_=$a,$a.InitialState={focused:!0,active:!0},$a);m_=g_=H([N(0,Ve)],m_);const RC=ne("IExtHostWindow");ot(Hv,Mv,1),ot(So,nf,1),ot(rf,Yv,1),ot(_a,Iv,0),ot(Rn,pv,0),ot(Yh,_v,0),ot(PC,d_,0),ot(wC,Gv,0),ot(Rl,Xv,0),ot(Uv,Bv,0),ot(ko,zk,0),ot(_C,qv,1),ot(TC,p_,0),ot(vv,Hx,0),ot(SC,s_,0),ot(Dl,Av,0),ot(Sv,Ev,0),ot(RC,m_,0),ot(An,ov,0),ot(Fv,dC,0),ot(Zh,Dv,0),ot($l,o_,0),ot(c_,l_,0);const LC={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},xP=8;class CP{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class je{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return cf(e,t)}compute(e,t,i){return i}}class af{constructor(e,t){this.newValue=e,this.didChange=t}}function cf(r,e){if(typeof r!="object"||typeof e!="object"||!r||!e)return new af(e,r!==e);if(Array.isArray(r)||Array.isArray(e)){const i=Array.isArray(r)&&Array.isArray(e)&&er(r,e);return new af(e,!i)}let t=!1;for(const i in e)if(e.hasOwnProperty(i)){const n=cf(r[i],e[i]);n.didChange&&(r[i]=n.newValue,t=!0)}return new af(r,t)}class Fl{constructor(e){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return cf(e,t)}validate(e){return this.defaultValue}}class ya{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return cf(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,i){return i}}function Y(r,e){return typeof r>"u"?e:r==="false"?!1:!!r}class _e extends ya{constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="boolean",n.default=i),super(e,t,i,n)}validate(e){return Y(e,this.defaultValue)}}function SP(r,e,t,i){if(typeof r>"u")return e;let n=parseInt(r,10);return isNaN(n)?e:(n=Math.max(t,n),n=Math.min(i,n),n|0)}class $e extends ya{static clampedInt(e,t,i,n){return SP(e,t,i,n)}constructor(e,t,i,n,s,o=void 0){typeof o<"u"&&(o.type="integer",o.default=i,o.minimum=n,o.maximum=s),super(e,t,i,o),this.minimum=n,this.maximum=s}validate(e){return $e.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}class cn extends ya{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;const i=parseFloat(e);return isNaN(i)?t:i}constructor(e,t,i,n,s){typeof s<"u"&&(s.type="number",s.default=i),super(e,t,i,s),this.validationFn=n}validate(e){return this.validationFn(cn.float(e,this.defaultValue))}}class Bt extends ya{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="string",n.default=i),super(e,t,i,n)}validate(e){return Bt.string(e,this.defaultValue)}}function nt(r,e,t,i){return typeof r!="string"?e:i&&r in i?i[r]:t.indexOf(r)===-1?e:r}class Je extends ya{constructor(e,t,i,n,s=void 0){typeof s<"u"&&(s.type="string",s.enum=n,s.default=i),super(e,t,i,s),this._allowedValues=n}validate(e){return nt(e,this.defaultValue,this._allowedValues)}}class lf extends je{constructor(e,t,i,n,s,o,a=void 0){typeof a<"u"&&(a.type="string",a.enum=s,a.default=n),super(e,t,i,a),this._allowedValues=s,this._convert=o}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function EP(r){switch(r){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class kP extends je{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[m("vs/editor/common/config/editorOptions","accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),m("vs/editor/common/config/editorOptions","accessibilitySupport.on","Optimize for usage with a Screen Reader."),m("vs/editor/common/config/editorOptions","accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:m("vs/editor/common/config/editorOptions","accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}}class DP extends je{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:m("vs/editor/common/config/editorOptions","comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:m("vs/editor/common/config/editorOptions","comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:Y(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Y(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function IP(r){switch(r){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var ln;(function(r){r[r.Line=1]="Line",r[r.Block=2]="Block",r[r.Underline=3]="Underline",r[r.LineThin=4]="LineThin",r[r.BlockOutline=5]="BlockOutline",r[r.UnderlineThin=6]="UnderlineThin"})(ln||(ln={}));function PP(r){switch(r){case"line":return ln.Line;case"block":return ln.Block;case"underline":return ln.Underline;case"line-thin":return ln.LineThin;case"block-outline":return ln.BlockOutline;case"underline-thin":return ln.UnderlineThin}}class TP extends Fl{constructor(){super(141)}compute(e,t,i){const n=["monaco-editor"];return t.get(39)&&n.push(t.get(39)),e.extraEditorClassName&&n.push(e.extraEditorClassName),t.get(74)==="default"?n.push("mouse-default"):t.get(74)==="copy"&&n.push("mouse-copy"),t.get(111)&&n.push("showUnused"),t.get(139)&&n.push("showDeprecated"),n.join(" ")}}class AP extends _e{constructor(){super(37,"emptySelectionClipboard",!0,{description:m("vs/editor/common/config/editorOptions","emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class RP extends je{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(41,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:m("vs/editor/common/config/editorOptions","find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[m("vs/editor/common/config/editorOptions","editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),m("vs/editor/common/config/editorOptions","editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),m("vs/editor/common/config/editorOptions","editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:m("vs/editor/common/config/editorOptions","find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[m("vs/editor/common/config/editorOptions","editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),m("vs/editor/common/config/editorOptions","editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),m("vs/editor/common/config/editorOptions","editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:m("vs/editor/common/config/editorOptions","find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:m("vs/editor/common/config/editorOptions","find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Ai},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:m("vs/editor/common/config/editorOptions","find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:m("vs/editor/common/config/editorOptions","find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:Y(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":nt(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":nt(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Y(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Y(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Y(t.loop,this.defaultValue.loop)}}}const Gn=class Gn extends je{constructor(){super(51,"fontLigatures",Gn.OFF,{anyOf:[{type:"boolean",description:m("vs/editor/common/config/editorOptions","fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:m("vs/editor/common/config/editorOptions","fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:m("vs/editor/common/config/editorOptions","fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?Gn.OFF:e==="true"?Gn.ON:e:e?Gn.ON:Gn.OFF}};Gn.OFF='"liga" off, "calt" off',Gn.ON='"liga" on, "calt" on';let v_=Gn;const Qn=class Qn extends je{constructor(){super(54,"fontVariations",Qn.OFF,{anyOf:[{type:"boolean",description:m("vs/editor/common/config/editorOptions","fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:m("vs/editor/common/config/editorOptions","fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:m("vs/editor/common/config/editorOptions","fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?Qn.OFF:e==="true"?Qn.TRANSLATE:e:e?Qn.TRANSLATE:Qn.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}};Qn.OFF="normal",Qn.TRANSLATE="translate";let __=Qn;class LP extends Fl{constructor(){super(50)}compute(e,t,i){return e.fontInfo}}class OP extends ya{constructor(){super(52,"fontSize",$n.fontSize,{type:"number",minimum:6,maximum:100,default:$n.fontSize,description:m("vs/editor/common/config/editorOptions","fontSize","Controls the font size in pixels.")})}validate(e){const t=cn.float(e,this.defaultValue);return t===0?$n.fontSize:cn.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}const un=class un extends je{constructor(){super(53,"fontWeight",$n.fontWeight,{anyOf:[{type:"number",minimum:un.MINIMUM_VALUE,maximum:un.MAXIMUM_VALUE,errorMessage:m("vs/editor/common/config/editorOptions","fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:un.SUGGESTION_VALUES}],default:$n.fontWeight,description:m("vs/editor/common/config/editorOptions","fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String($e.clampedInt(e,$n.fontWeight,un.MINIMUM_VALUE,un.MAXIMUM_VALUE))}};un.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],un.MINIMUM_VALUE=1,un.MAXIMUM_VALUE=1e3;let w_=un;class $P extends je{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[m("vs/editor/common/config/editorOptions","editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),m("vs/editor/common/config/editorOptions","editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),m("vs/editor/common/config/editorOptions","editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(58,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:m("vs/editor/common/config/editorOptions","editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:m("vs/editor/common/config/editorOptions","editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:m("vs/editor/common/config/editorOptions","editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:m("vs/editor/common/config/editorOptions","editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:m("vs/editor/common/config/editorOptions","editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:m("vs/editor/common/config/editorOptions","editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:m("vs/editor/common/config/editorOptions","alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:m("vs/editor/common/config/editorOptions","alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:m("vs/editor/common/config/editorOptions","alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:m("vs/editor/common/config/editorOptions","alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:m("vs/editor/common/config/editorOptions","alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:nt(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??nt(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??nt(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??nt(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??nt(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??nt(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Bt.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Bt.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Bt.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Bt.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Bt.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand)}}}class NP extends je{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(60,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:m("vs/editor/common/config/editorOptions","hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:m("vs/editor/common/config/editorOptions","hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:m("vs/editor/common/config/editorOptions","hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:m("vs/editor/common/config/editorOptions","hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:m("vs/editor/common/config/editorOptions","hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Y(t.enabled,this.defaultValue.enabled),delay:$e.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:Y(t.sticky,this.defaultValue.sticky),hidingDelay:$e.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:Y(t.above,this.defaultValue.above)}}}class Ml extends Fl{constructor(){super(144)}compute(e,t,i){return Ml.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight);let n=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(n=Math.max(n,t-1));const s=(i+e.viewLineCount+n)/(e.pixelRatio*e.height),o=Math.floor(e.viewLineCount/s);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:n,desiredRatio:s,minimapLineCount:o}}static _computeMinimapLayout(e,t){const i=e.outerWidth,n=e.outerHeight,s=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(s*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};const o=t.stableMinimapLayoutInput,a=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.paddingTop===o.paddingTop&&e.paddingBottom===o.paddingBottom&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping,c=e.lineHeight,l=e.typicalHalfwidthCharacterWidth,u=e.scrollBeyondLastLine,d=e.minimap.renderCharacters;let h=s>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const g=e.minimap.maxColumn,w=e.minimap.size,p=e.minimap.side,b=e.verticalScrollbarWidth,k=e.viewLineCount,D=e.remainingWidth,C=e.isViewportWrapping,R=d?2:3;let A=Math.floor(s*n);const B=A/s;let Q=!1,ee=!1,ue=R*h,Re=h/s,q=1;if(w==="fill"||w==="fit"){const{typicalViewportLineCount:Ye,extraLinesBeforeFirstLine:Ze,extraLinesBeyondLastLine:kt,desiredRatio:Qt,minimapLineCount:vt}=Ml.computeContainedMinimapLineCount({viewLineCount:k,scrollBeyondLastLine:u,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:n,lineHeight:c,pixelRatio:s});if(k/vt>1)Q=!0,ee=!0,h=1,ue=1,Re=h/s;else{let ft=!1,xi=h+1;if(w==="fit"){const Nt=Math.ceil((Ze+k+kt)*ue);C&&a&&D<=t.stableFitRemainingWidth?(ft=!0,xi=t.stableFitMaxMinimapScale):ft=Nt>A}if(w==="fill"||ft){Q=!0;const Nt=h;ue=Math.min(c*s,Math.max(1,Math.floor(1/Qt))),C&&a&&D<=t.stableFitRemainingWidth&&(xi=t.stableFitMaxMinimapScale),h=Math.min(xi,Math.max(1,Math.floor(ue/R))),h>Nt&&(q=Math.min(2,h/Nt)),Re=h/s/q,A=Math.ceil(Math.max(Ye,Ze+k+kt)*ue),C?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=D,t.stableFitMaxMinimapScale=h):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const U=Math.floor(g*Re),J=Math.min(U,Math.max(0,Math.floor((D-b-2)*Re/(l+Re)))+xP);let j=Math.floor(s*J);const oe=j/s;j=Math.floor(j*q);const ge=d?1:2,le=p==="left"?0:i-J-b;return{renderMinimap:ge,minimapLeft:le,minimapWidth:J,minimapHeightIsEditorHeight:Q,minimapIsSampling:ee,minimapScale:h,minimapLineHeight:ue,minimapCanvasInnerWidth:j,minimapCanvasInnerHeight:A,minimapCanvasOuterWidth:oe,minimapCanvasOuterHeight:B}}static computeLayout(e,t){const i=t.outerWidth|0,n=t.outerHeight|0,s=t.lineHeight|0,o=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,c=t.maxDigitWidth,l=t.pixelRatio,u=t.viewLineCount,d=e.get(136),h=d==="inherit"?e.get(135):d,g=h==="inherit"?e.get(131):h,w=e.get(134),p=t.isDominatedByLongLines,b=e.get(57),k=e.get(68).renderType!==0,D=e.get(69),C=e.get(105),R=e.get(84),A=e.get(73),B=e.get(103),Q=B.verticalScrollbarSize,ee=B.verticalHasArrows,ue=B.arrowSize,Re=B.horizontalScrollbarSize,q=e.get(43),U=e.get(110)!=="never";let J=e.get(66);q&&U&&(J+=16);let j=0;if(k){const ye=Math.max(o,D);j=Math.round(ye*c)}let oe=0;b&&(oe=s*t.glyphMarginDecorationLaneCount);let ge=0,le=ge+oe,Ye=le+j,Ze=Ye+J;const kt=i-oe-j-J;let Qt=!1,vt=!1,ct=-1;h==="inherit"&&p?(Qt=!0,vt=!0):g==="on"||g==="bounded"?vt=!0:g==="wordWrapColumn"&&(ct=w);const ft=Ml._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:s,typicalHalfwidthCharacterWidth:a,pixelRatio:l,scrollBeyondLastLine:C,paddingTop:R.top,paddingBottom:R.bottom,minimap:A,verticalScrollbarWidth:Q,viewLineCount:u,remainingWidth:kt,isViewportWrapping:vt},t.memory||new CP);ft.renderMinimap!==0&&ft.minimapLeft===0&&(ge+=ft.minimapWidth,le+=ft.minimapWidth,Ye+=ft.minimapWidth,Ze+=ft.minimapWidth);const xi=kt-ft.minimapWidth,Nt=Math.max(1,Math.floor((xi-Q-2)/a)),qi=ee?ue:0;return vt&&(ct=Math.max(1,Nt),g==="bounded"&&(ct=Math.min(ct,w))),{width:i,height:n,glyphMarginLeft:ge,glyphMarginWidth:oe,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:le,lineNumbersWidth:j,decorationsLeft:Ye,decorationsWidth:J,contentLeft:Ze,contentWidth:xi,minimap:ft,viewportColumn:Nt,isWordWrapMinified:Qt,isViewportWrapping:vt,wrappingColumn:ct,verticalScrollbarWidth:Q,horizontalScrollbarHeight:Re,overviewRuler:{top:qi,width:Q,height:n-2*qi,right:0}}}}class FP extends je{constructor(){super(138,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[m("vs/editor/common/config/editorOptions","wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),m("vs/editor/common/config/editorOptions","wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:m("vs/editor/common/config/editorOptions","wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return nt(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}}var On;(function(r){r.Off="off",r.OnCode="onCode",r.On="on"})(On||(On={}));class MP extends je{constructor(){const e={enabled:On.OnCode};super(65,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:[On.Off,On.OnCode,On.On],default:e.enabled,enumDescriptions:[m("vs/editor/common/config/editorOptions","editor.lightbulb.enabled.off","Disable the code action menu."),m("vs/editor/common/config/editorOptions","editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),m("vs/editor/common/config/editorOptions","editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:m("vs/editor/common/config/editorOptions","enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:nt(e.enabled,this.defaultValue.enabled,[On.Off,On.OnCode,On.On])}}}class HP extends je{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(115,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:m("vs/editor/common/config/editorOptions","editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:m("vs/editor/common/config/editorOptions","editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:m("vs/editor/common/config/editorOptions","editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:m("vs/editor/common/config/editorOptions","editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Y(t.enabled,this.defaultValue.enabled),maxLineCount:$e.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:nt(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:Y(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class UP extends je{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1};super(140,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:m("vs/editor/common/config/editorOptions","inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[m("vs/editor/common/config/editorOptions","editor.inlayHints.on","Inlay hints are enabled"),m("vs/editor/common/config/editorOptions","editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",Ai?"Ctrl+Option":"Ctrl+Alt"),m("vs/editor/common/config/editorOptions","editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",Ai?"Ctrl+Option":"Ctrl+Alt"),m("vs/editor/common/config/editorOptions","editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:m("vs/editor/common/config/editorOptions","inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:m("vs/editor/common/config/editorOptions","inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:m("vs/editor/common/config/editorOptions","inlayHints.padding","Enables the padding around the inlay hints in the editor.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:nt(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:$e.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Bt.string(t.fontFamily,this.defaultValue.fontFamily),padding:Y(t.padding,this.defaultValue.padding)}}}class BP extends je{constructor(){super(66,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):$e.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?$e.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}}class WP extends cn{constructor(){super(67,"lineHeight",$n.lineHeight,e=>cn.clamp(e,0,150),{markdownDescription:m("vs/editor/common/config/editorOptions","lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,i){return e.fontInfo.lineHeight}}class VP extends je{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1};super(73,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:m("vs/editor/common/config/editorOptions","minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:m("vs/editor/common/config/editorOptions","minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[m("vs/editor/common/config/editorOptions","minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),m("vs/editor/common/config/editorOptions","minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),m("vs/editor/common/config/editorOptions","minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:m("vs/editor/common/config/editorOptions","minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:m("vs/editor/common/config/editorOptions","minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:m("vs/editor/common/config/editorOptions","minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:m("vs/editor/common/config/editorOptions","minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:m("vs/editor/common/config/editorOptions","minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:m("vs/editor/common/config/editorOptions","minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Y(t.enabled,this.defaultValue.enabled),autohide:Y(t.autohide,this.defaultValue.autohide),size:nt(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:nt(t.side,this.defaultValue.side,["right","left"]),showSlider:nt(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Y(t.renderCharacters,this.defaultValue.renderCharacters),scale:$e.clampedInt(t.scale,1,1,3),maxColumn:$e.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4)}}}function zP(r){return r==="ctrlCmd"?Ai?"metaKey":"ctrlKey":"altKey"}class jP extends je{constructor(){super(84,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:m("vs/editor/common/config/editorOptions","padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:m("vs/editor/common/config/editorOptions","padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:$e.clampedInt(t.top,0,0,1e3),bottom:$e.clampedInt(t.bottom,0,0,1e3)}}}class qP extends je{constructor(){const e={enabled:!0,cycle:!0};super(86,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:m("vs/editor/common/config/editorOptions","parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:m("vs/editor/common/config/editorOptions","parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Y(t.enabled,this.defaultValue.enabled),cycle:Y(t.cycle,this.defaultValue.cycle)}}}class GP extends Fl{constructor(){super(142)}compute(e,t,i){return e.pixelRatio}}class QP extends je{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[m("vs/editor/common/config/editorOptions","on","Quick suggestions show inside the suggest widget"),m("vs/editor/common/config/editorOptions","inline","Quick suggestions show as ghost text"),m("vs/editor/common/config/editorOptions","off","Quick suggestions are disabled")]}];super(89,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:m("vs/editor/common/config/editorOptions","quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:m("vs/editor/common/config/editorOptions","quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:m("vs/editor/common/config/editorOptions","quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:m("vs/editor/common/config/editorOptions","quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the '{0}'-setting which controls if suggestions are triggered by special characters.","#editor.suggestOnTriggerCharacters#")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const l=e?"on":"off";return{comments:l,strings:l,other:l}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:n}=e,s=["on","inline","off"];let o,a,c;return typeof t=="boolean"?o=t?"on":"off":o=nt(t,this.defaultValue.other,s),typeof i=="boolean"?a=i?"on":"off":a=nt(i,this.defaultValue.comments,s),typeof n=="boolean"?c=n?"on":"off":c=nt(n,this.defaultValue.strings,s),{other:o,comments:a,strings:c}}}class JP extends je{constructor(){super(68,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[m("vs/editor/common/config/editorOptions","lineNumbers.off","Line numbers are not rendered."),m("vs/editor/common/config/editorOptions","lineNumbers.on","Line numbers are rendered as absolute number."),m("vs/editor/common/config/editorOptions","lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),m("vs/editor/common/config/editorOptions","lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:m("vs/editor/common/config/editorOptions","lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}}class KP extends je{constructor(){const e=[],t={type:"number",description:m("vs/editor/common/config/editorOptions","rulers.size","Number of monospace characters at which this editor ruler will render.")};super(102,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:m("vs/editor/common/config/editorOptions","rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:m("vs/editor/common/config/editorOptions","rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:$e.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const n=i;t.push({column:$e.clampedInt(n.column,0,0,1e4),color:n.color})}return t.sort((i,n)=>i.column-n.column),t}return this.defaultValue}}class XP extends je{constructor(){super(92,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function OC(r,e){if(typeof r!="string")return e;switch(r){case"hidden":return 2;case"visible":return 3;default:return 1}}class YP extends je{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(103,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[m("vs/editor/common/config/editorOptions","scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),m("vs/editor/common/config/editorOptions","scrollbar.vertical.visible","The vertical scrollbar will always be visible."),m("vs/editor/common/config/editorOptions","scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:m("vs/editor/common/config/editorOptions","scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[m("vs/editor/common/config/editorOptions","scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),m("vs/editor/common/config/editorOptions","scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),m("vs/editor/common/config/editorOptions","scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:m("vs/editor/common/config/editorOptions","scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:m("vs/editor/common/config/editorOptions","scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:m("vs/editor/common/config/editorOptions","scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:m("vs/editor/common/config/editorOptions","scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:m("vs/editor/common/config/editorOptions","scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=$e.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=$e.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:$e.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:OC(t.vertical,this.defaultValue.vertical),horizontal:OC(t.horizontal,this.defaultValue.horizontal),useShadows:Y(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:Y(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Y(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Y(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Y(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:$e.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:$e.clampedInt(t.verticalSliderSize,n,0,1e3),scrollByPage:Y(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:Y(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}}const Bi="inUntrustedWorkspace",Ns={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class ZP extends je{constructor(){const e={nonBasicASCII:Bi,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Bi,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(125,"unicodeHighlight",e,{[Ns.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Bi],default:e.nonBasicASCII,description:m("vs/editor/common/config/editorOptions","unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[Ns.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:m("vs/editor/common/config/editorOptions","unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[Ns.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:m("vs/editor/common/config/editorOptions","unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[Ns.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Bi],default:e.includeComments,description:m("vs/editor/common/config/editorOptions","unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[Ns.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Bi],default:e.includeStrings,description:m("vs/editor/common/config/editorOptions","unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[Ns.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:m("vs/editor/common/config/editorOptions","unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[Ns.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:m("vs/editor/common/config/editorOptions","unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(Ni(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(Ni(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const n=super.applyUpdate(e,t);return i?new af(n.newValue,!0):n}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:xa(t.nonBasicASCII,Bi,[!0,!1,Bi]),invisibleCharacters:Y(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:Y(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:xa(t.includeComments,Bi,[!0,!1,Bi]),includeStrings:xa(t.includeStrings,Bi,[!0,!1,Bi]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[n,s]of Object.entries(e))s===!0&&(i[n]=!0);return i}}class eT extends je{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default"};super(62,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:m("vs/editor/common/config/editorOptions","inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[m("vs/editor/common/config/editorOptions","inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),m("vs/editor/common/config/editorOptions","inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),m("vs/editor/common/config/editorOptions","inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:m("vs/editor/common/config/editorOptions","inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:m("vs/editor/common/config/editorOptions","inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:m("vs/editor/common/config/editorOptions","inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Y(t.enabled,this.defaultValue.enabled),mode:nt(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:nt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:Y(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:Y(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Bt.string(t.fontFamily,this.defaultValue.fontFamily)}}}class tT extends je{constructor(){const e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1,backgroundColoring:!1};super(63,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:m("vs/editor/common/config/editorOptions","inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[m("vs/editor/common/config/editorOptions","inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),m("vs/editor/common/config/editorOptions","inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),m("vs/editor/common/config/editorOptions","inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:m("vs/editor/common/config/editorOptions","inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:m("vs/editor/common/config/editorOptions","inlineEdit.fontFamily","Controls the font family of the inline edit.")},"editor.experimentalInlineEdit.backgroundColoring":{type:"boolean",default:e.backgroundColoring,description:m("vs/editor/common/config/editorOptions","inlineEdit.backgroundColoring","Controls whether to color the background of inline edits.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Y(t.enabled,this.defaultValue.enabled),showToolbar:nt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:Bt.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:Y(t.keepOnBlur,this.defaultValue.keepOnBlur),backgroundColoring:Y(t.backgroundColoring,this.defaultValue.backgroundColoring)}}}class iT extends je{constructor(){const e={enabled:LC.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:LC.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("vs/editor/common/config/editorOptions","bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:m("vs/editor/common/config/editorOptions","bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Y(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:Y(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class nT extends je{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[m("vs/editor/common/config/editorOptions","editor.guides.bracketPairs.true","Enables bracket pair guides."),m("vs/editor/common/config/editorOptions","editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),m("vs/editor/common/config/editorOptions","editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:m("vs/editor/common/config/editorOptions","editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[m("vs/editor/common/config/editorOptions","editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),m("vs/editor/common/config/editorOptions","editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),m("vs/editor/common/config/editorOptions","editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:m("vs/editor/common/config/editorOptions","editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:m("vs/editor/common/config/editorOptions","editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:m("vs/editor/common/config/editorOptions","editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[m("vs/editor/common/config/editorOptions","editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),m("vs/editor/common/config/editorOptions","editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),m("vs/editor/common/config/editorOptions","editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:m("vs/editor/common/config/editorOptions","editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:xa(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:xa(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:Y(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:Y(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:xa(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function xa(r,e,t){const i=t.indexOf(r);return i===-1?e:t[i]}class rT extends je{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(118,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[m("vs/editor/common/config/editorOptions","suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),m("vs/editor/common/config/editorOptions","suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:m("vs/editor/common/config/editorOptions","suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:m("vs/editor/common/config/editorOptions","suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:m("vs/editor/common/config/editorOptions","suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:m("vs/editor/common/config/editorOptions","suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[m("vs/editor/common/config/editorOptions","suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),m("vs/editor/common/config/editorOptions","suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),m("vs/editor/common/config/editorOptions","suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),m("vs/editor/common/config/editorOptions","suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:m("vs/editor/common/config/editorOptions","suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions (`#editor.quickSuggestions#` and `#editor.suggestOnTriggerCharacters#`) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:m("vs/editor/common/config/editorOptions","suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:m("vs/editor/common/config/editorOptions","suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:m("vs/editor/common/config/editorOptions","suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:m("vs/editor/common/config/editorOptions","suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:m("vs/editor/common/config/editorOptions","suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:m("vs/editor/common/config/editorOptions","suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:m("vs/editor/common/config/editorOptions","deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:m("vs/editor/common/config/editorOptions","editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:nt(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Y(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Y(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Y(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Y(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:nt(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:Y(t.showIcons,this.defaultValue.showIcons),showStatusBar:Y(t.showStatusBar,this.defaultValue.showStatusBar),preview:Y(t.preview,this.defaultValue.preview),previewMode:nt(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:Y(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Y(t.showMethods,this.defaultValue.showMethods),showFunctions:Y(t.showFunctions,this.defaultValue.showFunctions),showConstructors:Y(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:Y(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:Y(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:Y(t.showFields,this.defaultValue.showFields),showVariables:Y(t.showVariables,this.defaultValue.showVariables),showClasses:Y(t.showClasses,this.defaultValue.showClasses),showStructs:Y(t.showStructs,this.defaultValue.showStructs),showInterfaces:Y(t.showInterfaces,this.defaultValue.showInterfaces),showModules:Y(t.showModules,this.defaultValue.showModules),showProperties:Y(t.showProperties,this.defaultValue.showProperties),showEvents:Y(t.showEvents,this.defaultValue.showEvents),showOperators:Y(t.showOperators,this.defaultValue.showOperators),showUnits:Y(t.showUnits,this.defaultValue.showUnits),showValues:Y(t.showValues,this.defaultValue.showValues),showConstants:Y(t.showConstants,this.defaultValue.showConstants),showEnums:Y(t.showEnums,this.defaultValue.showEnums),showEnumMembers:Y(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Y(t.showKeywords,this.defaultValue.showKeywords),showWords:Y(t.showWords,this.defaultValue.showWords),showColors:Y(t.showColors,this.defaultValue.showColors),showFiles:Y(t.showFiles,this.defaultValue.showFiles),showReferences:Y(t.showReferences,this.defaultValue.showReferences),showFolders:Y(t.showFolders,this.defaultValue.showFolders),showTypeParameters:Y(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Y(t.showSnippets,this.defaultValue.showSnippets),showUsers:Y(t.showUsers,this.defaultValue.showUsers),showIssues:Y(t.showIssues,this.defaultValue.showIssues)}}}class sT extends je{constructor(){super(113,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:m("vs/editor/common/config/editorOptions","selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:m("vs/editor/common/config/editorOptions","selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:Y(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:Y(e.selectSubwords,this.defaultValue.selectSubwords)}}}class oT extends je{constructor(){super(137,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[m("vs/editor/common/config/editorOptions","wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),m("vs/editor/common/config/editorOptions","wrappingIndent.same","Wrapped lines get the same indentation as the parent."),m("vs/editor/common/config/editorOptions","wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),m("vs/editor/common/config/editorOptions","wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:m("vs/editor/common/config/editorOptions","wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}}class aT extends Fl{constructor(){super(145)}compute(e,t,i){const n=t.get(144);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}}class cT extends je{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("vs/editor/common/config/editorOptions","dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:m("vs/editor/common/config/editorOptions","dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[m("vs/editor/common/config/editorOptions","dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),m("vs/editor/common/config/editorOptions","dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Y(t.enabled,this.defaultValue.enabled),showDropSelector:nt(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class lT extends je{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(85,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("vs/editor/common/config/editorOptions","pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:m("vs/editor/common/config/editorOptions","pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[m("vs/editor/common/config/editorOptions","pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),m("vs/editor/common/config/editorOptions","pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Y(t.enabled,this.defaultValue.enabled),showPasteSelector:nt(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const $n={fontFamily:Ai?"Menlo, Monaco, 'Courier New', monospace":tr?"'Droid Sans Mono', 'monospace', monospace":"Consolas, 'Courier New', monospace",fontWeight:"normal",fontSize:Ai?12:14,lineHeight:0,letterSpacing:0},uT=[];function O(r){return uT[r.id]=r,r}O(new _e(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:m("vs/editor/common/config/editorOptions","acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),O(new Je(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",m("vs/editor/common/config/editorOptions","acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:m("vs/editor/common/config/editorOptions","acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),O(new kP),O(new $e(3,"accessibilityPageSize",10,1,1073741824,{description:m("vs/editor/common/config/editorOptions","accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),O(new Bt(4,"ariaLabel",m("vs/editor/common/config/editorOptions","editorViewAccessibleLabel","Editor content"))),O(new _e(5,"ariaRequired",!1,void 0)),O(new _e(8,"screenReaderAnnounceInlineSuggestion",!0,{description:m("vs/editor/common/config/editorOptions","screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),O(new Je(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("vs/editor/common/config/editorOptions","editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),m("vs/editor/common/config/editorOptions","editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:m("vs/editor/common/config/editorOptions","autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),O(new Je(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("vs/editor/common/config/editorOptions","editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),m("vs/editor/common/config/editorOptions","editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:m("vs/editor/common/config/editorOptions","autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),O(new Je(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",m("vs/editor/common/config/editorOptions","editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:m("vs/editor/common/config/editorOptions","autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),O(new Je(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",m("vs/editor/common/config/editorOptions","editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:m("vs/editor/common/config/editorOptions","autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),O(new Je(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("vs/editor/common/config/editorOptions","editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),m("vs/editor/common/config/editorOptions","editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:m("vs/editor/common/config/editorOptions","autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),O(new lf(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],EP,{enumDescriptions:[m("vs/editor/common/config/editorOptions","editor.autoIndent.none","The editor will not insert indentation automatically."),m("vs/editor/common/config/editorOptions","editor.autoIndent.keep","The editor will keep the current line's indentation."),m("vs/editor/common/config/editorOptions","editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),m("vs/editor/common/config/editorOptions","editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),m("vs/editor/common/config/editorOptions","editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:m("vs/editor/common/config/editorOptions","autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),O(new _e(13,"automaticLayout",!1)),O(new Je(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[m("vs/editor/common/config/editorOptions","editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),m("vs/editor/common/config/editorOptions","editor.autoSurround.quotes","Surround with quotes but not brackets."),m("vs/editor/common/config/editorOptions","editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:m("vs/editor/common/config/editorOptions","autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),O(new iT),O(new nT),O(new _e(116,"stickyTabStops",!1,{description:m("vs/editor/common/config/editorOptions","stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),O(new _e(17,"codeLens",!0,{description:m("vs/editor/common/config/editorOptions","codeLens","Controls whether the editor shows CodeLens.")})),O(new Bt(18,"codeLensFontFamily","",{description:m("vs/editor/common/config/editorOptions","codeLensFontFamily","Controls the font family for CodeLens.")})),O(new $e(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:m("vs/editor/common/config/editorOptions","codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),O(new _e(20,"colorDecorators",!0,{description:m("vs/editor/common/config/editorOptions","colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),O(new Je(147,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[m("vs/editor/common/config/editorOptions","editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),m("vs/editor/common/config/editorOptions","editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),m("vs/editor/common/config/editorOptions","editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:m("vs/editor/common/config/editorOptions","colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),O(new $e(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:m("vs/editor/common/config/editorOptions","colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),O(new _e(22,"columnSelection",!1,{description:m("vs/editor/common/config/editorOptions","columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),O(new DP),O(new _e(24,"contextmenu",!0)),O(new _e(25,"copyWithSyntaxHighlighting",!0,{description:m("vs/editor/common/config/editorOptions","copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),O(new lf(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],IP,{description:m("vs/editor/common/config/editorOptions","cursorBlinking","Control the cursor animation style.")})),O(new Je(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[m("vs/editor/common/config/editorOptions","cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),m("vs/editor/common/config/editorOptions","cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),m("vs/editor/common/config/editorOptions","cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:m("vs/editor/common/config/editorOptions","cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),O(new lf(28,"cursorStyle",ln.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],PP,{description:m("vs/editor/common/config/editorOptions","cursorStyle","Controls the cursor style.")})),O(new $e(29,"cursorSurroundingLines",0,0,1073741824,{description:m("vs/editor/common/config/editorOptions","cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),O(new Je(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[m("vs/editor/common/config/editorOptions","cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),m("vs/editor/common/config/editorOptions","cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:m("vs/editor/common/config/editorOptions","cursorSurroundingLinesStyle","Controls when `#cursorSurroundingLines#` should be enforced.")})),O(new $e(31,"cursorWidth",0,0,1073741824,{markdownDescription:m("vs/editor/common/config/editorOptions","cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),O(new _e(32,"disableLayerHinting",!1)),O(new _e(33,"disableMonospaceOptimizations",!1)),O(new _e(34,"domReadOnly",!1)),O(new _e(35,"dragAndDrop",!0,{description:m("vs/editor/common/config/editorOptions","dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),O(new AP),O(new cT),O(new HP),O(new Je(38,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[m("vs/editor/common/config/editorOptions","experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),m("vs/editor/common/config/editorOptions","experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),m("vs/editor/common/config/editorOptions","experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:m("vs/editor/common/config/editorOptions","experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),O(new Bt(39,"extraEditorClassName","")),O(new cn(40,"fastScrollSensitivity",5,r=>r<=0?5:r,{markdownDescription:m("vs/editor/common/config/editorOptions","fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),O(new RP),O(new _e(42,"fixedOverflowWidgets",!1)),O(new _e(43,"folding",!0,{description:m("vs/editor/common/config/editorOptions","folding","Controls whether the editor has code folding enabled.")})),O(new Je(44,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[m("vs/editor/common/config/editorOptions","foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),m("vs/editor/common/config/editorOptions","foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:m("vs/editor/common/config/editorOptions","foldingStrategy","Controls the strategy for computing folding ranges.")})),O(new _e(45,"foldingHighlight",!0,{description:m("vs/editor/common/config/editorOptions","foldingHighlight","Controls whether the editor should highlight folded ranges.")})),O(new _e(46,"foldingImportsByDefault",!1,{description:m("vs/editor/common/config/editorOptions","foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),O(new $e(47,"foldingMaximumRegions",5e3,10,65e3,{description:m("vs/editor/common/config/editorOptions","foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),O(new _e(48,"unfoldOnClickAfterEndOfLine",!1,{description:m("vs/editor/common/config/editorOptions","unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),O(new Bt(49,"fontFamily",$n.fontFamily,{description:m("vs/editor/common/config/editorOptions","fontFamily","Controls the font family.")})),O(new LP),O(new v_),O(new OP),O(new w_),O(new __),O(new _e(55,"formatOnPaste",!1,{description:m("vs/editor/common/config/editorOptions","formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),O(new _e(56,"formatOnType",!1,{description:m("vs/editor/common/config/editorOptions","formatOnType","Controls whether the editor should automatically format the line after typing.")})),O(new _e(57,"glyphMargin",!0,{description:m("vs/editor/common/config/editorOptions","glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),O(new $P),O(new _e(59,"hideCursorInOverviewRuler",!1,{description:m("vs/editor/common/config/editorOptions","hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),O(new NP),O(new _e(61,"inDiffEditor",!1)),O(new cn(64,"letterSpacing",$n.letterSpacing,r=>cn.clamp(r,-5,20),{description:m("vs/editor/common/config/editorOptions","letterSpacing","Controls the letter spacing in pixels.")})),O(new MP),O(new BP),O(new WP),O(new JP),O(new $e(69,"lineNumbersMinChars",5,1,300)),O(new _e(70,"linkedEditing",!1,{description:m("vs/editor/common/config/editorOptions","linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),O(new _e(71,"links",!0,{description:m("vs/editor/common/config/editorOptions","links","Controls whether the editor should detect links and make them clickable.")})),O(new Je(72,"matchBrackets","always",["always","near","never"],{description:m("vs/editor/common/config/editorOptions","matchBrackets","Highlight matching brackets.")})),O(new VP),O(new Je(74,"mouseStyle","text",["text","default","copy"])),O(new cn(75,"mouseWheelScrollSensitivity",1,r=>r===0?1:r,{markdownDescription:m("vs/editor/common/config/editorOptions","mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),O(new _e(76,"mouseWheelZoom",!1,{markdownDescription:Ai?m("vs/editor/common/config/editorOptions","mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):m("vs/editor/common/config/editorOptions","mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),O(new _e(77,"multiCursorMergeOverlapping",!0,{description:m("vs/editor/common/config/editorOptions","multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),O(new lf(78,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],zP,{markdownEnumDescriptions:[m("vs/editor/common/config/editorOptions","multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),m("vs/editor/common/config/editorOptions","multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:m("vs/editor/common/config/editorOptions",{key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),O(new Je(79,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[m("vs/editor/common/config/editorOptions","multiCursorPaste.spread","Each cursor pastes a single line of the text."),m("vs/editor/common/config/editorOptions","multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:m("vs/editor/common/config/editorOptions","multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),O(new $e(80,"multiCursorLimit",1e4,1,1e5,{markdownDescription:m("vs/editor/common/config/editorOptions","multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),O(new Je(81,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[m("vs/editor/common/config/editorOptions","occurrencesHighlight.off","Does not highlight occurrences."),m("vs/editor/common/config/editorOptions","occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),m("vs/editor/common/config/editorOptions","occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:m("vs/editor/common/config/editorOptions","occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),O(new _e(82,"overviewRulerBorder",!0,{description:m("vs/editor/common/config/editorOptions","overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),O(new $e(83,"overviewRulerLanes",3,0,3)),O(new jP),O(new lT),O(new qP),O(new Je(87,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[m("vs/editor/common/config/editorOptions","peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),m("vs/editor/common/config/editorOptions","peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:m("vs/editor/common/config/editorOptions","peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),O(new _e(88,"definitionLinkOpensInPeek",!1,{description:m("vs/editor/common/config/editorOptions","definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),O(new QP),O(new $e(90,"quickSuggestionsDelay",10,0,1073741824,{description:m("vs/editor/common/config/editorOptions","quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),O(new _e(91,"readOnly",!1)),O(new XP),O(new _e(93,"renameOnType",!1,{description:m("vs/editor/common/config/editorOptions","renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:m("vs/editor/common/config/editorOptions","renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),O(new _e(94,"renderControlCharacters",!0,{description:m("vs/editor/common/config/editorOptions","renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),O(new Je(95,"renderFinalNewline",tr?"dimmed":"on",["off","on","dimmed"],{description:m("vs/editor/common/config/editorOptions","renderFinalNewline","Render last line number when the file ends with a newline.")})),O(new Je(96,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",m("vs/editor/common/config/editorOptions","renderLineHighlight.all","Highlights both the gutter and the current line.")],description:m("vs/editor/common/config/editorOptions","renderLineHighlight","Controls how the editor should render the current line highlight.")})),O(new _e(97,"renderLineHighlightOnlyWhenFocus",!1,{description:m("vs/editor/common/config/editorOptions","renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),O(new Je(98,"renderValidationDecorations","editable",["editable","on","off"])),O(new Je(99,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",m("vs/editor/common/config/editorOptions","renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),m("vs/editor/common/config/editorOptions","renderWhitespace.selection","Render whitespace characters only on selected text."),m("vs/editor/common/config/editorOptions","renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:m("vs/editor/common/config/editorOptions","renderWhitespace","Controls how the editor should render whitespace characters.")})),O(new $e(100,"revealHorizontalRightPadding",15,0,1e3)),O(new _e(101,"roundedSelection",!0,{description:m("vs/editor/common/config/editorOptions","roundedSelection","Controls whether selections should have rounded corners.")})),O(new KP),O(new YP),O(new $e(104,"scrollBeyondLastColumn",4,0,1073741824,{description:m("vs/editor/common/config/editorOptions","scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),O(new _e(105,"scrollBeyondLastLine",!0,{description:m("vs/editor/common/config/editorOptions","scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),O(new _e(106,"scrollPredominantAxis",!0,{description:m("vs/editor/common/config/editorOptions","scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),O(new _e(107,"selectionClipboard",!0,{description:m("vs/editor/common/config/editorOptions","selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:tr})),O(new _e(108,"selectionHighlight",!0,{description:m("vs/editor/common/config/editorOptions","selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),O(new _e(109,"selectOnLineNumbers",!0)),O(new Je(110,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[m("vs/editor/common/config/editorOptions","showFoldingControls.always","Always show the folding controls."),m("vs/editor/common/config/editorOptions","showFoldingControls.never","Never show the folding controls and reduce the gutter size."),m("vs/editor/common/config/editorOptions","showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:m("vs/editor/common/config/editorOptions","showFoldingControls","Controls when the folding controls on the gutter are shown.")})),O(new _e(111,"showUnused",!0,{description:m("vs/editor/common/config/editorOptions","showUnused","Controls fading out of unused code.")})),O(new _e(139,"showDeprecated",!0,{description:m("vs/editor/common/config/editorOptions","showDeprecated","Controls strikethrough deprecated variables.")})),O(new UP),O(new Je(112,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[m("vs/editor/common/config/editorOptions","snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),m("vs/editor/common/config/editorOptions","snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),m("vs/editor/common/config/editorOptions","snippetSuggestions.inline","Show snippets suggestions with other suggestions."),m("vs/editor/common/config/editorOptions","snippetSuggestions.none","Do not show snippet suggestions.")],description:m("vs/editor/common/config/editorOptions","snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),O(new sT),O(new _e(114,"smoothScrolling",!1,{description:m("vs/editor/common/config/editorOptions","smoothScrolling","Controls whether the editor will scroll using an animation.")})),O(new $e(117,"stopRenderingLineAfter",1e4,-1,1073741824)),O(new rT),O(new eT),O(new tT),O(new _e(148,"inlineCompletionsAccessibilityVerbose",!1,{description:m("vs/editor/common/config/editorOptions","inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),O(new $e(119,"suggestFontSize",0,0,1e3,{markdownDescription:m("vs/editor/common/config/editorOptions","suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),O(new $e(120,"suggestLineHeight",0,0,1e3,{markdownDescription:m("vs/editor/common/config/editorOptions","suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),O(new _e(121,"suggestOnTriggerCharacters",!0,{description:m("vs/editor/common/config/editorOptions","suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),O(new Je(122,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[m("vs/editor/common/config/editorOptions","suggestSelection.first","Always select the first suggestion."),m("vs/editor/common/config/editorOptions","suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),m("vs/editor/common/config/editorOptions","suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:m("vs/editor/common/config/editorOptions","suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),O(new Je(123,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[m("vs/editor/common/config/editorOptions","tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),m("vs/editor/common/config/editorOptions","tabCompletion.off","Disable tab completions."),m("vs/editor/common/config/editorOptions","tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:m("vs/editor/common/config/editorOptions","tabCompletion","Enables tab completions.")})),O(new $e(124,"tabIndex",0,-1,1073741824)),O(new ZP),O(new Je(126,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[m("vs/editor/common/config/editorOptions","unusualLineTerminators.auto","Unusual line terminators are automatically removed."),m("vs/editor/common/config/editorOptions","unusualLineTerminators.off","Unusual line terminators are ignored."),m("vs/editor/common/config/editorOptions","unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:m("vs/editor/common/config/editorOptions","unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),O(new _e(127,"useShadowDOM",!0)),O(new _e(128,"useTabStops",!0,{description:m("vs/editor/common/config/editorOptions","useTabStops","Inserting and deleting whitespace follows tab stops.")})),O(new Je(129,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[m("vs/editor/common/config/editorOptions","wordBreak.normal","Use the default line break rule."),m("vs/editor/common/config/editorOptions","wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:m("vs/editor/common/config/editorOptions","wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),O(new Bt(130,"wordSeparators",bC,{description:m("vs/editor/common/config/editorOptions","wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),O(new Je(131,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[m("vs/editor/common/config/editorOptions","wordWrap.off","Lines will never wrap."),m("vs/editor/common/config/editorOptions","wordWrap.on","Lines will wrap at the viewport width."),m("vs/editor/common/config/editorOptions",{key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),m("vs/editor/common/config/editorOptions",{key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:m("vs/editor/common/config/editorOptions",{key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),O(new Bt(132,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣")),O(new Bt(133,"wordWrapBreakBeforeCharacters","([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋")),O(new $e(134,"wordWrapColumn",80,1,1073741824,{markdownDescription:m("vs/editor/common/config/editorOptions",{key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),O(new Je(135,"wordWrapOverride1","inherit",["off","on","inherit"])),O(new Je(136,"wordWrapOverride2","inherit",["off","on","inherit"])),O(new TP),O(new _e(146,"defaultColorDecorators",!1,{markdownDescription:m("vs/editor/common/config/editorOptions","defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),O(new GP),O(new _e(143,"tabFocusMode",!1,{markdownDescription:m("vs/editor/common/config/editorOptions","tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),O(new Ml),O(new aT),O(new oT),O(new FP);function $C(r,e,t,i,n,s){if(Array.isArray(r)){let o=0;for(const a of r){const c=$C(a,e,t,i,n,s);if(c===10)return c;c>o&&(o=c)}return o}else{if(typeof r=="string")return i?r==="*"?5:r===t?10:0:0;if(r){const{language:o,pattern:a,scheme:c,hasAccessToAllModels:l,notebookType:u}=r;if(!i&&!l)return 0;u&&n&&(e=n);let d=0;if(c)if(c===e.scheme)d=10;else if(c==="*")d=5;else return 0;if(o)if(o===t)d=10;else if(o==="*")d=Math.max(d,5);else return 0;if(u)if(u===s)d=10;else if(u==="*"&&s!==void 0)d=Math.max(d,5);else return 0;if(a){let h;if(typeof a=="string"?h=a:h={...a,base:vo(a.base)},h===e.fsPath||Fc(h,e.fsPath))d=10;else return 0}return d}else return 0}}function NC(r){return typeof r=="string"?!1:Array.isArray(r)?r.some(NC):!!r.notebookType}var b_;(function(r){r[r.None=0]="None",r[r.Indent=1]="Indent",r[r.IndentOutdent=2]="IndentOutdent",r[r.Outdent=3]="Outdent"})(b_||(b_={})),ne("editSessionIdentityService");var y_;(function(r){r[r.Complete=100]="Complete",r[r.Partial=50]="Partial",r[r.None=0]="None"})(y_||(y_={}));class dT{constructor(e){this._relatedInformationProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(G.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,t,i){if(this._relatedInformationProviders.size===0)throw new Error("No related information providers registered");const n=this._relatedInformationProviders.get(e);if(!n)throw new Error("related information provider not found");return await n.provideRelatedInformation(t,i)??[]}getRelatedInformation(e,t,i){return this._proxy.$getAiRelatedInformation(t,i)}registerRelatedInformationProvider(e,t,i){const n=this._nextHandle;return this._nextHandle++,this._relatedInformationProviders.set(n,i),this._proxy.$registerAiRelatedInformationProvider(n,t),new Pe(()=>{this._proxy.$unregisterAiRelatedInformationProvider(n),this._relatedInformationProviders.delete(n)})}}function FC(r){for(let e=0,t=r.length;e<t;e+=4){const i=r[e+0],n=r[e+1],s=r[e+2],o=r[e+3];r[e+0]=o,r[e+1]=s,r[e+2]=n,r[e+3]=i}}function hT(r){const e=new Uint8Array(r.buffer,r.byteOffset,r.length*4);return Sb()||FC(e),me.wrap(e)}function fT(r){const e=r.buffer;if(Sb()||FC(e),e.byteOffset%4===0)return new Uint32Array(e.buffer,e.byteOffset,e.length/4);{const t=new Uint8Array(e.byteLength);return t.set(e),new Uint32Array(t.buffer,t.byteOffset,t.length/4)}}function x_(r){const e=new Uint32Array(pT(r));let t=0;if(e[t++]=r.id,r.type==="full")e[t++]=1,e[t++]=r.data.length,e.set(r.data,t),t+=r.data.length;else{e[t++]=2,e[t++]=r.deltas.length;for(const i of r.deltas)e[t++]=i.start,e[t++]=i.deleteCount,i.data?(e[t++]=i.data.length,e.set(i.data,t),t+=i.data.length):e[t++]=0}return hT(e)}function pT(r){let e=0;if(e+=2,r.type==="full")e+=1+r.data.length;else{e+=1,e+=3*r.deltas.length;for(const t of r.deltas)t.data&&(e+=t.data.length)}return e}function MC(r){const e=fT(r);let t=0;const i=e[t++];if(e[t++]===1){const a=e[t++],c=e.subarray(t,t+a);return t+=a,{id:i,type:"full",data:c}}const s=e[t++],o=[];for(let a=0;a<s;a++){const c=e[t++],l=e[t++],u=e[t++];let d;u>0&&(d=e.subarray(t,t+u),t+=u),o[a]={start:c,deleteCount:l,data:d}}return{id:i,type:"delta",deltas:o}}const gT=[new ve("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[W.Uri,W.Position],new pe("A promise that resolves to an array of DocumentHighlight-instances.",Nn(na.to))),new ve("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[W.Uri],new pe("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",(r,e)=>{if(wp(r))return;class t extends Vc{static to(n){const s=new t(n.name,Pi.to(n.kind),n.containerName||"",new vi(e[0],F.to(n.range)));return s.detail=n.detail,s.range=s.location.range,s.selectionRange=F.to(n.selectionRange),s.children=n.children?n.children.map(t.to):[],s}}return r.map(t.to)})),new ve("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[W.Uri,new W("options","Formatting options",r=>!0,r=>r)],new pe("A promise that resolves to an array of TextEdits.",Nn(St.to))),new ve("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[W.Uri,W.Range,new W("options","Formatting options",r=>!0,r=>r)],new pe("A promise that resolves to an array of TextEdits.",Nn(St.to))),new ve("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[W.Uri,W.Position,new W("ch","Trigger character",r=>typeof r=="string",r=>r),new W("options","Formatting options",r=>!0,r=>r)],new pe("A promise that resolves to an array of TextEdits.",Nn(St.to))),new ve("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[W.Uri,W.Position],new pe("A promise that resolves to an array of Location or LocationLink instances.",uf)),new ve("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[W.Uri,W.Position],new pe("A promise that resolves to an array of Location or LocationLink instances.",uf)),new ve("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[W.Uri,W.Position],new pe("A promise that resolves to an array of Location or LocationLink instances.",uf)),new ve("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[W.Uri,W.Position],new pe("A promise that resolves to an array of Location or LocationLink instances.",uf)),new ve("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[W.Uri,W.Position],new pe("A promise that resolves to an array of Location-instances.",Nn(_i.to))),new ve("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[W.Uri,W.Position],new pe("A promise that resolves to an array of Hover-instances.",Nn(bh.to))),new ve("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[W.Uri,new W("position","A position in a text document",r=>Array.isArray(r)&&r.every(e=>Se.isPosition(e)),r=>r.map(We.from))],new pe("A promise that resolves to an array of ranges.",r=>r.map(e=>{let t;for(const i of e.reverse())t=new qc(F.to(i),t);return t}))),new ve("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[W.String.with("query","Search string")],new pe("A promise that resolves to an array of SymbolInformation-instances.",r=>r.map(dl.to))),new ve("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[W.Uri,W.Position],new pe("A promise that resolves to an array of CallHierarchyItem-instances",r=>r.map(Is.to))),new ve("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[W.CallHierarchyItem],new pe("A promise that resolves to an array of CallHierarchyIncomingCall-instances",r=>r.map($m.to))),new ve("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[W.CallHierarchyItem],new pe("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",r=>r.map(Nm.to))),new ve("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[W.Uri,W.Position],new pe("A promise that resolves to a range and placeholder text.",r=>{if(r)return{range:F.to(r.range),placeholder:r.text}})),new ve("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[W.Uri,W.Position,W.String.with("newName","The new symbol name")],new pe("A promise that resolves to a WorkspaceEdit.",r=>{if(r){if(r.rejectReason)throw new Error(r.rejectReason);return ei.to(r)}})),new ve("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[W.Uri,W.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new pe("A promise that resolves to an array of DocumentLink-instances.",r=>r.map(Ps.to))),new ve("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[W.Uri],new pe("A promise that resolves to SemanticTokensLegend.",r=>{if(r)return new sm(r.tokenTypes,r.tokenModifiers)})),new ve("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[W.Uri],new pe("A promise that resolves to SemanticTokens.",r=>{if(!r)return;const e=MC(r);if(e.type==="full")return new Jo(e.data,void 0)})),new ve("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[W.Uri,W.Range.optional()],new pe("A promise that resolves to SemanticTokensLegend.",r=>{if(r)return new sm(r.tokenTypes,r.tokenModifiers)})),new ve("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[W.Uri,W.Range],new pe("A promise that resolves to SemanticTokens.",r=>{if(!r)return;const e=MC(r);if(e.type==="full")return new Jo(e.data,void 0)})),new ve("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[W.Uri,W.Position,W.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),W.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new pe("A promise that resolves to a CompletionList-instance.",(r,e,t)=>{if(!r)return new Ho([]);const i=r.suggestions.map(n=>Bm.to(n,t));return new Ho(i,r.incomplete)})),new ve("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[W.Uri,W.Position,W.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new pe("A promise that resolves to SignatureHelp.",r=>{if(r)return fl.to(r)})),new ve("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[W.Uri,W.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new pe("A promise that resolves to an array of CodeLens-instances.",(r,e,t)=>Nn(i=>new Rd(F.to(i.range),i.command&&t.fromInternal(i.command)))(r))),new ve("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[W.Uri,new W("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",r=>be.isRange(r),r=>kn.isSelection(r)?Ii.from(r):F.from(r)),W.String.with("kind","Code action kind to return code actions for").optional(),W.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new pe("A promise that resolves to an array of Command-instances.",(r,e,t)=>Nn(i=>{if(i._isSynthetic){if(!i.command)throw new Error("Synthetic code actions must have a command");return t.fromInternal(i.command)}else{const n=new Ad(i.title,i.kind?new it(i.kind):void 0);return i.edit&&(n.edit=ei.to(i.edit)),i.command&&(n.command=t.fromInternal(i.command)),n.isPreferred=i.isPreferred,n}})(r))),new ve("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[W.Uri],new pe("A promise that resolves to an array of ColorInformation objects.",r=>r?r.map(e=>new Md(F.to(e.range),ra.to(e.color))):[])),new ve("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new W("color","The color to show and insert",r=>r instanceof Vo,ra.from),new W("context","Context object with uri and range",r=>!0,r=>({uri:r.uri,range:F.from(r.range)}))],new pe("A promise that resolves to an array of ColorPresentation objects.",r=>r?r.map(Ih.to):[])),new ve("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[W.Uri,W.Range],new pe("A promise that resolves to an array of Inlay objects",(r,e,t)=>r.map(Wm.to.bind(void 0,t)))),new ve("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[W.Uri],new pe("A promise that resolves to an array of FoldingRange objects",(r,e)=>{if(r)return r.map(Th.to)})),new ve("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new pe("A promise that resolves to an array of NotebookContentProvider static info objects.",Nn(r=>({viewType:r.viewType,displayName:r.displayName,options:{transientOutputs:r.options.transientOutputs,transientCellMetadata:r.options.transientCellMetadata,transientDocumentMetadata:r.options.transientDocumentMetadata},filenamePattern:r.filenamePattern.map(e=>Lh.to(e))})))),new ve("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[W.Uri,W.Range,new W("context","An InlineValueContext",r=>r&&typeof r.frameId=="number"&&r.stoppedLocation instanceof be,r=>xh.from(r))],new pe("A promise that resolves to an array of InlineValue objects",r=>r.map(yh.to))),new ve("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new W("uriOrString","Uri-instance or string (only http/https)",r=>y.isUri(r)||typeof r=="string"&&FE(r,Z.http,Z.https),r=>r),new W("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",r=>r===void 0||typeof r=="number"||typeof r=="object",r=>r&&(typeof r=="number"?[bt.from(r),void 0]:[bt.from(r.viewColumn),pl.from(r)])).optional(),W.String.with("label","").optional()],pe.Void),new ve("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[W.Uri.with("resource","Resource to open"),W.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor"),new W("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",r=>r===void 0||typeof r=="number"||typeof r=="object",r=>r&&(typeof r=="number"?[bt.from(r),void 0]:[bt.from(r.viewColumn),pl.from(r)])).optional()],pe.Void),new ve("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[W.Uri.with("left","Left-hand side resource of the diff editor"),W.Uri.with("right","Right-hand side resource of the diff editor"),W.String.with("title","Human readable title for the diff editor").optional(),new W("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",r=>r===void 0||typeof r=="object",r=>r&&[bt.from(r.viewColumn),pl.from(r)]).optional()],pe.Void),new ve("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[W.String.with("title","Human readable title for the changes editor"),new W("resourceList","List of resources to compare",r=>{for(const e of r){if(e.length!==3)return!1;const[t,i,n]=e;if(!y.isUri(t)||!y.isUri(i)&&i!==void 0&&i!==null||!y.isUri(n)&&n!==void 0&&n!==null)return!1}return!0},r=>r)],pe.Void),new ve("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[W.Uri,W.Position],new pe("A promise that resolves to an array of TypeHierarchyItem-instances",r=>r.map(Ts.to))),new ve("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[W.TypeHierarchyItem],new pe("A promise that resolves to an array of TypeHierarchyItem-instances",r=>r.map(Ts.to))),new ve("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[W.TypeHierarchyItem],new pe("A promise that resolves to an array of TypeHierarchyItem-instances",r=>r.map(Ts.to))),new ve("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[W.TestItem],pe.Void),new ve("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[W.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],pe.Void),new ve("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[W.String.with("name","The context key name"),new W("value","The context key value",()=>!0,r=>r)],pe.Void),new ve("vscode.executeMappedEditsProvider","_executeMappedEditsProvider","Execute Mapped Edits Provider",[W.Uri,W.StringArray,new W("MappedEditsContext","Mapped Edits Context",r=>Rh.is(r),r=>Rh.from(r))],new pe("A promise that resolves to a workspace edit or null",r=>r?ei.to(r):null))];class mT{static register(e){gT.forEach(e.registerApiCommand,e),this._registerValidateWhenClausesCommand(e)}static _registerValidateWhenClausesCommand(e){e.registerCommand(!1,"_validateWhenClauses",Ck)}}function Nn(r){return e=>{if(Array.isArray(e))return e.map(r)}}function uf(r){if(!Array.isArray(r))return;const e=[];for(const t of r)z2(t)?e.push(hl.to(t)):e.push(_i.to(t));return e}const HC="__";ne("IAuthenticationService");class vT{constructor(e){this._authenticationProviders=new Map,this._onDidChangeSessions=new T,this.onDidChangeSessions=this._onDidChangeSessions.event,this._getSessionTaskSingler=new UC,this._getSessionsTaskSingler=new UC,this._proxy=e.getProxy(G.MainThreadAuthentication)}async getSession(e,t,i,n={}){const s=Xe.toKey(e.identifier),o=[...i].sort().join(" ");return await this._getSessionTaskSingler.getOrCreate(`${s} ${t} ${o}`,async()=>{await this._proxy.$ensureProvider(t);const a=e.displayName||e.name;return this._proxy.$getSession(t,i,s,a,n)})}async getSessions(e,t,i){const n=Xe.toKey(e.identifier),s=[...i].sort().join(" ");return await this._getSessionsTaskSingler.getOrCreate(`${n} ${s}`,async()=>{await this._proxy.$ensureProvider(t);const o=e.displayName||e.name;return this._proxy.$getSessions(t,i,n,o)})}async removeSession(e,t){const i=this._authenticationProviders.get(e);return i?i.provider.removeSession(t):this._proxy.$removeSession(e,t)}registerAuthenticationProvider(e,t,i,n){if(this._authenticationProviders.get(e))throw new Error(`An authentication provider with id '${e}' is already registered.`);this._authenticationProviders.set(e,{label:t,provider:i,options:n??{supportsMultipleAccounts:!1}});const s=i.onDidChangeSessions(o=>this._proxy.$sendDidChangeSessions(e,o));return this._proxy.$registerAuthenticationProvider(e,t,(n==null?void 0:n.supportsMultipleAccounts)??!1),new Pe(()=>{s.dispose(),this._authenticationProviders.delete(e),this._proxy.$unregisterAuthenticationProvider(e)})}$createSession(e,t,i){const n=this._authenticationProviders.get(e);if(n)return Promise.resolve(n.provider.createSession(t,i));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$removeSession(e,t){const i=this._authenticationProviders.get(e);if(i)return Promise.resolve(i.provider.removeSession(t));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$getSessions(e,t){const i=this._authenticationProviders.get(e);if(i)return Promise.resolve(i.provider.getSessions(t));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$onDidChangeAuthenticationSessions(e,t){return e.startsWith(HC)||this._onDidChangeSessions.fire({provider:{id:e,label:t}}),Promise.resolve()}}class UC{constructor(){this._inFlightPromises=new Map}getOrCreate(e,t){const i=this._inFlightPromises.get(e);if(i)return i;const n=t().finally(()=>this._inFlightPromises.delete(e));return this._inFlightPromises.set(e,n),n}}let C_=class{constructor(e,t){this._proxy=e.getProxy(G.MainThreadBulkEdits),this._versionInformationProvider={getTextDocumentVersion:i=>{var n;return(n=t.getDocument(i))==null?void 0:n.version},getNotebookDocumentVersion:()=>{}}}applyWorkspaceEdit(e,t,i){const n=ei.from(e,this._versionInformationProvider);return this._proxy.$tryApplyWorkspaceEdit(n,void 0,(i==null?void 0:i.isRefactoring)??!1)}};C_=H([N(0,Ve)],C_);const zf=class zf{constructor(e,t){this.extension=e,this.provider=t,this.handle=zf._pool++}};zf._pool=0;let S_=zf;const jf=class jf{constructor(e){this._chatProvider=new Map,this._chatSessions=new Map,this._proxy=e.getProxy(G.MainThreadChat)}registerChatProvider(e,t,i){const n=new S_(e,i);return this._chatProvider.set(n.handle,n),this._proxy.$registerChatProvider(n.handle,t),Le(()=>{this._proxy.$unregisterChatProvider(n.handle),this._chatProvider.delete(n.handle)})}transferChatSession(e,t){const i=Jr.find(this._chatSessions.keys(),n=>this._chatSessions.get(n)===e)??0;typeof i=="number"&&this._proxy.$transferChatSession(i,t)}sendInteractiveRequestToProvider(e,t){this._proxy.$sendRequestToProvider(e,t)}async $prepareChat(e,t){var o,a,c,l;const i=this._chatProvider.get(e);if(!i)return;const n=await i.provider.prepareSession(t);if(!n)return;const s=jf._nextId++;return this._chatSessions.set(s,n),{id:s,requesterUsername:(o=n.requester)==null?void 0:o.name,requesterAvatarIconUri:(a=n.requester)==null?void 0:a.icon,responderUsername:(c=n.responder)==null?void 0:c.name,responderAvatarIconUri:(l=n.responder)==null?void 0:l.icon,inputPlaceholder:n.inputPlaceholder}}$releaseSession(e){this._chatSessions.delete(e)}};jf._nextId=0;let E_=jf;var df;(function(r){r[r.Down=0]="Down",r[r.Up=1]="Up"})(df||(df={}));var BC;(function(r){r[r.Action=1]="Action",r[r.Toolbar=2]="Toolbar"})(BC||(BC={})),ne("IChatService");class _T{constructor(e,t,i,n,s,o){this._extension=e,this._request=t,this._proxy=i,this._logService=n,this._commandsConverter=s,this._sessionDisposables=o,this._stopWatch=vn.create(!1),this._isClosed=!1}close(){this._isClosed=!0}get timings(){return{firstProgress:this._firstProgress,totalElapsed:this._stopWatch.elapsed()}}get apiObject(){if(!this._apiObject){let t=function(n){if(e._isClosed){const s=new Error("Response stream has been closed");throw Error.captureStackTrace(s,n),s}};const e=this;this._stopWatch.reset();const i=n=>{typeof this._firstProgress>"u"&&"content"in n&&(this._firstProgress=this._stopWatch.elapsed()),this._proxy.$handleProgressChunk(this._request.requestId,n)};this._apiObject={markdown(n){t(this.markdown);const s=new hh(n),o=_l.to(s);return i(o),this},filetree(n,s){t(this.filetree);const o=new fh(n,s),a=wl.to(o);return i(a),this},anchor(n,s){t(this.anchor);const o=new ph(n,s),a=bl.to(o);return i(a),this},button(n){t(this.anchor);const s=new Sm(n),o=Uh.to(s,e._commandsConverter,e._sessionDisposables);return i(o),this},progress(n){t(this.progress);const s=new cl(n),o=yl.to(s);return i(o),this},reference(n){t(this.reference);const s=new ll(n),o=da.to(s);return i(o),this},push(n){t(this.push);const s=xl.to(n);return i(s),this},report(n){if(t(this.report),"placeholder"in n&&"resolvedContent"in n)return;const s=Bh.from(e._extension,n);if(!s){e._logService.error("Unknown progress type: "+JSON.stringify(n));return}return i(s),this}}}return this._apiObject}}const qf=class qf{constructor(e,t,i){this._logService=t,this.commands=i,this._agents=new Map,this._sessionDisposables=new lb,this._proxy=e.getProxy(G.MainThreadChatAgents2)}createChatAgent(e,t,i){const n=qf._idPool++,s=new wT(e,t,this._proxy,n,i);return this._agents.set(n,s),this._proxy.$registerAgent(n,e.identifier,t,{}),s.apiAgent}async $invokeAgent(e,t,i,n){const s=this._agents.get(e);if(!s)throw new Error(`[CHAT](${e}) CANNOT invoke agent because the agent is not registered`);let o=this._sessionDisposables.get(t.sessionId);o||(o=new Ae,this._sessionDisposables.set(t.sessionId,o));const a=new _T(s.extension,t,this._proxy,this._logService,this.commands.converter,o);try{const c=await this.prepareHistoryTurns(t.agentId,i),l=s.invoke(tv.to(t),{history:c},a.apiObject,n);return await Qp(Promise.resolve(l).then(u=>{if(u!=null&&u.metadata)try{JSON.stringify(u.metadata)}catch(d){const h=`result.metadata MUST be JSON.stringify-able. Got error: ${d.message}`;return this._logService.error(`[${s.extension.identifier.value}] [@${s.id}] ${h}`,s.extension),{errorDetails:{message:h},timings:a.timings}}return{errorDetails:u==null?void 0:u.errorDetails,timings:a.timings,metadata:u==null?void 0:u.metadata}}),n)}catch(c){return this._logService.error(c,s.extension),{errorDetails:{message:m("vs/workbench/api/common/extHostChatAgents2","errorResponse","Error from provider: {0}",ur(c)),responseIsIncomplete:!0}}}finally{a.close()}}async prepareHistoryTurns(e,t){const i=[];for(const n of t.history){const s=ha.to(n.result),o=e===n.request.agentId?s:{...s,metadata:void 0};i.push(new _x(n.request.message,n.request.command,n.request.variables.variables.map(Wh.to),{extensionId:"",name:n.request.agentId}));const a=Jt(n.response.map(c=>xl.fromContent(c,this.commands.converter)));i.push(new wx(a,o,{extensionId:"",name:n.request.agentId},n.request.command))}return i}$releaseSession(e){this._sessionDisposables.deleteAndDispose(e)}async $provideSlashCommands(e,t,i){const n=this._agents.get(e);if(!n)return[];const s=await this.prepareHistoryTurns(n.id,t);try{return await n.provideSlashCommands({history:s},i)}catch(o){const a=ur(o);return this._logService.error(`[${n.extension.identifier.value}] [@${n.id}] Error while providing slash commands: ${a}`),[]}}async $provideFollowups(e,t,i,n){const s=this._agents.get(t);if(!s)return Promise.resolve([]);const o=ha.to(i);return(await s.provideFollowups(o,n)).filter(a=>{const c=!a.participant||Jr.some(this._agents.values(),l=>l.id===a.participant&&Xe.equals(l.extension.identifier,s.extension.identifier));return c||this._logService.warn(`[@${s.id}] ChatFollowup refers to an invalid participant: ${a.participant}`),c}).map(a=>vl.from(a,e))}$acceptFeedback(e,t,i,n){const s=this._agents.get(e);if(!s)return;const o=ha.to(t);let a;switch(i){case df.Down:a=al.Unhelpful;break;case df.Up:a=al.Helpful;break}s.acceptFeedback(Object.freeze(n?{result:o,kind:a,reportIssue:n}:{result:o,kind:a}))}$acceptAction(e,t,i){const n=this._agents.get(e);if(!n||i.action.kind==="vote")return;const s=nv.to(t,i,this.commands.converter);s&&n.acceptAction(Object.freeze(s))}async $invokeCompletionProvider(e,t,i){const n=this._agents.get(e);return n?(await n.invokeCompletionProvider(t,i)).map(iv.from):[]}async $provideWelcomeMessage(e,t){const i=this._agents.get(e);if(i)return await i.provideWelcomeMessage(t)}async $provideSampleQuestions(e,t){const i=this._agents.get(e);if(i)return(await i.provideSampleQuestions(t)).map(n=>vl.from(n,void 0))}};qf._idPool=0;let k_=qf;class wT{constructor(e,t,i,n,s){this.extension=e,this.id=t,this._proxy=i,this._handle=n,this._requestHandler=s,this._onDidReceiveFeedback=new T,this._onDidPerformAction=new T}acceptFeedback(e){this._onDidReceiveFeedback.fire(e)}acceptAction(e){this._onDidPerformAction.fire(e)}async invokeCompletionProvider(e,t){return this._agentVariableProvider?await this._agentVariableProvider.provider.provideCompletionItems(e,t)??[]:[]}async provideSlashCommands(e,t){if(!this._commandProvider)return[];const i=await this._commandProvider.provideCommands(e,t);return i?i.map(n=>{var s,o;return"isSticky2"in n&&M(this.extension,"chatParticipantAdditions"),{name:n.name,description:n.description??"",followupPlaceholder:(s=n.isSticky2)==null?void 0:s.placeholder,isSticky:((o=n.isSticky2)==null?void 0:o.isSticky)??n.isSticky,sampleRequest:n.sampleRequest}}):[]}async provideFollowups(e,t){if(!this._followupProvider)return[];const i=await this._followupProvider.provideFollowups(e,t);return i?i.filter(n=>!(n&&"commandId"in n)).filter(n=>!(n&&"message"in n)):[]}async provideWelcomeMessage(e){if(!this._welcomeMessageProvider)return[];const t=await this._welcomeMessageProvider.provideWelcomeMessage(e);return t?t.map(i=>typeof i=="string"?i:Te.from(i)):[]}async provideSampleQuestions(e){if(!this._welcomeMessageProvider||!this._welcomeMessageProvider.provideSampleQuestions)return[];const t=await this._welcomeMessageProvider.provideSampleQuestions(e);return t||[]}get apiAgent(){let e=!1,t=!1;const i=()=>{e||t||(t=!0,queueMicrotask(()=>{this._proxy.$updateAgent(this._handle,{description:this._description??"",fullName:this._fullName,icon:this._iconPath?this._iconPath instanceof y?this._iconPath:"light"in this._iconPath?this._iconPath.light:void 0:void 0,iconDark:this._iconPath&&"dark"in this._iconPath?this._iconPath.dark:void 0,themeIcon:this._iconPath instanceof Gt?this._iconPath:void 0,hasSlashCommands:this._commandProvider!==void 0,hasFollowups:this._followupProvider!==void 0,isDefault:this._isDefault,isSecondary:this._isSecondary,helpTextPrefix:!this._helpTextPrefix||typeof this._helpTextPrefix=="string"?this._helpTextPrefix:Te.from(this._helpTextPrefix),helpTextVariablesPrefix:!this._helpTextVariablesPrefix||typeof this._helpTextVariablesPrefix=="string"?this._helpTextVariablesPrefix:Te.from(this._helpTextVariablesPrefix),helpTextPostfix:!this._helpTextPostfix||typeof this._helpTextPostfix=="string"?this._helpTextPostfix:Te.from(this._helpTextPostfix),sampleRequest:this._sampleRequest,supportIssueReporting:this._supportIssueReporting,isSticky:this._isSticky}),t=!1}))},n=this;return{get name(){return n.id},get description(){return n._description??""},set description(s){n._description=s,i()},get fullName(){return M(n.extension,"defaultChatParticipant"),n._fullName??n.extension.displayName??n.extension.name},set fullName(s){M(n.extension,"defaultChatParticipant"),n._fullName=s,i()},get iconPath(){return n._iconPath},set iconPath(s){n._iconPath=s,i()},get requestHandler(){return n._requestHandler},set requestHandler(s){Yb(typeof s=="function","Invalid request handler"),n._requestHandler=s},get commandProvider(){return n._commandProvider},set commandProvider(s){n._commandProvider=s,i()},get followupProvider(){return n._followupProvider},set followupProvider(s){n._followupProvider=s,i()},get isDefault(){return M(n.extension,"defaultChatParticipant"),n._isDefault},set isDefault(s){M(n.extension,"defaultChatParticipant"),n._isDefault=s,i()},get helpTextPrefix(){return M(n.extension,"defaultChatParticipant"),n._helpTextPrefix},set helpTextPrefix(s){if(M(n.extension,"defaultChatParticipant"),!n._isDefault)throw new Error("helpTextPrefix is only available on the default chat agent");n._helpTextPrefix=s,i()},get helpTextVariablesPrefix(){return M(n.extension,"defaultChatParticipant"),n._helpTextVariablesPrefix},set helpTextVariablesPrefix(s){if(M(n.extension,"defaultChatParticipant"),!n._isDefault)throw new Error("helpTextVariablesPrefix is only available on the default chat agent");n._helpTextVariablesPrefix=s,i()},get helpTextPostfix(){return M(n.extension,"defaultChatParticipant"),n._helpTextPostfix},set helpTextPostfix(s){if(M(n.extension,"defaultChatParticipant"),!n._isDefault)throw new Error("helpTextPostfix is only available on the default chat agent");n._helpTextPostfix=s,i()},get isSecondary(){return M(n.extension,"defaultChatParticipant"),n._isSecondary},set isSecondary(s){M(n.extension,"defaultChatParticipant"),n._isSecondary=s,i()},get sampleRequest(){return n._sampleRequest},set sampleRequest(s){n._sampleRequest=s,i()},get supportIssueReporting(){return M(n.extension,"chatParticipantAdditions"),n._supportIssueReporting},set supportIssueReporting(s){M(n.extension,"chatParticipantAdditions"),n._supportIssueReporting=s,i()},get onDidReceiveFeedback(){return n._onDidReceiveFeedback.event},set participantVariableProvider(s){if(M(n.extension,"chatParticipantAdditions"),n._agentVariableProvider=s,s){if(!s.triggerCharacters.length)throw new Error("triggerCharacters are required");n._proxy.$registerAgentCompletionsProvider(n._handle,s.triggerCharacters)}else n._proxy.$unregisterAgentCompletionsProvider(n._handle)},get participantVariableProvider(){return M(n.extension,"chatParticipantAdditions"),n._agentVariableProvider},set welcomeMessageProvider(s){M(n.extension,"defaultChatParticipant"),n._welcomeMessageProvider=s,i()},get welcomeMessageProvider(){return M(n.extension,"defaultChatParticipant"),n._welcomeMessageProvider},onDidPerformAction:Tt(this.extension,"chatParticipantAdditions")?this._onDidPerformAction.event:void 0,get isSticky(){return n._isSticky},set isSticky(s){n._isSticky=s,i()},dispose(){e=!0,n._commandProvider=void 0,n._followupProvider=void 0,n._onDidReceiveFeedback.dispose(),n._proxy.$unregisterAgent(n._handle)}}}invoke(e,t,i,n){return this._requestHandler(e,t,i,n)}}const bT=ne("progressService"),Dw=class Dw{get value(){return this._value}constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}};Dw.None=Object.freeze({report(){}});let hf=Dw,WC=class extends Be{constructor(e,t){super(),this.deferred=new Co,t.withProgress(e,i=>(this.reporter=i,this.lastStep&&i.report(this.lastStep),this.deferred.p)),this._register(Le(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};WC=H([N(1,bT)],WC),ne("editorProgressService");class VC{constructor(e,t){this.option=e,this.stream=new Yp,this.stream=t??new Yp}}class yT{constructor(e,t){this.cts=t,this._responseStreams=new Map,this._defaultStream=new Yp,this._isDone=!1;const i=this;this.apiObject={result:e,stream:i._defaultStream.asyncIterable},e.then(()=>{for(const n of this._streams())n.resolve()}).catch(n=>{n instanceof Error||(n=new Error(ur(n),{cause:n}));for(const s of this._streams())s.reject(n)}).finally(()=>{this._isDone=!0})}*_streams(){if(this._responseStreams.size>0)for(const[,e]of this._responseStreams)yield e.stream;else yield this._defaultStream}handleFragment(e){if(this._isDone)return;let t=this._responseStreams.get(e.index);t||(this._responseStreams.size===0?t=new VC(e.index,this._defaultStream):t=new VC(e.index),this._responseStreams.set(e.index,t)),t.stream.emitOne(e.part)}}const Gf=class Gf{constructor(e,t,i){this._logService=t,this._extHostAuthentication=i,this._onDidChangeModelAccess=new T,this._onDidChangeProviders=new T,this.onDidChangeProviders=this._onDidChangeProviders.event,this._languageModels=new Map,this._languageModelIds=new Set,this._modelAccessList=new fr,this._pendingRequest=new Map,this._proxy=e.getProxy(G.MainThreadChatProvider)}dispose(){this._onDidChangeModelAccess.dispose(),this._onDidChangeProviders.dispose()}registerLanguageModel(e,t,i,n){const s=Gf._idPool++;this._languageModels.set(s,{extension:e.identifier,provider:i});let o;return n.auth&&(o={providerLabel:e.displayName||e.name,accountLabel:typeof n.auth=="object"?n.auth.label:void 0}),this._proxy.$registerProvider(s,t,{extension:e.identifier,model:n.name??"",auth:o}),Le(()=>{this._languageModels.delete(s),this._proxy.$unregisterProvider(s)})}async $provideLanguageModelResponse(e,t,i,n,s,o){const a=this._languageModels.get(e);if(!a)return;const c=new hf(async l=>{if(o.isCancellationRequested){this._logService.warn(`[CHAT](${a.extension.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}this._proxy.$handleProgressChunk(t,{index:l.index,part:l.part})});return a.provider.provideLanguageModelResponse2(n.map(Mh.to),s,Xe.toKey(i),c,o)}$updateLanguageModels(e){const t=[],i=[];if(e.added)for(const n of e.added)this._languageModelIds.add(n),t.push(n);if(e.removed)for(const n of e.removed){this._languageModelIds.delete(n),i.push(n);for(const[s,o]of this._pendingRequest)o.languageModelId===n&&(o.res.cts.cancel(),this._pendingRequest.delete(s))}this._onDidChangeProviders.fire(Object.freeze({added:Object.freeze(t),removed:Object.freeze(i)}))}getLanguageModelIds(){return Array.from(this._languageModelIds)}$updateModelAccesslist(e){const t=new Array;for(const{from:i,to:n,enabled:s}of e){const o=this._modelAccessList.get(i)??new $o;if(o.has(n)!==s){s?o.add(n):o.delete(n),this._modelAccessList.set(i,o);const c={from:i,to:n};t.push(c),this._onDidChangeModelAccess.fire(c)}}}async requestLanguageModelAccess(e,t,i){const n=e.identifier,s=i==null?void 0:i.justification,o=await this._proxy.$prepareChatAccess(n,t,s);if(!o)throw new Error(`Language model '${t}' NOT found`);this._isUsingAuth(n,o)&&await this._getAuthAccess(e,{identifier:o.extension,displayName:o.auth.providerLabel},s);const a=this;return{get model(){return o.model},get isRevoked(){var c;return a._isUsingAuth(n,o)&&!((c=a._modelAccessList.get(n))!=null&&c.has(o.extension))||!a._languageModelIds.has(t)},get onDidChangeAccess(){const c=_t.filter(a._onDidChangeProviders.event,u=>u.removed.includes(t)),l=_t.filter(a._onDidChangeModelAccess.event,u=>Xe.equals(u.from,n)&&Xe.equals(u.to,o.extension));return _t.signal(_t.any(c,l))},makeChatRequest(c,l,u){var p;if(a._isUsingAuth(n,o)&&!((p=a._modelAccessList.get(n))!=null&&p.has(o.extension)))throw new Error("Access to chat has been revoked");if(!a._languageModelIds.has(t))throw new Error("Language Model has been removed");const d=new mt(u),h=Math.random()*1e6|0,g=a._proxy.$fetchResponse(n,t,h,c.map(Mh.from),l??{},d.token),w=new yT(g,d);return a._pendingRequest.set(h,{languageModelId:t,res:w}),g.finally(()=>{a._pendingRequest.delete(h),d.dispose()}),w.apiObject}}}async $handleResponseFragment(e,t){const i=this._pendingRequest.get(e);i&&i.res.handleFragment(t)}async _getAuthAccess(e,t,i){const n=HC+t.identifier.value;if(!await this._extHostAuthentication.getSession(e,n,[],{silent:!0}))try{const o=i?m("vs/workbench/api/common/extHostChatProvider","chatAccessWithJustification",`To allow access to the language models provided by {0}. Justification:

{1}`,t.displayName,i):m("vs/workbench/api/common/extHostChatProvider","chatAccess","To allow access to the language models provided by {0}",t.displayName);await this._extHostAuthentication.getSession(e,n,[],{forceNewSession:{detail:o}})}catch{throw new Error("Access to language models has not been granted")}this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}])}_isUsingAuth(e,t){return!!t.auth&&!Xe.equals(t.extension,e)}};Gf._idPool=1;let D_=Gf;const Qf=class Qf{constructor(e){this._resolver=new Map,this._proxy=e.getProxy(G.MainThreadChatVariables)}async $resolveVariable(e,t,i,n){const s=this._resolver.get(e);if(s)try{if(s.resolver.resolve2){M(s.extension,"chatParticipantAdditions");const o=new xT(t,this._proxy),a=await s.resolver.resolve2(s.data.name,{prompt:i},o.apiObject,n);if(a)return a.map(ua.from)}else{const o=await s.resolver.resolve(s.data.name,{prompt:i},n);if(o)return o.map(ua.from)}}catch(o){mp(o)}}registerVariableResolver(e,t,i,n){const s=Qf._idPool++;return this._resolver.set(s,{extension:e,data:{name:t,description:i},resolver:n}),this._proxy.$registerVariable(s,{name:t,description:i}),Le(()=>{this._resolver.delete(s),this._proxy.$unregisterVariable(s)})}};Qf._idPool=0;let I_=Qf;class xT{constructor(e,t){this._requestId=e,this._proxy=t,this._isClosed=!1}close(){this._isClosed=!0}get apiObject(){if(!this._apiObject){let t=function(n){if(e._isClosed){const s=new Error("Response stream has been closed");throw Error.captureStackTrace(s,n),s}};const e=this,i=n=>{this._proxy.$handleProgressChunk(this._requestId,n)};this._apiObject={progress(n){t(this.progress);const s=new cl(n),o=yl.to(s);return i(o),this},reference(n){t(this.reference);const s=new ll(n),o=da.to(s);return i(o),this},push(n){t(this.push);const s=xl.to(n);return i(s),this}}}return this._apiObject}}class CT{constructor(e){const t=e.getProxy(G.MainThreadClipboard);this.value=Object.freeze({readText(){return t.$readText()},writeText(i){return t.$writeText(i)}})}}const zC="vscode-cdn.net",ST=`vscode-resource.${zC}`,P_=`'self' https://*.${zC}`;function Hl(r,e){return r.scheme===Z.http||r.scheme===Z.https?r:(e&&e.authority&&e.isRemote&&r.scheme===Z.file&&(r=y.from({scheme:Z.vscodeRemote,authority:e.authority,path:r.path})),y.from({scheme:Z.https,authority:`${r.scheme}+${ET(r.authority)}.${ST}`,path:r.path,fragment:r.fragment,query:r.query}))}function ET(r){return r.replace(/./g,e=>{const t=e.charCodeAt(0);return t>=97&&t<=122||t>=65&&t<=90||t>=48&&t<=57?e:"-"+t.toString(16).padStart(4,"0")})}class kT{constructor(e,t,i){this._proxy=e,this._editors=t,this._remoteInfo=i,this._handlePool=0,this._disposables=new Ae,this._insets=new Map,this._disposables.add(t.onDidChangeVisibleTextEditors(()=>{const n=t.getVisibleTextEditors();for(const s of this._insets.values())n.indexOf(s.editor)<0&&s.inset.dispose()}))}dispose(){this._insets.forEach(e=>e.inset.dispose()),this._disposables.dispose()}createWebviewEditorInset(e,t,i,n,s){let o;for(const g of this._editors.getVisibleTextEditors(!0))if(g.value===e){o=g;break}if(!o)throw new Error("not a visible editor");const a=this,c=this._handlePool++,l=new T,u=new T,d=new class{constructor(){this._html="",this._options=Object.create(null)}asWebviewUri(g){return Hl(g,a._remoteInfo)}get cspSource(){return P_}set options(g){this._options=g,a._proxy.$setOptions(c,g)}get options(){return this._options}set html(g){this._html=g,a._proxy.$setHtml(c,g)}get html(){return this._html}get onDidReceiveMessage(){return l.event}postMessage(g){return a._proxy.$postMessage(c,g)}},h=new class{constructor(){this.editor=e,this.line=t,this.height=i,this.webview=d,this.onDidDispose=u.event}dispose(){a._insets.has(c)&&(a._insets.delete(c),a._proxy.$disposeEditorInset(c),u.fire(),u.dispose(),l.dispose())}};return this._proxy.$createEditorInset(c,o.id,o.value.document.uri,t+1,i,n||{},s.identifier,s.extensionLocation),this._insets.set(c,{editor:e,inset:h,onDidReceiveMessage:l}),h}$onDidDispose(e){const t=this._insets.get(e);t&&t.inset.dispose()}$onDidReceiveMessage(e,t){const i=this._insets.get(e);i==null||i.onDidReceiveMessage.fire(t)}}function DT(r,e,t){const i=r.getProxy(G.MainThreadComments),h=class h{constructor(){this._commentControllers=new Map,this._commentControllersByExtension=new fr,e.registerArgumentProcessor({processArgument:p=>{if(p&&p.$mid===6){const b=this._commentControllers.get(p.handle);return b?b.value:p}else if(p&&p.$mid===7){const b=this._commentControllers.get(p.commentControlHandle);if(!b)return p;const k=b.getCommentThread(p.commentThreadHandle);return k?k.value:p}else if(p&&(p.$mid===9||p.$mid===8)){const b=this._commentControllers.get(p.thread.commentControlHandle);if(!b)return p;const k=b.getCommentThread(p.thread.commentThreadHandle);return k?p.$mid===8?k.value:{thread:k.value,text:p.text}:p}else if(p&&p.$mid===10){const b=this._commentControllers.get(p.thread.commentControlHandle);if(!b)return p;const k=b.getCommentThread(p.thread.commentThreadHandle);if(!k)return p;const D=p.commentUniqueId,C=k.getCommentByUniqueId(D);return C||p}else if(p&&p.$mid===11){const b=this._commentControllers.get(p.thread.commentControlHandle);if(!b)return p;const k=b.getCommentThread(p.thread.commentThreadHandle);if(!k)return p;const D=p.text,C=p.commentUniqueId,R=k.getCommentByUniqueId(C);return R?(typeof R.body=="string"?R.body=D:R.body=new Di(D),R):p}return p}})}createCommentController(p,b,k){const D=h.handlePool++,C=new o(p,D,b,k);this._commentControllers.set(C.handle,C);const R=this._commentControllersByExtension.get(p.identifier)||[];return R.push(C),this._commentControllersByExtension.set(p.identifier,R),C.value}async $createCommentThreadTemplate(p,b,k){const D=this._commentControllers.get(p);D&&D.$createCommentThreadTemplate(b,k)}async $setActiveComment(p,b){const k=this._commentControllers.get(p);k&&k.$setActiveComment(b??void 0)}async $updateCommentThreadTemplate(p,b,k){const D=this._commentControllers.get(p);D&&D.$updateCommentThreadTemplate(b,k)}$deleteCommentThread(p,b){const k=this._commentControllers.get(p);k==null||k.$deleteCommentThread(b)}$provideCommentingRanges(p,b,k){const D=this._commentControllers.get(p);if(!D||!D.commentingRangeProvider)return Promise.resolve(void 0);const C=t.getDocument(y.revive(b));return Mt(async()=>{const R=await D.commentingRangeProvider.provideCommentingRanges(C,k);let A;return Array.isArray(R)?A={ranges:R,fileComments:!1}:R?A={ranges:R.ranges||[],fileComments:R.fileComments||!1}:A=R??void 0,A}).then(R=>{let A;return R&&(A={ranges:R.ranges.map(B=>F.from(B)),fileComments:R.fileComments}),A})}$toggleReaction(p,b,k,D,C){const R=this._commentControllers.get(p);return!R||!R.reactionHandler?Promise.resolve(void 0):Mt(()=>{const A=R.getCommentThread(b);if(A){const B=A.getCommentByUniqueId(D.uniqueIdInThread);if(R!==void 0&&B&&R.reactionHandler)return R.reactionHandler(B,l(C))}return Promise.resolve(void 0)})}};h.handlePool=0;let n=h;const g=class g{set threadId(p){this._id=p}get threadId(){return this._id}get id(){return this._id}get resource(){return this._uri}get uri(){return this._uri}set range(p){(p===void 0!=(this._range===void 0)||!p||!this._range||!p.isEqual(this._range))&&(this._range=p,this.modifications.range=p,this._onDidUpdateCommentThread.fire())}get range(){return this._range}set canReply(p){this._canReply!==p&&(this._canReply=p,this.modifications.canReply=p,this._onDidUpdateCommentThread.fire())}get canReply(){return this._canReply}get label(){return this._label}set label(p){this._label=p,this.modifications.label=p,this._onDidUpdateCommentThread.fire()}get contextValue(){return this._contextValue}set contextValue(p){this._contextValue=p,this.modifications.contextValue=p,this._onDidUpdateCommentThread.fire()}get comments(){return this._comments}set comments(p){this._comments=p,this.modifications.comments=p,this._onDidUpdateCommentThread.fire()}get collapsibleState(){return this._collapseState}set collapsibleState(p){this._collapseState=p,this.modifications.collapsibleState=p,this._onDidUpdateCommentThread.fire()}get state(){return this._state}set state(p){this._state=p,this.modifications.state=p,this._onDidUpdateCommentThread.fire()}get isDisposed(){return this._isDiposed}constructor(p,b,k,D,C,R,A,B){this._commentControllerHandle=b,this._id=k,this._uri=D,this._range=C,this._comments=R,this.extensionDescription=A,this._isTemplate=B,this.handle=g._handlePool++,this.commentHandle=0,this.modifications=Object.create(null),this._onDidUpdateCommentThread=new T,this.onDidUpdateCommentThread=this._onDidUpdateCommentThread.event,this._canReply=!0,this._commentsMap=new Map,this._acceptInputDisposables=new go,this._acceptInputDisposables.value=new Ae,this._id===void 0&&(this._id=`${p}.${this.handle}`),i.$createCommentThread(b,this.handle,this._id,this._uri,F.from(this._range),A.identifier,this._isTemplate),this._localDisposables=[],this._isDiposed=!1,this._localDisposables.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()})),this.comments=R,this._localDisposables.push({dispose:()=>{i.$deleteCommentThread(b,this.handle)}});const Q=this;this.value={get uri(){return Q.uri},get range(){return Q.range},set range(ee){Q.range=ee},get comments(){return Q.comments},set comments(ee){Q.comments=ee},get collapsibleState(){return Q.collapsibleState},set collapsibleState(ee){Q.collapsibleState=ee},get canReply(){return Q.canReply},set canReply(ee){Q.canReply=ee},get contextValue(){return Q.contextValue},set contextValue(ee){Q.contextValue=ee},get label(){return Q.label},set label(ee){Q.label=ee},get state(){return Q.state},set state(ee){Q.state=ee},dispose:()=>{Q.dispose()}}}updateIsTemplate(){this._isTemplate&&(this._isTemplate=!1,this.modifications.isTemplate=!1)}eventuallyUpdateCommentThread(){if(this._isDiposed)return;this.updateIsTemplate(),this._acceptInputDisposables.value||(this._acceptInputDisposables.value=new Ae);const p=k=>Object.prototype.hasOwnProperty.call(this.modifications,k),b={};p("range")&&(b.range=F.from(this._range)),p("label")&&(b.label=this.label),p("contextValue")&&(b.contextValue=this.contextValue??null),p("comments")&&(b.comments=this._comments.map(k=>a(this,k,this._commentsMap,this.extensionDescription))),p("collapsibleState")&&(b.collapseState=u(this._collapseState)),p("canReply")&&(b.canReply=this.canReply),p("state")&&(b.state=d(this._state)),p("isTemplate")&&(b.isTemplate=this._isTemplate),this.modifications={},i.$updateCommentThread(this._commentControllerHandle,this.handle,this._id,this._uri,b)}getCommentByUniqueId(p){for(const b of this._commentsMap){const k=b[0],D=b[1];if(p===D)return k}}dispose(){this._isDiposed=!0,this._acceptInputDisposables.dispose(),this._localDisposables.forEach(p=>p.dispose())}};g._handlePool=0;let s=g;class o{get id(){return this._id}get label(){return this._label}get handle(){return this._handle}get commentingRangeProvider(){return this._commentingRangeProvider}set commentingRangeProvider(p){this._commentingRangeProvider=p,i.$updateCommentingRanges(this.handle)}get reactionHandler(){return this._reactionHandler}set reactionHandler(p){this._reactionHandler=p,i.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!p})}get options(){return this._options}set options(p){this._options=p,i.$updateCommentControllerFeatures(this.handle,{options:this._options})}get activeComment(){return M(this._extension,"activeComment"),this._activeComment}get activeCommentThread(){return M(this._extension,"activeComment"),this._activeThread}constructor(p,b,k,D){this._extension=p,this._handle=b,this._id=k,this._label=D,this._threads=new Map,i.$registerCommentController(this.handle,k,D,this._extension.identifier.value);const C=this;this.value=Object.freeze({id:C.id,label:C.label,get options(){return C.options},set options(R){C.options=R},get commentingRangeProvider(){return C.commentingRangeProvider},set commentingRangeProvider(R){C.commentingRangeProvider=R},get reactionHandler(){return C.reactionHandler},set reactionHandler(R){C.reactionHandler=R},get activeCommentThread(){return C.activeCommentThread},createCommentThread(R,A,B){return C.createCommentThread(R,A,B).value},dispose:()=>{C.dispose()}}),this._localDisposables=[],this._localDisposables.push({dispose:()=>{i.$unregisterCommentController(this.handle)}})}createCommentThread(p,b,k){b===void 0&&M(this._extension,"fileComments");const D=new s(this.id,this.handle,void 0,p,b,k,this._extension,!1);return this._threads.set(D.handle,D),D}$setActiveComment(p){if(!p){this._activeComment=void 0,this._activeThread=void 0;return}const b=this._threads.get(p.commentThreadHandle);b&&(this._activeComment=p.uniqueIdInThread?b.getCommentByUniqueId(p.uniqueIdInThread):void 0,this._activeThread=b)}$createCommentThreadTemplate(p,b){const k=new s(this.id,this.handle,void 0,y.revive(p),F.to(b),[],this._extension,!0);return k.collapsibleState=To.Expanded,this._threads.set(k.handle,k),k}$updateCommentThreadTemplate(p,b){const k=this._threads.get(p);k&&(k.range=F.to(b))}$deleteCommentThread(p){const b=this._threads.get(p);b==null||b.dispose(),this._threads.delete(p)}getCommentThread(p){return this._threads.get(p)}dispose(){this._threads.forEach(p=>{p.dispose()}),this._localDisposables.forEach(p=>p.dispose())}}function a(w,p,b,k){var C,R;let D=b.get(p);return D||(D=++w.commentHandle,b.set(p,D)),p.state!==void 0&&M(k,"commentsDraftState"),(C=p.reactions)!=null&&C.some(A=>A.reactors!==void 0)&&M(k,"commentReactor"),{mode:p.mode,contextValue:p.contextValue,uniqueIdInThread:D,body:typeof p.body=="string"?p.body:Te.from(p.body),userName:p.author.name,userIconPath:p.author.iconPath,label:p.label,commentReactions:p.reactions?p.reactions.map(A=>c(A)):void 0,state:p.state,timestamp:(R=p.timestamp)==null?void 0:R.toJSON()}}function c(w){return{label:w.label,iconPath:w.iconPath?_h(w.iconPath):void 0,count:w.count,hasReacted:w.authorHasReacted,reactors:w.reactors&&w.reactors.length>0&&typeof w.reactors[0]!="string"?w.reactors.map(p=>p.name):w.reactors}}function l(w){var p;return{label:w.label||"",count:w.count||0,iconPath:w.iconPath?y.revive(w.iconPath):"",authorHasReacted:w.hasReacted||!1,reactors:(p=w.reactors)==null?void 0:p.map(b=>({name:b}))}}function u(w){if(w!==void 0)switch(w){case tl.Expanded:return To.Expanded;case tl.Collapsed:return To.Collapsed}return To.Collapsed}function d(w){if(w!==void 0)switch(w){case il.Unresolved:return Rc.Unresolved;case il.Resolved:return Rc.Resolved}return Rc.Unresolved}return new n}var jC={exports:{}};(function(r,e){e=r.exports=He;var t;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?t=function(){var x=Array.prototype.slice.call(arguments,0);x.unshift("SEMVER"),console.log.apply(console,x)}:t=function(){},e.SEMVER_SPEC_VERSION="2.0.0";var i=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,s=16,o=e.re=[],a=e.src=[],c=0,l=c++;a[l]="0|[1-9]\\d*";var u=c++;a[u]="[0-9]+";var d=c++;a[d]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var h=c++;a[h]="("+a[l]+")\\.("+a[l]+")\\.("+a[l]+")";var g=c++;a[g]="("+a[u]+")\\.("+a[u]+")\\.("+a[u]+")";var w=c++;a[w]="(?:"+a[l]+"|"+a[d]+")";var p=c++;a[p]="(?:"+a[u]+"|"+a[d]+")";var b=c++;a[b]="(?:-("+a[w]+"(?:\\."+a[w]+")*))";var k=c++;a[k]="(?:-?("+a[p]+"(?:\\."+a[p]+")*))";var D=c++;a[D]="[0-9A-Za-z-]+";var C=c++;a[C]="(?:\\+("+a[D]+"(?:\\."+a[D]+")*))";var R=c++,A="v?"+a[h]+a[b]+"?"+a[C]+"?";a[R]="^"+A+"$";var B="[v=\\s]*"+a[g]+a[k]+"?"+a[C]+"?",Q=c++;a[Q]="^"+B+"$";var ee=c++;a[ee]="((?:<|>)?=?)";var ue=c++;a[ue]=a[u]+"|x|X|\\*";var Re=c++;a[Re]=a[l]+"|x|X|\\*";var q=c++;a[q]="[v=\\s]*("+a[Re]+")(?:\\.("+a[Re]+")(?:\\.("+a[Re]+")(?:"+a[b]+")?"+a[C]+"?)?)?";var U=c++;a[U]="[v=\\s]*("+a[ue]+")(?:\\.("+a[ue]+")(?:\\.("+a[ue]+")(?:"+a[k]+")?"+a[C]+"?)?)?";var J=c++;a[J]="^"+a[ee]+"\\s*"+a[q]+"$";var j=c++;a[j]="^"+a[ee]+"\\s*"+a[U]+"$";var oe=c++;a[oe]="(?:^|[^\\d])(\\d{1,"+s+"})(?:\\.(\\d{1,"+s+"}))?(?:\\.(\\d{1,"+s+"}))?(?:$|[^\\d])";var ge=c++;a[ge]="(?:~>?)";var le=c++;a[le]="(\\s*)"+a[ge]+"\\s+",o[le]=new RegExp(a[le],"g");var Ye="$1~",Ze=c++;a[Ze]="^"+a[ge]+a[q]+"$";var kt=c++;a[kt]="^"+a[ge]+a[U]+"$";var Qt=c++;a[Qt]="(?:\\^)";var vt=c++;a[vt]="(\\s*)"+a[Qt]+"\\s+",o[vt]=new RegExp(a[vt],"g");var ct="$1^",ft=c++;a[ft]="^"+a[Qt]+a[q]+"$";var xi=c++;a[xi]="^"+a[Qt]+a[U]+"$";var Nt=c++;a[Nt]="^"+a[ee]+"\\s*("+B+")$|^$";var qi=c++;a[qi]="^"+a[ee]+"\\s*("+A+")$|^$";var ye=c++;a[ye]="(\\s*)"+a[ee]+"\\s*("+B+"|"+a[q]+")",o[ye]=new RegExp(a[ye],"g");var Pw="$1$2$3",fn=c++;a[fn]="^\\s*("+a[q]+")\\s+-\\s+("+a[q]+")\\s*$";var Wr=c++;a[Wr]="^\\s*("+a[U]+")\\s+-\\s+("+a[U]+")\\s*$";var bu=c++;a[bu]="(<|>)?=?\\s*\\*";for(var Xn=0;Xn<c;Xn++)t(Xn,a[Xn]),o[Xn]||(o[Xn]=new RegExp(a[Xn]));e.parse=Yn;function Yn(x,P){if(x instanceof He)return x;if(typeof x!="string"||x.length>i)return null;var L=P?o[Q]:o[R];if(!L.test(x))return null;try{return new He(x,P)}catch{return null}}e.valid=Tw;function Tw(x,P){var L=Yn(x,P);return L?L.version:null}e.clean=lp;function lp(x,P){var L=Yn(x.trim().replace(/^[=v]+/,""),P);return L?L.version:null}e.SemVer=He;function He(x,P){if(x instanceof He){if(x.loose===P)return x;x=x.version}else if(typeof x!="string")throw new TypeError("Invalid Version: "+x);if(x.length>i)throw new TypeError("version is longer than "+i+" characters");if(!(this instanceof He))return new He(x,P);t("SemVer",x,P),this.loose=P;var L=x.trim().match(P?o[Q]:o[R]);if(!L)throw new TypeError("Invalid Version: "+x);if(this.raw=x,this.major=+L[1],this.minor=+L[2],this.patch=+L[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");L[4]?this.prerelease=L[4].split(".").map(function(X){if(/^[0-9]+$/.test(X)){var V=+X;if(V>=0&&V<n)return V}return X}):this.prerelease=[],this.build=L[5]?L[5].split("."):[],this.format()}He.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},He.prototype.toString=function(){return this.version},He.prototype.compare=function(x){return t("SemVer.compare",this.version,this.loose,x),x instanceof He||(x=new He(x,this.loose)),this.compareMain(x)||this.comparePre(x)},He.prototype.compareMain=function(x){return x instanceof He||(x=new He(x,this.loose)),pn(this.major,x.major)||pn(this.minor,x.minor)||pn(this.patch,x.patch)},He.prototype.comparePre=function(x){if(x instanceof He||(x=new He(x,this.loose)),this.prerelease.length&&!x.prerelease.length)return-1;if(!this.prerelease.length&&x.prerelease.length)return 1;if(!this.prerelease.length&&!x.prerelease.length)return 0;var P=0;do{var L=this.prerelease[P],X=x.prerelease[P];if(t("prerelease compare",P,L,X),L===void 0&&X===void 0)return 0;if(X===void 0)return 1;if(L===void 0)return-1;if(L===X)continue;return pn(L,X)}while(++P)},He.prototype.inc=function(x,P){switch(x){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",P);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",P);break;case"prepatch":this.prerelease.length=0,this.inc("patch",P),this.inc("pre",P);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",P),this.inc("pre",P);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var L=this.prerelease.length;--L>=0;)typeof this.prerelease[L]=="number"&&(this.prerelease[L]++,L=-2);L===-1&&this.prerelease.push(0)}P&&(this.prerelease[0]===P?isNaN(this.prerelease[1])&&(this.prerelease=[P,0]):this.prerelease=[P,0]);break;default:throw new Error("invalid increment argument: "+x)}return this.format(),this.raw=this.version,this},e.inc=up;function up(x,P,L,X){typeof L=="string"&&(X=L,L=void 0);try{return new He(x,L).inc(P,X).version}catch{return null}}e.diff=Vr;function Vr(x,P){if(ic(x,P))return null;var L=Yn(x),X=Yn(P);if(L.prerelease.length||X.prerelease.length){for(var V in L)if((V==="major"||V==="minor"||V==="patch")&&L[V]!==X[V])return"pre"+V;return"prerelease"}for(var V in L)if((V==="major"||V==="minor"||V==="patch")&&L[V]!==X[V])return V}e.compareIdentifiers=pn;var dp=/^[0-9]+$/;function pn(x,P){var L=dp.test(x),X=dp.test(P);return L&&X&&(x=+x,P=+P),L&&!X?-1:X&&!L?1:x<P?-1:x>P?1:0}e.rcompareIdentifiers=yu;function yu(x,P){return pn(P,x)}e.major=Aw;function Aw(x,P){return new He(x,P).major}e.minor=Rw;function Rw(x,P){return new He(x,P).minor}e.patch=lo;function lo(x,P){return new He(x,P).patch}e.compare=Gi;function Gi(x,P,L){return new He(x,L).compare(new He(P,L))}e.compareLoose=Lw;function Lw(x,P){return Gi(x,P,!0)}e.rcompare=Ow;function Ow(x,P,L){return Gi(P,x,L)}e.sort=ec;function ec(x,P){return x.sort(function(L,X){return e.compare(L,X,P)})}e.rsort=$w;function $w(x,P){return x.sort(function(L,X){return e.rcompare(L,X,P)})}e.gt=tc;function tc(x,P,L){return Gi(x,P,L)>0}e.lt=zr;function zr(x,P,L){return Gi(x,P,L)<0}e.eq=ic;function ic(x,P,L){return Gi(x,P,L)===0}e.neq=hp;function hp(x,P,L){return Gi(x,P,L)!==0}e.gte=nc;function nc(x,P,L){return Gi(x,P,L)>=0}e.lte=rc;function rc(x,P,L){return Gi(x,P,L)<=0}e.cmp=sc;function sc(x,P,L,X){var V;switch(P){case"===":typeof x=="object"&&(x=x.version),typeof L=="object"&&(L=L.version),V=x===L;break;case"!==":typeof x=="object"&&(x=x.version),typeof L=="object"&&(L=L.version),V=x!==L;break;case"":case"=":case"==":V=ic(x,L,X);break;case"!=":V=hp(x,L,X);break;case">":V=tc(x,L,X);break;case">=":V=nc(x,L,X);break;case"<":V=zr(x,L,X);break;case"<=":V=rc(x,L,X);break;default:throw new TypeError("Invalid operator: "+P)}return V}e.Comparator=fi;function fi(x,P){if(x instanceof fi){if(x.loose===P)return x;x=x.value}if(!(this instanceof fi))return new fi(x,P);t("comparator",x,P),this.loose=P,this.parse(x),this.semver===uo?this.value="":this.value=this.operator+this.semver.version,t("comp",this)}var uo={};fi.prototype.parse=function(x){var P=this.loose?o[Nt]:o[qi],L=x.match(P);if(!L)throw new TypeError("Invalid comparator: "+x);this.operator=L[1],this.operator==="="&&(this.operator=""),L[2]?this.semver=new He(L[2],this.loose):this.semver=uo},fi.prototype.toString=function(){return this.value},fi.prototype.test=function(x){return t("Comparator.test",x,this.loose),this.semver===uo?!0:(typeof x=="string"&&(x=new He(x,this.loose)),sc(x,this.operator,this.semver,this.loose))},fi.prototype.intersects=function(x,P){if(!(x instanceof fi))throw new TypeError("a Comparator is required");var L;if(this.operator==="")return L=new lt(x.value,P),ac(this.value,L,P);if(x.operator==="")return L=new lt(this.value,P),ac(x.semver,L,P);var X=(this.operator===">="||this.operator===">")&&(x.operator===">="||x.operator===">"),V=(this.operator==="<="||this.operator==="<")&&(x.operator==="<="||x.operator==="<"),v=this.semver.version===x.semver.version,_=(this.operator===">="||this.operator==="<=")&&(x.operator===">="||x.operator==="<="),S=sc(this.semver,"<",x.semver,P)&&(this.operator===">="||this.operator===">")&&(x.operator==="<="||x.operator==="<"),z=sc(this.semver,">",x.semver,P)&&(this.operator==="<="||this.operator==="<")&&(x.operator===">="||x.operator===">");return X||V||v&&_||S||z},e.Range=lt;function lt(x,P){if(x instanceof lt)return x.loose===P?x:new lt(x.raw,P);if(x instanceof fi)return new lt(x.value,P);if(!(this instanceof lt))return new lt(x,P);if(this.loose=P,this.raw=x,this.set=x.split(/\s*\|\|\s*/).map(function(L){return this.parseRange(L.trim())},this).filter(function(L){return L.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+x);this.format()}lt.prototype.format=function(){return this.range=this.set.map(function(x){return x.join(" ").trim()}).join("||").trim(),this.range},lt.prototype.toString=function(){return this.range},lt.prototype.parseRange=function(x){var P=this.loose;x=x.trim(),t("range",x,P);var L=P?o[Wr]:o[fn];x=x.replace(L,Hw),t("hyphen replace",x),x=x.replace(o[ye],Pw),t("comparator trim",x,o[ye]),x=x.replace(o[le],Ye),x=x.replace(o[vt],ct),x=x.split(/\s+/).join(" ");var X=P?o[Nt]:o[qi],V=x.split(" ").map(function(v){return fp(v,P)}).join(" ").split(/\s+/);return this.loose&&(V=V.filter(function(v){return!!v.match(X)})),V=V.map(function(v){return new fi(v,P)}),V},lt.prototype.intersects=function(x,P){if(!(x instanceof lt))throw new TypeError("a Range is required");return this.set.some(function(L){return L.every(function(X){return x.set.some(function(V){return V.every(function(v){return X.intersects(v,P)})})})})},e.toComparators=xu;function xu(x,P){return new lt(x,P).set.map(function(L){return L.map(function(X){return X.value}).join(" ").trim().split(" ")})}function fp(x,P){return t("comp",x),x=de(x,P),t("caret",x),x=gn(x,P),t("tildes",x),x=Nw(x,P),t("xrange",x),x=Mw(x,P),t("stars",x),x}function E(x){return!x||x.toLowerCase()==="x"||x==="*"}function gn(x,P){return x.trim().split(/\s+/).map(function(L){return pp(L,P)}).join(" ")}function pp(x,P){var L=P?o[kt]:o[Ze];return x.replace(L,function(X,V,v,_,S){t("tilde",x,X,V,v,_,S);var z;return E(V)?z="":E(v)?z=">="+V+".0.0 <"+(+V+1)+".0.0":E(_)?z=">="+V+"."+v+".0 <"+V+"."+(+v+1)+".0":S?(t("replaceTilde pr",S),S.charAt(0)!=="-"&&(S="-"+S),z=">="+V+"."+v+"."+_+S+" <"+V+"."+(+v+1)+".0"):z=">="+V+"."+v+"."+_+" <"+V+"."+(+v+1)+".0",t("tilde return",z),z})}function de(x,P){return x.trim().split(/\s+/).map(function(L){return Ue(L,P)}).join(" ")}function Ue(x,P){t("caret",x,P);var L=P?o[xi]:o[ft];return x.replace(L,function(X,V,v,_,S){t("caret",x,X,V,v,_,S);var z;return E(V)?z="":E(v)?z=">="+V+".0.0 <"+(+V+1)+".0.0":E(_)?V==="0"?z=">="+V+"."+v+".0 <"+V+"."+(+v+1)+".0":z=">="+V+"."+v+".0 <"+(+V+1)+".0.0":S?(t("replaceCaret pr",S),S.charAt(0)!=="-"&&(S="-"+S),V==="0"?v==="0"?z=">="+V+"."+v+"."+_+S+" <"+V+"."+v+"."+(+_+1):z=">="+V+"."+v+"."+_+S+" <"+V+"."+(+v+1)+".0":z=">="+V+"."+v+"."+_+S+" <"+(+V+1)+".0.0"):(t("no pr"),V==="0"?v==="0"?z=">="+V+"."+v+"."+_+" <"+V+"."+v+"."+(+_+1):z=">="+V+"."+v+"."+_+" <"+V+"."+(+v+1)+".0":z=">="+V+"."+v+"."+_+" <"+(+V+1)+".0.0"),t("caret return",z),z})}function Nw(x,P){return t("replaceXRanges",x,P),x.split(/\s+/).map(function(L){return Fw(L,P)}).join(" ")}function Fw(x,P){x=x.trim();var L=P?o[j]:o[J];return x.replace(L,function(X,V,v,_,S,z){t("xRange",x,X,V,v,_,S,z);var ke=E(v),Ke=ke||E(_),Dt=Ke||E(S),Ci=Dt;return V==="="&&Ci&&(V=""),ke?V===">"||V==="<"?X="<0.0.0":X="*":V&&Ci?(Ke&&(_=0),Dt&&(S=0),V===">"?(V=">=",Ke?(v=+v+1,_=0,S=0):Dt&&(_=+_+1,S=0)):V==="<="&&(V="<",Ke?v=+v+1:_=+_+1),X=V+v+"."+_+"."+S):Ke?X=">="+v+".0.0 <"+(+v+1)+".0.0":Dt&&(X=">="+v+"."+_+".0 <"+v+"."+(+_+1)+".0"),t("xRange return",X),X})}function Mw(x,P){return t("replaceStars",x,P),x.trim().replace(o[bu],"")}function Hw(x,P,L,X,V,v,_,S,z,ke,Ke,Dt,Ci){return E(L)?P="":E(X)?P=">="+L+".0.0":E(V)?P=">="+L+"."+X+".0":P=">="+P,E(z)?S="":E(ke)?S="<"+(+z+1)+".0.0":E(Ke)?S="<"+z+"."+(+ke+1)+".0":Dt?S="<="+z+"."+ke+"."+Ke+"-"+Dt:S="<="+S,(P+" "+S).trim()}lt.prototype.test=function(x){if(!x)return!1;typeof x=="string"&&(x=new He(x,this.loose));for(var P=0;P<this.set.length;P++)if(oc(this.set[P],x))return!0;return!1};function oc(x,P){for(var L=0;L<x.length;L++)if(!x[L].test(P))return!1;if(P.prerelease.length){for(var L=0;L<x.length;L++)if(t(x[L].semver),x[L].semver!==uo&&x[L].semver.prerelease.length>0){var X=x[L].semver;if(X.major===P.major&&X.minor===P.minor&&X.patch===P.patch)return!0}return!1}return!0}e.satisfies=ac;function ac(x,P,L){try{P=new lt(P,L)}catch{return!1}return P.test(x)}e.maxSatisfying=Uw;function Uw(x,P,L){var X=null,V=null;try{var v=new lt(P,L)}catch{return null}return x.forEach(function(_){v.test(_)&&(!X||V.compare(_)===-1)&&(X=_,V=new He(X,L))}),X}e.minSatisfying=Bw;function Bw(x,P,L){var X=null,V=null;try{var v=new lt(P,L)}catch{return null}return x.forEach(function(_){v.test(_)&&(!X||V.compare(_)===1)&&(X=_,V=new He(X,L))}),X}e.validRange=gp;function gp(x,P){try{return new lt(x,P).range||"*"}catch{return null}}e.ltr=Ww;function Ww(x,P,L){return Cu(x,P,"<",L)}e.gtr=Vw;function Vw(x,P,L){return Cu(x,P,">",L)}e.outside=Cu;function Cu(x,P,L,X){x=new He(x,X),P=new lt(P,X);var V,v,_,S,z;switch(L){case">":V=tc,v=rc,_=zr,S=">",z=">=";break;case"<":V=zr,v=nc,_=tc,S="<",z="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ac(x,P,X))return!1;for(var ke=0;ke<P.set.length;++ke){var Ke=P.set[ke],Dt=null,Ci=null;if(Ke.forEach(function(jr){jr.semver===uo&&(jr=new fi(">=0.0.0")),Dt=Dt||jr,Ci=Ci||jr,V(jr.semver,Dt.semver,X)?Dt=jr:_(jr.semver,Ci.semver,X)&&(Ci=jr)}),Dt.operator===S||Dt.operator===z||(!Ci.operator||Ci.operator===S)&&v(x,Ci.semver))return!1;if(Ci.operator===z&&_(x,Ci.semver))return!1}return!0}e.prerelease=zw;function zw(x,P){var L=Yn(x,P);return L&&L.prerelease.length?L.prerelease:null}e.intersects=jw;function jw(x,P,L){return x=new lt(x,L),P=new lt(P,L),x.intersects(P)}e.coerce=qw;function qw(x){if(x instanceof He)return x;if(typeof x!="string")return null;var P=x.match(o[oe]);return P==null?null:Yn((P[1]||"0")+"."+(P[2]||"0")+"."+(P[3]||"0"))}})(jC,jC.exports);const qC=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,IT=/^-(\d{4})(\d{2})(\d{2})$/;function PT(r){return r=r.trim(),r==="*"||qC.test(r)}function GC(r){if(!PT(r))return null;if(r=r.trim(),r==="*")return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};const e=r.match(qC);return e?{hasCaret:e[1]==="^",hasGreaterEquals:e[1]===">=",majorBase:e[2]==="x"?0:parseInt(e[2],10),majorMustEqual:e[2]!=="x",minorBase:e[4]==="x"?0:parseInt(e[4],10),minorMustEqual:e[4]!=="x",patchBase:e[6]==="x"?0:parseInt(e[6],10),patchMustEqual:e[6]!=="x",preRelease:e[8]||null}:null}function QC(r){if(!r)return null;const e=r.majorBase,t=r.majorMustEqual,i=r.minorBase;let n=r.minorMustEqual;const s=r.patchBase;let o=r.patchMustEqual;r.hasCaret&&(e===0||(n=!1),o=!1);let a=0;if(r.preRelease){const c=IT.exec(r.preRelease);if(c){const[,l,u,d]=c;a=Date.UTC(Number(l),Number(u)-1,Number(d))}}return{majorBase:e,majorMustEqual:t,minorBase:i,minorMustEqual:n,patchBase:s,patchMustEqual:o,isMinimum:r.hasGreaterEquals,notBefore:a}}class TT{constructor(){this.buffers=[]}add(e){let t=this.buffers.indexOf(e);return t<0&&(t=this.buffers.length,this.buffers.push(e)),t}}function AT(r,e){if(e.serializeBuffersForPostMessage){const t=new TT,n=JSON.stringify(r,(o,a)=>{if(a instanceof ArrayBuffer)return{$$vscode_array_buffer_reference$$:!0,index:t.add(a)};if(ArrayBuffer.isView(a)){const c=RT(a);if(c)return{$$vscode_array_buffer_reference$$:!0,index:t.add(a.buffer),view:{type:c,byteLength:a.byteLength,byteOffset:a.byteOffset}}}return a}),s=t.buffers.map(o=>{const a=new Uint8Array(o);return me.wrap(a)});return{message:n,buffers:s}}else return{message:JSON.stringify(r),buffers:[]}}function RT(r){switch(r.constructor.name){case"Int8Array":return 1;case"Uint8Array":return 2;case"Uint8ClampedArray":return 3;case"Int16Array":return 4;case"Uint16Array":return 5;case"Int32Array":return 6;case"Uint32Array":return 7;case"Float32Array":return 8;case"Float64Array":return 9;case"BigInt64Array":return 10;case"BigUint64Array":return 11}}function LT(r,e){const t=e.map(s=>{const o=new ArrayBuffer(s.byteLength);return new Uint8Array(o).set(s.buffer),o}),i=e.length?(s,o)=>{if(o&&typeof o=="object"&&o.$$vscode_array_buffer_reference$$){const a=o,{index:c}=a,l=t[c];if(a.view)switch(a.view.type){case 1:return new Int8Array(l,a.view.byteOffset,a.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case 2:return new Uint8Array(l,a.view.byteOffset,a.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case 3:return new Uint8ClampedArray(l,a.view.byteOffset,a.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case 4:return new Int16Array(l,a.view.byteOffset,a.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case 5:return new Uint16Array(l,a.view.byteOffset,a.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case 6:return new Int32Array(l,a.view.byteOffset,a.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case 7:return new Uint32Array(l,a.view.byteOffset,a.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case 8:return new Float32Array(l,a.view.byteOffset,a.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case 9:return new Float64Array(l,a.view.byteOffset,a.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case 10:return new BigInt64Array(l,a.view.byteOffset,a.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case 11:return new BigUint64Array(l,a.view.byteOffset,a.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw new Error("Unknown array buffer view type")}return l}return o}:void 0;return{message:JSON.parse(r,i),arrayBuffers:t}}class OT{constructor(e,t,i,n,s,o,a){ae(this,Js,void 0);ae(this,Ks,void 0);ae(this,cu,void 0);ae(this,lu,void 0);ae(this,uu,void 0);ae(this,dn,void 0);ae(this,Xs,void 0);ae(this,Ys,void 0);ae(this,Zs,void 0);ae(this,eo,void 0);ae(this,du,void 0);ae(this,Na,void 0);ae(this,to,void 0);K(this,Xs,""),K(this,Zs,!1),K(this,eo,!1),this._onMessageEmitter=new T,this.onDidReceiveMessage=this._onMessageEmitter.event,K(this,to,new T),this._onDidDispose=I(this,to).event,K(this,Js,e),K(this,Ks,t),K(this,Ys,i),K(this,lu,n),K(this,uu,s),K(this,dn,o),K(this,du,Ca(o)),K(this,Na,$T(o)),K(this,cu,a)}dispose(){K(this,Zs,!0),I(this,to).fire(),I(this,to).dispose(),this._onMessageEmitter.dispose()}asWebviewUri(e){return K(this,eo,!0),Hl(e,I(this,lu))}get cspSource(){const e=I(this,dn).extensionLocation;if(e.scheme===Z.https||e.scheme===Z.http){let t=e.toString();return t.endsWith("/")||(t+="/"),t+" "+P_}return P_}get html(){return this.assertNotDisposed(),I(this,Xs)}set html(e){this.assertNotDisposed(),I(this,Xs)!==e&&(K(this,Xs,e),I(this,Na)&&!I(this,eo)&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)&&(K(this,eo,!0),I(this,cu).report("Webview vscode-resource: uris",I(this,dn),"Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri")),I(this,Ks).$setHtml(I(this,Js),this.rewriteOldResourceUrlsIfNeeded(e)))}get options(){return this.assertNotDisposed(),I(this,Ys)}set options(e){this.assertNotDisposed(),Ni(I(this,Ys),e)||I(this,Ks).$setOptions(I(this,Js),JC(I(this,dn),I(this,uu),e)),K(this,Ys,e)}async postMessage(e){if(I(this,Zs))return!1;const t=AT(e,{serializeBuffersForPostMessage:I(this,du)});return I(this,Ks).$postMessage(I(this,Js),t.message,...t.buffers)}assertNotDisposed(){if(I(this,Zs))throw new Error("Webview is disposed")}rewriteOldResourceUrlsIfNeeded(e){var n;if(!I(this,Na))return e;const t=((n=I(this,dn).extensionLocation)==null?void 0:n.scheme)===Z.vscodeRemote,i=I(this,dn).extensionLocation.scheme===Z.vscodeRemote?I(this,dn).extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,o,a,c,l,u)=>{const d=y.from({scheme:c||"file",path:decodeURIComponent(l)}),h=Hl(d,{isRemote:t,authority:i}).toString();return`${o}${h}${u}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,o,a,c,l,u)=>{const d=y.from({scheme:c||"file",path:decodeURIComponent(l)}),h=Hl(d,{isRemote:t,authority:i}).toString();return`${o}${h}${u}`})}}Js=new WeakMap,Ks=new WeakMap,cu=new WeakMap,lu=new WeakMap,uu=new WeakMap,dn=new WeakMap,Xs=new WeakMap,Ys=new WeakMap,Zs=new WeakMap,eo=new WeakMap,du=new WeakMap,Na=new WeakMap,to=new WeakMap;function Ca(r){try{const e=QC(GC(r.engines.vscode));return!!e&&e.majorBase>=1&&e.minorBase>=57}catch{return!1}}function $T(r){try{const e=QC(GC(r.engines.vscode));return e?e.majorBase<1||e.majorBase===1&&e.minorBase<60:!1}catch{return!1}}class NT extends Be{constructor(e,t,i,n,s){super(),this.remoteInfo=t,this.workspace=i,this._logService=n,this._deprecationService=s,this._webviews=new Map,this._webviewProxy=e.getProxy(G.MainThreadWebviews)}dispose(){super.dispose();for(const e of this._webviews.values())e.dispose();this._webviews.clear()}$onMessage(e,t,i){const n=this.getWebview(e);if(n){const{message:s}=LT(t,i.value);n._onMessageEmitter.fire(s)}}$onMissingCsp(e,t){this._logService.warn(`${t} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,t,i){const n=new OT(e,this._webviewProxy,FT(t),this.remoteInfo,this.workspace,i,this._deprecationService);this._webviews.set(e,n);const s=n._onDidDispose(()=>{s.dispose(),this.deleteWebview(e)});return n}deleteWebview(e){this._webviews.delete(e)}getWebview(e){return this._webviews.get(e)}}function ff(r){return{id:r.identifier,location:r.extensionLocation}}function JC(r,e,t){return{enableCommandUris:t.enableCommandUris,enableScripts:t.enableScripts,enableForms:t.enableForms,portMapping:t.portMapping,localResourceRoots:t.localResourceRoots||MT(r,e)}}function FT(r){var e;return{enableCommandUris:r.enableCommandUris,enableScripts:r.enableScripts,enableForms:r.enableForms,portMapping:r.portMapping,localResourceRoots:(e=r.localResourceRoots)==null?void 0:e.map(t=>y.from(t))}}function MT(r,e){return[...((e==null?void 0:e.getWorkspaceFolders())||[]).map(t=>t.uri),r.extensionLocation]}const Jf=class Jf{constructor(e){this.id=e,this._data=new Map,this._idPool=1}add(e){const t=this._idPool++;return this._data.set(t,e),this.logDebugInfo(),t}get(e,t){return this._data.has(e)?this._data.get(e)[t]:void 0}delete(e){this._data.delete(e),this.logDebugInfo()}logDebugInfo(){Jf.enableDebugLogging&&console.log(`${this.id} cache size - ${this._data.size}`)}};Jf.enableDebugLogging=!1;let Wi=Jf;class HT{constructor(e,t){this.document=e,this._storagePath=t,this._backupCounter=1,this._edits=new Wi("custom documents")}addEdit(e){return this._edits.add([e])}async undo(e,t){await this.getEdit(e).undo(),t||this.disposeBackup()}async redo(e,t){await this.getEdit(e).redo(),t||this.disposeBackup()}disposeEdits(e){for(const t of e)this._edits.delete(t)}getNewBackupUri(){if(!this._storagePath)throw new Error("Backup requires a valid storage path");const e=jT(this.document.uri)+this._backupCounter++;return xo(this._storagePath,e)}updateBackup(e){var t;(t=this._backup)==null||t.delete(),this._backup=e}disposeBackup(){var e;(e=this._backup)==null||e.delete(),this._backup=void 0}getEdit(e){const t=this._edits.get(e,0);if(!t)throw new Error("No edit found");return t}}class UT{constructor(){this._documents=new Map}get(e,t){return this._documents.get(this.key(e,t))}add(e,t,i){const n=this.key(e,t.uri);if(this._documents.has(n))throw new Error(`Document already exists for viewType:${e} resource:${t.uri}`);const s=new HT(t,i);return this._documents.set(n,s),s}delete(e,t){const i=this.key(e,t.uri);this._documents.delete(i)}key(e,t){return`${e}@@@${t}`}}class BT{constructor(){this._providers=new Map}addTextProvider(e,t,i){return this.add(0,e,t,i)}addCustomProvider(e,t,i){return this.add(1,e,t,i)}get(e){return this._providers.get(e)}add(e,t,i,n){if(this._providers.has(t))throw new Error(`Provider for viewType:${t} already registered`);return this._providers.set(t,{type:e,extension:i,provider:n}),new Pe(()=>this._providers.delete(t))}}class WT{constructor(e,t,i,n,s){this._extHostDocuments=t,this._extensionStoragePaths=i,this._extHostWebview=n,this._extHostWebviewPanels=s,this._editorProviders=new BT,this._documents=new UT,this._proxy=e.getProxy(G.MainThreadCustomEditors)}registerCustomEditorProvider(e,t,i,n){const s=new Ae;return VT(i)?(s.add(this._editorProviders.addTextProvider(t,e,i)),this._proxy.$registerTextEditorProvider(ff(e),t,n.webviewOptions||{},{supportsMove:!!i.moveCustomTextEditor},Ca(e))):(s.add(this._editorProviders.addCustomProvider(t,e,i)),pf(i)&&s.add(i.onDidChangeCustomDocument(o=>{const a=this.getCustomDocumentEntry(t,o.document.uri);if(zT(o)){const c=a.addEdit(o);this._proxy.$onDidEdit(o.document.uri,t,c,o.label)}else this._proxy.$onContentChange(o.document.uri,t)})),this._proxy.$registerCustomEditorProvider(ff(e),t,n.webviewOptions||{},!!n.supportsMultipleEditorsPerDocument,Ca(e))),Pe.from(s,new Pe(()=>{this._proxy.$unregisterEditorProvider(t)}))}async $createCustomDocument(e,t,i,n,s){const o=this._editorProviders.get(t);if(!o)throw new Error(`No provider found for '${t}'`);if(o.type!==1)throw new Error(`Invalid provide type for '${t}'`);const a=y.revive(e),c=await o.provider.openCustomDocument(a,{backupId:i,untitledDocumentData:n==null?void 0:n.buffer},s);let l;return pf(o.provider)&&this._extensionStoragePaths&&(l=this._extensionStoragePaths.workspaceValue(o.extension)??this._extensionStoragePaths.globalValue(o.extension)),this._documents.add(t,c,l),{editable:pf(o.provider)}}async $disposeCustomDocument(e,t){const i=this._editorProviders.get(t);if(!i)throw new Error(`No provider found for '${t}'`);if(i.type!==1)throw new Error(`Invalid provider type for '${t}'`);const n=y.revive(e),{document:s}=this.getCustomDocumentEntry(t,n);this._documents.delete(t,s),s.dispose()}async $resolveCustomEditor(e,t,i,n,s,o){const a=this._editorProviders.get(i);if(!a)throw new Error(`No provider found for '${i}'`);const c=bt.to(s),l=this._extHostWebview.createNewWebview(t,n.contentOptions,a.extension),u=this._extHostWebviewPanels.createNewWebviewPanel(t,i,n.title,c,n.options,l,n.active),d=y.revive(e);switch(a.type){case 1:{const{document:h}=this.getCustomDocumentEntry(i,d);return a.provider.resolveCustomEditor(h,u,o)}case 0:{const h=this._extHostDocuments.getDocument(d);return a.provider.resolveCustomTextEditor(h,u,o)}default:throw new Error("Unknown webview provider type")}}$disposeEdits(e,t,i){this.getCustomDocumentEntry(t,e).disposeEdits(i)}async $onMoveCustomEditor(e,t,i){const n=this._editorProviders.get(i);if(!n)throw new Error(`No provider found for '${i}'`);if(!n.provider.moveCustomTextEditor)throw new Error(`Provider does not implement move '${i}'`);const s=this._extHostWebviewPanels.getWebviewPanel(e);if(!s)throw new Error("No webview found");const o=y.revive(t),a=this._extHostDocuments.getDocument(o);await n.provider.moveCustomTextEditor(a,s,It.None)}async $undo(e,t,i,n){return this.getCustomDocumentEntry(t,e).undo(i,n)}async $redo(e,t,i,n){return this.getCustomDocumentEntry(t,e).redo(i,n)}async $revert(e,t,i){const n=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).revertCustomDocument(n.document,i),n.disposeBackup()}async $onSave(e,t,i){const n=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).saveCustomDocument(n.document,i),n.disposeBackup()}async $onSaveAs(e,t,i,n){const s=this.getCustomDocumentEntry(t,e);return this.getCustomEditorProvider(t).saveCustomDocumentAs(s.document,y.revive(i),n)}async $backup(e,t,i){const n=this.getCustomDocumentEntry(t,e),o=await this.getCustomEditorProvider(t).backupCustomDocument(n.document,{destination:n.getNewBackupUri()},i);return n.updateBackup(o),o.id}getCustomDocumentEntry(e,t){const i=this._documents.get(e,y.revive(t));if(!i)throw new Error("No custom document found");return i}getCustomEditorProvider(e){const t=this._editorProviders.get(e),i=t==null?void 0:t.provider;if(!i||!pf(i))throw new Error("Custom document is not editable");return i}}function pf(r){return!!r.onDidChangeCustomDocument}function VT(r){return typeof r.resolveCustomTextEditor=="function"}function zT(r){return typeof r.undo=="function"&&typeof r.redo=="function"}function jT(r){const e=r.scheme===Z.file||r.scheme===Z.untitled?r.fsPath:r.toString();return ng(e)+""}var Tr;const Iw=class Iw{constructor(e,t,i,n,s,o,a,c){ae(this,Jn,void 0);ae(this,Or,void 0);ae(this,At,void 0);this._name=e,this._owner=t,this._maxDiagnosticsTotal=i,this._maxDiagnosticsPerFile=n,this._modelVersionIdProvider=s,this._isDisposed=!1,this._maxDiagnosticsTotal=Math.max(n,i),K(this,At,new pt(l=>o.getComparisonKey(l))),K(this,Jn,a),K(this,Or,c)}dispose(){var e;this._isDisposed||(I(this,Or).fire([...I(this,At).keys()]),(e=I(this,Jn))==null||e.$clear(this._owner),I(this,At).clear(),this._isDisposed=!0)}get name(){return this._checkDisposed(),this._name}set(e,t){if(!e){this.clear();return}this._checkDisposed();let i=[];if(y.isUri(e)){if(!t){this.delete(e);return}I(this,At).set(e,t.slice()),i=[e]}else if(Array.isArray(e)){i=[];let o;e=[...e].sort(Iw._compareIndexedTuplesByUri);for(const a of e){const[c,l]=a;if((!o||c.toString()!==o.toString())&&(o&&I(this,At).get(o).length===0&&I(this,At).delete(o),o=c,i.push(c),I(this,At).set(c,[])),l){const u=I(this,At).get(c);u==null||u.push(...l)}else{const u=I(this,At).get(c);u&&(u.length=0)}}}if(I(this,Or).fire(i),!I(this,Jn))return;const n=[];let s=0;for(const o of i){let a=[];const c=I(this,At).get(o);if(c)if(c.length>this._maxDiagnosticsPerFile){a=[];const l=[$t.Error,$t.Warning,$t.Information,$t.Hint];e:for(let u=0;u<4;u++)for(const d of c)if(d.severity===l[u]&&a.push({...ta.from(d),modelVersionId:this._modelVersionIdProvider(o)})===this._maxDiagnosticsPerFile)break e;a.push({severity:Yt.Info,message:m("vs/workbench/api/common/extHostDiagnostics",{key:"limitHit",comment:["amount of errors/warning skipped due to limits"]},"Not showing {0} further errors and warnings.",c.length-this._maxDiagnosticsPerFile),startLineNumber:a[a.length-1].startLineNumber,startColumn:a[a.length-1].startColumn,endLineNumber:a[a.length-1].endLineNumber,endColumn:a[a.length-1].endColumn})}else a=c.map(l=>({...ta.from(l),modelVersionId:this._modelVersionIdProvider(o)}));if(n.push([o,a]),s+=a.length,s>this._maxDiagnosticsTotal)break}I(this,Jn).$changeMany(this._owner,n)}delete(e){var t;this._checkDisposed(),I(this,Or).fire([e]),I(this,At).delete(e),(t=I(this,Jn))==null||t.$changeMany(this._owner,[[e,void 0]])}clear(){var e;this._checkDisposed(),I(this,Or).fire([...I(this,At).keys()]),I(this,At).clear(),(e=I(this,Jn))==null||e.$clear(this._owner)}forEach(e,t){this._checkDisposed();for(const[i,n]of this)e.call(t,i,n,this)}*[Symbol.iterator](){this._checkDisposed();for(const e of I(this,At).keys())yield[e,this.get(e)]}get(e){this._checkDisposed();const t=I(this,At).get(e);return Array.isArray(t)?Object.freeze(t.slice(0)):[]}has(e){return this._checkDisposed(),Array.isArray(I(this,At).get(e))}_checkDisposed(){if(this._isDisposed)throw new Error("illegal state - object is disposed")}static _compareIndexedTuplesByUri(e,t){return e[0].toString()<t[0].toString()?-1:e[0].toString()>t[0].toString()?1:0}};Jn=new WeakMap,Or=new WeakMap,At=new WeakMap;let gf=Iw,T_=($r=class{static _mapper(e){const t=new pt;for(const i of e)t.set(i,i);return{uris:Object.freeze(Array.from(t.values()))}}constructor(e,t,i,n){this._logService=t,this._fileSystemInfoService=i,this._extHostDocumentsAndEditors=n,this._collections=new Map,this._onDidChangeDiagnostics=new PS({merge:s=>s.flat(),delay:50}),this.onDidChangeDiagnostics=_t.map(this._onDidChangeDiagnostics.event,Tr._mapper),this._proxy=e.getProxy(G.MainThreadDiagnostics)}createDiagnosticCollection(e,t){const{_collections:i,_proxy:n,_onDidChangeDiagnostics:s,_logService:o,_fileSystemInfoService:a,_extHostDocumentsAndEditors:c}=this,l=new class{$changeMany(h,g){n.$changeMany(h,g),o.trace("[DiagnosticCollection] change many (extension, owner, uris)",e.value,h,g.length===0?"CLEARING":g)}$clear(h){n.$clear(h),o.trace("[DiagnosticCollection] remove all (extension, owner)",e.value,h)}dispose(){n.dispose()}};let u;if(!t)t="_generated_diagnostic_collection_name_#"+Tr._idPool++,u=t;else if(!i.has(t))u=t;else{this._logService.warn(`DiagnosticCollection with name '${t}' does already exist.`);do u=t+Tr._idPool++;while(i.has(u))}return new class extends gf{constructor(){super(t,u,Tr._maxDiagnosticsTotal,Tr._maxDiagnosticsPerFile,h=>{var g;return(g=c.getDocument(h))==null?void 0:g.version},a.extUri,l,s),i.set(u,this)}dispose(){super.dispose(),i.delete(u)}}}getDiagnostics(e){if(e)return this._getDiagnostics(e);{const t=new Map,i=[];for(const n of this._collections.values())n.forEach((s,o)=>{let a=t.get(s.toString());typeof a>"u"&&(a=i.length,t.set(s.toString(),a),i.push([s,[]])),i[a][1]=i[a][1].concat(...o)});return i}}_getDiagnostics(e){let t=[];for(const i of this._collections.values())i.has(e)&&(t=t.concat(i.get(e)));return t}$acceptMarkersChange(e){if(!this._mirrorCollection){const t="_generated_mirror",i=new gf(t,t,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,n=>{},this._fileSystemInfoService.extUri,void 0,this._onDidChangeDiagnostics);this._collections.set(t,i),this._mirrorCollection=i}for(const[t,i]of e)this._mirrorCollection.set(y.revive(t),i.map(ta.to))}},Tr=$r,$r._idPool=0,$r._maxDiagnosticsPerFile=1e3,$r._maxDiagnosticsTotal=1.1*Tr._maxDiagnosticsPerFile,$r);T_=Tr=H([N(1,Ge),N(2,ko)],T_);class qT{constructor(e){this._proxy=e.getProxy(G.MainThreadDialogs)}showOpenDialog(e,t){return t!=null&&t.allowUIResources&&M(e,"showLocal"),this._proxy.$showOpenDialog(t).then(i=>i?i.map(n=>y.revive(n)):void 0)}showSaveDialog(e){return this._proxy.$showSaveDialog(e).then(t=>t?y.revive(t):void 0)}}const Kf=class Kf{constructor(e,t,i){this._documentsAndEditors=t,this._logService=i,this._documentContentProviders=new Map,this._proxy=e.getProxy(G.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(e,t){if(Object.keys(Z).indexOf(e)>=0)throw new Error(`scheme '${e}' already registered`);const i=Kf._handlePool++;this._documentContentProviders.set(i,t),this._proxy.$registerTextContentProvider(i,e);let n;if(typeof t.onDidChange=="function"){let s;n=t.onDidChange(async o=>{if(o.scheme!==e){this._logService.warn(`Provider for scheme '${e}' is firing event for schema '${o.scheme}' which will be IGNORED`);return}if(!this._documentsAndEditors.getDocument(o))return;s&&await s;const a=this.$provideTextDocumentContent(i,o).then(async c=>{if(!c&&typeof c!="string")return;const l=this._documentsAndEditors.getDocument(o);if(!l)return;const u=Bb(c);if(!l.equalLines(u))return this._proxy.$onVirtualDocumentChange(o,c)}).catch(mn).finally(()=>{s===a&&(s=void 0)});s=a})}return new Pe(()=>{this._documentContentProviders.delete(i)&&this._proxy.$unregisterTextContentProvider(i),n&&(n.dispose(),n=void 0)})}$provideTextDocumentContent(e,t){const i=this._documentContentProviders.get(e);return i?Promise.resolve(i.provideTextDocumentContent(y.revive(t),It.None)):Promise.reject(new Error(`unsupported uri-scheme: ${t.scheme}`))}};Kf._handlePool=0;let A_=Kf;class GT{constructor(e,t,i,n={timeout:1500,errors:3}){this._logService=e,this._documents=t,this._mainThreadBulkEdits=i,this._thresholds=n,this._callbacks=new dc,this._badListeners=new WeakMap}dispose(){this._callbacks.clear()}getOnWillSaveTextDocumentEvent(e){return(t,i,n)=>{const o={dispose:this._callbacks.push([t,i,e])};return Array.isArray(n)&&n.push(o),o}}async $participateInSave(e,t){const i=y.revive(e);let n=!1;const s=setTimeout(()=>n=!0,this._thresholds.timeout),o=[];try{for(const a of[...this._callbacks]){if(n)break;const c=this._documents.getDocument(i),l=await this._deliverEventAsyncAndBlameBadListeners(a,{document:c,reason:Ph.to(t)});o.push(l)}}finally{clearTimeout(s)}return o}_deliverEventAsyncAndBlameBadListeners([e,t,i],n){const s=this._badListeners.get(e);return typeof s=="number"&&s>this._thresholds.errors?Promise.resolve(!1):this._deliverEventAsync(i,e,t,n).then(()=>!0,o=>{if(this._logService.error(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' threw ERROR`),this._logService.error(o),!(o instanceof Error)||o.message!=="concurrent_edits"){const a=this._badListeners.get(e);this._badListeners.set(e,a?a+1:1),typeof a=="number"&&a>this._thresholds.errors&&this._logService.info(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}return!1})}_deliverEventAsync(e,t,i,n){const s=[],o=Date.now(),{document:a,reason:c}=n,{version:l}=a,u=Object.freeze({document:a,reason:c,waitUntil(d){if(Object.isFrozen(s))throw vp("waitUntil can not be called async");s.push(Promise.resolve(d))}});try{t.apply(i,[u])}catch(d){return Promise.reject(d)}return new Promise((d,h)=>{const g=setTimeout(()=>h(new Error("timeout")),this._thresholds.timeout);return Promise.all(s).then(w=>{this._logService.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-o}ms`),clearTimeout(g),d(w)}).catch(w=>{clearTimeout(g),h(w)})}).then(d=>{const h={edits:[]};for(const g of d)if(Array.isArray(g)&&g.every(w=>w instanceof gr))for(const{newText:w,newEol:p,range:b}of g)h.edits.push({resource:a.uri,versionId:void 0,textEdit:{range:b&&F.from(b),text:w,eol:p&&oa.from(p)}});if(h.edits.length!==0)return l===a.version?this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(h):Promise.reject(new Error("concurrent_edits"))})}}class QT{constructor(e,t){this._onDidAddDocument=new T,this._onDidRemoveDocument=new T,this._onDidChangeDocument=new T,this._onDidSaveDocument=new T,this.onDidAddDocument=this._onDidAddDocument.event,this.onDidRemoveDocument=this._onDidRemoveDocument.event,this.onDidChangeDocument=this._onDidChangeDocument.event,this.onDidSaveDocument=this._onDidSaveDocument.event,this._toDispose=new Ae,this._documentLoader=new Map,this._proxy=e.getProxy(G.MainThreadDocuments),this._documentsAndEditors=t,this._documentsAndEditors.onDidRemoveDocuments(i=>{for(const n of i)this._onDidRemoveDocument.fire(n.document)},void 0,this._toDispose),this._documentsAndEditors.onDidAddDocuments(i=>{for(const n of i)this._onDidAddDocument.fire(n.document)},void 0,this._toDispose)}dispose(){this._toDispose.dispose()}getAllDocumentData(){return[...this._documentsAndEditors.allDocuments()]}getDocumentData(e){if(!e)return;const t=this._documentsAndEditors.getDocument(e);if(t)return t}getDocument(e){const t=this.getDocumentData(e);if(!(t!=null&&t.document))throw new Error(`Unable to retrieve document from URI '${e}'`);return t.document}ensureDocumentData(e){const t=this._documentsAndEditors.getDocument(e);if(t)return Promise.resolve(t);let i=this._documentLoader.get(e.toString());return i||(i=this._proxy.$tryOpenDocument(e).then(n=>{this._documentLoader.delete(e.toString());const s=y.revive(n);return yo(this._documentsAndEditors.getDocument(s))},n=>(this._documentLoader.delete(e.toString()),Promise.reject(n))),this._documentLoader.set(e.toString(),i)),i}createDocumentData(e){return this._proxy.$tryCreateDocument(e).then(t=>y.revive(t))}$acceptModelLanguageChanged(e,t){const i=y.revive(e),n=this._documentsAndEditors.getDocument(i);if(!n)throw new Error("unknown document");this._onDidRemoveDocument.fire(n.document),n._acceptLanguageId(t),this._onDidAddDocument.fire(n.document)}$acceptModelSaved(e){const t=y.revive(e),i=this._documentsAndEditors.getDocument(t);if(!i)throw new Error("unknown document");this.$acceptDirtyStateChanged(e,!1),this._onDidSaveDocument.fire(i.document)}$acceptDirtyStateChanged(e,t){const i=y.revive(e),n=this._documentsAndEditors.getDocument(i);if(!n)throw new Error("unknown document");n._acceptIsDirty(t),this._onDidChangeDocument.fire({document:n.document,contentChanges:[],reason:void 0})}$acceptModelChanged(e,t,i){const n=y.revive(e),s=this._documentsAndEditors.getDocument(n);if(!s)throw new Error("unknown document");s._acceptIsDirty(i),s.onEvents(t);let o;t.isUndoing?o=Jc.Undo:t.isRedoing&&(o=Jc.Redo),this._onDidChangeDocument.fire(ag({document:s.document,contentChanges:t.changes.map(a=>({range:F.to(a.range),rangeOffset:a.rangeOffset,rangeLength:a.rangeLength,text:a.text})),reason:o}))}setWordDefinitionFor(e,t){JI(e,t)}}class JT{constructor(e){this._AiEmbeddingVectorProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(G.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,t,i){if(this._AiEmbeddingVectorProviders.size===0)throw new Error("No embedding vector providers registered");const n=this._AiEmbeddingVectorProviders.get(e);if(!n)throw new Error("Embedding vector provider not found");const s=await n.provideEmbeddingVector(t,i);if(!s)throw new Error("Embedding vector provider returned undefined");return s}registerEmbeddingVectorProvider(e,t,i){const n=this._nextHandle;return this._nextHandle++,this._AiEmbeddingVectorProviders.set(n,i),this._proxy.$registerAiEmbeddingVectorProvider(t,n),new Pe(()=>{this._proxy.$unregisterAiEmbeddingVectorProvider(n),this._AiEmbeddingVectorProviders.delete(n)})}}class KT{constructor(e,t,i){const n=new Uint8Array(e*t);for(let s=0,o=e*t;s<o;s++)n[s]=i;this._data=n,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class KC{constructor(e){let t=0,i=0;for(let s=0,o=e.length;s<o;s++){const[a,c,l]=e[s];c>t&&(t=c),a>i&&(i=a),l>i&&(i=l)}t++,i++;const n=new KT(i,t,0);for(let s=0,o=e.length;s<o;s++){const[a,c,l]=e[s];n.set(a,c,l)}this._states=n,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let R_=null;function XT(){return R_===null&&(R_=new KC([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),R_}let Ul=null;function YT(){if(Ul===null){Ul=new ef(0);const r=` 	<>'"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…`;for(let t=0;t<r.length;t++)Ul.set(r.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)Ul.set(e.charCodeAt(t),2)}return Ul}class mf{static _createLink(e,t,i,n,s){let o=s-1;do{const a=t.charCodeAt(o);if(e.get(a)!==2)break;o--}while(o>n);if(n>0){const a=t.charCodeAt(n-1),c=t.charCodeAt(o);(a===40&&c===41||a===91&&c===93||a===123&&c===125)&&o--}return{range:{startLineNumber:i,startColumn:n+1,endLineNumber:i,endColumn:o+2},url:t.substring(n,o+1)}}static computeLinks(e,t=XT()){const i=YT(),n=[];for(let s=1,o=e.getLineCount();s<=o;s++){const a=e.getLineContent(s),c=a.length;let l=0,u=0,d=0,h=1,g=!1,w=!1,p=!1,b=!1;for(;l<c;){let k=!1;const D=a.charCodeAt(l);if(h===13){let C;switch(D){case 40:g=!0,C=0;break;case 41:C=g?0:1;break;case 91:p=!0,w=!0,C=0;break;case 93:p=!1,C=w?0:1;break;case 123:b=!0,C=0;break;case 125:C=b?0:1;break;case 39:case 34:case 96:d===D?C=1:d===39||d===34||d===96?C=0:C=1;break;case 42:C=d===42?1:0;break;case 124:C=d===124?1:0;break;case 32:C=p?0:1;break;default:C=i.get(D)}C===1&&(n.push(mf._createLink(i,a,s,u,l)),k=!0)}else if(h===12){let C;D===91?(w=!0,C=0):C=i.get(D),C===1?k=!0:h=13}else h=t.nextState(h,D),h===0&&(k=!0);k&&(h=1,g=!1,w=!1,b=!1,u=l+1,d=D),l++}h===13&&n.push(mf._createLink(i,a,s,u,c))}return n}}class ZT{constructor(){this._schemes=[]}add(e){this._stateMachine=void 0,this._schemes.push(e)}delete(e){const t=this._schemes.indexOf(e);t>=0&&(this._schemes.splice(t,1),this._stateMachine=void 0)}_initStateMachine(){if(!this._stateMachine){const e=this._schemes.sort(),t=[];let i,n,s=14,o=14;for(const a of e){let c=i?fE(i,a):0;for(c===0?n=1:n=o;c<a.length;c++)c+1===a.length?(s=o,o=9):o+=1,t.push([n,a.toUpperCase().charCodeAt(c),o]),t.push([n,a.toLowerCase().charCodeAt(c),o]),n=o;i=a,o=s}t.push([9,58,10]),t.push([10,47,12]),this._stateMachine=new KC(t)}}provideDocumentLinks(e){this._initStateMachine();const t=[],i=mf.computeLinks({getLineContent(n){return e.lineAt(n-1).text},getLineCount(){return e.lineCount}},this._stateMachine);for(const n of i){const s=Ps.to(n);s.target&&t.push(s)}return t}}class vf{constructor(e,t){this._extHostLanguageFeatures=t,this._linkProvider=new ZT,this._fsProvider=new Map,this._registeredSchemes=new Set,this._watches=new Map,this._handlePool=0,this._proxy=e.getProxy(G.MainThreadFileSystem)}dispose(){var e;(e=this._linkProviderRegistration)==null||e.dispose()}registerFileSystemProvider(e,t,i,n={}){if(vf._validateFileSystemProvider(i),this._registeredSchemes.has(t))throw new Error(`a provider for the scheme '${t}' is already registered`);this._linkProviderRegistration||(this._linkProviderRegistration=this._extHostLanguageFeatures.registerDocumentLinkProvider(e,"*",this._linkProvider));const s=this._handlePool++;this._linkProvider.add(t),this._registeredSchemes.add(t),this._fsProvider.set(s,i);let o=2;n.isCaseSensitive&&(o+=1024),n.isReadonly&&(o+=2048),typeof i.copy=="function"&&(o+=8),typeof i.open=="function"&&typeof i.close=="function"&&typeof i.read=="function"&&typeof i.write=="function"&&(M(e,"fsChunks"),o+=4);let a;n.isReadonly&&ls(n.isReadonly)&&n.isReadonly.value!==""&&(a={value:n.isReadonly.value,isTrusted:n.isReadonly.isTrusted,supportThemeIcons:n.isReadonly.supportThemeIcons,supportHtml:n.isReadonly.supportHtml,baseUri:n.isReadonly.baseUri,uris:n.isReadonly.uris}),this._proxy.$registerFileSystemProvider(s,t,o,a).catch(l=>{console.error(`FAILED to register filesystem provider of ${e.identifier.value}-extension for the scheme ${t}`),console.error(l)});const c=i.onDidChangeFile(l=>{const u=[];for(const d of l){const{uri:h,type:g}=d;if(h.scheme!==t)continue;let w;switch(g){case Qo.Changed:w=0;break;case Qo.Created:w=1;break;case Qo.Deleted:w=2;break;default:throw new Error("Unknown FileChangeType")}u.push({resource:h,type:w})}this._proxy.$onFileSystemChange(s,u)});return Le(()=>{c.dispose(),this._linkProvider.delete(t),this._registeredSchemes.delete(t),this._fsProvider.delete(s),this._proxy.$unregisterProvider(s)})}static _validateFileSystemProvider(e){if(!e)throw new Error("MISSING provider");if(typeof e.watch!="function")throw new Error("Provider does NOT implement watch");if(typeof e.stat!="function")throw new Error("Provider does NOT implement stat");if(typeof e.readDirectory!="function")throw new Error("Provider does NOT implement readDirectory");if(typeof e.createDirectory!="function")throw new Error("Provider does NOT implement createDirectory");if(typeof e.readFile!="function")throw new Error("Provider does NOT implement readFile");if(typeof e.writeFile!="function")throw new Error("Provider does NOT implement writeFile");if(typeof e.delete!="function")throw new Error("Provider does NOT implement delete");if(typeof e.rename!="function")throw new Error("Provider does NOT implement rename")}static _asIStat(e){const{type:t,ctime:i,mtime:n,size:s,permissions:o}=e;return{type:t,ctime:i,mtime:n,size:s,permissions:o}}$stat(e,t){return Promise.resolve(this._getFsProvider(e).stat(y.revive(t))).then(i=>vf._asIStat(i))}$readdir(e,t){return Promise.resolve(this._getFsProvider(e).readDirectory(y.revive(t)))}$readFile(e,t){return Promise.resolve(this._getFsProvider(e).readFile(y.revive(t))).then(i=>me.wrap(i))}$writeFile(e,t,i,n){return Promise.resolve(this._getFsProvider(e).writeFile(y.revive(t),i.buffer,n))}$delete(e,t,i){return Promise.resolve(this._getFsProvider(e).delete(y.revive(t),i))}$rename(e,t,i,n){return Promise.resolve(this._getFsProvider(e).rename(y.revive(t),y.revive(i),n))}$copy(e,t,i,n){const s=this._getFsProvider(e);if(!s.copy)throw new Error('FileSystemProvider does not implement "copy"');return Promise.resolve(s.copy(y.revive(t),y.revive(i),n))}$mkdir(e,t){return Promise.resolve(this._getFsProvider(e).createDirectory(y.revive(t)))}$watch(e,t,i,n){const s=this._getFsProvider(e).watch(y.revive(i),n);this._watches.set(t,s)}$unwatch(e,t){const i=this._watches.get(t);i&&(i.dispose(),this._watches.delete(t))}$open(e,t,i){const n=this._getFsProvider(e);if(!n.open)throw new Error('FileSystemProvider does not implement "open"');return Promise.resolve(n.open(y.revive(t),i))}$close(e,t){const i=this._getFsProvider(e);if(!i.close)throw new Error('FileSystemProvider does not implement "close"');return Promise.resolve(i.close(t))}$read(e,t,i,n){const s=this._getFsProvider(e);if(!s.read)throw new Error('FileSystemProvider does not implement "read"');const o=me.alloc(n);return Promise.resolve(s.read(t,i,o.buffer,0,n)).then(a=>o.slice(0,a))}$write(e,t,i,n){const s=this._getFsProvider(e);if(!s.write)throw new Error('FileSystemProvider does not implement "write"');return Promise.resolve(s.write(t,i,n.buffer,0,n.byteLength))}_getFsProvider(e){const t=this._fsProvider.get(e);if(!t){const i=new Error;throw i.name="ENOPRO",i.message="no provider",i}return t}}class e5{get ignoreCreateEvents(){return!!(this._config&1)}get ignoreChangeEvents(){return!!(this._config&2)}get ignoreDeleteEvents(){return!!(this._config&4)}constructor(e,t,i,n,s,o){this.session=Math.random(),this._onDidCreate=new T,this._onDidChange=new T,this._onDidDelete=new T,this._config=0,o!=null&&o.ignoreCreateEvents&&(this._config+=1),o!=null&&o.ignoreChangeEvents&&(this._config+=2),o!=null&&o.ignoreDeleteEvents&&(this._config+=4);const a=Lo(s),c=typeof s=="string",l=o==null?void 0:o.correlate,u=n(d=>{if(!(typeof d.session=="number"&&d.session!==this.session)&&!(l&&typeof d.session>"u")){if(!(o!=null&&o.ignoreCreateEvents))for(const h of d.created){const g=y.revive(h);a(g.fsPath)&&(!c||t.getWorkspaceFolder(g))&&this._onDidCreate.fire(g)}if(!(o!=null&&o.ignoreChangeEvents))for(const h of d.changed){const g=y.revive(h);a(g.fsPath)&&(!c||t.getWorkspaceFolder(g))&&this._onDidChange.fire(g)}if(!(o!=null&&o.ignoreDeleteEvents))for(const h of d.deleted){const g=y.revive(h);a(g.fsPath)&&(!c||t.getWorkspaceFolder(g))&&this._onDidDelete.fire(g)}}});this._disposable=Pe.from(this.ensureWatching(e,i,s,o,o==null?void 0:o.correlate),this._onDidCreate,this._onDidChange,this._onDidDelete,u)}ensureWatching(e,t,i,n,s){const o=Pe.from();if(typeof i=="string")return o;const a=e.getProxy(G.MainThreadFileSystemEventService);let c=!1;return(i.pattern.includes(Nc)||i.pattern.includes(bg))&&(c=!0),a.$watch(t.identifier.value,this.session,i.baseUri,{recursive:c,excludes:(n==null?void 0:n.excludes)??[]},!!s),Pe.from({dispose:()=>a.$unwatch(this.session)})}dispose(){this._disposable.dispose()}get onDidCreate(){return this._onDidCreate.event}get onDidChange(){return this._onDidChange.event}get onDidDelete(){return this._onDidDelete.event}}class t5{constructor(e){this._events=e,this.session=this._events.session,this._created=new ut(()=>this._events.created.map(y.revive)),this._changed=new ut(()=>this._events.changed.map(y.revive)),this._deleted=new ut(()=>this._events.deleted.map(y.revive))}get created(){return this._created.value}get changed(){return this._changed.value}get deleted(){return this._deleted.value}}class i5{constructor(e,t,i){this._mainContext=e,this._logService=t,this._extHostDocumentsAndEditors=i,this._onFileSystemEvent=new T,this._onDidRenameFile=new T,this._onDidCreateFile=new T,this._onDidDeleteFile=new T,this._onWillRenameFile=new hc,this._onWillCreateFile=new hc,this._onWillDeleteFile=new hc,this.onDidRenameFile=this._onDidRenameFile.event,this.onDidCreateFile=this._onDidCreateFile.event,this.onDidDeleteFile=this._onDidDeleteFile.event}createFileSystemWatcher(e,t,i,n){return new e5(this._mainContext,e,t,this._onFileSystemEvent.event,li.from(i),n)}$onFileEvent(e){this._onFileSystemEvent.fire(new t5(e))}$onDidRunFileOperation(e,t){switch(e){case 2:this._onDidRenameFile.fire(Object.freeze({files:t.map(i=>({oldUri:y.revive(i.source),newUri:y.revive(i.target)}))}));break;case 1:this._onDidDeleteFile.fire(Object.freeze({files:t.map(i=>y.revive(i.target))}));break;case 0:case 3:this._onDidCreateFile.fire(Object.freeze({files:t.map(i=>y.revive(i.target))}));break}}getOnWillRenameFileEvent(e){return this._createWillExecuteEvent(e,this._onWillRenameFile)}getOnWillCreateFileEvent(e){return this._createWillExecuteEvent(e,this._onWillCreateFile)}getOnWillDeleteFileEvent(e){return this._createWillExecuteEvent(e,this._onWillDeleteFile)}_createWillExecuteEvent(e,t){return(i,n,s)=>{const o=function(c){i.call(n,c)};return o.extension=e,t.event(o,void 0,s)}}async $onWillRunFileOperation(e,t,i,n){switch(e){case 2:return await this._fireWillEvent(this._onWillRenameFile,{files:t.map(s=>({oldUri:y.revive(s.source),newUri:y.revive(s.target)}))},i,n);case 1:return await this._fireWillEvent(this._onWillDeleteFile,{files:t.map(s=>y.revive(s.target))},i,n);case 0:case 3:return await this._fireWillEvent(this._onWillCreateFile,{files:t.map(s=>y.revive(s.target))},i,n)}}async _fireWillEvent(e,t,i,n){const s=new Set,o=[];if(await e.fireAsync(t,n,async(c,l)=>{const u=Date.now(),d=await Promise.resolve(c);d instanceof mr&&(o.push([l.extension,d]),s.add(l.extension.displayName??l.extension.identifier.value)),Date.now()-u>i&&this._logService.warn("SLOW file-participant",l.extension.identifier)}),n.isCancellationRequested||o.length===0)return;const a={edits:[]};for(const[,c]of o){const{edits:l}=ei.from(c,{getTextDocumentVersion:u=>{var d;return(d=this._extHostDocumentsAndEditors.getDocument(u))==null?void 0:d.version},getNotebookDocumentVersion:()=>{}});a.edits=a.edits.concat(l)}return{edit:a,extensionNames:Array.from(s)}}}const Xf=class Xf{constructor(e,t){this.extension=e,this.provider=t,this.handle=Xf._pool++}};Xf._pool=0;let L_=Xf;class n5{constructor(e){this.session=e,this.responses=[]}}const hu=class hu{constructor(e,t,i,n){this._documents=i,this._logService=n,this._inputProvider=new Map,this._inputSessions=new Map,this._proxy=e.getProxy(G.MainThreadInlineChat),t.registerApiCommand(new ve("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new W("Run arguments","",s=>!0,s=>{if(s)return{initialRange:s.initialRange?F.from(s.initialRange):void 0,initialSelection:kn.isSelection(s.initialSelection)?Ii.from(s.initialSelection):void 0,message:s.message,autoSend:s.autoSend,position:s.position?We.from(s.position):void 0}})],pe.Void))}registerProvider(e,t,i){const n=new L_(e,t);return this._inputProvider.set(n.handle,n),this._proxy.$registerInteractiveEditorProvider(n.handle,(i==null?void 0:i.label)??e.displayName??e.name,e.identifier.value,typeof t.handleInteractiveEditorResponseFeedback=="function",typeof t.provideFollowups=="function",(i==null?void 0:i.supportReportIssue)??!1),Le(()=>{this._proxy.$unregisterInteractiveEditorProvider(n.handle),this._inputProvider.delete(n.handle)})}async $prepareSession(e,t,i,n){var u;const s=this._inputProvider.get(e);if(!s){this._logService.warn("CANNOT prepare session because the PROVIDER IS GONE");return}const o=this._documents.getDocument(y.revive(t)),a=Ii.to(i),c=await s.provider.prepareInteractiveEditorSession({document:o,selection:a},n);if(!c)return;if(c.wholeRange&&!c.wholeRange.contains(a))throw new Error("InteractiveEditorSessionProvider returned a wholeRange that does not contain the selection.");const l=hu._nextId++;return this._inputSessions.set(l,new n5(c)),{id:l,placeholder:c.placeholder,input:c.input,slashCommands:(u=c.slashCommands)==null?void 0:u.map(d=>({command:d.command,detail:d.detail,refer:d.refer,executeImmediately:d.executeImmediately})),wholeRange:F.from(c.wholeRange),message:c.message}}async $provideResponse(e,t,i,n){const s=this._inputProvider.get(e);if(!s)return;const o=this._inputSessions.get(t.id);if(!o)return;const a={prompt:i.prompt,selection:Ii.to(i.selection),wholeRange:F.to(i.wholeRange),attempt:i.attempt,live:i.live,previewDocument:this._documents.getDocument(y.revive(i.previewDocument)),withIntentDetection:i.withIntentDetection};let c=!1;const l={report:async k=>{var D,C,R;if(!i.live&&((D=k.edits)!=null&&D.length))throw new Error("Progress reporting is only supported for live sessions");c||n.isCancellationRequested||await this._proxy.$handleProgressChunk(i.requestId,{message:k.message,edits:(C=k.edits)==null?void 0:C.map(St.from),editsShouldBeInstant:k.editsShouldBeInstant,slashCommand:(R=k.slashCommand)==null?void 0:R.command,markdownFragment:Di.isMarkdownString(k.content)?k.content.value:k.content})}},u=Promise.resolve(s.provider.provideInteractiveEditorResponse(o.session,a,l,n));let d;try{d=await Qp(u,n)}finally{c=!0}if(!d)return;const h=o.responses.push(d)-1,g={wholeRange:F.from(d.wholeRange),placeholder:d.placeholder};if(!hu._isEditResponse(d))return{...g,id:h,type:"editorEdit",message:Te.from(d.contents),edits:[]};const{edits:w,contents:p}=d,b=p!==void 0?Te.from(p):void 0;return w instanceof mr?{...g,id:h,type:"bulkEdit",edits:ei.from(w),message:b}:{...g,id:h,type:"editorEdit",edits:w.map(St.from),message:b}}async $provideFollowups(e,t,i,n){const s=this._inputProvider.get(e),o=this._inputSessions.get(t),a=o==null?void 0:o.responses[i];if(s&&a&&s.provider.provideFollowups){const c=Promise.resolve(s.provider.provideFollowups(o.session,a,n)),l=await Qp(c,n);return l==null?void 0:l.map(Zm.from)}}$handleFeedback(e,t,i,n){var c,l;const s=this._inputProvider.get(e),o=this._inputSessions.get(t),a=o==null?void 0:o.responses[i];if(s&&a){const u=ev.to(n);(l=(c=s.provider).handleInteractiveEditorResponseFeedback)==null||l.call(c,o.session,a,u)}}$releaseSession(e,t){}static _isEditResponse(e){return typeof e=="object"&&typeof e.edits=="object"}};hu._nextId=0;let O_=hu;class r5{constructor(e,t,i,n,s){this._extHostNotebooks=t,this._textDocumentsAndEditors=i,this._commands=n;const o=new ve("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new W("showOptions","Show Options",a=>!0,a=>a),new W("resource","Interactive resource Uri",a=>!0,a=>a),new W("controllerId","Notebook controller Id",a=>!0,a=>a),new W("title","Interactive editor title",a=>!0,a=>a)],new pe("Notebook and input URI",a=>{if(s.debug("[ExtHostInteractive] open iw with notebook editor id",a.notebookEditorId),a.notebookEditorId!==void 0){const c=this._extHostNotebooks.getEditorById(a.notebookEditorId);return s.debug("[ExtHostInteractive] notebook editor found",c.id),{notebookUri:y.revive(a.notebookUri),inputUri:y.revive(a.inputUri),notebookEditor:c.apiEditor}}return s.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",a.notebookUri,a.inputUri),{notebookUri:y.revive(a.notebookUri),inputUri:y.revive(a.inputUri)}}));this._commands.registerApiCommand(o)}$willAddInteractiveDocument(e,t,i,n){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:t,lines:[""],languageId:i,uri:e,isDirty:!1,versionId:1}]})}$willRemoveInteractiveDocument(e,t){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}}class s5{constructor(e){this._IssueUriRequestHandlers=new Map,this._IssueDataProviders=new Map,this._proxy=e.getProxy(G.MainThreadIssueReporter)}async $getIssueReporterUri(e,t){if(this._IssueUriRequestHandlers.size===0)throw new Error("No issue request handlers registered");const i=this._IssueUriRequestHandlers.get(e);if(!i)throw new Error("Issue request handler not found");const n=await i.handleIssueUrlRequest();if(!n)throw new Error("Issue request handler returned no result");return n}async $getIssueReporterData(e,t){if(this._IssueDataProviders.size===0)throw new Error("No issue request handlers registered");const i=this._IssueDataProviders.get(e);if(!i)throw new Error("Issue data provider not found");const n=await i.provideIssueData(t);if(!n)throw new Error("Issue data provider returned no result");return n}async $getIssueReporterTemplate(e,t){if(this._IssueDataProviders.size===0)throw new Error("No issue request handlers registered");const i=this._IssueDataProviders.get(e);if(!i)throw new Error("Issue data provider not found");const n=await i.provideIssueTemplate(t);if(!n)throw new Error("Issue template provider returned no result");return n}registerIssueUriRequestHandler(e,t){const i=e.identifier.value;return this._IssueUriRequestHandlers.set(i,t),this._proxy.$registerIssueUriRequestHandler(i),new Pe(()=>{this._proxy.$unregisterIssueUriRequestHandler(i),this._IssueUriRequestHandlers.delete(i)})}registerIssueDataProvider(e,t){const i=e.identifier.value;return this._IssueDataProviders.set(i,t),this._proxy.$registerIssueDataProvider(i),new Pe(()=>{this._proxy.$unregisterIssueDataProvider(i),this._IssueDataProviders.delete(i)})}}class o5{constructor(e){this._handlePool=0,this._proxy=e.getProxy(G.MainThreadLabelService)}$registerResourceLabelFormatter(e){const t=this._handlePool++;return this._proxy.$registerResourceLabelFormatter(t,e),Le(()=>{this._proxy.$unregisterResourceLabelFormatter(t)})}}class wi extends ze{constructor(e,t,i,n){super(e,t,i,n),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return wi.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new wi(this.startLineNumber,this.startColumn,e,t):new wi(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new ki(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new ki(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new wi(e,t,this.endLineNumber,this.endColumn):new wi(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new wi(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new wi(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new wi(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new wi(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,n,s){return s===0?new wi(e,t,i,n):new wi(i,n,e,t)}}class _f{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentSymbols(e,t){const i=this._documents.getDocument(e),n=await this._provider.provideDocumentSymbols(i,t);if(!wp(n))return n[0]instanceof zc?n.map(Om.from):_f._asDocumentSymbolTree(n)}static _asDocumentSymbolTree(e){var n,s;e=e.slice(0).sort((o,a)=>{let c=o.location.range.start.compareTo(a.location.range.start);return c===0&&(c=a.location.range.end.compareTo(o.location.range.end)),c});const t=[],i=[];for(const o of e){const a={name:o.name||"!!MISSING: name!!",kind:Pi.from(o.kind),tags:((n=o.tags)==null?void 0:n.map(Tn.from))||[],detail:"",containerName:o.containerName,range:F.from(o.location.range),selectionRange:F.from(o.location.range),children:[]};for(;;){if(i.length===0){i.push(a),t.push(a);break}const c=i[i.length-1];if(ze.containsRange(c.range,a.range)&&!ze.equalsRange(c.range,a.range)){(s=c.children)==null||s.push(a),i.push(a);break}i.pop()}}return t}}class wf{constructor(e,t,i,n,s,o){this._documents=e,this._commands=t,this._provider=i,this._extension=n,this._extTelemetry=s,this._logService=o,this._cache=new Wi("CodeLens"),this._disposables=new Map}async provideCodeLenses(e,t){const i=this._documents.getDocument(e),n=await this._provider.provideCodeLenses(i,t);if(!n||t.isCancellationRequested)return;const s=this._cache.add(n),o=new Ae;this._disposables.set(s,o);const a={cacheId:s,lenses:[]};for(let c=0;c<n.length;c++)a.lenses.push({cacheId:[s,c],range:F.from(n[c].range),command:this._commands.toInternal(n[c].command,o)});return a}async resolveCodeLens(e,t){const i=e.cacheId&&this._cache.get(...e.cacheId);if(!i)return;let n;if(typeof this._provider.resolveCodeLens!="function"||i.isResolved?n=i:n=await this._provider.resolveCodeLens(i,t),n||(n=i),t.isCancellationRequested)return;const s=e.cacheId&&this._disposables.get(e.cacheId[0]);if(s){if(!n.command){const o=new Error("INVALID code lens resolved, lacks command: "+this._extension.identifier.value);this._extTelemetry.onExtensionError(this._extension.identifier,o),this._logService.error(o);return}return e.command=this._commands.toInternal(n.command,s),e}}releaseCodeLenses(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}}function bf(r){return Array.isArray(r)?r.map(hl.from):r?[hl.from(r)]:[]}class XC{constructor(e,t){this._documents=e,this._provider=t}async provideDefinition(e,t,i){const n=this._documents.getDocument(e),s=We.to(t),o=await this._provider.provideDefinition(n,s,i);return bf(o)}}class YC{constructor(e,t){this._documents=e,this._provider=t}async provideDeclaration(e,t,i){const n=this._documents.getDocument(e),s=We.to(t),o=await this._provider.provideDeclaration(n,s,i);return bf(o)}}class ZC{constructor(e,t){this._documents=e,this._provider=t}async provideImplementation(e,t,i){const n=this._documents.getDocument(e),s=We.to(t),o=await this._provider.provideImplementation(n,s,i);return bf(o)}}class e0{constructor(e,t){this._documents=e,this._provider=t}async provideTypeDefinition(e,t,i){const n=this._documents.getDocument(e),s=We.to(t),o=await this._provider.provideTypeDefinition(n,s,i);return bf(o)}}class t0{constructor(e,t){this._documents=e,this._provider=t}async provideHover(e,t,i){const n=this._documents.getDocument(e),s=We.to(t),o=await this._provider.provideHover(n,s,i);if(!(!o||wp(o.contents)))return o.range||(o.range=n.getWordRangeAtPosition(s)),o.range||(o.range=new be(s,s)),bh.from(o)}}class i0{constructor(e,t){this._documents=e,this._provider=t}async provideEvaluatableExpression(e,t,i){const n=this._documents.getDocument(e),s=We.to(t),o=await this._provider.provideEvaluatableExpression(n,s,i);if(o)return Fm.from(o)}}class n0{constructor(e,t){this._documents=e,this._provider=t}async provideInlineValues(e,t,i,n){const s=this._documents.getDocument(e),o=await this._provider.provideInlineValues(s,F.to(t),xh.to(i),n);if(Array.isArray(o))return o.map(a=>yh.from(a))}}class r0{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentHighlights(e,t,i){const n=this._documents.getDocument(e),s=We.to(t),o=await this._provider.provideDocumentHighlights(n,s,i);if(Array.isArray(o))return o.map(na.from)}}class s0{constructor(e,t){this._documents=e,this._provider=t}async provideMultiDocumentHighlights(e,t,i,n){const s=this._documents.getDocument(e),o=i.map(l=>this._documents.getDocument(l)),a=We.to(t),c=await this._provider.provideMultiDocumentHighlights(s,a,o,n);if(Array.isArray(c))return c.map(Mm.from)}}class o0{constructor(e,t){this._documents=e,this._provider=t}async provideLinkedEditingRanges(e,t,i){const n=this._documents.getDocument(e),s=We.to(t),o=await this._provider.provideLinkedEditingRanges(n,s,i);if(o&&Array.isArray(o.ranges))return{ranges:Jt(o.ranges.map(F.from)),wordPattern:o.wordPattern}}}class a0{constructor(e,t){this._documents=e,this._provider=t}async provideReferences(e,t,i,n){const s=this._documents.getDocument(e),o=We.to(t),a=await this._provider.provideReferences(s,o,i,n);if(Array.isArray(a))return a.map(_i.from)}}const Fa=class Fa{constructor(e,t,i,n,s,o,a){this._documents=e,this._commands=t,this._diagnostics=i,this._provider=n,this._logService=s,this._extension=o,this._apiDeprecation=a,this._cache=new Wi("CodeAction"),this._disposables=new Map}async provideCodeActions(e,t,i,n){var g;const s=this._documents.getDocument(e),o=wi.isISelection(t)?Ii.to(t):F.to(t),a=[];for(const w of this._diagnostics.getDiagnostics(e))if(o.intersection(w.range)&&a.push(w)>Fa._maxCodeActionsPerFile)break;const c={diagnostics:a,only:i.only?new it(i.only):void 0,triggerKind:Ym.to(i.trigger)},l=await this._provider.provideCodeActions(s,o,c,n);if(!cc(l)||n.isCancellationRequested)return;const u=this._cache.add(l),d=new Ae;this._disposables.set(u,d);const h=[];for(let w=0;w<l.length;w++){const p=l[w];if(p)if(Fa._isCommand(p))this._apiDeprecation.report("CodeActionProvider.provideCodeActions - return commands",this._extension,"Return 'CodeAction' instances instead."),h.push({_isSynthetic:!0,title:p.title,command:this._commands.toInternal(p,d)});else{c.only&&(p.kind?c.only.contains(p.kind)||this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${c.only.value} 'requested but returned code action is of kind '${p.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`):this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${c.only.value} 'requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`));const b=p.ranges??[];h.push({cacheId:[u,w],title:p.title,command:p.command&&this._commands.toInternal(p.command,d),diagnostics:p.diagnostics&&p.diagnostics.map(ta.from),edit:p.edit&&ei.from(p.edit,void 0),kind:p.kind&&p.kind.value,isPreferred:p.isPreferred,isAI:Tt(this._extension,"codeActionAI")?p.isAI:!1,ranges:Tt(this._extension,"codeActionRanges")?Jt(b.map(F.from)):void 0,disabled:(g=p.disabled)==null?void 0:g.reason})}}return{cacheId:u,actions:h}}async resolveCodeAction(e,t){const[i,n]=e,s=this._cache.get(i,n);if(!s||Fa._isCommand(s))return{};if(!this._provider.resolveCodeAction)return{};const o=await this._provider.resolveCodeAction(s,t)??s;let a;o.edit&&(a=ei.from(o.edit,void 0));let c;if(o.command){const l=this._disposables.get(i);l&&(c=this._commands.toInternal(o.command,l))}return{edit:a,command:c}}releaseCodeActions(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}static _isCommand(e){return typeof e.command=="string"&&typeof e.title=="string"}};Fa._maxCodeActionsPerFile=1e3;let Sa=Fa;class Ea{static toInternalProviderId(e,t){return e+"."+t}constructor(e,t,i,n,s){this._proxy=e,this._documents=t,this._provider=i,this._handle=n,this._extension=s}async prepareDocumentPaste(e,t,i,n){if(!this._provider.prepareDocumentPaste)return;const s=this._documents.getDocument(e),o=t.map(l=>F.to(l)),a=Er.toDataTransfer(i,()=>{throw new Z0});if(await this._provider.prepareDocumentPaste(s,o,a,n),n.isCancellationRequested)return;const c=Array.from(a).filter(([,l])=>!(l instanceof Vd));return Er.from(c)}async providePasteEdits(e,t,i,n,s){var u;if(!this._provider.provideDocumentPasteEdits)return;const o=this._documents.getDocument(t),a=i.map(d=>F.to(d)),c=Er.toDataTransfer(n,async d=>(await this._proxy.$resolvePasteFileData(this._handle,e,d)).buffer),l=await this._provider.provideDocumentPasteEdits(o,a,c,s);if(l)return{label:l.label??m("vs/workbench/api/common/extHostLanguageFeatures","defaultPasteLabel","Paste using '{0}' extension",this._extension.displayName||this._extension.name),detail:this._extension.displayName||this._extension.name,yieldTo:(u=l.yieldTo)==null?void 0:u.map(d=>"mimeType"in d?d:{providerId:Ea.toInternalProviderId(d.extensionId,d.providerId)}),insertText:typeof l.insertText=="string"?l.insertText:{snippet:l.insertText.value},additionalEdit:l.additionalEdit?ei.from(l.additionalEdit,void 0):void 0}}}class c0{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentFormattingEdits(e,t,i){const n=this._documents.getDocument(e),s=await this._provider.provideDocumentFormattingEdits(n,t,i);if(Array.isArray(s))return s.map(St.from)}}class $_{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeFormattingEdits(e,t,i,n){const s=this._documents.getDocument(e),o=F.to(t),a=await this._provider.provideDocumentRangeFormattingEdits(s,o,i,n);if(Array.isArray(a))return a.map(St.from)}async provideDocumentRangesFormattingEdits(e,t,i,n){Yb(typeof this._provider.provideDocumentRangesFormattingEdits=="function","INVALID invocation of `provideDocumentRangesFormattingEdits`");const s=this._documents.getDocument(e),o=t.map(F.to),a=await this._provider.provideDocumentRangesFormattingEdits(s,o,i,n);if(Array.isArray(a))return a.map(St.from)}}class l0{constructor(e,t){this._documents=e,this._provider=t,this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,t,i,n,s){const o=this._documents.getDocument(e),a=We.to(t),c=await this._provider.provideOnTypeFormattingEdits(o,a,i,n,s);if(Array.isArray(c))return c.map(St.from)}}class yf{constructor(e,t){this._provider=e,this._logService=t,this._cache=new Wi("WorkspaceSymbols")}async provideWorkspaceSymbols(e,t){const i=await this._provider.provideWorkspaceSymbols(e,t);if(!cc(i))return{symbols:[]};const n=this._cache.add(i),s={cacheId:n,symbols:[]};for(let o=0;o<i.length;o++){const a=i[o];if(!a||!a.name){this._logService.warn("INVALID SymbolInformation",a);continue}s.symbols.push({...dl.from(a),cacheId:[n,o]})}return s}async resolveWorkspaceSymbol(e,t){if(typeof this._provider.resolveWorkspaceSymbol!="function"||!e.cacheId)return e;const i=this._cache.get(...e.cacheId);if(i){const n=await this._provider.resolveWorkspaceSymbol(i,t);return n&&cs(e,dl.from(n),!0)}}releaseWorkspaceSymbols(e){this._cache.delete(e)}}class Fs{static supportsResolving(e){return typeof e.prepareRename=="function"}constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideRenameEdits(e,t,i,n){const s=this._documents.getDocument(e),o=We.to(t);try{const a=await this._provider.provideRenameEdits(s,o,i,n);return a?ei.from(a):void 0}catch(a){const c=Fs._asMessage(a);return c?{rejectReason:c,edits:void 0}:Promise.reject(a)}}async resolveRenameLocation(e,t,i){if(typeof this._provider.prepareRename!="function")return Promise.resolve(void 0);const n=this._documents.getDocument(e),s=We.to(t);try{const o=await this._provider.prepareRename(n,s,i);let a,c;if(be.isRange(o)?(a=o,c=n.getText(o)):Ft(o)&&(a=o.range,c=o.placeholder),!a||!c)return;if(a.start.line>s.line||a.end.line<s.line){this._logService.warn("INVALID rename location: position line must be within range start/end lines");return}return{range:F.from(a),text:c}}catch(o){const a=Fs._asMessage(o);return a?{rejectReason:a,range:void 0,text:void 0}:Promise.reject(o)}}static _asMessage(e){return typeof e=="string"?e:e instanceof Error&&typeof e.message=="string"?e.message:void 0}}class xf{constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideNewSymbolNames(e,t,i){const n=this._documents.getDocument(e),s=F.to(t);try{const o=await this._provider.provideNewSymbolNames(n,s,i);return o?o.map(a=>typeof a=="string"?{newSymbolName:a}:{newSymbolName:a.newSymbolName,tags:a.tags}):void 0}catch(o){this._logService.error(xf._asMessage(o)??JSON.stringify(o,null,"	"));return}}static _asMessage(e){return typeof e=="string"?e:e instanceof Error&&typeof e.message=="string"?e.message:void 0}}class N_{constructor(e,t){this.resultId=e,this.tokens=t}}class ui{constructor(e,t){this._documents=e,this._provider=t,this._nextResultId=1,this._previousResults=new Map}async provideDocumentSemanticTokens(e,t,i){const n=this._documents.getDocument(e),s=t!==0?this._previousResults.get(t):null;let o=typeof(s==null?void 0:s.resultId)=="string"&&typeof this._provider.provideDocumentSemanticTokensEdits=="function"?await this._provider.provideDocumentSemanticTokensEdits(n,s.resultId,i):await this._provider.provideDocumentSemanticTokens(n,i);return s&&this._previousResults.delete(t),o?(o=ui._fixProvidedSemanticTokens(o),this._send(ui._convertToEdits(s,o),o)):null}async releaseDocumentSemanticColoring(e){this._previousResults.delete(e)}static _fixProvidedSemanticTokens(e){return ui._isSemanticTokens(e)?ui._isCorrectSemanticTokens(e)?e:new Jo(new Uint32Array(e.data),e.resultId):ui._isSemanticTokensEdits(e)?ui._isCorrectSemanticTokensEdits(e)?e:new eh(e.edits.map(t=>new cx(t.start,t.deleteCount,t.data?new Uint32Array(t.data):t.data)),e.resultId):e}static _isSemanticTokens(e){return e&&!!e.data}static _isCorrectSemanticTokens(e){return e.data instanceof Uint32Array}static _isSemanticTokensEdits(e){return e&&Array.isArray(e.edits)}static _isCorrectSemanticTokensEdits(e){for(const t of e.edits)if(!(t.data instanceof Uint32Array))return!1;return!0}static _convertToEdits(e,t){if(!ui._isSemanticTokens(t)||!e||!e.tokens)return t;const i=e.tokens,n=i.length,s=t.data,o=s.length;let a=0;const c=Math.min(n,o);for(;a<c&&i[a]===s[a];)a++;if(a===n&&a===o)return new eh([],t.resultId);let l=0;const u=c-a;for(;l<u&&i[n-l-1]===s[o-l-1];)l++;return new eh([{start:a,deleteCount:n-a-l,data:s.subarray(a,o-l)}],t.resultId)}_send(e,t){if(ui._isSemanticTokens(e)){const i=this._nextResultId++;return this._previousResults.set(i,new N_(e.resultId,e.data)),x_({id:i,type:"full",data:e.data})}if(ui._isSemanticTokensEdits(e)){const i=this._nextResultId++;return ui._isSemanticTokens(t)?this._previousResults.set(i,new N_(t.resultId,t.data)):this._previousResults.set(i,new N_(e.resultId)),x_({id:i,type:"delta",deltas:(e.edits||[]).map(n=>({start:n.start,deleteCount:n.deleteCount,data:n.data}))})}return null}}class u0{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeSemanticTokens(e,t,i){const n=this._documents.getDocument(e),s=await this._provider.provideDocumentRangeSemanticTokens(n,F.to(t),i);return s?this._send(s):null}_send(e){return x_({id:0,type:"full",data:e.data})}}class Ms{static supportsResolving(e){return typeof e.resolveCompletionItem=="function"}constructor(e,t,i,n,s){this._documents=e,this._commands=t,this._provider=i,this._apiDeprecation=n,this._extension=s,this._cache=new Wi("CompletionItem"),this._disposables=new Map}async provideCompletionItems(e,t,i,n){const s=this._documents.getDocument(e),o=We.to(t),a=s.getWordRangeAtPosition(o)||new be(o,o),c=a.with({end:o}),l=new vn,u=await this._provider.provideCompletionItems(s,o,n,Um.to(i));if(!u||n.isCancellationRequested)return;const d=Array.isArray(u)?new Ho(u):u,h=Ms.supportsResolving(this._provider)?this._cache.add(d.items):this._cache.add([]),g=new Ae;this._disposables.set(h,g);const w=[],p={x:h,b:w,a:{replace:F.from(a),insert:F.from(c)},c:d.isIncomplete||void 0,d:l.elapsed()};for(let b=0;b<d.items.length;b++){const k=d.items[b],D=this._convertCompletionItem(k,[h,b],c,a);w.push(D)}return p}async resolveCompletionItem(e,t){if(typeof this._provider.resolveCompletionItem!="function")return;const i=this._cache.get(...e);if(!i)return;const n=this._convertCompletionItem(i,e),s=await this._provider.resolveCompletionItem(i,t);if(!s)return;const o=this._convertCompletionItem(s,e);return(n.h!==o.h||n.i!==o.i)&&this._apiDeprecation.report("CompletionItem.insertText",this._extension,"extension MAY NOT change 'insertText' of a CompletionItem during resolve"),(n.n!==o.n||n.o!==o.o||!Ni(n.p,o.p))&&this._apiDeprecation.report("CompletionItem.command",this._extension,"extension MAY NOT change 'command' of a CompletionItem during resolve"),{...n,d:o.d,c:o.c,l:o.l,h:o.h,i:o.i,n:o.n,o:o.o,p:o.p}}releaseCompletionItems(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}_convertCompletionItem(e,t,i,n){var l;const s=this._disposables.get(t[0]);if(!s)throw Error("DisposableStore is missing...");const o=this._commands.toInternal(e.command,s),a={x:t,a:e.label,b:e.kind!==void 0?Sh.from(e.kind):void 0,m:e.tags&&e.tags.map(Ch.from),c:e.detail,d:typeof e.documentation>"u"?void 0:Te.fromStrict(e.documentation),e:e.sortText!==e.label?e.sortText:void 0,f:e.filterText!==e.label?e.filterText:void 0,g:e.preselect||void 0,i:e.keepWhitespace?1:0,k:(l=e.commitCharacters)==null?void 0:l.join(""),l:e.additionalTextEdits&&e.additionalTextEdits.map(St.from),n:o==null?void 0:o.$ident,o:o==null?void 0:o.id,p:o!=null&&o.$ident||o==null?void 0:o.arguments};e.textEdit?(this._apiDeprecation.report("CompletionItem.textEdit",this._extension,"Use 'CompletionItem.insertText' and 'CompletionItem.range' instead."),a.h=e.textEdit.newText):typeof e.insertText=="string"?a.h=e.insertText:e.insertText instanceof vs&&(a.h=e.insertText.value,a.i|=4);let c;return e.textEdit?c=e.textEdit.range:e.range&&(c=e.range),be.isRange(c)?a.j=F.from(c):c&&(!(i!=null&&i.isEqual(c.inserting))||!(n!=null&&n.isEqual(c.replacing)))&&(a.j={insert:F.from(c.inserting),replace:F.from(c.replacing)}),a}}class Bl{async provideInlineCompletions(e,t,i,n){}disposeCompletions(e){}handleDidShowCompletionItem(e,t,i){}handlePartialAccept(e,t,i){}}class a5 extends Bl{constructor(e,t,i,n){super(),this._extension=e,this._documents=t,this._provider=i,this._commands=n,this._references=new d0,this._isAdditionsProposedApiEnabled=Tt(this._extension,"inlineCompletionsAdditions"),this.languageTriggerKindToVSCodeTriggerKind={[od.Automatic]:el.Automatic,[od.Explicit]:el.Invoke}}get supportsHandleEvents(){return Tt(this._extension,"inlineCompletionsAdditions")&&(typeof this._provider.handleDidShowCompletionItem=="function"||typeof this._provider.handleDidPartiallyAcceptCompletionItem=="function")}async provideInlineCompletions(e,t,i,n){const s=this._documents.getDocument(e),o=We.to(t),a=await this._provider.provideInlineCompletionItems(s,o,{selectedCompletionInfo:i.selectedSuggestionInfo?{range:F.to(i.selectedSuggestionInfo.range),text:i.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[i.triggerKind]},n);if(!a||n.isCancellationRequested)return;const c=Array.isArray(a)?a:a.items,l=this._isAdditionsProposedApiEnabled?Array.isArray(a)?[]:a.commands||[]:[],u=this._isAdditionsProposedApiEnabled&&!Array.isArray(a)?a.enableForwardStability:void 0;let d;return{pid:this._references.createReferenceId({dispose(){d==null||d.dispose()},items:c}),items:c.map((g,w)=>{let p;g.command&&(d||(d=new Ae),p=this._commands.toInternal(g.command,d));const b=g.insertText;return{insertText:typeof b=="string"?b:{snippet:b.value},filterText:g.filterText,range:g.range?F.from(g.range):void 0,command:p,idx:w,completeBracketPairs:this._isAdditionsProposedApiEnabled?g.completeBracketPairs:!1}}),commands:l.map(g=>(d||(d=new Ae),this._commands.toInternal(g,d))),suppressSuggestions:!1,enableForwardStability:u}}disposeCompletions(e){const t=this._references.disposeReferenceId(e);t==null||t.dispose()}handleDidShowCompletionItem(e,t,i){var s;const n=(s=this._references.get(e))==null?void 0:s.items[t];n&&this._provider.handleDidShowCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidShowCompletionItem(n,i)}handlePartialAccept(e,t,i){var s;const n=(s=this._references.get(e))==null?void 0:s.items[t];n&&this._provider.handleDidPartiallyAcceptCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidPartiallyAcceptCompletionItem(n,i)}}class F_{async provideInlineEdits(e,t,i){const n=this._documents.getDocument(e),s=await this._provider.provideInlineEdit(n,{triggerKind:this.languageTriggerKindToVSCodeTriggerKind[t.triggerKind]},i);if(!s||i.isCancellationRequested)return;let o;const a=this._references.createReferenceId({dispose(){o==null||o.dispose()},item:s});let c;s.accepted&&(o||(o=new Ae),c=this._commands.toInternal(s.accepted,o));let l;return s.rejected&&(o||(o=new Ae),l=this._commands.toInternal(s.rejected,o)),{pid:a,text:s.text,range:F.from(s.range),accepted:c,rejected:l}}disposeEdit(e){const t=this._references.disposeReferenceId(e);t==null||t.dispose()}constructor(e,t,i,n){this._documents=t,this._provider=i,this._commands=n,this._references=new d0,this.languageTriggerKindToVSCodeTriggerKind={[ad.Automatic]:ul.Automatic,[ad.Invoke]:ul.Invoke}}}class d0{constructor(){this._references=new Map,this._idPool=1}createReferenceId(e){const t=this._idPool++;return this._references.set(t,e),t}disposeReferenceId(e){const t=this._references.get(e);return this._references.delete(e),t}get(e){return this._references.get(e)}}class M_{constructor(e,t){this._documents=e,this._provider=t,this._cache=new Wi("SignatureHelp")}async provideSignatureHelp(e,t,i,n){const s=this._documents.getDocument(e),o=We.to(t),a=this.reviveContext(i),c=await this._provider.provideSignatureHelp(s,o,n,a);if(c){const l=this._cache.add([c]);return{...fl.from(c),id:l}}}reviveContext(e){let t;if(e.activeSignatureHelp){const i=fl.to(e.activeSignatureHelp),n=this._cache.get(e.activeSignatureHelp.id,0);n?(t=n,t.activeSignature=i.activeSignature,t.activeParameter=i.activeParameter):t=i}return{...e,activeSignatureHelp:t}}releaseSignatureHelp(e){this._cache.delete(e)}}class Cf{constructor(e,t,i,n,s){this._documents=e,this._commands=t,this._provider=i,this._logService=n,this._extension=s,this._cache=new Wi("InlayHints"),this._disposables=new Map}async provideInlayHints(e,t,i){const n=this._documents.getDocument(e),s=F.to(t),o=await this._provider.provideInlayHints(n,s,i);if(!Array.isArray(o)||o.length===0){this._logService.trace(`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`);return}if(i.isCancellationRequested)return;const a=this._cache.add(o);this._disposables.set(a,new Ae);const c={hints:[],cacheId:a};for(let l=0;l<o.length;l++)this._isValidInlayHint(o[l],s)&&c.hints.push(this._convertInlayHint(o[l],[a,l]));return this._logService.trace(`[InlayHints] ${c.hints.length} inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`),c}async resolveInlayHint(e,t){if(typeof this._provider.resolveInlayHint!="function")return;const i=this._cache.get(...e);if(!i)return;const n=await this._provider.resolveInlayHint(i,t);if(n&&this._isValidInlayHint(n))return this._convertInlayHint(n,e)}releaseHints(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}_isValidInlayHint(e,t){return e.label.length===0||Array.isArray(e.label)&&e.label.every(i=>i.value.length===0)?(console.log("INVALID inlay hint, empty label",e),!1):!(t&&!t.contains(e.position))}_convertInlayHint(e,t){const i=this._disposables.get(t[0]);if(!i)throw Error("DisposableStore is missing...");const n={label:"",cacheId:t,tooltip:Te.fromStrict(e.tooltip),position:We.from(e.position),textEdits:e.textEdits&&e.textEdits.map(St.from),kind:e.kind&&Dh.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label=="string")n.label=e.label;else{const s=[];n.label=s;for(const o of e.label){if(!o.value){console.warn("INVALID inlay hint, empty label part",this._extension.identifier.value);continue}const a={label:o.value,tooltip:Te.fromStrict(o.tooltip)};vi.isLocation(o.location)&&(a.location=_i.from(o.location)),o.command&&(a.command=this._commands.toInternal(o.command,i)),s.push(a)}}return n}}class Ar{constructor(e,t){this._documents=e,this._provider=t,this._cache=new Wi("DocumentLink")}async provideLinks(e,t){const i=this._documents.getDocument(e),n=await this._provider.provideDocumentLinks(i,t);if(!(!Array.isArray(n)||n.length===0)&&!t.isCancellationRequested){if(typeof this._provider.resolveDocumentLink!="function")return{links:n.filter(Ar._validateLink).map(Ps.from)};{const s=this._cache.add(n),o={links:[],cacheId:s};for(let a=0;a<n.length;a++){if(!Ar._validateLink(n[a]))continue;const c=Ps.from(n[a]);c.cacheId=[s,a],o.links.push(c)}return o}}}static _validateLink(e){return e.target&&e.target.path.length>5e4?(console.warn("DROPPING link because it is too long"),!1):!0}async resolveLink(e,t){if(typeof this._provider.resolveDocumentLink!="function")return;const i=this._cache.get(...e);if(!i)return;const n=await this._provider.resolveDocumentLink(i,t);if(!(!n||!Ar._validateLink(n)))return Ps.from(n)}releaseLinks(e){this._cache.delete(e)}}class H_{constructor(e,t){this._documents=e,this._provider=t}async provideColors(e,t){const i=this._documents.getDocument(e),n=await this._provider.provideDocumentColors(i,t);return Array.isArray(n)?n.map(o=>({color:ra.from(o.color),range:F.from(o.range)})):[]}async provideColorPresentations(e,t,i){const n=this._documents.getDocument(e),s=F.to(t.range),o=ra.to(t.color),a=await this._provider.provideColorPresentations(o,{document:n,range:s},i);if(Array.isArray(a))return a.map(Ih.from)}}class h0{constructor(e,t){this._documents=e,this._provider=t}async provideFoldingRanges(e,t,i){const n=this._documents.getDocument(e),s=await this._provider.provideFoldingRanges(n,t,i);if(Array.isArray(s))return s.map(Th.from)}}class f0{constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideSelectionRanges(e,t,i){const n=this._documents.getDocument(e),s=t.map(We.to),o=await this._provider.provideSelectionRanges(n,s,i);if(!cc(o))return[];if(o.length!==s.length)return this._logService.warn("BAD selection ranges, provider must return ranges for each position"),[];const a=[];for(let c=0;c<s.length;c++){const l=[];a.push(l);let u=s[c],d=o[c];for(;;){if(!d.range.contains(u))throw new Error("INVALID selection range, must contain the previous range");if(l.push(zm.from(d)),!d.parent)break;u=d.range,d=d.parent}}return a}}class Wl{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new Jv(""),this._cache=new Map}async prepareSession(e,t,i){const n=this._documents.getDocument(e),s=We.to(t),o=await this._provider.prepareCallHierarchy(n,s,i);if(!o)return;const a=this._idPool.nextId();return this._cache.set(a,new Map),Array.isArray(o)?o.map(c=>this._cacheAndConvertItem(a,c)):[this._cacheAndConvertItem(a,o)]}async provideCallsTo(e,t,i){const n=this._itemFromCache(e,t);if(!n)throw new Error("missing call hierarchy item");const s=await this._provider.provideCallHierarchyIncomingCalls(n,i);if(s)return s.map(o=>({from:this._cacheAndConvertItem(e,o.from),fromRanges:o.fromRanges.map(a=>F.from(a))}))}async provideCallsFrom(e,t,i){const n=this._itemFromCache(e,t);if(!n)throw new Error("missing call hierarchy item");const s=await this._provider.provideCallHierarchyOutgoingCalls(n,i);if(s)return s.map(o=>({to:this._cacheAndConvertItem(e,o.to),fromRanges:o.fromRanges.map(a=>F.from(a))}))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const i=this._cache.get(e),n=Is.from(t,e,i.size.toString(36));return i.set(n._itemId,t),n}_itemFromCache(e,t){const i=this._cache.get(e);return i==null?void 0:i.get(t)}}class Vl{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new Jv(""),this._cache=new Map}async prepareSession(e,t,i){const n=this._documents.getDocument(e),s=We.to(t),o=await this._provider.prepareTypeHierarchy(n,s,i);if(!o)return;const a=this._idPool.nextId();return this._cache.set(a,new Map),Array.isArray(o)?o.map(c=>this._cacheAndConvertItem(a,c)):[this._cacheAndConvertItem(a,o)]}async provideSupertypes(e,t,i){const n=this._itemFromCache(e,t);if(!n)throw new Error("missing type hierarchy item");const s=await this._provider.provideTypeHierarchySupertypes(n,i);if(s)return s.map(o=>this._cacheAndConvertItem(e,o))}async provideSubtypes(e,t,i){const n=this._itemFromCache(e,t);if(!n)throw new Error("missing type hierarchy item");const s=await this._provider.provideTypeHierarchySubtypes(n,i);if(s)return s.map(o=>this._cacheAndConvertItem(e,o))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const i=this._cache.get(e),n=Ts.from(t,e,i.size.toString(36));return i.set(n._itemId,t),n}_itemFromCache(e,t){const i=this._cache.get(e);return i==null?void 0:i.get(t)}}class zl{static toInternalProviderId(e,t){return e+"."+t}constructor(e,t,i,n,s){this._proxy=e,this._documents=t,this._provider=i,this._handle=n,this._extension=s}async provideDocumentOnDropEdits(e,t,i,n,s){var u;const o=this._documents.getDocument(t),a=We.to(i),c=Er.toDataTransfer(n,async d=>(await this._proxy.$resolveDocumentOnDropFileData(this._handle,e,d)).buffer),l=await this._provider.provideDocumentDropEdits(o,a,c,s);if(l)return{label:l.label??m("vs/workbench/api/common/extHostLanguageFeatures","defaultDropLabel","Drop using '{0}' extension",this._extension.displayName||this._extension.name),yieldTo:(u=l.yieldTo)==null?void 0:u.map(d=>"mimeType"in d?d:{providerId:zl.toInternalProviderId(d.extensionId,d.providerId)}),insertText:typeof l.insertText=="string"?l.insertText:{snippet:l.insertText.value},additionalEdit:l.additionalEdit?ei.from(l.additionalEdit,void 0):void 0}}}class p0{constructor(e,t){this._documents=e,this._provider=t}async provideMappedEdits(e,t,i,n){var u,d;const s=y.revive(e),o=this._documents.getDocument(s),a=i.documents.map(h=>h.map(g=>({uri:y.revive(g.uri),version:g.version,ranges:g.ranges.map(w=>F.to(w))}))),c={documents:a,selections:((d=(u=a[0])==null?void 0:u[0])==null?void 0:d.ranges)??[]},l=await this._provider.provideMappedEdits(o,t,c,n);return l?ei.from(l):null}}class jl{constructor(e,t){this.adapter=e,this.extension=t}}const yt=class yt{constructor(e,t,i,n,s,o,a,c){this._uriTransformer=t,this._documents=i,this._commands=n,this._diagnostics=s,this._logService=o,this._apiDeprecation=a,this._extensionTelemetry=c,this._adapter=new Map,this._proxy=e.getProxy(G.MainThreadLanguageFeatures)}_transformDocumentSelector(e,t){return ea.from(e,this._uriTransformer,t)}_createDisposable(e){return new Pe(()=>{this._adapter.delete(e),this._proxy.$unregister(e)})}_nextHandle(){return yt._handlePool++}async _withAdapter(e,t,i,n,s,o=!1){const a=this._adapter.get(e);if(!a||!(a.adapter instanceof t))return n;const c=Date.now();o||this._logService.trace(`[${a.extension.identifier.value}] INVOKE provider '${i.toString().replace(/[\r\n]/g,"")}'`);const l=i(a.adapter,a.extension);return Promise.resolve(l).catch(u=>{qr(u)||(this._logService.error(`[${a.extension.identifier.value}] provider FAILED`),this._logService.error(u),this._extensionTelemetry.onExtensionError(a.extension.identifier,u))}).finally(()=>{o||this._logService.trace(`[${a.extension.identifier.value}] provider DONE after ${Date.now()-c}ms`)}),It.isCancellationToken(s)?qE(l,s):l}_addNewAdapter(e,t){const i=this._nextHandle();return this._adapter.set(i,new jl(e,t)),i}static _extLabel(e){return e.displayName||e.name}registerDocumentSymbolProvider(e,t,i,n){const s=this._addNewAdapter(new _f(this._documents,i),e),o=n&&n.label||yt._extLabel(e);return this._proxy.$registerDocumentSymbolProvider(s,this._transformDocumentSelector(t,e),o),this._createDisposable(s)}$provideDocumentSymbols(e,t,i){return this._withAdapter(e,_f,n=>n.provideDocumentSymbols(y.revive(t),i),void 0,i)}registerCodeLensProvider(e,t,i){const n=this._nextHandle(),s=typeof i.onDidChangeCodeLenses=="function"?this._nextHandle():void 0;this._adapter.set(n,new jl(new wf(this._documents,this._commands.converter,i,e,this._extensionTelemetry,this._logService),e)),this._proxy.$registerCodeLensSupport(n,this._transformDocumentSelector(t,e),s);let o=this._createDisposable(n);if(s!==void 0){const a=i.onDidChangeCodeLenses(c=>this._proxy.$emitCodeLensEvent(s));o=Pe.from(o,a)}return o}$provideCodeLenses(e,t,i){return this._withAdapter(e,wf,n=>n.provideCodeLenses(y.revive(t),i),void 0,i)}$resolveCodeLens(e,t,i){return this._withAdapter(e,wf,n=>n.resolveCodeLens(t,i),void 0,void 0)}$releaseCodeLenses(e,t){this._withAdapter(e,wf,i=>Promise.resolve(i.releaseCodeLenses(t)),void 0,void 0)}registerDefinitionProvider(e,t,i){const n=this._addNewAdapter(new XC(this._documents,i),e);return this._proxy.$registerDefinitionSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideDefinition(e,t,i,n){return this._withAdapter(e,XC,s=>s.provideDefinition(y.revive(t),i,n),[],n)}registerDeclarationProvider(e,t,i){const n=this._addNewAdapter(new YC(this._documents,i),e);return this._proxy.$registerDeclarationSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideDeclaration(e,t,i,n){return this._withAdapter(e,YC,s=>s.provideDeclaration(y.revive(t),i,n),[],n)}registerImplementationProvider(e,t,i){const n=this._addNewAdapter(new ZC(this._documents,i),e);return this._proxy.$registerImplementationSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideImplementation(e,t,i,n){return this._withAdapter(e,ZC,s=>s.provideImplementation(y.revive(t),i,n),[],n)}registerTypeDefinitionProvider(e,t,i){const n=this._addNewAdapter(new e0(this._documents,i),e);return this._proxy.$registerTypeDefinitionSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideTypeDefinition(e,t,i,n){return this._withAdapter(e,e0,s=>s.provideTypeDefinition(y.revive(t),i,n),[],n)}registerHoverProvider(e,t,i,n){const s=this._addNewAdapter(new t0(this._documents,i),e);return this._proxy.$registerHoverProvider(s,this._transformDocumentSelector(t,e)),this._createDisposable(s)}$provideHover(e,t,i,n){return this._withAdapter(e,t0,s=>s.provideHover(y.revive(t),i,n),void 0,n)}registerEvaluatableExpressionProvider(e,t,i,n){const s=this._addNewAdapter(new i0(this._documents,i),e);return this._proxy.$registerEvaluatableExpressionProvider(s,this._transformDocumentSelector(t,e)),this._createDisposable(s)}$provideEvaluatableExpression(e,t,i,n){return this._withAdapter(e,i0,s=>s.provideEvaluatableExpression(y.revive(t),i,n),void 0,n)}registerInlineValuesProvider(e,t,i,n){const s=typeof i.onDidChangeInlineValues=="function"?this._nextHandle():void 0,o=this._addNewAdapter(new n0(this._documents,i),e);this._proxy.$registerInlineValuesProvider(o,this._transformDocumentSelector(t,e),s);let a=this._createDisposable(o);if(s!==void 0){const c=i.onDidChangeInlineValues(l=>this._proxy.$emitInlineValuesEvent(s));a=Pe.from(a,c)}return a}$provideInlineValues(e,t,i,n,s){return this._withAdapter(e,n0,o=>o.provideInlineValues(y.revive(t),i,n,s),void 0,s)}registerDocumentHighlightProvider(e,t,i){const n=this._addNewAdapter(new r0(this._documents,i),e);return this._proxy.$registerDocumentHighlightProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}registerMultiDocumentHighlightProvider(e,t,i){const n=this._addNewAdapter(new s0(this._documents,i),e);return this._proxy.$registerMultiDocumentHighlightProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideDocumentHighlights(e,t,i,n){return this._withAdapter(e,r0,s=>s.provideDocumentHighlights(y.revive(t),i,n),void 0,n)}$provideMultiDocumentHighlights(e,t,i,n,s){return this._withAdapter(e,s0,o=>o.provideMultiDocumentHighlights(y.revive(t),i,n.map(a=>y.revive(a)),s),void 0,s)}registerLinkedEditingRangeProvider(e,t,i){const n=this._addNewAdapter(new o0(this._documents,i),e);return this._proxy.$registerLinkedEditingRangeProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideLinkedEditingRanges(e,t,i,n){return this._withAdapter(e,o0,async s=>{const o=await s.provideLinkedEditingRanges(y.revive(t),i,n);if(o)return{ranges:o.ranges,wordPattern:o.wordPattern?yt._serializeRegExp(o.wordPattern):void 0}},void 0,n)}registerReferenceProvider(e,t,i){const n=this._addNewAdapter(new a0(this._documents,i),e);return this._proxy.$registerReferenceSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideReferences(e,t,i,n,s){return this._withAdapter(e,a0,o=>o.provideReferences(y.revive(t),i,n,s),void 0,s)}registerCodeActionProvider(e,t,i,n){var a,c;const s=new Ae,o=this._addNewAdapter(new Sa(this._documents,this._commands.converter,this._diagnostics,i,this._logService,e,this._apiDeprecation),e);return this._proxy.$registerQuickFixSupport(o,this._transformDocumentSelector(t,e),{providedKinds:(a=n==null?void 0:n.providedCodeActionKinds)==null?void 0:a.map(l=>l.value),documentation:(c=n==null?void 0:n.documentation)==null?void 0:c.map(l=>({kind:l.kind.value,command:this._commands.converter.toInternal(l.command,s)}))},yt._extLabel(e),!!i.resolveCodeAction),s.add(this._createDisposable(o)),s}$provideCodeActions(e,t,i,n,s){return this._withAdapter(e,Sa,o=>o.provideCodeActions(y.revive(t),i,n,s),void 0,s)}$resolveCodeAction(e,t,i){return this._withAdapter(e,Sa,n=>n.resolveCodeAction(t,i),{},void 0)}$releaseCodeActions(e,t){this._withAdapter(e,Sa,i=>Promise.resolve(i.releaseCodeActions(t)),void 0,void 0)}registerDocumentFormattingEditProvider(e,t,i){const n=this._addNewAdapter(new c0(this._documents,i),e);return this._proxy.$registerDocumentFormattingSupport(n,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name),this._createDisposable(n)}$provideDocumentFormattingEdits(e,t,i,n){return this._withAdapter(e,c0,s=>s.provideDocumentFormattingEdits(y.revive(t),i,n),void 0,n)}registerDocumentRangeFormattingEditProvider(e,t,i){const n=typeof i.provideDocumentRangesFormattingEdits=="function",s=this._addNewAdapter(new $_(this._documents,i),e);return this._proxy.$registerRangeFormattingSupport(s,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name,n),this._createDisposable(s)}$provideDocumentRangeFormattingEdits(e,t,i,n,s){return this._withAdapter(e,$_,o=>o.provideDocumentRangeFormattingEdits(y.revive(t),i,n,s),void 0,s)}$provideDocumentRangesFormattingEdits(e,t,i,n,s){return this._withAdapter(e,$_,o=>o.provideDocumentRangesFormattingEdits(y.revive(t),i,n,s),void 0,s)}registerOnTypeFormattingEditProvider(e,t,i,n){const s=this._addNewAdapter(new l0(this._documents,i),e);return this._proxy.$registerOnTypeFormattingSupport(s,this._transformDocumentSelector(t,e),n,e.identifier),this._createDisposable(s)}$provideOnTypeFormattingEdits(e,t,i,n,s,o){return this._withAdapter(e,l0,a=>a.provideOnTypeFormattingEdits(y.revive(t),i,n,s,o),void 0,o)}registerWorkspaceSymbolProvider(e,t){const i=this._addNewAdapter(new yf(t,this._logService),e);return this._proxy.$registerNavigateTypeSupport(i,typeof t.resolveWorkspaceSymbol=="function"),this._createDisposable(i)}$provideWorkspaceSymbols(e,t,i){return this._withAdapter(e,yf,n=>n.provideWorkspaceSymbols(t,i),{symbols:[]},i)}$resolveWorkspaceSymbol(e,t,i){return this._withAdapter(e,yf,n=>n.resolveWorkspaceSymbol(t,i),void 0,void 0)}$releaseWorkspaceSymbols(e,t){this._withAdapter(e,yf,i=>i.releaseWorkspaceSymbols(t),void 0,void 0)}registerRenameProvider(e,t,i){const n=this._addNewAdapter(new Fs(this._documents,i,this._logService),e);return this._proxy.$registerRenameSupport(n,this._transformDocumentSelector(t,e),Fs.supportsResolving(i)),this._createDisposable(n)}$provideRenameEdits(e,t,i,n,s){return this._withAdapter(e,Fs,o=>o.provideRenameEdits(y.revive(t),i,n,s),void 0,s)}$resolveRenameLocation(e,t,i,n){return this._withAdapter(e,Fs,s=>s.resolveRenameLocation(y.revive(t),i,n),void 0,n)}registerNewSymbolNamesProvider(e,t,i){const n=this._addNewAdapter(new xf(this._documents,i,this._logService),e);return this._proxy.$registerNewSymbolNamesProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideNewSymbolNames(e,t,i,n){return this._withAdapter(e,xf,s=>s.provideNewSymbolNames(y.revive(t),i,n),void 0,n)}registerDocumentSemanticTokensProvider(e,t,i,n){const s=this._addNewAdapter(new ui(this._documents,i),e),o=typeof i.onDidChangeSemanticTokens=="function"?this._nextHandle():void 0;this._proxy.$registerDocumentSemanticTokensProvider(s,this._transformDocumentSelector(t,e),n,o);let a=this._createDisposable(s);if(o){const c=i.onDidChangeSemanticTokens(l=>this._proxy.$emitDocumentSemanticTokensEvent(o));a=Pe.from(a,c)}return a}$provideDocumentSemanticTokens(e,t,i,n){return this._withAdapter(e,ui,s=>s.provideDocumentSemanticTokens(y.revive(t),i,n),null,n)}$releaseDocumentSemanticTokens(e,t){this._withAdapter(e,ui,i=>i.releaseDocumentSemanticColoring(t),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(e,t,i,n){const s=this._addNewAdapter(new u0(this._documents,i),e);return this._proxy.$registerDocumentRangeSemanticTokensProvider(s,this._transformDocumentSelector(t,e),n),this._createDisposable(s)}$provideDocumentRangeSemanticTokens(e,t,i,n){return this._withAdapter(e,u0,s=>s.provideDocumentRangeSemanticTokens(y.revive(t),i,n),null,n)}registerCompletionItemProvider(e,t,i,n){const s=this._addNewAdapter(new Ms(this._documents,this._commands.converter,i,this._apiDeprecation,e),e);return this._proxy.$registerCompletionsProvider(s,this._transformDocumentSelector(t,e),n,Ms.supportsResolving(i),e.identifier),this._createDisposable(s)}$provideCompletionItems(e,t,i,n,s){return this._withAdapter(e,Ms,o=>o.provideCompletionItems(y.revive(t),i,n,s),void 0,s)}$resolveCompletionItem(e,t,i){return this._withAdapter(e,Ms,n=>n.resolveCompletionItem(t,i),void 0,i)}$releaseCompletionItems(e,t){this._withAdapter(e,Ms,i=>i.releaseCompletionItems(t),void 0,void 0)}registerInlineCompletionsProvider(e,t,i,n){var a;const s=new a5(e,this._documents,i,this._commands.converter),o=this._addNewAdapter(s,e);return this._proxy.$registerInlineCompletionsSupport(o,this._transformDocumentSelector(t,e),s.supportsHandleEvents,Xe.toKey(e.identifier.value),((a=n==null?void 0:n.yieldTo)==null?void 0:a.map(c=>Xe.toKey(c)))||[]),this._createDisposable(o)}$provideInlineCompletions(e,t,i,n,s){return this._withAdapter(e,Bl,o=>o.provideInlineCompletions(y.revive(t),i,n,s),void 0,s)}$handleInlineCompletionDidShow(e,t,i,n){this._withAdapter(e,Bl,async s=>{s.handleDidShowCompletionItem(t,i,n)},void 0,void 0)}$handleInlineCompletionPartialAccept(e,t,i,n){this._withAdapter(e,Bl,async s=>{s.handlePartialAccept(t,i,n)},void 0,void 0)}$freeInlineCompletionsList(e,t){this._withAdapter(e,Bl,async i=>{i.disposeCompletions(t)},void 0,void 0)}registerInlineEditProvider(e,t,i){const n=new F_(e,this._documents,i,this._commands.converter),s=this._addNewAdapter(n,e);return this._proxy.$registerInlineEditProvider(s,this._transformDocumentSelector(t,e),e.identifier),this._createDisposable(s)}$provideInlineEdit(e,t,i,n){return this._withAdapter(e,F_,s=>s.provideInlineEdits(y.revive(t),i,n),void 0,n)}$freeInlineEdit(e,t){this._withAdapter(e,F_,async i=>{i.disposeEdit(t)},void 0,void 0)}registerSignatureHelpProvider(e,t,i,n){const s=Array.isArray(n)?{triggerCharacters:n,retriggerCharacters:[]}:n,o=this._addNewAdapter(new M_(this._documents,i),e);return this._proxy.$registerSignatureHelpProvider(o,this._transformDocumentSelector(t,e),s),this._createDisposable(o)}$provideSignatureHelp(e,t,i,n,s){return this._withAdapter(e,M_,o=>o.provideSignatureHelp(y.revive(t),i,n,s),void 0,s)}$releaseSignatureHelp(e,t){this._withAdapter(e,M_,i=>i.releaseSignatureHelp(t),void 0,void 0)}registerInlayHintsProvider(e,t,i){const n=typeof i.onDidChangeInlayHints=="function"?this._nextHandle():void 0,s=this._addNewAdapter(new Cf(this._documents,this._commands.converter,i,this._logService,e),e);this._proxy.$registerInlayHintsProvider(s,this._transformDocumentSelector(t,e),typeof i.resolveInlayHint=="function",n,yt._extLabel(e));let o=this._createDisposable(s);if(n!==void 0){const a=i.onDidChangeInlayHints(c=>this._proxy.$emitInlayHintsEvent(n));o=Pe.from(o,a)}return o}$provideInlayHints(e,t,i,n){return this._withAdapter(e,Cf,s=>s.provideInlayHints(y.revive(t),i,n),void 0,n)}$resolveInlayHint(e,t,i){return this._withAdapter(e,Cf,n=>n.resolveInlayHint(t,i),void 0,i)}$releaseInlayHints(e,t){this._withAdapter(e,Cf,i=>i.releaseHints(t),void 0,void 0)}registerDocumentLinkProvider(e,t,i){const n=this._addNewAdapter(new Ar(this._documents,i),e);return this._proxy.$registerDocumentLinkProvider(n,this._transformDocumentSelector(t,e),typeof i.resolveDocumentLink=="function"),this._createDisposable(n)}$provideDocumentLinks(e,t,i){return this._withAdapter(e,Ar,n=>n.provideLinks(y.revive(t),i),void 0,i,t.scheme==="output")}$resolveDocumentLink(e,t,i){return this._withAdapter(e,Ar,n=>n.resolveLink(t,i),void 0,void 0,!0)}$releaseDocumentLinks(e,t){this._withAdapter(e,Ar,i=>i.releaseLinks(t),void 0,void 0,!0)}registerColorProvider(e,t,i){const n=this._addNewAdapter(new H_(this._documents,i),e);return this._proxy.$registerDocumentColorProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideDocumentColors(e,t,i){return this._withAdapter(e,H_,n=>n.provideColors(y.revive(t),i),[],i)}$provideColorPresentations(e,t,i,n){return this._withAdapter(e,H_,s=>s.provideColorPresentations(y.revive(t),i,n),void 0,n)}registerFoldingRangeProvider(e,t,i){const n=this._nextHandle(),s=typeof i.onDidChangeFoldingRanges=="function"?this._nextHandle():void 0;this._adapter.set(n,new jl(new h0(this._documents,i),e)),this._proxy.$registerFoldingRangeProvider(n,this._transformDocumentSelector(t,e),e.identifier,s);let o=this._createDisposable(n);if(s!==void 0){const a=i.onDidChangeFoldingRanges(()=>this._proxy.$emitFoldingRangeEvent(s));o=Pe.from(o,a)}return o}$provideFoldingRanges(e,t,i,n){return this._withAdapter(e,h0,s=>s.provideFoldingRanges(y.revive(t),i,n),void 0,n)}registerSelectionRangeProvider(e,t,i){const n=this._addNewAdapter(new f0(this._documents,i,this._logService),e);return this._proxy.$registerSelectionRangeProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideSelectionRanges(e,t,i,n){return this._withAdapter(e,f0,s=>s.provideSelectionRanges(y.revive(t),i,n),[],n)}registerCallHierarchyProvider(e,t,i){const n=this._addNewAdapter(new Wl(this._documents,i),e);return this._proxy.$registerCallHierarchyProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$prepareCallHierarchy(e,t,i,n){return this._withAdapter(e,Wl,s=>Promise.resolve(s.prepareSession(y.revive(t),i,n)),void 0,n)}$provideCallHierarchyIncomingCalls(e,t,i,n){return this._withAdapter(e,Wl,s=>s.provideCallsTo(t,i,n),void 0,n)}$provideCallHierarchyOutgoingCalls(e,t,i,n){return this._withAdapter(e,Wl,s=>s.provideCallsFrom(t,i,n),void 0,n)}$releaseCallHierarchy(e,t){this._withAdapter(e,Wl,i=>Promise.resolve(i.releaseSession(t)),void 0,void 0)}registerTypeHierarchyProvider(e,t,i){const n=this._addNewAdapter(new Vl(this._documents,i),e);return this._proxy.$registerTypeHierarchyProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$prepareTypeHierarchy(e,t,i,n){return this._withAdapter(e,Vl,s=>Promise.resolve(s.prepareSession(y.revive(t),i,n)),void 0,n)}$provideTypeHierarchySupertypes(e,t,i,n){return this._withAdapter(e,Vl,s=>s.provideSupertypes(t,i,n),void 0,n)}$provideTypeHierarchySubtypes(e,t,i,n){return this._withAdapter(e,Vl,s=>s.provideSubtypes(t,i,n),void 0,n)}$releaseTypeHierarchy(e,t){this._withAdapter(e,Vl,i=>Promise.resolve(i.releaseSession(t)),void 0,void 0)}registerDocumentOnDropEditProvider(e,t,i,n){const s=this._nextHandle();this._adapter.set(s,new jl(new zl(this._proxy,this._documents,i,s,e),e));const o=Tt(e,"dropMetadata")&&n?zl.toInternalProviderId(e.identifier.value,n.id):void 0;return this._proxy.$registerDocumentOnDropEditProvider(s,this._transformDocumentSelector(t,e),o,Tt(e,"dropMetadata")?n:void 0),this._createDisposable(s)}$provideDocumentOnDropEdits(e,t,i,n,s,o){return this._withAdapter(e,zl,a=>Promise.resolve(a.provideDocumentOnDropEdits(t,y.revive(i),n,s,o)),void 0,void 0)}registerMappedEditsProvider(e,t,i){const n=this._addNewAdapter(new p0(this._documents,i),e);return this._proxy.$registerMappedEditsProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideMappedEdits(e,t,i,n,s){return this._withAdapter(e,p0,o=>Promise.resolve(o.provideMappedEdits(t,i,n,s)),null,s)}registerDocumentPasteEditProvider(e,t,i,n){const s=this._nextHandle();this._adapter.set(s,new jl(new Ea(this._proxy,this._documents,i,s,e),e));const o=Ea.toInternalProviderId(e.identifier.value,n.id);return this._proxy.$registerPasteEditProvider(s,this._transformDocumentSelector(t,e),o,{supportsCopy:!!i.prepareDocumentPaste,supportsPaste:!!i.provideDocumentPasteEdits,copyMimeTypes:n.copyMimeTypes,pasteMimeTypes:n.pasteMimeTypes}),this._createDisposable(s)}$prepareDocumentPaste(e,t,i,n,s){return this._withAdapter(e,Ea,o=>o.prepareDocumentPaste(y.revive(t),i,n,s),void 0,s)}$providePasteEdits(e,t,i,n,s,o){return this._withAdapter(e,Ea,a=>a.providePasteEdits(t,y.revive(i),n,s,o),void 0,o)}static _serializeRegExp(e){return{pattern:e.source,flags:e.flags}}static _serializeIndentationRule(e){return{decreaseIndentPattern:yt._serializeRegExp(e.decreaseIndentPattern),increaseIndentPattern:yt._serializeRegExp(e.increaseIndentPattern),indentNextLinePattern:e.indentNextLinePattern?yt._serializeRegExp(e.indentNextLinePattern):void 0,unIndentedLinePattern:e.unIndentedLinePattern?yt._serializeRegExp(e.unIndentedLinePattern):void 0}}static _serializeOnEnterRule(e){return{beforeText:yt._serializeRegExp(e.beforeText),afterText:e.afterText?yt._serializeRegExp(e.afterText):void 0,previousLineText:e.previousLineText?yt._serializeRegExp(e.previousLineText):void 0,action:e.action}}static _serializeOnEnterRules(e){return e.map(yt._serializeOnEnterRule)}static _serializeAutoClosingPair(e){return{open:e.open,close:e.close,notIn:e.notIn?e.notIn.map(t=>Wo.toString(t)):void 0}}static _serializeAutoClosingPairs(e){return e.map(yt._serializeAutoClosingPair)}setLanguageConfiguration(e,t,i){const{wordPattern:n}=i;if(n&&Ub(n))throw new Error(`Invalid language configuration: wordPattern '${n}' is not allowed to match the empty string.`);n?this._documents.setWordDefinitionFor(t,n):this._documents.setWordDefinitionFor(t,void 0),i.__electricCharacterSupport&&this._apiDeprecation.report("LanguageConfiguration.__electricCharacterSupport",e,"Do not use."),i.__characterPairSupport&&this._apiDeprecation.report("LanguageConfiguration.__characterPairSupport",e,"Do not use.");const s=this._nextHandle(),o={comments:i.comments,brackets:i.brackets,wordPattern:i.wordPattern?yt._serializeRegExp(i.wordPattern):void 0,indentationRules:i.indentationRules?yt._serializeIndentationRule(i.indentationRules):void 0,onEnterRules:i.onEnterRules?yt._serializeOnEnterRules(i.onEnterRules):void 0,__electricCharacterSupport:i.__electricCharacterSupport,__characterPairSupport:i.__characterPairSupport,autoClosingPairs:i.autoClosingPairs?yt._serializeAutoClosingPairs(i.autoClosingPairs):void 0};return this._proxy.$setLanguageConfiguration(s,t,o),this._createDisposable(s)}$setWordDefinitions(e){for(const t of e)this._documents.setWordDefinitionFor(t.languageId,new RegExp(t.regexSource,t.regexFlags))}};yt._handlePool=0;let U_=yt;class c5{constructor(e,t,i,n){this._documents=t,this._commands=i,this._uriTransformer=n,this._languageIds=[],this._handlePool=0,this._ids=new Set,this._proxy=e.getProxy(G.MainThreadLanguages)}$acceptLanguageIds(e){this._languageIds=e}async getLanguages(){return this._languageIds.slice(0)}async changeLanguage(e,t){await this._proxy.$changeLanguage(e,t);const i=this._documents.getDocumentData(e);if(!i)throw new Error(`document '${e.toString()}' NOT found`);return i.document}async tokenAtPosition(e,t){const i=e.version,n=We.from(t),s=await this._proxy.$tokensAtPosition(e.uri,n),o={type:wr.Other,range:e.getWordRangeAtPosition(t)??new be(t.line,t.character,t.line,t.character)};if(!s)return o;const a={range:F.to(s.range),type:Am.to(s.type)};return!a.range.contains(t)||i!==e.version?o:a}createLanguageStatusItem(e,t,i){const n=this._handlePool++,s=this._proxy,o=this._ids,a=`${e.identifier.value}/${t}`;if(o.has(a))throw new Error(`LanguageStatusItem with id '${t}' ALREADY exists`);o.add(a);const c={selector:i,id:t,name:e.displayName??e.name,severity:Fo.Information,command:void 0,text:"",detail:"",busy:!1};let l;const u=new Ae,d=()=>{if(l==null||l.dispose(),!o.has(a)){console.warn(`LanguageStatusItem (${t}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}l=QE(()=>{u.clear(),this._proxy.$setLanguageStatus(n,{id:a,name:c.name??e.displayName??e.name,source:e.displayName??e.name,selector:ea.from(c.selector,this._uriTransformer),label:c.text,detail:c.detail??"",severity:c.severity===Fo.Error?tt.Error:c.severity===Fo.Warning?tt.Warning:tt.Info,command:c.command&&this._commands.toInternal(c.command,u),accessibilityInfo:c.accessibilityInformation,busy:c.busy})},0)},h={dispose(){u.dispose(),l==null||l.dispose(),s.$removeLanguageStatus(n),o.delete(a)},get id(){return c.id},get name(){return c.name},set name(g){c.name=g,d()},get selector(){return c.selector},set selector(g){c.selector=g,d()},get text(){return c.text},set text(g){c.text=g,d()},set text2(g){M(e,"languageStatusText"),c.text=g,d()},get text2(){return M(e,"languageStatusText"),c.text},get detail(){return c.detail},set detail(g){c.detail=g,d()},get severity(){return c.severity},set severity(g){c.severity=g,d()},get accessibilityInformation(){return c.accessibilityInformation},set accessibilityInformation(g){c.accessibilityInformation=g,d()},get command(){return c.command},set command(g){c.command=g,d()},get busy(){return c.busy},set busy(g){c.busy=g,d()}};return d(),h}}function l5(r){return r&&r.title}let B_=class{constructor(e,t){this._logService=t,this._proxy=e.getProxy(G.MainThreadMessageService)}showMessage(e,t,i,n,s){const o={source:{identifier:e.identifier,label:e.displayName||e.name}};let a;typeof n=="string"||l5(n)?a=[n,...s]:(o.modal=n==null?void 0:n.modal,o.useCustom=n==null?void 0:n.useCustom,o.detail=n==null?void 0:n.detail,a=s),o.useCustom&&M(e,"resolvers");const c=[];let l=!1;for(let u=0;u<a.length;u++){const d=a[u];if(typeof d=="string")c.push({title:d,handle:u,isCloseAffordance:!1});else if(typeof d=="object"){const{title:h,isCloseAffordance:g}=d;c.push({title:h,isCloseAffordance:!!g,handle:u}),g&&(l?this._logService.warn(`[${e.identifier}] Only one message item can have 'isCloseAffordance':`,d):l=!0)}else this._logService.warn(`[${e.identifier}] Invalid message item:`,d)}return this._proxy.$showMessage(t,i,o,c).then(u=>{if(typeof u=="number")return a[u]})}};B_=H([N(1,Ge)],B_);class W_{constructor(e,t,i,n){this.start=e,this.deletedCount=t,this.deletedItems=i,this.items=n}asApiEvent(){return{range:new In(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}}class V_{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:!1,versionId:1}}constructor(e,t,i){this.notebook=e,this._extHostDocument=t,this._cellData=i,this.handle=i.handle,this.uri=y.revive(i.uri),this.cellKind=i.cellKind,this._outputs=i.outputs.map(Cr.to),this._internalMetadata=i.internalMetadata??{},this._metadata=Object.freeze(i.metadata??{}),this._previousResult=Object.freeze(aa.to(i.internalMetadata??{}))}get internalMetadata(){return this._internalMetadata}get apiCell(){if(!this._apiCell){const e=this,t=this._extHostDocument.getDocument(this.uri);if(!t)throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);const i={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:gl.to(this._cellData.cellKind),document:t.document,get mime(){return e._mime},set mime(n){e._mime=n},get outputs(){return e._outputs.slice(0)},get metadata(){return e._metadata},get executionSummary(){return e._previousResult}};this._apiCell=Object.freeze(i)}return this._apiCell}setOutputs(e){this._outputs=e.map(Cr.to)}setOutputItems(e,t,i){const n=i.map(ca.to),s=this._outputs.find(o=>o.id===e);if(s&&(t||(s.items.length=0),s.items.push(...n),s.items.length>1&&s.items.every(o=>j1(o.mime)))){const o=new Map,a=[];s.items.forEach(c=>{let l;o.has(c.mime)?l=o.get(c.mime):(l=[],o.set(c.mime,l),a.push(c.mime)),l.push(c.data)}),s.items.length=0,a.forEach(c=>{const l=kD(o.get(c));s.items.push({mime:c,data:l.data.buffer})})}}setMetadata(e){this._metadata=Object.freeze(e)}setInternalMetadata(e){this._internalMetadata=e,this._previousResult=Object.freeze(aa.to(e))}setMime(e){}}const Yf=class Yf{constructor(e,t,i,n,s){this._proxy=e,this._textDocumentsAndEditors=t,this._textDocuments=i,this.uri=n,this.handle=Yf._handlePool++,this._cells=[],this._versionId=0,this._isDirty=!1,this._disposed=!1,this._notebookType=s.viewType,this._metadata=Object.freeze(s.metadata??Object.create(null)),this._spliceNotebookCells([[0,0,s.cells]],!0,void 0),this._versionId=s.versionId}dispose(){this._disposed=!0}get versionId(){return this._versionId}get apiNotebook(){if(!this._notebook){const e=this,t={get uri(){return e.uri},get version(){return e._versionId},get notebookType(){return e._notebookType},get isDirty(){return e._isDirty},get isUntitled(){return e.uri.scheme===Z.untitled},get isClosed(){return e._disposed},get metadata(){return e._metadata},get cellCount(){return e._cells.length},cellAt(i){return i=e._validateIndex(i),e._cells[i].apiCell},getCells(i){return(i?e._getCells(i):e._cells).map(s=>s.apiCell)},save(){return e._save()}};this._notebook=Object.freeze(t)}return this._notebook}acceptDocumentPropertiesChanged(e){e.metadata&&(this._metadata=Object.freeze({...this._metadata,...e.metadata}))}acceptDirty(e){this._isDirty=e}acceptModelChanged(e,t,i){this._versionId=e.versionId,this._isDirty=t,this.acceptDocumentPropertiesChanged({metadata:i});const n={notebook:this.apiNotebook,metadata:i,cellChanges:[],contentChanges:[]},s=[];for(const a of e.rawEvents)a.kind===Fi.ModelChange?this._spliceNotebookCells(a.changes,!1,n.contentChanges):a.kind===Fi.Move?this._moveCells(a.index,a.length,a.newIdx,n.contentChanges):a.kind===Fi.Output?(this._setCellOutputs(a.index,a.outputs),s.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===Fi.OutputItem?(this._setCellOutputItems(a.index,a.outputId,a.append,a.outputItems),s.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===Fi.ChangeCellLanguage?(this._changeCellLanguage(a.index,a.language),s.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document})):a.kind===Fi.ChangeCellContent?s.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document}):a.kind===Fi.ChangeCellMime?this._changeCellMime(a.index,a.mime):a.kind===Fi.ChangeCellMetadata?(this._changeCellMetadata(a.index,a.metadata),s.push({cell:this._cells[a.index].apiCell,metadata:this._cells[a.index].apiCell.metadata})):a.kind===Fi.ChangeCellInternalMetadata&&(this._changeCellInternalMetadata(a.index,a.internalMetadata),s.push({cell:this._cells[a.index].apiCell,executionSummary:this._cells[a.index].apiCell.executionSummary}));const o=new Map;for(let a=0;a<s.length;a++){const c=s[a],l=o.get(c.cell);if(l===void 0){const u=n.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...c});o.set(c.cell,u-1)}else n.cellChanges[l]={...n.cellChanges[l],...c}}return n}_validateIndex(e){return e=e|0,e<0?0:e>=this._cells.length?this._cells.length-1:e}_validateRange(e){let t=e.start|0,i=e.end|0;return t<0&&(t=0),i>this._cells.length&&(i=this._cells.length),e.with({start:t,end:i})}_getCells(e){e=this._validateRange(e);const t=[];for(let i=e.start;i<e.end;i++)t.push(this._cells[i]);return t}async _save(){return this._disposed?Promise.reject(new Error("Notebook has been closed")):this._proxy.$trySaveNotebook(this.uri)}_spliceNotebookCells(e,t,i){if(this._disposed)return;const n=[],s=[],o=[];if(e.reverse().forEach(a=>{const l=a[2].map(h=>{const g=new V_(this,this._textDocumentsAndEditors,h);return t||s.push(V_.asModelAddData(h)),g}),u=new W_(a[0],a[1],[],l),d=this._cells.splice(a[0],a[1],...l);for(const h of d)o.push(h.uri),u.deletedItems.push(h.apiCell);n.push(u)}),this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:s,removedDocuments:o}),i)for(const a of n)i.push(a.asApiEvent())}_moveCells(e,t,i,n){const s=this._cells.splice(e,t);this._cells.splice(i,0,...s);const o=[new W_(e,t,s.map(a=>a.apiCell),[]),new W_(i,0,[],s)];for(const a of o)n.push(a.asApiEvent())}_setCellOutputs(e,t){this._cells[e].setOutputs(t)}_setCellOutputItems(e,t,i,n){this._cells[e].setOutputItems(t,i,n)}_changeCellLanguage(e,t){const i=this._cells[e];i.apiCell.document.languageId!==t&&this._textDocuments.$acceptModelLanguageChanged(i.uri,t)}_changeCellMime(e,t){const i=this._cells[e];i.apiCell.mime=t}_changeCellMetadata(e,t){this._cells[e].setMetadata(t)}_changeCellInternalMetadata(e,t){this._cells[e].setInternalMetadata(t)}getCellFromApiCell(e){return this._cells.find(t=>t.apiCell===e)}getCellFromIndex(e){return this._cells[e]}getCell(e){return this._cells.find(t=>t.handle===e)}getCellIndex(e){return this._cells.indexOf(e)}};Yf._handlePool=0;let z_=Yf;const Zf=class Zf{constructor(e,t,i,n,s,o){this.id=e,this._proxy=t,this.notebookData=i,this._selections=[],this._visibleRanges=[],this._visible=!1,this._selections=s,this._visibleRanges=n,this._viewColumn=o}get apiEditor(){if(!this._editor){const e=this;this._editor={get notebook(){return e.notebookData.apiNotebook},get selection(){return e._selections[0]},set selection(t){this.selections=[t]},get selections(){return e._selections},set selections(t){if(!Array.isArray(t)||!t.every(In.isNotebookRange))throw xe("selections");e._selections=t,e._trySetSelections(t)},get visibleRanges(){return e._visibleRanges},revealRange(t,i){e._proxy.$tryRevealRange(e.id,sn.from(t),i??oh.Default)},get viewColumn(){return e._viewColumn}},Zf.apiEditorsToExtHost.set(this._editor,this)}return this._editor}get visible(){return this._visible}_acceptVisibility(e){this._visible=e}_acceptVisibleRanges(e){this._visibleRanges=e}_acceptSelections(e){this._selections=e}_trySetSelections(e){this._proxy.$trySetSelections(this.id,e.map(sn.from))}_acceptViewColumn(e){this._viewColumn=e}};Zf.apiEditorsToExtHost=new WeakMap;let ql=Zf;class j_{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==se)return q_(this.right);let e=this;for(;e.parent!==se&&e.parent.left!==e;)e=e.parent;return e.parent===se?se:e.parent}prev(){if(this.left!==se)return g0(this.left);let e=this;for(;e.parent!==se&&e.parent.right!==e;)e=e.parent;return e.parent===se?se:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const se=new j_(null,0);se.parent=se,se.left=se,se.right=se,se.color=0;function q_(r){for(;r.left!==se;)r=r.left;return r}function g0(r){for(;r.right!==se;)r=r.right;return r}function G_(r){return r===se?0:r.size_left+r.piece.length+G_(r.right)}function Q_(r){return r===se?0:r.lf_left+r.piece.lineFeedCnt+Q_(r.right)}function J_(){se.parent=se}function Gl(r,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==se&&(t.left.parent=e),t.parent=e.parent,e.parent===se?r.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function Ql(r,e){const t=e.left;e.left=t.right,t.right!==se&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===se?r.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function Sf(r,e){let t,i;if(e.left===se?(i=e,t=i.right):e.right===se?(i=e,t=i.left):(i=q_(e.right),t=i.right),i===r.root){r.root=t,t.color=0,e.detach(),J_(),r.root.parent=se;return}const n=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,Jl(r,t)):(i.parent===e?t.parent=i:t.parent=i.parent,Jl(r,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===r.root?r.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==se&&(i.left.parent=i),i.right!==se&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,Jl(r,i)),e.detach(),t.parent.left===t){const o=G_(t),a=Q_(t);if(o!==t.parent.size_left||a!==t.parent.lf_left){const c=o-t.parent.size_left,l=a-t.parent.lf_left;t.parent.size_left=o,t.parent.lf_left=a,Fn(r,t.parent,c,l)}}if(Jl(r,t.parent),n){J_();return}let s;for(;t!==r.root&&t.color===0;)t===t.parent.left?(s=t.parent.right,s.color===1&&(s.color=0,t.parent.color=1,Gl(r,t.parent),s=t.parent.right),s.left.color===0&&s.right.color===0?(s.color=1,t=t.parent):(s.right.color===0&&(s.left.color=0,s.color=1,Ql(r,s),s=t.parent.right),s.color=t.parent.color,t.parent.color=0,s.right.color=0,Gl(r,t.parent),t=r.root)):(s=t.parent.left,s.color===1&&(s.color=0,t.parent.color=1,Ql(r,t.parent),s=t.parent.left),s.left.color===0&&s.right.color===0?(s.color=1,t=t.parent):(s.left.color===0&&(s.right.color=0,s.color=1,Gl(r,s),s=t.parent.left),s.color=t.parent.color,t.parent.color=0,s.left.color=0,Ql(r,t.parent),t=r.root));t.color=0,J_()}function m0(r,e){for(Jl(r,e);e!==r.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,Gl(r,e)),e.parent.color=0,e.parent.parent.color=1,Ql(r,e.parent.parent))}else{const t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,Ql(r,e)),e.parent.color=0,e.parent.parent.color=1,Gl(r,e.parent.parent))}r.root.color=0}function Fn(r,e,t,i){for(;e!==r.root&&e!==se;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function Jl(r,e){let t=0,i=0;if(e!==r.root){for(;e!==r.root&&e===e.parent.right;)e=e.parent;if(e!==r.root)for(e=e.parent,t=G_(e.left)-e.size_left,i=Q_(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==r.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}const Mn=65535;function v0(r){let e;return r[r.length-1]<65536?e=new Uint16Array(r.length):e=new Uint32Array(r.length),e.set(r,0),e}class u5{constructor(e,t,i,n,s){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=n,this.isBasicASCII=s}}function Hn(r,e=!0){const t=[0];let i=1;for(let n=0,s=r.length;n<s;n++){const o=r.charCodeAt(n);o===13?n+1<s&&r.charCodeAt(n+1)===10?(t[i++]=n+2,n++):t[i++]=n+1:o===10&&(t[i++]=n+1)}return e?v0(t):t}function d5(r,e){r.length=0,r[0]=0;let t=1,i=0,n=0,s=0,o=!0;for(let c=0,l=e.length;c<l;c++){const u=e.charCodeAt(c);u===13?c+1<l&&e.charCodeAt(c+1)===10?(s++,r[t++]=c+2,c++):(i++,r[t++]=c+1):u===10?(n++,r[t++]=c+1):o&&u!==9&&(u<32||u>126)&&(o=!1)}const a=new u5(v0(r),i,n,s,o);return r.length=0,a}class ni{constructor(e,t,i,n,s){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=n,this.length=s}}class Hs{constructor(e,t){this.buffer=e,this.lineStarts=t}}class h5{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==se&&e.iterate(e.root,i=>(i!==se&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class f5{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let n=0;n<i.length;n++){const s=i[n];if(s.node.parent===null||s.nodeStartOffset>=e){i[n]=null,t=!0;continue}}if(t){const n=[];for(const s of i)s!==null&&n.push(s);this._cache=n}}}class p5{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new Hs("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=se,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let n=null;for(let s=0,o=e.length;s<o;s++)if(e[s].buffer.length>0){e[s].lineStarts||(e[s].lineStarts=Hn(e[s].buffer));const a=new ni(s+1,{line:0,column:0},{line:e[s].lineStarts.length-1,column:e[s].buffer.length-e[s].lineStarts[e[s].lineStarts.length-1]},e[s].lineStarts.length-1,e[s].buffer.length);this._buffers.push(e[s]),n=this.rbInsertRight(n,a)}this._searchCache=new f5(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=Mn,i=t-Math.floor(t/3),n=i*2;let s="",o=0;const a=[];if(this.iterate(this.root,c=>{const l=this.getNodeContent(c),u=l.length;if(o<=i||o+u<n)return s+=l,o+=u,!0;const d=s.replace(/\r\n|\r|\n/g,e);return a.push(new Hs(d,Hn(d))),s=l,o=u,!0}),o>0){const c=s.replace(/\r\n|\r|\n/g,e);a.push(new Hs(c,Hn(c)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new h5(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,n=>{if(n===se)return!0;const s=this.getNodeContent(n),o=s.length,a=e.nodeAt(t),c=e.nodeAt(t+o),l=e.getValueInRange2(a,c);return t+=o,s===l})}getOffsetAt(e,t){let i=0,n=this.root;for(;n!==se;)if(n.left!==se&&n.lf_left+1>=e)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt+1>=e){i+=n.size_left;const s=this.getAccumulatedValue(n,e-n.lf_left-2);return i+=s+t-1}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const n=e;for(;t!==se;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const s=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+s.index,s.index===0){const o=this.getOffsetAt(i+1,1),a=n-o;return new ki(i+1,a+1)}return new ki(i+1,s.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===se){const s=this.getOffsetAt(i+1,1),o=n-e-s;return new ki(i+1,o+1)}else t=t.right;return new ki(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),n=this.nodeAt2(e.endLineNumber,e.endColumn),s=this.getValueInRange2(i,n);return t?t!==this._EOL||!this._EOLNormalized?s.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?s:s.replace(/\r\n|\r|\n/g,t):s}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,c=this._buffers[a.piece.bufferIndex].buffer,l=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return c.substring(l+e.remainder,l+t.remainder)}let i=e.node;const n=this._buffers[i.piece.bufferIndex].buffer,s=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let o=n.substring(s+e.remainder,s+i.piece.length);for(i=i.next();i!==se;){const a=this._buffers[i.piece.bufferIndex].buffer,c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){o+=a.substring(c,c+t.remainder);break}else o+=a.substr(c,i.piece.length);i=i.next()}return o}getLinesContent(){const e=[];let t=0,i="",n=!1;return this.iterate(this.root,s=>{if(s===se)return!0;const o=s.piece;let a=o.length;if(a===0)return!0;const c=this._buffers[o.bufferIndex].buffer,l=this._buffers[o.bufferIndex].lineStarts,u=o.start.line,d=o.end.line;let h=l[u]+o.start.column;if(n&&(c.charCodeAt(h)===10&&(h++,a--),e[t++]=i,i="",n=!1,a===0))return!0;if(u===d)return!this._EOLNormalized&&c.charCodeAt(h+a-1)===13?(n=!0,i+=c.substr(h,a-1)):i+=c.substr(h,a),!0;i+=this._EOLNormalized?c.substring(h,Math.max(h,l[u+1]-this._EOLLength)):c.substring(h,l[u+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let g=u+1;g<d;g++)i=this._EOLNormalized?c.substring(l[g],l[g+1]-this._EOLLength):c.substring(l[g],l[g+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&c.charCodeAt(l[d]+o.end.column-1)===13?(n=!0,o.end.column===0?t--:i=c.substr(l[d],o.end.column-1)):i=c.substr(l[d],o.end.column),!0}),n&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(n)}else{const t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(n)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){const t=this.nodeAt(e);return this._getCharCode(t)}findMatchesInNode(e,t,i,n,s,o,a,c,l,u,d){const h=this._buffers[e.piece.bufferIndex],g=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),w=this.offsetInBuffer(e.piece.bufferIndex,s),p=this.offsetInBuffer(e.piece.bufferIndex,o);let b;const k={line:0,column:0};let D,C;t._wordSeparators?(D=h.buffer.substring(w,p),C=R=>R+w,t.reset(0)):(D=h.buffer,C=R=>R,t.reset(w));do if(b=t.next(D),b){if(C(b.index)>=p)return u;this.positionInBuffer(e,C(b.index)-g,k);const R=this.getLineFeedCnt(e.piece.bufferIndex,s,k),A=k.line===s.line?k.column-s.column+n:k.column+1,B=A+b[0].length;if(d[u++]=sC(new ze(i+R,A,i+R,B),b,c),C(b.index)+b[0].length>=p||u>=l)return u}while(b);return u}findMatchesLineByLine(e,t,i,n){const s=[];let o=0;const a=new vI(t.wordSeparators,t.regex);let c=this.nodeAt2(e.startLineNumber,e.startColumn);if(c===null)return[];const l=this.nodeAt2(e.endLineNumber,e.endColumn);if(l===null)return[];let u=this.positionInBuffer(c.node,c.remainder);const d=this.positionInBuffer(l.node,l.remainder);if(c.node===l.node)return this.findMatchesInNode(c.node,a,e.startLineNumber,e.startColumn,u,d,t,i,n,o,s),s;let h=e.startLineNumber,g=c.node;for(;g!==l.node;){const p=this.getLineFeedCnt(g.piece.bufferIndex,u,g.piece.end);if(p>=1){const k=this._buffers[g.piece.bufferIndex].lineStarts,D=this.offsetInBuffer(g.piece.bufferIndex,g.piece.start),C=k[u.line+p],R=h===e.startLineNumber?e.startColumn:1;if(o=this.findMatchesInNode(g,a,h,R,u,this.positionInBuffer(g,C-D),t,i,n,o,s),o>=n)return s;h+=p}const b=h===e.startLineNumber?e.startColumn-1:0;if(h===e.endLineNumber){const k=this.getLineContent(h).substring(b,e.endColumn-1);return o=this._findMatchesInLine(t,a,k,e.endLineNumber,b,o,s,i,n),s}if(o=this._findMatchesInLine(t,a,this.getLineContent(h).substr(b),h,b,o,s,i,n),o>=n)return s;h++,c=this.nodeAt2(h,1),g=c.node,u=this.positionInBuffer(c.node,c.remainder)}if(h===e.endLineNumber){const p=h===e.startLineNumber?e.startColumn-1:0,b=this.getLineContent(h).substring(p,e.endColumn-1);return o=this._findMatchesInLine(t,a,b,e.endLineNumber,p,o,s,i,n),s}const w=h===e.startLineNumber?e.startColumn:1;return o=this.findMatchesInNode(l.node,a,h,w,u,d,t,i,n,o,s),s}_findMatchesInLine(e,t,i,n,s,o,a,c,l){const u=e.wordSeparators;if(!c&&e.simpleSearch){const h=e.simpleSearch,g=h.length,w=i.length;let p=-g;for(;(p=i.indexOf(h,p+g))!==-1;)if((!u||oC(u,i,w,p,g))&&(a[o++]=new Lv(new ze(n,p+1+s,n,p+1+g+s),null),o>=l))return o;return o}let d;t.reset(0);do if(d=t.next(i),d&&(a[o++]=sC(new ze(n,d.index+1+s,n,d.index+1+d[0].length+s),d,c),o>=l))return o;while(d);return o}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==se){const{node:n,remainder:s,nodeStartOffset:o}=this.nodeAt(e),a=n.piece,c=a.bufferIndex,l=this.positionInBuffer(n,s);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&o+a.length===e&&t.length<Mn){this.appendToNode(n,t),this.computeBufferMetadata();return}if(o===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(o+n.piece.length>e){const u=[];let d=new ni(a.bufferIndex,l,a.end,this.getLineFeedCnt(a.bufferIndex,l,a.end),this.offsetInBuffer(c,a.end)-this.offsetInBuffer(c,l));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(n,s)===10){const p={line:d.start.line+1,column:0};d=new ni(d.bufferIndex,p,d.end,this.getLineFeedCnt(d.bufferIndex,p,d.end),d.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(n,s-1)===13){const p=this.positionInBuffer(n,s-1);this.deleteNodeTail(n,p),t="\r"+t,n.piece.length===0&&u.push(n)}else this.deleteNodeTail(n,l);else this.deleteNodeTail(n,l);const h=this.createNewPieces(t);d.length>0&&this.rbInsertRight(n,d);let g=n;for(let w=0;w<h.length;w++)g=this.rbInsertRight(g,h[w]);this.deleteNodes(u)}else this.insertContentToNodeRight(t,n)}else{const n=this.createNewPieces(t);let s=this.rbInsertLeft(null,n[0]);for(let o=1;o<n.length;o++)s=this.rbInsertRight(s,n[o])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===se)return;const i=this.nodeAt(e),n=this.nodeAt(e+t),s=i.node,o=n.node;if(s===o){const h=this.positionInBuffer(s,i.remainder),g=this.positionInBuffer(s,n.remainder);if(i.nodeStartOffset===e){if(t===s.piece.length){const w=s.next();Sf(this,s),this.validateCRLFWithPrevNode(w),this.computeBufferMetadata();return}this.deleteNodeHead(s,g),this._searchCache.validate(e),this.validateCRLFWithPrevNode(s),this.computeBufferMetadata();return}if(i.nodeStartOffset+s.piece.length===e+t){this.deleteNodeTail(s,h),this.validateCRLFWithNextNode(s),this.computeBufferMetadata();return}this.shrinkNode(s,h,g),this.computeBufferMetadata();return}const a=[],c=this.positionInBuffer(s,i.remainder);this.deleteNodeTail(s,c),this._searchCache.validate(e),s.piece.length===0&&a.push(s);const l=this.positionInBuffer(o,n.remainder);this.deleteNodeHead(o,l),o.piece.length===0&&a.push(o);const u=s.next();for(let h=u;h!==se&&h!==o;h=h.next())a.push(h);const d=s.piece.length===0?s.prev():s;this.deleteNodes(a),this.validateCRLFWithNextNode(d),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const o=t.piece,a={line:o.start.line+1,column:0},c=new ni(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),o.length-1);t.piece=c,e+=`
`,Fn(this,t,-1,-1),t.piece.length===0&&i.push(t)}const n=this.createNewPieces(e);let s=this.rbInsertLeft(t,n[n.length-1]);for(let o=n.length-2;o>=0;o--)s=this.rbInsertLeft(s,n[o]);this.validateCRLFWithPrevNode(s),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),n=this.rbInsertRight(t,i[0]);let s=n;for(let o=1;o<i.length;o++)s=this.rbInsertRight(s,i[o]);this.validateCRLFWithPrevNode(n)}positionInBuffer(e,t,i){const n=e.piece,s=e.piece.bufferIndex,o=this._buffers[s].lineStarts,c=o[n.start.line]+n.start.column+t;let l=n.start.line,u=n.end.line,d=0,h=0,g=0;for(;l<=u&&(d=l+(u-l)/2|0,g=o[d],d!==u);)if(h=o[d+1],c<g)u=d-1;else if(c>=h)l=d+1;else break;return i?(i.line=d,i.column=c-g,null):{line:d,column:c-g}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const n=this._buffers[e].lineStarts;if(i.line===n.length-1)return i.line-t.line;const s=n[i.line+1],o=n[i.line]+i.column;if(s>o+1)return i.line-t.line;const a=o-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)Sf(this,e[t])}createNewPieces(e){if(e.length>Mn){const u=[];for(;e.length>Mn;){const h=e.charCodeAt(Mn-1);let g;h===13||h>=55296&&h<=56319?(g=e.substring(0,Mn-1),e=e.substring(Mn-1)):(g=e.substring(0,Mn),e=e.substring(Mn));const w=Hn(g);u.push(new ni(this._buffers.length,{line:0,column:0},{line:w.length-1,column:g.length-w[w.length-1]},w.length-1,g.length)),this._buffers.push(new Hs(g,w))}const d=Hn(e);return u.push(new ni(this._buffers.length,{line:0,column:0},{line:d.length-1,column:e.length-d[d.length-1]},d.length-1,e.length)),this._buffers.push(new Hs(e,d)),u}let t=this._buffers[0].buffer.length;const i=Hn(e,!1);let n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let u=0;u<i.length;u++)i[u]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let u=0;u<i.length;u++)i[u]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const s=this._buffers[0].buffer.length,o=this._buffers[0].lineStarts.length-1,a=s-this._buffers[0].lineStarts[o],c={line:o,column:a},l=new ni(0,n,c,this.getLineFeedCnt(0,n,c),s-t);return this._lastChangeBufferPos=c,[l]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let i=this.root,n="";const s=this._searchCache.get2(e);if(s){i=s.node;const o=this.getAccumulatedValue(i,e-s.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(s.nodeStartLineNumber+i.piece.lineFeedCnt===e)n=a.substring(c+o,c+i.piece.length);else{const l=this.getAccumulatedValue(i,e-s.nodeStartLineNumber);return a.substring(c+o,c+l-t)}}else{let o=0;const a=e;for(;i!==se;)if(i.left!==se&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const c=this.getAccumulatedValue(i,e-i.lf_left-2),l=this.getAccumulatedValue(i,e-i.lf_left-1),u=this._buffers[i.piece.bufferIndex].buffer,d=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return o+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:o,nodeStartLineNumber:a-(e-1-i.lf_left)}),u.substring(d+c,d+l-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const c=this.getAccumulatedValue(i,e-i.lf_left-2),l=this._buffers[i.piece.bufferIndex].buffer,u=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=l.substring(u+c,u+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,o+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==se;){const o=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(i,0),c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=o.substring(c,c+a-t),n}else{const a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=o.substr(a,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==se;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,n=this.positionInBuffer(e,t),s=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const o=this.getLineFeedCnt(e.piece.bufferIndex,i.start,n);if(o!==s)return{index:o,remainder:0}}return{index:s,remainder:n.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,n=this._buffers[i.bufferIndex].lineStarts,s=i.start.line+t+1;return s>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[s]-n[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,n=i.lineFeedCnt,s=this.offsetInBuffer(i.bufferIndex,i.end),o=t,a=this.offsetInBuffer(i.bufferIndex,o),c=this.getLineFeedCnt(i.bufferIndex,i.start,o),l=c-n,u=a-s,d=i.length+u;e.piece=new ni(i.bufferIndex,i.start,o,c,d),Fn(this,e,u,l)}deleteNodeHead(e,t){const i=e.piece,n=i.lineFeedCnt,s=this.offsetInBuffer(i.bufferIndex,i.start),o=t,a=this.getLineFeedCnt(i.bufferIndex,o,i.end),c=this.offsetInBuffer(i.bufferIndex,o),l=a-n,u=s-c,d=i.length+u;e.piece=new ni(i.bufferIndex,o,i.end,a,d),Fn(this,e,u,l)}shrinkNode(e,t,i){const n=e.piece,s=n.start,o=n.end,a=n.length,c=n.lineFeedCnt,l=t,u=this.getLineFeedCnt(n.bufferIndex,n.start,l),d=this.offsetInBuffer(n.bufferIndex,t)-this.offsetInBuffer(n.bufferIndex,s);e.piece=new ni(n.bufferIndex,n.start,l,u,d),Fn(this,e,d-a,u-c);const h=new ni(n.bufferIndex,i,o,this.getLineFeedCnt(n.bufferIndex,i,o),this.offsetInBuffer(n.bufferIndex,o)-this.offsetInBuffer(n.bufferIndex,i)),g=this.rbInsertRight(e,h);this.validateCRLFWithPrevNode(g)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const s=Hn(t,!1);for(let g=0;g<s.length;g++)s[g]+=n;if(i){const g=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-g}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(s.slice(1));const o=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o],c={line:o,column:a},l=e.piece.length+t.length,u=e.piece.lineFeedCnt,d=this.getLineFeedCnt(0,e.piece.start,c),h=d-u;e.piece=new ni(e.piece.bufferIndex,e.piece.start,c,d,l),this._lastChangeBufferPos=c,Fn(this,e,t.length,h)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let n=0;for(;t!==se;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){n+=t.size_left;const s={node:t,remainder:e-t.size_left,nodeStartOffset:n};return this._searchCache.set(s),s}else e-=t.size_left+t.piece.length,n+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,n=0;for(;i!==se;)if(i.left!==se&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const s=this.getAccumulatedValue(i,e-i.lf_left-2),o=this.getAccumulatedValue(i,e-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(s+t-1,o),nodeStartOffset:n}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const s=this.getAccumulatedValue(i,e-i.lf_left-2);if(s+t-1<=i.piece.length)return{node:i,remainder:s+t-1,nodeStartOffset:n};t-=i.piece.length-s;break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==se;){if(i.piece.lineFeedCnt>0){const s=this.getAccumulatedValue(i,0),o=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,s),nodeStartOffset:o}}else if(i.piece.length>=t-1){const s=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:s}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(n)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===se||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,n=t.start.line,s=i[n]+t.start.column;return n===i.length-1||i[n+1]>s+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(s)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===se||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],n=this._buffers[e.piece.bufferIndex].lineStarts;let s;e.piece.end.column===0?s={line:e.piece.end.line-1,column:n[e.piece.end.line]-n[e.piece.end.line-1]-1}:s={line:e.piece.end.line,column:e.piece.end.column-1};const o=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new ni(e.piece.bufferIndex,e.piece.start,s,a,o),Fn(this,e,-1,-1),e.piece.length===0&&i.push(e);const c={line:t.piece.start.line+1,column:0},l=t.piece.length-1,u=this.getLineFeedCnt(t.piece.bufferIndex,c,t.piece.end);t.piece=new ni(t.piece.bufferIndex,c,t.piece.end,u,l),Fn(this,t,-1,-1),t.piece.length===0&&i.push(t);const d=this.createNewPieces(`\r
`);this.rbInsertRight(e,d[0]);for(let h=0;h<i.length;h++)Sf(this,i[h])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)Sf(this,i);else{const n=i.piece,s={line:n.start.line+1,column:0},o=n.length-1,a=this.getLineFeedCnt(n.bufferIndex,s,n.end);i.piece=new ni(n.bufferIndex,s,n.end,a,o),Fn(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===se)return t(se);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===se)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,n=this.offsetInBuffer(i.bufferIndex,i.start),s=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(n,s)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),n=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,n)}rbInsertRight(e,t){const i=new j_(t,1);if(i.left=se,i.right=se,i.parent=se,i.size_left=0,i.lf_left=0,this.root===se)this.root=i,i.color=0;else if(e.right===se)e.right=i,i.parent=e;else{const s=q_(e.right);s.left=i,i.parent=s}return m0(this,i),i}rbInsertLeft(e,t){const i=new j_(t,1);if(i.left=se,i.right=se,i.parent=se,i.size_left=0,i.lf_left=0,this.root===se)this.root=i,i.color=0;else if(e.left===se)e.left=i,i.parent=e;else{const n=g0(e.left);n.right=i,i.parent=n}return m0(this,i),i}getContentOfSubTree(e){let t="";return this.iterate(e,i=>(t+=this.getNodeContent(i),!0)),t}}function K_(r){let e=0,t=0,i=0,n=0;for(let s=0,o=r.length;s<o;s++){const a=r.charCodeAt(s);a===13?(e===0&&(t=s),e++,s+1<o&&r.charCodeAt(s+1)===10?(n|=2,s++):n|=3,i=s+1):a===10&&(n|=1,e===0&&(t=s),e++,i=s+1)}return e===0&&(t=r.length),[e,t,r.length-i,n]}let X_;function g5(){return X_||(X_=new TextDecoder("UTF-16LE")),X_}function m5(r,e,t){const i=new Uint16Array(r.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?v5(r,e,t):g5().decode(i)}function v5(r,e,t){const i=[];let n=0;for(let s=0;s<t;s++){const o=hS(r,e);e+=2,i[n++]=String.fromCharCode(o)}return i.join("")}function Ef(r){return r.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class Vi{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,i,n){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=n}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${Ef(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${Ef(this.oldText)}")`:`(replace@${this.oldPosition} "${Ef(this.oldText)}" with "${Ef(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const n=t.length;Au(e,n,i),i+=4;for(let s=0;s<n;s++)fS(e,t.charCodeAt(s),i),i+=2;return i}static _readString(e,t){const i=Tu(e,t);return t+=4,m5(e,t,i)}writeSize(){return 8+Vi._writeStringSize(this.oldText)+Vi._writeStringSize(this.newText)}write(e,t){return Au(e,this.oldPosition,t),t+=4,Au(e,this.newPosition,t),t+=4,t=Vi._writeString(e,this.oldText,t),t=Vi._writeString(e,this.newText,t),t}static read(e,t,i){const n=Tu(e,t);t+=4;const s=Tu(e,t);t+=4;const o=Vi._readString(e,t);t+=Vi._writeStringSize(o);const a=Vi._readString(e,t);return t+=Vi._writeStringSize(a),i.push(new Vi(n,o,s,a)),t}}class ka extends Be{constructor(e,t,i,n,s,o,a){super(),this._onDidChangeContent=this._register(new T),this.onDidChangeContent=this._onDidChangeContent.event,this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=s,this._pieceTree=new p5(e,i,a)}equals(e){return!(e instanceof ka)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,n=this.getPositionAt(e),s=this.getPositionAt(i);return new ze(n.lineNumber,n.column,s.lineNumber,s.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),n=this.getOffsetAt(e.endLineNumber,e.endColumn);let s=0;const o=this._getEndOfLine(t),a=this.getEOL();if(o.length!==a.length){const c=o.length-a.length,l=e.endLineNumber-e.startLineNumber;s=c*l}return n-i+s}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const n=e.startLineNumber,s=e.endLineNumber;for(let o=n;o<=s;o++){const a=this.getLineContent(o),c=o===n?e.startColumn-1:0,l=o===s?e.endColumn-1:a.length;for(let u=c;u<l;u++)Bp(a.charCodeAt(u))?(i=i+1,u=u+1):i=i+1}return i+=this._getEndOfLine(t).length*(s-n),i}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){const t=Mp(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=dE(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let n=this._mightContainRTL,s=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,a=!0,c=[];for(let p=0;p<e.length;p++){const b=e[p];a&&b._isTracked&&(a=!1);const k=b.range;if(b.text){let B=!0;o||(B=!wE(b.text),o=B),!n&&B&&(n=Qb(b.text)),!s&&B&&(s=Jb(b.text))}let D="",C=0,R=0,A=0;if(b.text){let B;[C,R,A,B]=K_(b.text);const Q=this.getEOL();B===0||B===(Q===`\r
`?2:1)?D=b.text:D=b.text.replace(/\r\n|\r|\n/g,Q)}c[p]={sortIndex:p,identifier:b.identifier||null,range:k,rangeOffset:this.getOffsetAt(k.startLineNumber,k.startColumn),rangeLength:this.getValueLengthInRange(k),text:D,eolCount:C,firstLineLength:R,lastLineLength:A,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}c.sort(ka._sortOpsAscending);let l=!1;for(let p=0,b=c.length-1;p<b;p++){const k=c[p].range.getEndPosition(),D=c[p+1].range.getStartPosition();if(D.isBeforeOrEqual(k)){if(D.isBefore(k))throw new Error("Overlapping ranges are not allowed!");l=!0}}a&&(c=this._reduceOperations(c));const u=i||t?ka._getInverseEditRanges(c):[],d=[];if(t)for(let p=0;p<c.length;p++){const b=c[p],k=u[p];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let D=k.startLineNumber;D<=k.endLineNumber;D++){let C="";D===k.startLineNumber&&(C=this.getLineContent(b.range.startLineNumber),Mp(C)!==-1)||d.push({lineNumber:D,oldContent:C})}}let h=null;if(i){let p=0;h=[];for(let b=0;b<c.length;b++){const k=c[b],D=u[b],C=this.getValueInRange(k.range),R=k.rangeOffset+p;p+=k.text.length-C.length,h[b]={sortIndex:k.sortIndex,identifier:k.identifier,range:D,text:C,textChange:new Vi(k.rangeOffset,C,R,k.text)}}l||h.sort((b,k)=>b.sortIndex-k.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=s,this._mightContainNonBasicASCII=o;const g=this._doApplyEdits(c);let w=null;if(t&&d.length>0){d.sort((p,b)=>b.lineNumber-p.lineNumber),w=[];for(let p=0,b=d.length;p<b;p++){const k=d[p].lineNumber;if(p>0&&d[p-1].lineNumber===k)continue;const D=d[p].oldContent,C=this.getLineContent(k);C.length===0||C===D||Mp(C)!==-1||w.push(k)}}return this._onDidChangeContent.fire(),new pI(h,g,w)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,n=e[e.length-1].range,s=new ze(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn);let o=i.startLineNumber,a=i.startColumn;const c=[];for(let g=0,w=e.length;g<w;g++){const p=e[g],b=p.range;t=t||p.forceMoveMarkers,c.push(this.getValueInRange(new ze(o,a,b.startLineNumber,b.startColumn))),p.text.length>0&&c.push(p.text),o=b.endLineNumber,a=b.endColumn}const l=c.join(""),[u,d,h]=K_(l);return{sortIndex:0,identifier:e[0].identifier,range:s,rangeOffset:this.getOffsetAt(s.startLineNumber,s.startColumn),rangeLength:this.getValueLengthInRange(s,0),text:l,eolCount:u,firstLineLength:d,lastLineLength:h,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(ka._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const n=e[i],s=n.range.startLineNumber,o=n.range.startColumn,a=n.range.endLineNumber,c=n.range.endColumn;if(s===a&&o===c&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);const l=new ze(s,o,a,c);t.push({range:l,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,n){return this._pieceTree.findMatchesLineByLine(e,t,i,n)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){const i=e.startLineNumber,n=e.startColumn,[s,o,a]=K_(t);let c;if(t.length>0){const l=s+1;l===1?c=new ze(i,n,i,n+o):c=new ze(i,n,i+l-1,a+1)}else c=new ze(i,n,i,n);return c}static _getInverseEditRanges(e){const t=[];let i=0,n=0,s=null;for(let o=0,a=e.length;o<a;o++){const c=e[o];let l,u;s?s.range.endLineNumber===c.range.startLineNumber?(l=i,u=n+(c.range.startColumn-s.range.endColumn)):(l=i+(c.range.startLineNumber-s.range.endLineNumber),u=c.range.startColumn):(l=c.range.startLineNumber,u=c.range.startColumn);let d;if(c.text.length>0){const h=c.eolCount+1;h===1?d=new ze(l,u,l,u+c.firstLineLength):d=new ze(l,u,l+h-1,c.lastLineLength+1)}else d=new ze(l,u,l,u);i=d.endLineNumber,n=d.endColumn,t.push(d),s=c}return t}static _sortOpsAscending(e,t){const i=ze.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=ze.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class _5{constructor(e,t,i,n,s,o,a,c,l){this._chunks=e,this._bom=t,this._cr=i,this._lf=n,this._crlf=s,this._containsRTL=o,this._containsUnusualLineTerminators=a,this._isBasicASCII=c,this._normalizeEOL=l}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let s=0,o=i.length;s<o;s++){const a=i[s].buffer.replace(/\r\n|\r|\n/g,t),c=Hn(a);i[s]=new Hs(a,c)}const n=new ka(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}}class _0{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&xE(e)&&(this.BOM=yE,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=d5(this._tmpLineStarts,e);this.chunks.push(new Hs(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=Qb(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=Jb(e)))}finish(e=!0){return this._finish(),new _5(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=Hn(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}}class w5 extends Be{constructor(e,t,i){super(),this._source=e,this._inputTextBuffer=t,this._outputs=i,this._outputTextBuffers=void 0}_getFullModelRange(e){const t=e.getLineCount();return new ze(1,1,t,this._getLineMaxColumn(e,t))}_getLineMaxColumn(e,t){if(t<1||t>e.getLineCount())throw new Error("Illegal value for lineNumber");return e.getLineLength(t)+1}get inputTextBuffer(){if(!this._inputTextBuffer){const e=new _0;e.acceptChunk(this._source);const t=e.finish(!0),{textBuffer:i,disposable:n}=t.create(1);this._inputTextBuffer=i,this._register(n)}return this._inputTextBuffer}get outputTextBuffers(){return this._outputTextBuffers||(this._outputTextBuffers=this._outputs.map(e=>{const t=new _0;t.acceptChunk(e);const i=t.finish(!0),{textBuffer:n,disposable:s}=i.create(1);return this._register(s),n})),this._outputTextBuffers}findInInputs(e){const i=new nC(e,!1,!1,null).parseSearchRequest();if(!i)return[];const n=this._getFullModelRange(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(n,i,!0,5e3)}findInOutputs(e){const i=new nC(e,!1,!1,null).parseSearchRequest();return i?this.outputTextBuffers.map(n=>{const s=n.findMatchesLineByLine(this._getFullModelRange(n),i,!0,5e3);if(s.length!==0)return{textBuffer:n,matches:s}}).filter(n=>!!n):[]}}function w0(r,e){let t=-1;const i=[];let n=[];return r.forEach(o=>{o.range.startLineNumber!==t&&n.length>0&&(i.push([...n]),n=[]),n.push(o),t=o.range.endLineNumber}),n.length>0&&i.push([...n]),i.map(o=>{const a=[],c=o[0].range.startLineNumber,l=o[o.length-1].range.endLineNumber;for(let u=c;u<=l;u++)a.push(e.getLineContent(u));return new g4(a.join(`
`)+`
`,o.map(u=>new ze(u.range.startLineNumber-1,u.range.startColumn-1,u.range.endLineNumber-1,u.range.endColumn-1)))})}Object.freeze({id:"application",order:100,title:m("vs/workbench/common/configuration","applicationConfigurationTitle","Application"),type:"object"});const b5=Object.freeze({id:"workbench",order:7,title:m("vs/workbench/common/configuration","workbenchConfigurationTitle","Workbench"),type:"object"}),y5=Object.freeze({id:"security",scope:1,title:m("vs/workbench/common/configuration","securityConfigurationTitle","Security"),type:"object",order:7});Object.freeze({id:"problems",title:m("vs/workbench/common/configuration","problemsConfigurationTitle","Problems"),type:"object",order:101});const x5={ConfigurationMigration:"base.contributions.configuration.migration"};class C5{constructor(){this.migrations=[],this._onDidRegisterConfigurationMigrations=new T,this.onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event}registerConfigurationMigrations(e){this.migrations.push(...e)}}const kf=new C5;mi.add(x5.ConfigurationMigration,kf);let b0=(fu=class extends Be{constructor(e,t){super(),this.configurationService=e,this.workspaceService=t,this._register(this.workspaceService.onDidChangeWorkspaceFolders(async i=>{for(const n of i.added)await this.migrateConfigurationsForFolder(n,kf.migrations)})),this.migrateConfigurations(kf.migrations),this._register(kf.onDidRegisterConfigurationMigration(i=>this.migrateConfigurations(i)))}async migrateConfigurations(e){await this.migrateConfigurationsForFolder(void 0,e);for(const t of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(t,e)}async migrateConfigurationsForFolder(e,t){await Promise.all([t.map(i=>this.migrateConfigurationsForFolderAndOverride(i,e==null?void 0:e.uri))])}async migrateConfigurationsForFolderAndOverride(e,t){const i=this.configurationService.inspect(e.key,{resource:t}),n=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(const[s,o]of n){const a=i[s];if(!a)continue;const c=[];if(a.value!==void 0){const l=await this.runMigration(e,s,a.value,t,void 0);for(const u of l??[])c.push([u,[]])}for(const{identifiers:l,value:u}of a.overrides??[])if(u!==void 0){const d=await this.runMigration(e,s,u,t,l);for(const h of d??[])c.push([h,l])}c.length&&await Promise.allSettled(c.map(async([[l,u],d])=>this.configurationService.updateValue(l,u.value,{resource:t,overrideIdentifiers:d},o)))}}async runMigration(e,t,i,n,s){const o=c=>{var d,h;const u=this.configurationService.inspect(c,{resource:n})[t];if(u)return s?(h=(d=u.overrides)==null?void 0:d.find(({identifiers:g})=>Ni(g,s)))==null?void 0:h.value:u.value},a=await e.migrateFn(i,o);return Array.isArray(a)?a:[[e.key,a]]}},fu.ID="workbench.contrib.configurationMigration",fu);b0=H([N(0,uv),N(1,lg)],b0);let y0=(pu=class extends Be{constructor(e){super(),this.remoteAgentService=e,this._ready=new Co,this.ready=this._ready.p,this.create()}async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!si){const t=await this.remoteAgentService.getEnvironment();if((t==null?void 0:t.os)!==1)return}mi.as(Gh.Configuration).registerConfiguration({...y5,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:m("vs/workbench/common/configuration","security.allowedUNCHosts.patternErrorMessage","UNC host names must not contain backslashes.")},default:[],markdownDescription:m("vs/workbench/common/configuration","security.allowedUNCHosts","A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:m("vs/workbench/common/configuration","security.restrictUNCAccess","If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2}}})}},pu.ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration",pu);y0=H([N(0,cC)],y0),ne("editorResolverService");const S5=mi.as(Gh.Configuration),E5={...b5,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:m("vs/workbench/services/editor/common/editorResolverService","editor.editorAssociations",'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};S5.registerConfiguration(E5);var x0;(function(r){r.builtin="builtin",r.option="option",r.exclusive="exclusive",r.default="default"})(x0||(x0={}));function k5(r,e){if(new Set([Z.extension,Z.webviewPanel,Z.vscodeWorkspaceTrust,Z.vscodeSettings]).has(e.scheme))return!1;const n=typeof r=="string"&&r.indexOf(Me.sep)>=0?`${e.scheme}:${e.path}`:ns(e);return Fc(typeof r=="string"?r.toLowerCase():r,n.toLowerCase())}const io=class io{get activeNotebookEditor(){var e;return(e=this._activeNotebookEditor)==null?void 0:e.apiEditor}get visibleNotebookEditors(){return this._visibleNotebookEditors.map(e=>e.apiEditor)}constructor(e,t,i,n,s,o){this._textDocumentsAndEditors=i,this._textDocuments=n,this._extHostFileSystem=s,this._extHostSearch=o,this._notebookStatusBarItemProviders=new Map,this._documents=new pt,this._editors=new Map,this._onDidChangeActiveNotebookEditor=new T,this.onDidChangeActiveNotebookEditor=this._onDidChangeActiveNotebookEditor.event,this._visibleNotebookEditors=[],this._onDidOpenNotebookDocument=new T,this.onDidOpenNotebookDocument=this._onDidOpenNotebookDocument.event,this._onDidCloseNotebookDocument=new T,this.onDidCloseNotebookDocument=this._onDidCloseNotebookDocument.event,this._onDidChangeVisibleNotebookEditors=new T,this.onDidChangeVisibleNotebookEditors=this._onDidChangeVisibleNotebookEditors.event,this._statusBarCache=new Wi("NotebookCellStatusBarCache"),this._handlePool=0,this._notebookSerializer=new Map,this._notebookProxy=e.getProxy(G.MainThreadNotebook),this._notebookDocumentsProxy=e.getProxy(G.MainThreadNotebookDocuments),this._notebookEditorsProxy=e.getProxy(G.MainThreadNotebookEditors),this._commandsConverter=t.converter,t.registerArgumentProcessor({processArgument:a=>{var c;if(a&&a.$mid===13){const l=(c=a.notebookEditor)==null?void 0:c.notebookUri,u=a.cell.handle,d=this._documents.get(l),h=d==null?void 0:d.getCell(u);if(h)return h.apiCell}if(a&&a.$mid===14){const l=a.uri,u=this._documents.get(l);if(u)return u.apiNotebook}return a}}),io._registerApiCommands(t)}getEditorById(e){const t=this._editors.get(e);if(!t)throw new Error(`unknown text editor: ${e}. known editors: ${[...this._editors.keys()]} `);return t}getIdByEditor(e){for(const[t,i]of this._editors)if(i.apiEditor===e)return t}get notebookDocuments(){return[...this._documents.values()]}getNotebookDocument(e,t){const i=this._documents.get(e);if(!i&&!t)throw new Error(`NO notebook document for '${e}'`);return i}static _convertNotebookRegistrationData(e,t){if(!t)return;const i=t.filenamePattern.map(n=>Lh.from(n)).filter(n=>n!==void 0);if(t.filenamePattern&&!i){console.warn(`Notebook content provider view options file name pattern is invalid ${t.filenamePattern}`);return}return{extension:e.identifier,providerDisplayName:e.displayName||e.name,displayName:t.displayName,filenamePattern:i,exclusive:t.exclusive||!1}}registerNotebookCellStatusBarItemProvider(e,t,i){const n=io._notebookStatusBarItemProviderHandlePool++,s=typeof i.onDidChangeCellStatusBarItems=="function"?io._notebookStatusBarItemProviderHandlePool++:void 0;this._notebookStatusBarItemProviders.set(n,i),this._notebookProxy.$registerNotebookCellStatusBarItemProvider(n,s,t);let o;return s!==void 0&&(o=i.onDidChangeCellStatusBarItems(a=>this._notebookProxy.$emitCellStatusBarEvent(s))),new Pe(()=>{this._notebookStatusBarItemProviders.delete(n),this._notebookProxy.$unregisterNotebookCellStatusBarItemProvider(n,s),o==null||o.dispose()})}async createNotebookDocument(e){const t=await this._notebookDocumentsProxy.$tryCreateNotebook({viewType:e.viewType,content:e.content&&xr.from(e.content)});return y.revive(t)}async openNotebookDocument(e){const t=this._documents.get(e);if(t)return t.apiNotebook;const i=await this._notebookDocumentsProxy.$tryOpenNotebook(e),n=this._documents.get(y.revive(i));return yo(n==null?void 0:n.apiNotebook)}async showNotebookDocument(e,t){var o;y.isUri(e)&&(e=await this.openNotebookDocument(e));let i;typeof t=="object"?i={position:bt.from(t.viewColumn),preserveFocus:t.preserveFocus,selections:t.selections&&t.selections.map(sn.from),pinned:typeof t.preview=="boolean"?!t.preview:void 0}:i={preserveFocus:!1};const n=await this._notebookEditorsProxy.$tryShowNotebookDocument(e.uri,e.notebookType,i),s=n&&((o=this._editors.get(n))==null?void 0:o.apiEditor);if(s)return s;throw n?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}async $provideNotebookCellStatusBarItems(e,t,i,n){const s=this._notebookStatusBarItemProviders.get(e),o=y.revive(t),a=this._documents.get(o);if(!a||!s)return;const c=a.getCellFromIndex(i);if(!c)return;const l=await s.provideCellStatusBarItems(c.apiCell,n);if(!l)return;const u=new Ae,d=this._statusBarCache.add([u]),g=(Array.isArray(l)?l:[l]).map(w=>Qm.from(w,this._commandsConverter,u));return{cacheId:d,items:g}}$releaseNotebookCellStatusBarItems(e){this._statusBarCache.delete(e)}registerNotebookSerializer(e,t,i,n,s){if(Vu(t))throw new Error("viewType cannot be empty or just whitespace");const o=this._handlePool++;return this._notebookSerializer.set(o,{viewType:t,serializer:i,options:n}),this._notebookProxy.$registerNotebookSerializer(o,{id:e.identifier,location:e.extensionLocation},t,Km.from(n),io._convertNotebookRegistrationData(e,s)),Le(()=>{this._notebookProxy.$unregisterNotebookSerializer(o)})}async $dataToNotebook(e,t,i){const n=this._notebookSerializer.get(e);if(!n)throw new Error("NO serializer found");const s=await n.serializer.deserializeNotebook(t.buffer,i);return new Ji(xr.from(s))}async $notebookToData(e,t,i){const n=this._notebookSerializer.get(e);if(!n)throw new Error("NO serializer found");const s=await n.serializer.serializeNotebook(xr.to(t.value),i);return me.wrap(s)}async $saveNotebook(e,t,i,n,s){var w;const o=y.revive(t),a=this._notebookSerializer.get(e);if(!a)throw new Error("NO serializer found");const c=this._documents.get(o);if(!c)throw new Error("Document NOT found");if(c.versionId!==i)throw new Error("Document version mismatch");if(!this._extHostFileSystem.value.isWritableFileSystem(o.scheme))throw new x1(m("vs/workbench/api/common/extHostNotebook","err.readonly","Unable to modify read-only file '{0}'",this._resourceForError(o)),6);await this._validateWriteFile(o,n);const l={metadata:Py(c.apiNotebook.metadata,p=>{var b;return!(((b=a.options)==null?void 0:b.transientDocumentMetadata)??{})[p]}),cells:[]};for(const p of c.apiNotebook.getCells()){const b=new nh(p.kind,p.document.getText(),p.document.languageId,p.mime,(w=a.options)!=null&&w.transientOutputs?[]:[...p.outputs],p.metadata,p.executionSummary);b.metadata=Py(p.metadata,k=>{var D;return!(((D=a.options)==null?void 0:D.transientCellMetadata)??{})[k]}),l.cells.push(b)}const u=await a.serializer.serializeNotebook(l,s);await this._extHostFileSystem.value.writeFile(o,u);const d=this._extHostFileSystem.getFileSystemProviderExtUri(o.scheme),h=await this._extHostFileSystem.value.stat(o);return{name:d.basename(o),isFile:(h.type&hs.File)!==0,isDirectory:(h.type&hs.Directory)!==0,isSymbolicLink:(h.type&hs.SymbolicLink)!==0,mtime:h.mtime,ctime:h.ctime,size:h.size,readonly:!!((h.permissions??0)&Ro.Readonly)||!this._extHostFileSystem.value.isWritableFileSystem(o.scheme),locked:!!((h.permissions??0)&Ro.Locked),etag:S1({mtime:h.mtime,size:h.size}),children:void 0}}async $searchInNotebooks(e,t,i,n,s){var h;const o=(h=this._notebookSerializer.get(e))==null?void 0:h.serializer;if(!o)return{limitHit:!1,results:[]};const a=new ob;await(async(g,w,p)=>{await Promise.all(g.map(async b=>await Promise.all(b.filenamePatterns.map(k=>{const D={_reason:p._reason,folderQueries:p.folderQueries,includePattern:p.includePattern,excludePattern:p.excludePattern,maxResults:p.maxResults,type:1,filePattern:k};return this._extHostSearch.doInternalFileSearchWithCustomCallback(D,w,C=>{C.forEach(R=>{a.has(R)||n.some(B=>b.isFromSettings&&!B.isFromSettings?!1:B.filenamePatterns.some(Q=>k5(Q,R)))||a.add(R)})}).catch(C=>{if(C.code==="ENOENT")return console.warn("Could not find notebook search results, ignoring notebook results."),{limitHit:!1,messages:[]};throw C})}))))})(i,s,t);const l=new pt;let u=!1;const d=Array.from(a).map(async g=>{const w=[];try{if(s.isCancellationRequested)return;if(t.maxResults&&[...l.values()].reduce((D,C)=>D+C.cellResults.length,0)>t.maxResults){u=!0;return}const p=[],b=this._documents.get(g);if(b)b.apiNotebook.getCells().forEach(C=>p.push({input:C.document.getText(),outputs:C.outputs.flatMap(R=>R.items.map(A=>A.data.toString()))}));else{const D=await this._extHostFileSystem.value.readFile(g),C=me.fromString(D.toString()),R=await o.deserializeNotebook(C.buffer,s);if(s.isCancellationRequested)return;xr.from(R).cells.forEach(B=>p.push({input:B.source,outputs:B.outputs.flatMap(Q=>Q.items.map(ee=>ee.valueBytes.toString()))}))}if(s.isCancellationRequested)return;p.forEach((D,C)=>{const R=t.contentPattern.pattern,A=new w5(D.input,void 0,D.outputs),B=A.findInInputs(R),Q=A.findInOutputs(R),ee=Q.flatMap(ue=>w0(ue.matches,ue.textBuffer)).map((ue,Re)=>(ue.webviewIndex=Re,ue));if(B.length>0||Q.length>0){const ue={index:C,contentResults:w0(B,A.inputTextBuffer),webviewResults:ee};w.push(ue)}});const k={resource:g,cellResults:w};l.set(g,k);return}catch{return}});return await Promise.all(d),{limitHit:u,results:[...l.values()]}}async _validateWriteFile(e,t){const i=await this._extHostFileSystem.value.stat(e);if(typeof(t==null?void 0:t.mtime)=="number"&&typeof t.etag=="string"&&t.etag!==nD&&typeof i.mtime=="number"&&typeof i.size=="number"&&t.mtime<i.mtime&&t.etag!==S1({mtime:t.mtime,size:i.size}))throw new x1(m("vs/workbench/api/common/extHostNotebook","fileModifiedError","File Modified Since"),3,t)}_resourceForError(e){return e.scheme===Z.file?e.fsPath:e.toString()}_createExtHostEditor(e,t,i){if(this._editors.has(t))throw new Error(`editor with id ALREADY EXSIST: ${t}`);const n=new ql(t,this._notebookEditorsProxy,e,i.visibleRanges.map(sn.to),i.selections.map(sn.to),typeof i.viewColumn=="number"?bt.to(i.viewColumn):void 0);this._editors.set(t,n)}$acceptDocumentAndEditorsDelta(e){var t,i,n;if(e.value.removedDocuments)for(const s of e.value.removedDocuments){const o=y.revive(s),a=this._documents.get(o);a&&(a.dispose(),this._documents.delete(o),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({removedDocuments:a.apiNotebook.getCells().map(c=>c.document.uri)}),this._onDidCloseNotebookDocument.fire(a.apiNotebook));for(const c of this._editors.values())c.notebookData.uri.toString()===o.toString()&&this._editors.delete(c.id)}if(e.value.addedDocuments){const s=[];for(const o of e.value.addedDocuments){const a=y.revive(o.uri);if(this._documents.has(a))throw new Error(`adding EXISTING notebook ${a} `);const c=new z_(this._notebookDocumentsProxy,this._textDocumentsAndEditors,this._textDocuments,a,o);s.push(...o.cells.map(l=>V_.asModelAddData(l))),(t=this._documents.get(a))==null||t.dispose(),this._documents.set(a,c),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({addedDocuments:s}),this._onDidOpenNotebookDocument.fire(c.apiNotebook)}}if(e.value.addedEditors)for(const s of e.value.addedEditors){if(this._editors.has(s.id))return;const o=y.revive(s.documentUri),a=this._documents.get(o);a&&this._createExtHostEditor(a,s.id,s)}if(e.value.removedEditors)for(const s of e.value.removedEditors){const o=this._editors.get(s);o&&(this._editors.delete(s),((i=this._activeNotebookEditor)==null?void 0:i.id)===o.id&&(this._activeNotebookEditor=void 0))}if(e.value.visibleEditors){this._visibleNotebookEditors=e.value.visibleEditors.map(o=>this._editors.get(o)).filter(o=>!!o);const s=new Set;this._visibleNotebookEditors.forEach(o=>s.add(o.id));for(const o of this._editors.values()){const a=s.has(o.id);o._acceptVisibility(a)}this._visibleNotebookEditors=[...this._editors.values()].map(o=>o).filter(o=>o.visible),this._onDidChangeVisibleNotebookEditors.fire(this.visibleNotebookEditors)}e.value.newActiveEditor===null?this._activeNotebookEditor=void 0:e.value.newActiveEditor&&(this._editors.get(e.value.newActiveEditor)||console.error(`FAILED to find active notebook editor ${e.value.newActiveEditor}`),this._activeNotebookEditor=this._editors.get(e.value.newActiveEditor)),e.value.newActiveEditor!==void 0&&this._onDidChangeActiveNotebookEditor.fire((n=this._activeNotebookEditor)==null?void 0:n.apiEditor)}static _registerApiCommands(e){const t=W.String.with("notebookType","A notebook type"),i=new ve("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[t,new W("data","Bytes to convert to data",s=>s instanceof Uint8Array,s=>me.wrap(s))],new pe("Notebook Data",s=>xr.to(s.value))),n=new ve("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[t,new W("NotebookData","Notebook data to convert to bytes",s=>!0,s=>new Ji(xr.from(s)))],new pe("Bytes",s=>s.buffer));e.registerApiCommand(i),e.registerApiCommand(n)}};io._notebookStatusBarItemProviderHandlePool=0;let Y_=io;class D5{constructor(e,t,i,n={timeout:1500,errors:3}){this._logService=e,this._notebooksAndEditors=t,this._mainThreadBulkEdits=i,this._thresholds=n,this._onWillSaveNotebookDocumentEvent=new hc}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(t,i,n)=>{const s=function(a){t.call(i,a)};return s.extension=e,this._onWillSaveNotebookDocumentEvent.event(s,void 0,n)}}async $participateInSave(e,t,i){const n=y.revive(e),s=this._notebooksAndEditors.getNotebookDocument(n);if(!s)throw new Error("Unable to resolve notebook document");const o=[];if(await this._onWillSaveNotebookDocumentEvent.fireAsync({notebook:s.apiNotebook,reason:Ph.to(t)},i,async(c,l)=>{const u=Date.now(),d=await await Promise.resolve(c);Date.now()-u>this._thresholds.timeout&&this._logService.warn("onWillSaveNotebookDocument-listener from extension",l.extension.identifier),!i.isCancellationRequested&&d&&(d instanceof mr?o.push(d):this._logService.warn("onWillSaveNotebookDocument-listener from extension",l.extension.identifier,"ignored due to invalid data"))}),i.isCancellationRequested)return!1;if(o.length===0)return!0;const a={edits:[]};for(const c of o){const{edits:l}=ei.from(c);a.edits=a.edits.concat(l)}return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(a)}}class I5{constructor(e){this._notebooksAndEditors=e,this._onDidSaveNotebookDocument=new T,this.onDidSaveNotebookDocument=this._onDidSaveNotebookDocument.event,this._onDidChangeNotebookDocument=new T,this.onDidChangeNotebookDocument=this._onDidChangeNotebookDocument.event}$acceptModelChanged(e,t,i,n){const o=this._notebooksAndEditors.getNotebookDocument(y.revive(e)).acceptModelChanged(t.value,i,n);this._onDidChangeNotebookDocument.fire(o)}$acceptDirtyStateChanged(e,t){this._notebooksAndEditors.getNotebookDocument(y.revive(e)).acceptDirty(t)}$acceptModelSaved(e){const t=this._notebooksAndEditors.getNotebookDocument(y.revive(e));this._onDidSaveNotebookDocument.fire(t.apiNotebook)}}let Z_=class{constructor(e,t){this._logService=e,this._notebooksAndEditors=t,this._onDidChangeNotebookEditorSelection=new T,this._onDidChangeNotebookEditorVisibleRanges=new T,this.onDidChangeNotebookEditorSelection=this._onDidChangeNotebookEditorSelection.event,this.onDidChangeNotebookEditorVisibleRanges=this._onDidChangeNotebookEditorVisibleRanges.event}$acceptEditorPropertiesChanged(e,t){this._logService.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",e,t);const i=this._notebooksAndEditors.getEditorById(e);t.visibleRanges&&i._acceptVisibleRanges(t.visibleRanges.ranges.map(sn.to)),t.selections&&i._acceptSelections(t.selections.selections.map(sn.to)),t.visibleRanges&&this._onDidChangeNotebookEditorVisibleRanges.fire({notebookEditor:i.apiEditor,visibleRanges:i.apiEditor.visibleRanges}),t.selections&&this._onDidChangeNotebookEditorSelection.fire(Object.freeze({notebookEditor:i.apiEditor,selections:i.apiEditor.selections}))}$acceptEditorViewColumns(e){for(const t in e)this._notebooksAndEditors.getEditorById(t)._acceptViewColumn(bt.to(e[t]))}};Z_=H([N(0,Ge)],Z_);var Da;(function(r){r[r.Output=1]="Output",r[r.OutputItems=2]="OutputItems",r[r.ExecutionState=3]="ExecutionState"})(Da||(Da={})),ne("INotebookExecutionService");const P5=100;ne("INotebookKernelService"),ne("INotebookKernelHistoryService");let ew=class{constructor(e,t,i,n,s){this._initData=t,this._extHostNotebook=i,this._commands=n,this._logService=s,this._activeExecutions=new pt,this._activeNotebookExecutions=new pt,this._kernelDetectionTask=new Map,this._kernelDetectionTaskHandlePool=0,this._kernelSourceActionProviders=new Map,this._kernelSourceActionProviderHandlePool=0,this._kernelData=new Map,this._handlePool=0,this._onDidChangeCellExecutionState=new T,this.onDidChangeNotebookCellExecutionState=this._onDidChangeCellExecutionState.event,this.id=0,this.variableStore={},this._proxy=e.getProxy(G.MainThreadNotebookKernels);const o=new ve("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new W("options","Select kernel options",c=>!0,c=>{if(c&&"notebookEditor"in c&&"id"in c){const l=this._extHostNotebook.getIdByEditor(c.notebookEditor);return{id:c.id,extension:c.extension,notebookEditorId:l}}else if(c&&"notebookEditor"in c){const l=this._extHostNotebook.getIdByEditor(c.notebookEditor);if(l===void 0)throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${c.notebookEditor.notebook.uri.toString()}`);return{notebookEditorId:l}}return c})],pe.Void),a=new ve("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[W.Uri],new pe("A promise that resolves to an array of variables",(c,l)=>c.map(u=>({name:u.name,value:u.value,type:u.type,editable:!1}))));this._commands.registerApiCommand(o),this._commands.registerApiCommand(a)}createNotebookController(e,t,i,n,s,o){for(const A of this._kernelData.values())if(A.controller.id===t&&Xe.equals(e.identifier,A.extensionId))throw new Error(`notebook controller with id '${t}' ALREADY exist`);const a=this._handlePool++,c=this;this._logService.trace(`NotebookController[${a}], CREATED by ${e.identifier.value}, ${t}`);const l=()=>console.warn(`NO execute handler from notebook controller '${g.id}' of extension: '${e.identifier}'`);let u=!1;const d=new T,h=new T,g={id:Df(e.identifier,t),notebookType:i,extensionId:e.identifier,extensionLocation:e.extensionLocation,label:n||e.identifier.value,preloads:o?o.map(Oh.from):[]};let w=s??l,p,b;this._proxy.$addKernel(a,g).catch(A=>{console.log(A),u=!0});let k=0;const D=()=>{if(u)return;const A=++k;Promise.resolve().then(()=>{A===k&&this._proxy.$updateKernel(a,g)})},C=new pt,R={get id(){return t},get notebookType(){return g.notebookType},onDidChangeSelectedNotebooks:d.event,get label(){return g.label},set label(A){g.label=A??e.displayName??e.name,D()},get detail(){return g.detail??""},set detail(A){g.detail=A,D()},get description(){return g.description??""},set description(A){g.description=A,D()},get supportedLanguages(){return g.supportedLanguages},set supportedLanguages(A){g.supportedLanguages=A,D()},get supportsExecutionOrder(){return g.supportsExecutionOrder??!1},set supportsExecutionOrder(A){g.supportsExecutionOrder=A,D()},get rendererScripts(){return g.preloads?g.preloads.map(Oh.to):[]},get executeHandler(){return w},set executeHandler(A){w=A??l},get interruptHandler(){return p},set interruptHandler(A){p=A,g.supportsInterrupt=!!A,D()},set variableProvider(A){M(e,"notebookVariableProvider"),b=A,g.hasVariableProvider=!!A,A==null||A.onDidChangeVariables(B=>c._proxy.$variablesUpdated(B.uri)),D()},get variableProvider(){return b},createNotebookCellExecution(A){if(u)throw new Error("notebook controller is DISPOSED");if(!C.has(A.notebook.uri))throw c._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(C.keys()).map(B=>B.toString())),new Error(`notebook controller is NOT associated to notebook: ${A.notebook.uri.toString()}`);return c._createNotebookCellExecution(A,Df(e.identifier,this.id))},createNotebookExecution(A){if(M(e,"notebookExecution"),u)throw new Error("notebook controller is DISPOSED");if(!C.has(A.uri))throw c._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(C.keys()).map(B=>B.toString())),new Error(`notebook controller is NOT associated to notebook: ${A.uri.toString()}`);return c._createNotebookExecution(A,Df(e.identifier,this.id))},dispose:()=>{u||(this._logService.trace(`NotebookController[${a}], DISPOSED`),u=!0,this._kernelData.delete(a),d.dispose(),h.dispose(),this._proxy.$removeKernel(a))},updateNotebookAffinity(A,B){B===ah.Hidden&&M(e,"notebookControllerAffinityHidden"),c._proxy.$updateNotebookPriority(a,A.uri,B)},onDidReceiveMessage:h.event,postMessage(A,B){return M(e,"notebookMessaging"),c._proxy.$postMessage(a,B&&c._extHostNotebook.getIdByEditor(B),A)},asWebviewUri(A){return M(e,"notebookMessaging"),Hl(A,c._initData.remote)}};return this._kernelData.set(a,{extensionId:e.identifier,controller:R,onDidReceiveMessage:h,onDidChangeSelection:d,associatedNotebooks:C}),R}getIdByController(e){for(const[t,i]of this._kernelData)if(i.controller===e)return Df(i.extensionId,e.id);return null}createNotebookControllerDetectionTask(e,t){const i=this._kernelDetectionTaskHandlePool++,n=this;this._logService.trace(`NotebookControllerDetectionTask[${i}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelDetectionTask(i,t);const s={dispose:()=>{this._kernelDetectionTask.delete(i),n._proxy.$removeKernelDetectionTask(i)}};return this._kernelDetectionTask.set(i,s),s}registerKernelSourceActionProvider(e,t,i){const n=this._kernelSourceActionProviderHandlePool++,s=typeof i.onDidChangeNotebookKernelSourceActions=="function"?n:void 0,o=this;this._kernelSourceActionProviders.set(n,i),this._logService.trace(`NotebookKernelSourceActionProvider[${n}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelSourceActionProvider(n,n,t);let a;return s!==void 0&&(a=i.onDidChangeNotebookKernelSourceActions(c=>this._proxy.$emitNotebookKernelSourceActionsChangeEvent(s))),{dispose:()=>{this._kernelSourceActionProviders.delete(n),o._proxy.$removeKernelSourceActionProvider(n,n),a==null||a.dispose()}}}async $provideKernelSourceActions(e,t){const i=this._kernelSourceActionProviders.get(e);if(i){const n=new Ae;return(await i.provideNotebookKernelSourceActions(t)??[]).map(o=>Jm.from(o,this._commands.converter,n))}return[]}$acceptNotebookAssociation(e,t,i){const n=this._kernelData.get(e);if(n){const s=this._extHostNotebook.getNotebookDocument(y.revive(t));i?n.associatedNotebooks.set(s.uri,!0):n.associatedNotebooks.delete(s.uri),this._logService.trace(`NotebookController[${e}] ASSOCIATE notebook`,s.uri.toString(),i),n.onDidChangeSelection.fire({selected:i,notebook:s.apiNotebook})}}async $executeCells(e,t,i){const n=this._kernelData.get(e);if(!n)return;const s=this._extHostNotebook.getNotebookDocument(y.revive(t)),o=[];for(const a of i){const c=s.getCell(a);c&&o.push(c.apiCell)}try{this._logService.trace(`NotebookController[${e}] EXECUTE cells`,s.uri.toString(),o.length),await n.controller.executeHandler.call(n.controller,o,s.apiNotebook,n.controller)}catch(a){this._logService.error(`NotebookController[${e}] execute cells FAILED`,a),console.error(a)}}async $cancelCells(e,t,i){var o;const n=this._kernelData.get(e);if(!n)return;const s=this._extHostNotebook.getNotebookDocument(y.revive(t));if(n.controller.interruptHandler)await n.controller.interruptHandler.call(n.controller,s.apiNotebook);else for(const a of i){const c=s.getCell(a);c&&((o=this._activeExecutions.get(c.uri))==null||o.cancel())}if(n.controller.interruptHandler){const a=this._activeNotebookExecutions.get(s.uri);i.length&&Array.isArray(a)&&a.length&&a.forEach(c=>c.dispose())}}async $provideVariables(e,t,i,n,s,o,a){const c=this._kernelData.get(e);if(!c)return;const l=this._extHostNotebook.getNotebookDocument(y.revive(i)),u=c.controller.variableProvider;if(!u)return;let d;if(n!==void 0){if(d=this.variableStore[n],!d)return}else this.variableStore={};const h=s==="named"?sl.Named:sl.Indexed,g=u.provideVariables(l.apiNotebook,d,h,o,a);let w=0;for await(const p of g){if(a.isCancellationRequested)return;const b={id:this.id++,name:p.variable.name,value:p.variable.value,type:p.variable.type,hasNamedChildren:p.hasNamedChildren,indexedChildrenCount:p.indexedChildrenCount,extensionId:c.extensionId.value};if(this.variableStore[b.id]=p.variable,this._proxy.$receiveVariable(t,b),w++>=P5)return}}$acceptKernelMessageFromRenderer(e,t,i){const n=this._kernelData.get(e);if(!n)return;const s=this._extHostNotebook.getEditorById(t);n.onDidReceiveMessage.fire(Object.freeze({editor:s.apiEditor,message:i}))}$cellExecutionChanged(e,t,i){const s=this._extHostNotebook.getNotebookDocument(y.revive(e)).getCell(t);if(s){const o=i?Gm.to(i):Xo.Idle;o!==void 0&&this._onDidChangeCellExecutionState.fire({cell:s.apiCell,state:o})}}_createNotebookCellExecution(e,t){if(e.index<0)throw new Error("CANNOT execute cell that has been REMOVED from notebook");const n=this._extHostNotebook.getNotebookDocument(e.notebook.uri).getCellFromApiCell(e);if(!n)throw new Error("invalid cell");if(this._activeExecutions.has(n.uri))throw new Error(`duplicate execution for ${n.uri}`);const s=new tw(t,n,this._proxy);this._activeExecutions.set(n.uri,s);const o=s.onDidChangeState(()=>{s.state===zi.Resolved&&(s.dispose(),o.dispose(),this._activeExecutions.delete(n.uri))});return s.asApiObject()}_createNotebookExecution(e,t){const i=this._extHostNotebook.getNotebookDocument(e.uri),n=e.getCells().find(a=>{const c=i.getCellFromApiCell(a);return c&&this._activeExecutions.has(c.uri)});if(n)throw new Error(`duplicate cell execution for ${n.document.uri}`);if(this._activeNotebookExecutions.has(i.uri))throw new Error(`duplicate notebook execution for ${i.uri}`);const s=new iw(t,i,this._proxy),o=s.onDidChangeState(()=>{s.state===Un.Resolved&&(s.dispose(),o.dispose(),this._activeNotebookExecutions.delete(i.uri))});return this._activeNotebookExecutions.set(i.uri,[s,o]),s.asApiObject()}};ew=H([N(4,Ge)],ew);var zi;(function(r){r[r.Init=0]="Init",r[r.Started=1]="Started",r[r.Resolved=2]="Resolved"})(zi||(zi={}));const ep=class ep extends Be{get state(){return this._state}constructor(e,t,i){super(),this._cell=t,this._proxy=i,this._handle=ep.HANDLE++,this._onDidChangeState=new T,this.onDidChangeState=this._onDidChangeState.event,this._state=zi.Init,this._tokenSource=this._register(new mt),this._collector=new T5(10,n=>this.update(n)),this._executionOrder=t.internalMetadata.executionOrder,this._proxy.$createExecution(this._handle,e,this._cell.notebook.uri,this._cell.handle)}cancel(){this._tokenSource.cancel()}async updateSoon(e){await this._collector.addItem(e)}async update(e){const t=Array.isArray(e)?e:[e];return this._proxy.$updateExecution(this._handle,new Ji(t))}verifyStateForOutput(){if(this._state===zi.Init)throw new Error("Must call start before modifying cell output");if(this._state===zi.Resolved)throw new Error("Cannot modify cell output after calling resolve")}cellIndexToHandle(e){let t=this._cell;if(e&&(t=this._cell.notebook.getCellFromApiCell(e)),!t)throw new Error("INVALID cell");return t.handle}validateAndConvertOutputs(e){return e.map(t=>{const i=rh.ensureUniqueMimeTypes(t.items,!0);return i===t.items?Cr.from(t):Cr.from({items:i,id:t.id,metadata:t.metadata})})}async updateOutputs(e,t,i){const n=this.cellIndexToHandle(t),s=this.validateAndConvertOutputs(uc(e));return this.updateSoon({editType:Da.Output,cellHandle:n,append:i,outputs:s})}async updateOutputItems(e,t,i){return e=rh.ensureUniqueMimeTypes(uc(e),!0),this.updateSoon({editType:Da.OutputItems,items:e.map(ca.from),outputId:t.id,append:i})}asApiObject(){const e=this;return Object.freeze({get token(){return e._tokenSource.token},get cell(){return e._cell.apiCell},get executionOrder(){return e._executionOrder},set executionOrder(i){e._executionOrder=i,e.update([{editType:Da.ExecutionState,executionOrder:e._executionOrder}])},start(i){if(e._state===zi.Resolved||e._state===zi.Started)throw new Error("Cannot call start again");e._state=zi.Started,e._onDidChangeState.fire(),e.update({editType:Da.ExecutionState,runStartTime:i})},end(i,n){if(e._state===zi.Resolved)throw new Error("Cannot call resolve twice");e._state=zi.Resolved,e._onDidChangeState.fire(),e._collector.flush(),e._proxy.$completeExecution(e._handle,new Ji({runEndTime:n,lastRunSuccess:i}))},clearOutput(i){return e.verifyStateForOutput(),e.updateOutputs([],i,!1)},appendOutput(i,n){return e.verifyStateForOutput(),e.updateOutputs(i,n,!0)},replaceOutput(i,n){return e.verifyStateForOutput(),e.updateOutputs(i,n,!1)},appendOutputItems(i,n){return e.verifyStateForOutput(),e.updateOutputItems(i,n,!0)},replaceOutputItems(i,n){return e.verifyStateForOutput(),e.updateOutputItems(i,n,!1)}})}};ep.HANDLE=0;let tw=ep;var Un;(function(r){r[r.Init=0]="Init",r[r.Started=1]="Started",r[r.Resolved=2]="Resolved"})(Un||(Un={}));const tp=class tp extends Be{get state(){return this._state}constructor(e,t,i){super(),this._notebook=t,this._proxy=i,this._handle=tp.HANDLE++,this._onDidChangeState=new T,this.onDidChangeState=this._onDidChangeState.event,this._state=Un.Init,this._tokenSource=this._register(new mt),this._proxy.$createNotebookExecution(this._handle,e,this._notebook.uri)}cancel(){this._tokenSource.cancel()}asApiObject(){return Object.freeze({start:()=>{if(this._state===Un.Resolved||this._state===Un.Started)throw new Error("Cannot call start again");this._state=Un.Started,this._onDidChangeState.fire(),this._proxy.$beginNotebookExecution(this._handle)},end:()=>{if(this._state===Un.Resolved)throw new Error("Cannot call resolve twice");this._state=Un.Resolved,this._onDidChangeState.fire(),this._proxy.$completeNotebookExecution(this._handle)}})}};tp.HANDLE=0;let iw=tp;class T5{constructor(e,t){this.delay=e,this.callback=t,this.batch=[],this.startedTimer=Date.now()}addItem(e){return this.batch.push(e),this.currentDeferred||(this.currentDeferred=new Co,this.startedTimer=Date.now(),lr(this.delay).then(()=>this.flush())),Date.now()-this.startedTimer>this.delay?this.flush():this.currentDeferred.p}flush(){if(this.batch.length===0||!this.currentDeferred)return Promise.resolve();const e=this.currentDeferred;this.currentDeferred=void 0;const t=this.batch;return this.batch=[],this.callback(t).finally(()=>e.complete())}}function Df(r,e){return`${r.value}/${e}`}class A5{constructor(e,t){this._extHostNotebook=t,this._rendererMessageEmitters=new Map,this.proxy=e.getProxy(G.MainThreadNotebookRenderers)}$postRendererMessage(e,t,i){var s;const n=this._extHostNotebook.getEditorById(e);(s=this._rendererMessageEmitters.get(t))==null||s.fire({editor:n.apiEditor,message:i})}createRendererMessaging(e,t){var n,s;if(!((s=(n=e.contributes)==null?void 0:n.notebookRenderer)!=null&&s.some(o=>o.id===t)))throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${t})`);return{onDidReceiveMessage:(o,a,c)=>this.getOrCreateEmitterFor(t).event(o,a,c),postMessage:(o,a)=>{ql.apiEditorsToExtHost.has(o)&&([o,a]=[a,o]);const c=a&&ql.apiEditorsToExtHost.get(a);return this.proxy.$postMessage(c==null?void 0:c.id,t,o)}}}getOrCreateEmitterFor(e){let t=this._rendererMessageEmitters.get(e);return t||(t=new T({onDidRemoveLastListener:()=>{t==null||t.dispose(),this._rendererMessageEmitters.delete(e)}}),this._rendererMessageEmitters.set(e,t),t)}}class R5{constructor(e){this.handlers=new Map,this.proxy=e.getProxy(G.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,t,i){if(M(e,"profileContentHandlers"),this.handlers.has(t))throw new Error(`Handler with id '${t}' already registered`);return this.handlers.set(t,i),this.proxy.$registerProfileContentHandler(t,i.name,i.description,e.identifier.value),Le(()=>{this.handlers.delete(t),this.proxy.$unregisterProfileContentHandler(t)})}async $saveProfile(e,t,i,n){const s=this.handlers.get(e);if(!s)throw new Error(`Unknown handler with id: ${e}`);return s.saveProfile(t,i,n)}async $readProfile(e,t,i){const n=this.handlers.get(e);if(!n)throw new Error(`Unknown handler with id: ${e}`);return n.readProfile(Ne(t)?t:y.revive(t),i)}}function C0(r){return(e,t,i)=>{let n=null,s=null;if(typeof i.value=="function"?(n="value",s=i.value):typeof i.get=="function"&&(n="get",s=i.get),!s)throw new Error("not supported");i[n]=r(s,t)}}function S0(r,e,t){return C0((i,n)=>{const s=`$debounce$${n}`,o=`$debounce$result$${n}`;return function(...a){this[o]||(this[o]=t?t():void 0),clearTimeout(this[s]),e&&(this[o]=e(this[o],...a),a=[this[o]]),this[s]=setTimeout(()=>{i.apply(this,a),this[o]=t?t():void 0},r)}})}function L5(r,e,t){return C0((i,n)=>{const s=`$throttle$timer$${n}`,o=`$throttle$result$${n}`,a=`$throttle$lastRun$${n}`,c=`$throttle$pending$${n}`;return function(...l){if(this[o]||(this[o]=t?t():void 0),(this[a]===null||this[a]===void 0)&&(this[a]=-Number.MAX_VALUE),e&&(this[o]=e(this[o],...l)),this[c])return;const u=this[a]+r;u<=Date.now()?(this[a]=Date.now(),i.apply(this,[this[o]]),this[o]=t?t():void 0):(this[c]=!0,this[s]=setTimeout(()=>{this[c]=!1,this[a]=Date.now(),i.apply(this,[this[o]]),this[o]=t?t():void 0},u-Date.now()))}})}class O5{constructor(e){this._handles=0,this._mapHandleToCancellationSource=new Map,this._proxy=e}async withProgress(e,t,i){const n=this._handles++,{title:s,location:o,cancellable:a}=t,c={label:e.displayName||e.name,id:e.identifier.value};return this._proxy.$startProgress(n,{location:jm.from(o),title:s,source:c,cancellable:a},e.isUnderDevelopment?void 0:e.identifier.value).catch(mp),this._withProgress(n,i,!!a)}_withProgress(e,t,i){let n;i&&(n=new mt,this._mapHandleToCancellationSource.set(e,n));const s=a=>{this._proxy.$progressEnd(a),this._mapHandleToCancellationSource.delete(a),n==null||n.dispose()};let o;try{o=t(new nw(this._proxy,e),i&&n?n.token:It.None)}catch(a){throw s(e),a}return o.then(a=>s(e),a=>s(e)),o}$acceptProgressCanceled(e){const t=this._mapHandleToCancellationSource.get(e);t&&(t.cancel(),this._mapHandleToCancellationSource.delete(e))}}function $5(r,e){return r.message=e.message,typeof e.increment=="number"&&(typeof r.increment=="number"?r.increment+=e.increment:r.increment=e.increment),r}class nw extends hf{constructor(e,t){super(i=>this.throttledReport(i)),this._proxy=e,this._handle=t}throttledReport(e){this._proxy.$progressReport(this._handle,e)}}nw.__decorator=H([L5(100,(r,e)=>$5(r,e),()=>Object.create(null))],nw.prototype,"throttledReport",null);const ip=class ip{constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(G.MainThreadQuickDiff)}$provideOriginalResource(e,t,i){const n=y.revive(t),s=this.providers.get(e);return s?Mt(()=>s.provideOriginalResource(n,i)).then(o=>o||null):Promise.resolve(null)}registerQuickDiffProvider(e,t,i,n){const s=ip.handlePool++;return this.providers.set(s,t),this.proxy.$registerQuickDiffProvider(s,ea.from(e,this.uriTransformer),i,n),{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(s),this.providers.delete(s)}}}};ip.handlePool=0;let rw=ip;function N5(r,e,t){const i=r.getProxy(G.MainThreadQuickOpen);class n{constructor(w,p){this._sessions=new Map,this._instances=0,this._workspace=w,this._commands=p}showQuickPick(w,p,b,k=It.None){this._onDidSelectItem=void 0;const D=Promise.resolve(p),C=++this._instances,R=i.$show(C,{title:b==null?void 0:b.title,placeHolder:b==null?void 0:b.placeHolder,matchOnDescription:b==null?void 0:b.matchOnDescription,matchOnDetail:b==null?void 0:b.matchOnDetail,ignoreFocusLost:b==null?void 0:b.ignoreFocusOut,canPickMany:b==null?void 0:b.canPickMany},k),A={},B=R.then(()=>A);return Promise.race([B,D]).then(Q=>{if(Q===A)return;const ee=Tt(w,"quickPickItemTooltip");return D.then(ue=>{const Re=[];for(let q=0;q<ue.length;q++){const U=ue[q];if(typeof U=="string")Re.push({label:U,handle:q});else if(U.kind===rl.Separator)Re.push({type:"separator",label:U.label});else{U.tooltip&&!ee&&console.warn(`Extension '${w.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${w.identifier.value}`);const J=U.iconPath?l(U.iconPath):void 0;Re.push({label:U.label,iconPath:J==null?void 0:J.iconPath,iconClass:J==null?void 0:J.iconClass,description:U.description,detail:U.detail,picked:U.picked,alwaysShow:U.alwaysShow,tooltip:ee?Te.fromStrict(U.tooltip):void 0,handle:q})}}return b&&typeof b.onDidSelectItem=="function"&&(this._onDidSelectItem=q=>{b.onDidSelectItem(ue[q])}),i.$setItems(C,Re),R.then(q=>{if(typeof q=="number")return ue[q];if(Array.isArray(q))return q.map(U=>ue[U])})})}).then(void 0,Q=>{if(!qr(Q))return i.$setError(C,Q),Promise.reject(Q)})}$onItemSelected(w){var p;(p=this._onDidSelectItem)==null||p.call(this,w)}showInput(w,p=It.None){return this._validateInput=w==null?void 0:w.validateInput,i.$input(w,typeof this._validateInput=="function",p).then(void 0,b=>{if(!qr(b))return Promise.reject(b)})}async $validateInput(w){if(!this._validateInput)return;const p=await this._validateInput(w);if(!p||typeof p=="string")return p;let b;switch(p.severity){case Ko.Info:b=tt.Info;break;case Ko.Warning:b=tt.Warning;break;case Ko.Error:b=tt.Error;break;default:b=p.message?tt.Error:tt.Ignore;break}return{content:p.message,severity:b}}async showWorkspaceFolderPick(w,p=It.None){const b=await this._commands.executeCommand("_workbench.pickWorkspaceFolder",[w]);if(!b)return;const k=await this._workspace.getWorkspaceFolders2();if(k)return k.find(D=>D.uri.toString()===b.uri.toString())}createQuickPick(w){const p=new u(w,()=>this._sessions.delete(p._id));return this._sessions.set(p._id,p),p}createInputBox(w){const p=new d(w,()=>this._sessions.delete(p._id));return this._sessions.set(p._id,p),p}$onDidChangeValue(w,p){const b=this._sessions.get(w);b==null||b._fireDidChangeValue(p)}$onDidAccept(w){const p=this._sessions.get(w);p==null||p._fireDidAccept()}$onDidChangeActive(w,p){const b=this._sessions.get(w);b instanceof u&&b._fireDidChangeActive(p)}$onDidChangeSelection(w,p){const b=this._sessions.get(w);b instanceof u&&b._fireDidChangeSelection(p)}$onDidTriggerButton(w,p){const b=this._sessions.get(w);b==null||b._fireDidTriggerButton(p)}$onDidTriggerItemButton(w,p,b){const k=this._sessions.get(w);k instanceof u&&k._fireDidTriggerItemButton(p,b)}$onDidHide(w){const p=this._sessions.get(w);p==null||p._fireDidHide()}}const h=class h{constructor(w,p){this._extensionId=w,this._onDidDispose=p,this._id=u._nextId++,this._visible=!1,this._expectingHide=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!0,this._value="",this._buttons=[],this._handlesToButtons=new Map,this._onDidAcceptEmitter=new T,this._onDidChangeValueEmitter=new T,this._onDidTriggerButtonEmitter=new T,this._onDidHideEmitter=new T,this._pendingUpdate={id:this._id},this._disposed=!1,this._disposables=[this._onDidTriggerButtonEmitter,this._onDidHideEmitter,this._onDidAcceptEmitter,this._onDidChangeValueEmitter],this.onDidChangeValue=this._onDidChangeValueEmitter.event,this.onDidAccept=this._onDidAcceptEmitter.event,this.onDidTriggerButton=this._onDidTriggerButtonEmitter.event,this.onDidHide=this._onDidHideEmitter.event}get title(){return this._title}set title(w){this._title=w,this.update({title:w})}get step(){return this._steps}set step(w){this._steps=w,this.update({step:w})}get totalSteps(){return this._totalSteps}set totalSteps(w){this._totalSteps=w,this.update({totalSteps:w})}get enabled(){return this._enabled}set enabled(w){this._enabled=w,this.update({enabled:w})}get busy(){return this._busy}set busy(w){this._busy=w,this.update({busy:w})}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(w){this._ignoreFocusOut=w,this.update({ignoreFocusOut:w})}get value(){return this._value}set value(w){this._value=w,this.update({value:w})}get placeholder(){return this._placeholder}set placeholder(w){this._placeholder=w,this.update({placeholder:w})}get buttons(){return this._buttons}set buttons(w){this._buttons=w.slice(),this._handlesToButtons.clear(),w.forEach((p,b)=>{const k=p===nl.Back?-1:b;this._handlesToButtons.set(k,p)}),this.update({buttons:w.map((p,b)=>({...l(p.iconPath),tooltip:p.tooltip,handle:p===nl.Back?-1:b}))})}show(){this._visible=!0,this._expectingHide=!0,this.update({visible:!0})}hide(){this._visible=!1,this.update({visible:!1})}_fireDidAccept(){this._onDidAcceptEmitter.fire()}_fireDidChangeValue(w){this._value=w,this._onDidChangeValueEmitter.fire(w)}_fireDidTriggerButton(w){const p=this._handlesToButtons.get(w);p&&this._onDidTriggerButtonEmitter.fire(p)}_fireDidHide(){this._expectingHide&&(this._expectingHide=this._visible,this._onDidHideEmitter.fire())}dispose(){this._disposed||(this._disposed=!0,this._fireDidHide(),this._disposables=Kr(this._disposables),this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this._onDidDispose(),i.$dispose(this._id))}update(w){if(!this._disposed){for(const p of Object.keys(w)){const b=w[p];this._pendingUpdate[p]=b===void 0?null:b}"visible"in this._pendingUpdate?(this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this.dispatchUpdate()):this._visible&&!this._updateTimeout&&(this._updateTimeout=setTimeout(()=>{this._updateTimeout=void 0,this.dispatchUpdate()},0))}}dispatchUpdate(){i.$createOrUpdate(this._pendingUpdate),this._pendingUpdate={id:this._id}}};h._nextId=1;let s=h;function o(g){if(g instanceof Gt)return{id:g.id};const w=c(g),p=a(g);return{dark:typeof w=="string"?y.file(w):w,light:typeof p=="string"?y.file(p):p}}function a(g){return typeof g=="object"&&"light"in g?g.light:g}function c(g){return typeof g=="object"&&"dark"in g?g.dark:g}function l(g){const w=o(g);let p,b;return"id"in w?b=Xt.asClassName(w):p=w,{iconPath:p,iconClass:b}}class u extends s{constructor(w,p){super(w.identifier,p),this.extension=w,this._items=[],this._handlesToItems=new Map,this._itemsToHandles=new Map,this._canSelectMany=!1,this._matchOnDescription=!0,this._matchOnDetail=!0,this._sortByLabel=!0,this._keepScrollPosition=!1,this._activeItems=[],this._onDidChangeActiveEmitter=new T,this._selectedItems=[],this._onDidChangeSelectionEmitter=new T,this._onDidTriggerItemButtonEmitter=new T,this.onDidChangeActive=this._onDidChangeActiveEmitter.event,this.onDidChangeSelection=this._onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this._onDidTriggerItemButtonEmitter.event,this._disposables.push(this._onDidChangeActiveEmitter,this._onDidChangeSelectionEmitter,this._onDidTriggerItemButtonEmitter),this.update({type:"quickPick"})}get items(){return this._items}set items(w){var k;this._items=w.slice(),this._handlesToItems.clear(),this._itemsToHandles.clear(),w.forEach((D,C)=>{this._handlesToItems.set(C,D),this._itemsToHandles.set(D,C)});const p=Tt(this.extension,"quickPickItemTooltip"),b=[];for(let D=0;D<w.length;D++){const C=w[D];if(C.kind===rl.Separator)b.push({type:"separator",label:C.label});else{C.tooltip&&!p&&console.warn(`Extension '${this.extension.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this.extension.identifier.value}`);const R=C.iconPath?l(C.iconPath):void 0;b.push({handle:D,label:C.label,iconPath:R==null?void 0:R.iconPath,iconClass:R==null?void 0:R.iconClass,description:C.description,detail:C.detail,picked:C.picked,alwaysShow:C.alwaysShow,tooltip:p?Te.fromStrict(C.tooltip):void 0,buttons:(k=C.buttons)==null?void 0:k.map((A,B)=>({...l(A.iconPath),tooltip:A.tooltip,handle:B}))})}}this.update({items:b})}get canSelectMany(){return this._canSelectMany}set canSelectMany(w){this._canSelectMany=w,this.update({canSelectMany:w})}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(w){this._matchOnDescription=w,this.update({matchOnDescription:w})}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(w){this._matchOnDetail=w,this.update({matchOnDetail:w})}get sortByLabel(){return this._sortByLabel}set sortByLabel(w){this._sortByLabel=w,this.update({sortByLabel:w})}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(w){this._keepScrollPosition=w,this.update({keepScrollPosition:w})}get activeItems(){return this._activeItems}set activeItems(w){this._activeItems=w.filter(p=>this._itemsToHandles.has(p)),this.update({activeItems:this._activeItems.map(p=>this._itemsToHandles.get(p))})}get selectedItems(){return this._selectedItems}set selectedItems(w){this._selectedItems=w.filter(p=>this._itemsToHandles.has(p)),this.update({selectedItems:this._selectedItems.map(p=>this._itemsToHandles.get(p))})}_fireDidChangeActive(w){const p=Jt(w.map(b=>this._handlesToItems.get(b)));this._activeItems=p,this._onDidChangeActiveEmitter.fire(p)}_fireDidChangeSelection(w){const p=Jt(w.map(b=>this._handlesToItems.get(b)));this._selectedItems=p,this._onDidChangeSelectionEmitter.fire(p)}_fireDidTriggerItemButton(w,p){const b=this._handlesToItems.get(w);if(!b||!b.buttons||!b.buttons.length)return;const k=b.buttons[p];k&&this._onDidTriggerItemButtonEmitter.fire({button:k,item:b})}}class d extends s{constructor(w,p){super(w.identifier,p),this._password=!1,this.update({type:"inputBox"})}get password(){return this._password}set password(w){this._password=w,this.update({password:w})}get prompt(){return this._prompt}set prompt(w){this._prompt=w,this.update({prompt:w})}get valueSelection(){return this._valueSelection}set valueSelection(w){this._valueSelection=w,this.update({valueSelection:w})}get validationMessage(){return this._validationMessage}set validationMessage(w){this._validationMessage=w,w?typeof w=="string"?this.update({validationMessage:w,severity:tt.Error}):this.update({validationMessage:w.message,severity:w.severity??tt.Error}):this.update({validationMessage:void 0,severity:tt.Ignore})}}return new n(e,t)}const E0=new ut(()=>{const r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:r,collatorIsNumeric:r.resolvedOptions().numeric}});function F5(r,e,t=!1){const i=r||"",n=e||"",s=E0.value.collator.compare(i,n);return E0.value.collatorIsNumeric&&s===0&&i!==n?i<n?-1:1:s}function M5(r,e,t=!1){return t||(r=r&&r.toLowerCase(),e=e&&e.toLowerCase()),r===e?0:r<e?-1:1}function If(r,e,t=!1){const i=r.split(Ri),n=e.split(Ri),s=i.length-1,o=n.length-1;let a,c;for(let l=0;;l++){if(a=s===l,c=o===l,a&&c)return F5(i[l],n[l],t);if(a)return-1;if(c)return 1;const u=M5(i[l],n[l],t);if(u!==0)return u}}var sw;function k0(r){return r instanceof y}function H5(r,e){return r.scheme===Z.file&&e.scheme===Z.file&&tr?r.toString()===e.toString():r.toString().toLowerCase()===e.toString().toLowerCase()}function ow(r){if(r)return typeof r.iconPath=="string"?y.file(r.iconPath):y.isUri(r.iconPath)||Xt.isThemeIcon(r.iconPath)?r.iconPath:void 0}function D0(r){if(r.icon){if(y.isUri(r.icon))return r.icon;if(Xt.isThemeIcon(r.icon))return r.icon;{const e=r.icon;return{light:e.light,dark:e.dark}}}else return}function aw(r,e){if(!r.iconPath&&!e.iconPath)return 0;if(r.iconPath){if(!e.iconPath)return 1}else return-1;const t=typeof r.iconPath=="string"?r.iconPath:y.isUri(r.iconPath)?r.iconPath.fsPath:r.iconPath.id,i=typeof e.iconPath=="string"?e.iconPath:y.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id;return If(t,i)}function U5(r,e){let t=0;if(r.strikeThrough!==e.strikeThrough)return r.strikeThrough?1:-1;if(r.faded!==e.faded)return r.faded?1:-1;if(r.tooltip!==e.tooltip)return(r.tooltip||"").localeCompare(e.tooltip||"");if(t=aw(r,e),t!==0)return t;if(r.light&&e.light)t=aw(r.light,e.light);else{if(r.light)return 1;if(e.light)return-1}if(t!==0)return t;if(r.dark&&e.dark)t=aw(r.dark,e.dark);else{if(r.dark)return 1;if(e.dark)return-1}return t}function B5(r,e){if(r.command!==e.command)return r.command<e.command?-1:1;if(r.title!==e.title)return r.title<e.title?-1:1;if(r.tooltip!==e.tooltip){if(r.tooltip!==void 0&&e.tooltip!==void 0)return r.tooltip<e.tooltip?-1:1;if(r.tooltip!==void 0)return 1;if(e.tooltip!==void 0)return-1}if(r.arguments===e.arguments)return 0;if(r.arguments)if(e.arguments){if(r.arguments.length!==e.arguments.length)return r.arguments.length-e.arguments.length}else return 1;else return-1;for(let t=0;t<r.arguments.length;t++){const i=r.arguments[t],n=e.arguments[t];if(i!==n&&!(k0(i)&&k0(n)&&H5(i,n)))return i<n?-1:1}return 0}function I0(r,e){let t=If(r.resourceUri.fsPath,e.resourceUri.fsPath,!0);if(t!==0)return t;if(r.command&&e.command)t=B5(r.command,e.command);else{if(r.command)return 1;if(e.command)return-1}if(t!==0)return t;if(r.decorations&&e.decorations)t=U5(r.decorations,e.decorations);else{if(r.decorations)return 1;if(e.decorations)return-1}if(r.multiFileDiffEditorModifiedUri&&e.multiFileDiffEditorModifiedUri)t=If(r.multiFileDiffEditorModifiedUri.fsPath,e.multiFileDiffEditorModifiedUri.fsPath,!0);else{if(r.multiFileDiffEditorModifiedUri)return 1;if(e.multiFileDiffEditorModifiedUri)return-1}if(r.multiDiffEditorOriginalUri&&e.multiDiffEditorOriginalUri)t=If(r.multiDiffEditorOriginalUri.fsPath,e.multiDiffEditorOriginalUri.fsPath,!0);else{if(r.multiDiffEditorOriginalUri)return 1;if(e.multiDiffEditorOriginalUri)return-1}return t}function W5(r,e){for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function V5(r,e){return r.command===e.command&&r.title===e.title&&r.tooltip===e.tooltip&&(r.arguments&&e.arguments?W5(r.arguments,e.arguments):r.arguments===e.arguments)}function z5(r,e){return er(r,e,V5)}class j5{constructor(e,t,i,n,s){ae(this,hn,void 0);ae(this,gu,void 0);this._extension=e,this._sourceControlHandle=n,this._documentUri=s,this._value="",this._onDidChange=new T,this._placeholder="",this._enabled=!0,this._visible=!0,K(this,gu,t),K(this,hn,i)}get value(){return this._value}set value(e){e=e??"",I(this,hn).$setInputBoxValue(this._sourceControlHandle,e),this.updateValue(e)}get onDidChange(){return this._onDidChange.event}get placeholder(){return this._placeholder}set placeholder(e){I(this,hn).$setInputBoxPlaceholder(this._sourceControlHandle,e),this._placeholder=e}get validateInput(){return M(this._extension,"scmValidation"),this._validateInput}set validateInput(e){if(M(this._extension,"scmValidation"),e&&typeof e!="function")throw new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);this._validateInput=e,I(this,hn).$setValidationProviderIsEnabled(this._sourceControlHandle,!!e)}get enabled(){return this._enabled}set enabled(e){e=!!e,this._enabled!==e&&(this._enabled=e,I(this,hn).$setInputBoxEnablement(this._sourceControlHandle,e))}get visible(){return this._visible}set visible(e){e=!!e,this._visible!==e&&(this._visible=e,I(this,hn).$setInputBoxVisibility(this._sourceControlHandle,e))}get document(){return M(this._extension,"scmTextDocument"),I(this,gu).getDocument(this._documentUri)}showValidationMessage(e,t){M(this._extension,"scmValidation"),I(this,hn).$showValidationMessage(this._sourceControlHandle,e,t)}$onInputBoxValueChange(e){this.updateValue(e)}updateValue(e){this._value=e,this._onDidChange.fire(e)}}hn=new WeakMap,gu=new WeakMap;const np=class np{get disposed(){return this._disposed}get id(){return this._id}get label(){return this._label}set label(e){this._label=e,this._proxy.$updateGroupLabel(this._sourceControlHandle,this.handle,e)}get hideWhenEmpty(){return this._hideWhenEmpty}set hideWhenEmpty(e){this._hideWhenEmpty=e,this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get features(){return{hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this._resourceStates]}set resourceStates(e){this._resourceStates=[...e],this._onDidUpdateResourceStates.fire()}constructor(e,t,i,n,s,o,a){this._proxy=e,this._commands=t,this._sourceControlHandle=i,this._id=n,this._label=s,this.multiDiffEditorEnableViewChanges=o,this._extension=a,this._resourceHandlePool=0,this._resourceStates=[],this._resourceStatesMap=new Map,this._resourceStatesCommandsMap=new Map,this._resourceStatesDisposablesMap=new Map,this._onDidUpdateResourceStates=new T,this.onDidUpdateResourceStates=this._onDidUpdateResourceStates.event,this._disposed=!1,this._onDidDispose=new T,this.onDidDispose=this._onDidDispose.event,this._handlesSnapshot=[],this._resourceSnapshot=[],this._hideWhenEmpty=void 0,this.handle=np._handlePool++}getResourceState(e){return this._resourceStatesMap.get(e)}$executeResourceCommand(e,t){const i=this._resourceStatesCommandsMap.get(e);return i?Mt(()=>this._commands.executeCommand(i.command,...i.arguments||[],t)):Promise.resolve(void 0)}_takeResourceStateSnapshot(){var o;const e=[...this._resourceStates].sort(I0),i=eb(this._resourceSnapshot,e,I0).map(a=>{const c=a.toInsert.map(l=>{const u=this._resourceHandlePool++;this._resourceStatesMap.set(u,l);const d=l.resourceUri;let h;if(l.command)if(l.command.command==="vscode.open"||l.command.command==="vscode.diff"||l.command.command==="vscode.changes"){const ue=new Ae;h=this._commands.converter.toInternal(l.command,ue),this._resourceStatesDisposablesMap.set(u,ue)}else this._resourceStatesCommandsMap.set(u,l.command);const g=Tt(this._extension,"scmMultiDiffEditor"),w=g?l.multiDiffEditorOriginalUri:void 0,p=g?l.multiFileDiffEditorModifiedUri:void 0,b=ow(l.decorations),k=l.decorations&&ow(l.decorations.light)||b,D=l.decorations&&ow(l.decorations.dark)||b,C=[k,D],R=l.decorations&&l.decorations.tooltip||"",A=l.decorations&&!!l.decorations.strikeThrough,B=l.decorations&&!!l.decorations.faded,Q=l.contextValue||"";return{rawResource:[u,d,C,R,A,B,Q,h,w,p],handle:u}});return{start:a.start,deleteCount:a.deleteCount,toInsert:c}}),n=i.map(({start:a,deleteCount:c,toInsert:l})=>[a,c,l.map(u=>u.rawResource)]),s=i.reverse();for(const{start:a,deleteCount:c,toInsert:l}of s){const u=l.map(h=>h.handle),d=this._handlesSnapshot.splice(a,c,...u);for(const h of d)this._resourceStatesMap.delete(h),this._resourceStatesCommandsMap.delete(h),(o=this._resourceStatesDisposablesMap.get(h))==null||o.dispose(),this._resourceStatesDisposablesMap.delete(h)}return this._resourceSnapshot=e,n}dispose(){this._disposed=!0,this._onDidDispose.fire()}};np._handlePool=0;let cw=np;const rp=class rp{constructor(e,t,i,n,s,o,a){ae(this,Rt,void 0);this._extension=e,this._commands=n,this._id=s,this._label=o,this._rootUri=a,this._groups=new Map,this._count=void 0,this._quickDiffProvider=void 0,this._historyProviderDisposable=new go,this._commitTemplate=void 0,this._acceptInputDisposables=new go,this._acceptInputCommand=void 0,this._actionButtonDisposables=new go,this._statusBarDisposables=new go,this._statusBarCommands=void 0,this._selected=!1,this._onDidChangeSelection=new T,this.onDidChangeSelection=this._onDidChangeSelection.event,this.handle=rp._handlePool++,this.createdResourceGroups=new Map,this.updatedResourceGroups=new Set,K(this,Rt,i);const c=y.from({scheme:Z.vscodeSourceControl,path:`${s}/scm${this.handle}/input`,query:a?`rootUri=${encodeURIComponent(a.toString())}`:void 0});this._inputBox=new j5(e,t,I(this,Rt),this.handle,c),I(this,Rt).$registerSourceControl(this.handle,s,o,a,c)}get id(){return this._id}get label(){return this._label}get rootUri(){return this._rootUri}get inputBox(){return this._inputBox}get count(){return this._count}set count(e){this._count!==e&&(this._count=e,I(this,Rt).$updateSourceControl(this.handle,{count:e}))}get quickDiffProvider(){return this._quickDiffProvider}set quickDiffProvider(e){this._quickDiffProvider=e;let t;Tt(this._extension,"quickDiffProvider")&&(t=e==null?void 0:e.label),I(this,Rt).$updateSourceControl(this.handle,{hasQuickDiffProvider:!!e,quickDiffLabel:t})}get historyProvider(){return M(this._extension,"scmHistoryProvider"),this._historyProvider}set historyProvider(e){M(this._extension,"scmHistoryProvider"),this._historyProvider=e,this._historyProviderDisposable.value=new Ae,I(this,Rt).$updateSourceControl(this.handle,{hasHistoryProvider:!!e}),e&&this._historyProviderDisposable.value.add(e.onDidChangeCurrentHistoryItemGroup(()=>{this._historyProviderCurrentHistoryItemGroup=e==null?void 0:e.currentHistoryItemGroup,I(this,Rt).$onDidChangeHistoryProviderCurrentHistoryItemGroup(this.handle,this._historyProviderCurrentHistoryItemGroup)}))}get commitTemplate(){return this._commitTemplate}set commitTemplate(e){e!==this._commitTemplate&&(this._commitTemplate=e,I(this,Rt).$updateSourceControl(this.handle,{commitTemplate:e}))}get acceptInputCommand(){return this._acceptInputCommand}set acceptInputCommand(e){this._acceptInputDisposables.value=new Ae,this._acceptInputCommand=e;const t=this._commands.converter.toInternal(e,this._acceptInputDisposables.value);I(this,Rt).$updateSourceControl(this.handle,{acceptInputCommand:t})}get actionButton(){return M(this._extension,"scmActionButton"),this._actionButton}set actionButton(e){var i;M(this._extension,"scmActionButton"),this._actionButtonDisposables.value=new Ae,this._actionButton=e;const t=e!==void 0?{command:this._commands.converter.toInternal(e.command,this._actionButtonDisposables.value),secondaryCommands:(i=e.secondaryCommands)==null?void 0:i.map(n=>n.map(s=>this._commands.converter.toInternal(s,this._actionButtonDisposables.value))),description:e.description,enabled:e.enabled}:void 0;I(this,Rt).$updateSourceControl(this.handle,{actionButton:t??null})}get statusBarCommands(){return this._statusBarCommands}set statusBarCommands(e){if(this._statusBarCommands&&e&&z5(this._statusBarCommands,e))return;this._statusBarDisposables.value=new Ae,this._statusBarCommands=e;const t=(e||[]).map(i=>this._commands.converter.toInternal(i,this._statusBarDisposables.value));I(this,Rt).$updateSourceControl(this.handle,{statusBarCommands:t})}get selected(){return this._selected}createResourceGroup(e,t,i){const n=Tt(this._extension,"scmMultiDiffEditor")&&(i==null?void 0:i.multiDiffEditorEnableViewChanges)===!0,s=new cw(I(this,Rt),this._commands,this.handle,e,t,n,this._extension),o=_t.once(s.onDidDispose)(()=>this.createdResourceGroups.delete(s));return this.createdResourceGroups.set(s,o),this.eventuallyAddResourceGroups(),s}eventuallyAddResourceGroups(){const e=[],t=[];for(const[i,n]of this.createdResourceGroups){n.dispose();const s=i.onDidUpdateResourceStates(()=>{this.updatedResourceGroups.add(i),this.eventuallyUpdateResourceStates()});_t.once(i.onDidDispose)(()=>{this.updatedResourceGroups.delete(i),s.dispose(),this._groups.delete(i.handle),I(this,Rt).$unregisterGroup(this.handle,i.handle)}),e.push([i.handle,i.id,i.label,i.features,i.multiDiffEditorEnableViewChanges]);const o=i._takeResourceStateSnapshot();o.length>0&&t.push([i.handle,o]),this._groups.set(i.handle,i)}I(this,Rt).$registerGroups(this.handle,e,t),this.createdResourceGroups.clear()}eventuallyUpdateResourceStates(){const e=[];this.updatedResourceGroups.forEach(t=>{const i=t._takeResourceStateSnapshot();i.length!==0&&e.push([t.handle,i])}),e.length>0&&I(this,Rt).$spliceResourceStates(this.handle,e),this.updatedResourceGroups.clear()}getResourceGroup(e){return this._groups.get(e)}setSelectionState(e){this._selected=e,this._onDidChangeSelection.fire(e)}dispose(){this._acceptInputDisposables.dispose(),this._actionButtonDisposables.dispose(),this._statusBarDisposables.dispose(),this._groups.forEach(e=>e.dispose()),I(this,Rt).$unregisterSourceControl(this.handle)}};Rt=new WeakMap,rp._handlePool=0;let Us=rp;Us.__decorator=H([S0(100)],Us.prototype,"eventuallyAddResourceGroups",null),Us.__decorator=H([S0(100)],Us.prototype,"eventuallyUpdateResourceStates",null);let lw=(Ma=class{get onDidChangeActiveProvider(){return this._onDidChangeActiveProvider.event}constructor(e,t,i,n){this._commands=t,this._extHostDocuments=i,this.logService=n,this._sourceControls=new Map,this._sourceControlsByExtension=new fr,this._onDidChangeActiveProvider=new T,this._proxy=e.getProxy(G.MainThreadSCM),this._telemetry=e.getProxy(G.MainThreadTelemetry),t.registerArgumentProcessor({processArgument:s=>{if(s&&s.$mid===3){const o=this._sourceControls.get(s.sourceControlHandle);if(!o)return s;const a=o.getResourceGroup(s.groupHandle);return a?a.getResourceState(s.handle):s}else if(s&&s.$mid===4){const o=this._sourceControls.get(s.sourceControlHandle);return o?o.getResourceGroup(s.groupHandle):s}else if(s&&s.$mid===5){const o=this._sourceControls.get(s.handle);return o||s}return s}})}createSourceControl(e,t,i,n){this.logService.trace("ExtHostSCM#createSourceControl",e.identifier.value,t,i,n),this._telemetry.$publicLog2("api/scm/createSourceControl",{extensionId:e.identifier.value});const s=sw._handlePool++,o=new Us(e,this._extHostDocuments,this._proxy,this._commands,t,i,n);this._sourceControls.set(s,o);const a=this._sourceControlsByExtension.get(e.identifier)||[];return a.push(o),this._sourceControlsByExtension.set(e.identifier,a),o}getLastInputBox(e){this.logService.trace("ExtHostSCM#getLastInputBox",e.identifier.value);const t=this._sourceControlsByExtension.get(e.identifier),i=t&&t[t.length-1];return i&&i.inputBox}$provideOriginalResource(e,t,i){const n=y.revive(t);this.logService.trace("ExtHostSCM#$provideOriginalResource",e,n.toString());const s=this._sourceControls.get(e);return!s||!s.quickDiffProvider||!s.quickDiffProvider.provideOriginalResource?Promise.resolve(null):Mt(()=>s.quickDiffProvider.provideOriginalResource(n,i)).then(o=>o||null)}$onInputBoxValueChange(e,t){this.logService.trace("ExtHostSCM#$onInputBoxValueChange",e);const i=this._sourceControls.get(e);return i&&i.inputBox.$onInputBoxValueChange(t),Promise.resolve(void 0)}$executeResourceCommand(e,t,i,n){this.logService.trace("ExtHostSCM#$executeResourceCommand",e,t,i);const s=this._sourceControls.get(e);if(!s)return Promise.resolve(void 0);const o=s.getResourceGroup(t);return o?o.$executeResourceCommand(i,n):Promise.resolve(void 0)}$validateInput(e,t,i){this.logService.trace("ExtHostSCM#$validateInput",e);const n=this._sourceControls.get(e);return!n||!n.inputBox.validateInput?Promise.resolve(void 0):Mt(()=>n.inputBox.validateInput(t,i)).then(s=>{if(!s)return Promise.resolve(void 0);const o=Te.fromStrict(s.message);return o?Promise.resolve([o,s.type]):Promise.resolve(void 0)})}$setSelectedSourceControl(e){var t,i;return this.logService.trace("ExtHostSCM#$setSelectedSourceControl",e),e!==void 0&&((t=this._sourceControls.get(e))==null||t.setSelectionState(!0)),this._selectedSourceControlHandle!==void 0&&((i=this._sourceControls.get(this._selectedSourceControlHandle))==null||i.setSelectionState(!1)),this._selectedSourceControlHandle=e,Promise.resolve(void 0)}async $resolveHistoryItemGroupCommonAncestor(e,t,i,n){var o;const s=(o=this._sourceControls.get(e))==null?void 0:o.historyProvider;return await(s==null?void 0:s.resolveHistoryItemGroupCommonAncestor(t,i,n))??void 0}async $provideHistoryItems(e,t,i,n){var a;const s=(a=this._sourceControls.get(e))==null?void 0:a.historyProvider,o=await(s==null?void 0:s.provideHistoryItems(t,i,n));return(o==null?void 0:o.map(c=>({...c,icon:D0(c)})))??void 0}async $provideHistoryItemSummary(e,t,i,n){var a;const s=(a=this._sourceControls.get(e))==null?void 0:a.historyProvider;if(typeof(s==null?void 0:s.provideHistoryItemSummary)!="function")return;const o=await s.provideHistoryItemSummary(t,i,n);return o?{...o,icon:D0(o)}:void 0}async $provideHistoryItemChanges(e,t,i,n){var o;const s=(o=this._sourceControls.get(e))==null?void 0:o.historyProvider;return await(s==null?void 0:s.provideHistoryItemChanges(t,i,n))??void 0}},sw=Ma,Ma._handlePool=0,Ma);lw=sw=H([N(3,Ge)],lw);const sp=class sp{constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(G.MainThreadShare)}async $provideShare(e,t,i){const n=this.providers.get(e);return await(n==null?void 0:n.provideShare({selection:F.to(t.selection),resourceUri:y.revive(t.resourceUri)},i))??void 0}registerShareProvider(e,t){const i=sp.handlePool++;return this.providers.set(i,t),this.proxy.$registerShareProvider(i,ea.from(e,this.uriTransformer),t.id,t.label,t.priority),{dispose:()=>{this.proxy.$unregisterShareProvider(i),this.providers.delete(i)}}}};sp.handlePool=0;let uw=sp;const op=class op{constructor(e){this.providers=new Map,this.sessions=new Map,this.proxy=e.getProxy(G.MainThreadSpeech)}async $createSpeechToTextSession(e,t,i){const n=this.providers.get(e);if(!n)return;const s=new Ae,o=new mt;this.sessions.set(t,o);const a=s.add(n.provideSpeechToTextSession(o.token,i?{language:i}:void 0));s.add(a.onDidChange(c=>{o.token.isCancellationRequested||this.proxy.$emitSpeechToTextEvent(t,c)})),s.add(o.token.onCancellationRequested(()=>s.dispose()))}async $cancelSpeechToTextSession(e){var t;(t=this.sessions.get(e))==null||t.dispose(!0),this.sessions.delete(e)}async $createKeywordRecognitionSession(e,t){const i=this.providers.get(e);if(!i)return;const n=new Ae,s=new mt;this.sessions.set(t,s);const o=n.add(i.provideKeywordRecognitionSession(s.token));n.add(o.onDidChange(a=>{s.token.isCancellationRequested||this.proxy.$emitKeywordRecognitionEvent(t,a)})),n.add(s.token.onCancellationRequested(()=>n.dispose()))}async $cancelKeywordRecognitionSession(e){var t;(t=this.sessions.get(e))==null||t.dispose(!0),this.sessions.delete(e)}registerProvider(e,t,i){const n=op.ID_POOL++;return this.providers.set(n,i),this.proxy.$registerProvider(n,t,{extension:e,displayName:e.value}),Le(()=>{this.proxy.$unregisterProvider(n),this.providers.delete(n)})}};op.ID_POOL=1;let dw=op;const no=class no{constructor(e,t,i,n,s,o=vr.Left,a){ae(this,Ha,void 0);ae(this,Ua,void 0);if(this._disposed=!1,this._text="",this._staleCommandRegistrations=new Ae,K(this,Ha,e),K(this,Ua,t),s&&n){this._entryId=qD(n.identifier,s);const c=i.get(this._entryId);c&&(o=c.alignLeft?vr.Left:vr.Right,a=c.priority,this._visible=!0,this.name=c.name,this.text=c.text,this.tooltip=c.tooltip,this.command=c.command,this.accessibilityInformation=c.accessibilityInformation)}else this._entryId=String(no.ID_GEN++);this._extension=n,this._id=s,this._alignment=o,this._priority=this.validatePriority(a)}validatePriority(e){if(or(e))return e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:e}get id(){return this._id??this._extension.identifier.value}get alignment(){return this._alignment}get priority(){return this._priority}get text(){return this._text}get name(){return this._name}get tooltip(){return this._tooltip}get color(){return this._color}get backgroundColor(){return this._backgroundColor}get command(){var e;return(e=this._command)==null?void 0:e.fromApi}get accessibilityInformation(){return this._accessibilityInformation}set text(e){this._text=e,this.update()}set name(e){this._name=e,this.update()}set tooltip(e){this._tooltip=e,this.update()}set color(e){this._color=e,this.update()}set backgroundColor(e){e&&!no.ALLOWED_BACKGROUND_COLORS.has(e.id)&&(e=void 0),this._backgroundColor=e,this.update()}set command(e){var t;((t=this._command)==null?void 0:t.fromApi)!==e&&(this._latestCommandRegistration&&this._staleCommandRegistrations.add(this._latestCommandRegistration),this._latestCommandRegistration=new Ae,typeof e=="string"?this._command={fromApi:e,internal:I(this,Ua).toInternal({title:"",command:e},this._latestCommandRegistration)}:e?this._command={fromApi:e,internal:I(this,Ua).toInternal(e,this._latestCommandRegistration)}:this._command=void 0,this.update())}set accessibilityInformation(e){this._accessibilityInformation=e,this.update()}show(){this._visible=!0,this.update()}hide(){clearTimeout(this._timeoutHandle),this._visible=!1,I(this,Ha).$disposeEntry(this._entryId)}update(){this._disposed||!this._visible||(clearTimeout(this._timeoutHandle),this._timeoutHandle=setTimeout(()=>{var s,o;this._timeoutHandle=void 0;let e;this._extension?this._id?e=`${this._extension.identifier.value}.${this._id}`:e=this._extension.identifier.value:e=this._id;let t;this._name?t=this._name:t=m("vs/workbench/api/common/extHostStatusBar","extensionLabel","{0} (Extension)",this._extension.displayName||this._extension.name);let i=this._color;this._backgroundColor&&(i=no.ALLOWED_BACKGROUND_COLORS.get(this._backgroundColor.id));const n=Te.fromStrict(this._tooltip);I(this,Ha).$setEntry(this._entryId,e,(s=this._extension)==null?void 0:s.identifier.value,t,this._text,n,(o=this._command)==null?void 0:o.internal,i,this._backgroundColor,this._alignment===vr.Left,this._priority,this._accessibilityInformation),this._staleCommandRegistrations.clear()},0))}dispose(){this.hide(),this._disposed=!0}};Ha=new WeakMap,Ua=new WeakMap,no.ID_GEN=0,no.ALLOWED_BACKGROUND_COLORS=new Map([["statusBarItem.errorBackground",new Yc("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new Yc("statusBarItem.warningForeground")]]);let hw=no;class q5{constructor(e){this._messages=[],this._item=e.createStatusBarEntry(void 0,"status.extensionMessage",vr.Left,Number.MIN_VALUE),this._item.name=m("vs/workbench/api/common/extHostStatusBar","status.extensionMessage","Extension Status")}dispose(){this._messages.length=0,this._item.dispose()}setMessage(e){const t={message:e};return this._messages.unshift(t),this._update(),new Pe(()=>{const i=this._messages.indexOf(t);i>=0&&(this._messages.splice(i,1),this._update())})}_update(){this._messages.length>0?(this._item.text=this._messages[0].message,this._item.show()):this._item.hide()}}class G5{constructor(e,t){this._existingItems=new Map,this._proxy=e.getProxy(G.MainThreadStatusBar),this._commands=t,this._statusMessage=new q5(this)}$acceptStaticEntries(e){for(const t of e)this._existingItems.set(t.entryId,t)}createStatusBarEntry(e,t,i,n){return new hw(this._proxy,this._commands,this._existingItems,e,t,i,n)}setStatusBarMessage(e,t){const i=this._statusMessage.setMessage(e);let n;return typeof t=="number"?n=setTimeout(()=>i.dispose(),t):typeof t<"u"&&t.then(()=>i.dispose(),()=>i.dispose()),new Pe(()=>{i.dispose(),clearTimeout(n)})}}let fw=class extends Be{constructor(e,t,i,n){super(),this.editors=n,this.resultsChangedEmitter=this._register(new T),this.controllers=new Map,this.defaultProfilesChangedEmitter=this._register(new T),this.onResultsChanged=this.resultsChangedEmitter.event,this.results=[],this.proxy=e.getProxy(G.MainThreadTesting),this.observer=new eA(this.proxy),this.runTracker=new K5(this.proxy,t),i.registerArgumentProcessor({processArgument:s=>{var o,a,c;switch(s==null?void 0:s.$mid){case 16:{const l=s,u=l.tests[l.tests.length-1].item.extId,d=this.controllers.get(we.root(u));return((o=d==null?void 0:d.collection.tree.get(u))==null?void 0:o.actual)??nI(s)}case 18:{const{extId:l,message:u}=s;return{test:(c=(a=this.controllers.get(we.root(l)))==null?void 0:a.collection.tree.get(l))==null?void 0:c.actual,message:la.to(u)}}default:return s}}}),i.registerCommand(!1,"testing.getExplorerSelection",async()=>{const s=await i.executeCommand("_testing.getExplorerSelection"),o=a=>{var l;const c=this.controllers.get(we.root(a));if(c)return we.isRoot(a)?c.controller:(l=c.collection.tree.get(a))==null?void 0:l.actual};return{include:(s==null?void 0:s.include.map(o).filter(bo))||[],exclude:(s==null?void 0:s.exclude.map(o).filter(bo))||[]}})}createTestController(e,t,i,n){if(this.controllers.has(t))throw new Error(`Attempt to insert a duplicate controller with ID "${t}"`);const s=new Ae,o=s.add(new rI(t,i,this.editors));o.root.label=i;const a=new Map,c=new Set,l=this.proxy,u={items:o.root.children,get label(){return i},set label(h){i=h,o.root.label=h,l.$updateController(t,{label:i})},get refreshHandler(){return n},set refreshHandler(h){n=h,l.$updateController(t,{canRefresh:!!h})},get id(){return t},createRunProfile:(h,g,w,p,b,k)=>{let D=ng(h);for(;a.has(D);)D++;return new T0(this.proxy,a,c,this.defaultProfilesChangedEmitter.event,t,D,h,g,w,p,b,k)},createTestItem(h,g,w){return new $s(t,h,g,w)},createTestRun:(h,g,w=!0)=>this.runTracker.createTestRun(e,t,o,h,g,w),invalidateTestResults:h=>{if(h===void 0)this.proxy.$markTestRetired(void 0);else{const g=h instanceof Array?h:[h];this.proxy.$markTestRetired(g.map(w=>we.fromExtHostTestItem(w,t).toString()))}},set resolveHandler(h){o.resolveHandler=h},get resolveHandler(){return o.resolveHandler},dispose:()=>{s.dispose()}};l.$registerTestController(t,i,!!n),s.add(Le(()=>l.$unregisterTestController(t)));const d={controller:u,collection:o,profiles:a,extension:e,activeProfiles:c};return this.controllers.set(t,d),s.add(Le(()=>this.controllers.delete(t))),s.add(o.onDidGenerateDiff(h=>l.$publishDiff(t,h.map(vd.serialize)))),u}createTestObserver(){return this.observer.checkout()}async runTests(e,t=It.None){var s,o;const i=P0(e);if(!i)throw new Error("The request passed to `vscode.test.runTests` must include a profile");const n=this.controllers.get(i.controllerId);if(!n)throw new Error("Controller not found");await this.proxy.$runTests({isUiTriggered:!1,targets:[{testIds:((s=e.include)==null?void 0:s.map(a=>we.fromExtHostTestItem(a,n.collection.root.id).toString()))??[n.collection.root.id],profileGroup:pw[i.kind],profileId:i.profileId,controllerId:i.controllerId}],exclude:(o=e.exclude)==null?void 0:o.map(a=>a.id)},t)}$syncTests(){for(const{collection:e}of this.controllers.values())e.flushDiff();return Promise.resolve()}async $provideFileCoverage(e,t,i){const n=this.runTracker.getCoverageReport(e,t);return await(n==null?void 0:n.provideFileCoverage(i))??[]}async $resolveFileCoverage(e,t,i,n){const s=this.runTracker.getCoverageReport(e,t);return await(s==null?void 0:s.resolveFileCoverage(i,n))??[]}$configureRunProfile(e,t){var i,n,s;(s=(n=(i=this.controllers.get(e))==null?void 0:i.profiles.get(t))==null?void 0:n.configureHandler)==null||s.call(n)}$setDefaultRunProfiles(e){const t=new Map;for(const[i,n]of Object.entries(e)){const s=this.controllers.get(i);if(!s)continue;const o=new Map,a=n.filter(l=>!s.activeProfiles.has(l)),c=[...s.activeProfiles].filter(l=>!n.includes(l));for(const l of a)o.set(l,!0),s.activeProfiles.add(l);for(const l of c)o.set(l,!1),s.activeProfiles.delete(l);o.size&&t.set(i,o)}this.defaultProfilesChangedEmitter.fire(t)}async $refreshTests(e,t){var i,n,s;await((s=(i=this.controllers.get(e))==null?void 0:(n=i.controller).refreshHandler)==null?void 0:s.call(n,t))}$publishTestResults(e){this.results=Object.freeze(e.map(t=>ag(Xm.to(t))).concat(this.results).sort((t,i)=>i.completedAt-t.completedAt).slice(0,32)),this.resultsChangedEmitter.fire()}async $expandTest(e,t){var n;const i=(n=this.controllers.get(we.fromString(e).controllerId))==null?void 0:n.collection;i&&(await i.expand(e,t<0?1/0:t),i.flushDiff())}$acceptDiff(e){this.observer.applyDiff(e.map(t=>vd.deserialize({asCanonicalUri:i=>i},t)))}async $runControllerTests(e,t){return Promise.all(e.map(i=>this.runControllerTestRequest(i,!1,t)))}async $startContinuousRun(e,t){const i=new mt(t),n=await Promise.all(e.map(s=>this.runControllerTestRequest(s,!0,i.token)));return!t.isCancellationRequested&&!n.some(s=>s.error)&&await new Promise(s=>t.onCancellationRequested(s)),i.dispose(!0),n}async runControllerTestRequest(e,t,i){const n=this.controllers.get(e.controllerId);if(!n)return{};const{collection:s,profiles:o,extension:a}=n,c=o.get(e.profileId);if(!c)return{};const l=e.testIds.map(g=>s.tree.get(g)).filter(bo),u=e.excludeExtIds.map(g=>n.collection.tree.get(g)).filter(bo).filter(g=>l.some(w=>w.fullId.compare(g.fullId)===2));if(!l.length)return{};const d=new lh(l.some(g=>g.actual instanceof kv)?void 0:l.map(g=>g.actual),u.map(g=>g.actual),c,t),h=q2(e)&&this.runTracker.prepareForMainThreadTestRun(d,Kl.fromInternal(e,n.collection),a,i);try{return await c.runHandler(d,i),{}}catch(g){return{error:String(g)}}finally{h&&(h.hasRunningTasks&&!i.isCancellationRequested&&await _t.toPromise(h.onEnd),h.dispose())}}$cancelExtensionTestRun(e){e===void 0?this.runTracker.cancelAllRuns():this.runTracker.cancelRunById(e)}};fw=H([N(0,Ve),N(1,Ge)],fw);const Q5=1e4;class J5 extends Be{get hasRunningTasks(){return this.tasks.size>0}get id(){return this.dto.id}constructor(e,t,i,n,s){super(),this.dto=e,this.proxy=t,this.extension=i,this.logService=n,this.state=0,this.tasks=new Map,this.sharedTestIds=new Set,this.endEmitter=this._register(new T),this.coverageEmitter=this._register(new T),this.onDidCoverage=this.coverageEmitter.event,this.onEnd=this.endEmitter.event,this.cts=this._register(new mt(s));const o=this._register(new _c(()=>this.forciblyEndTasks(),Q5));this._register(this.cts.token.onCancellationRequested(()=>o.schedule()))}cancel(){this.state===0?(this.cts.cancel(),this.state=1):this.state===1&&this.forciblyEndTasks()}createRun(e){const t=this.dto.id,i=this.dto.controllerId,n=xn(),s=this.extension,o=this.coverageEmitter;let a;const c=h=>(g,...w)=>{if(u){this.logService.warn(`Setting the state of test "${g.id}" is a no-op after the run ends.`);return}this.dto.isIncluded(g)&&(this.ensureTestIsKnown(g),h(g,...w))},l=(h,g)=>{const w=g instanceof Array?g.map(la.from):[la.from(g)];if(h.uri&&h.range){const p={range:F.from(h.range),uri:h.uri};for(const b of w)b.location=b.location||p}this.proxy.$appendTestMessagesInRun(t,n,we.fromExtHostTestItem(h,i).toString(),w)};let u=!1;const d={isPersisted:this.dto.isPersisted,token:this.cts.token,name:e,get coverageProvider(){return a==null?void 0:a.provider},set coverageProvider(h){M(s,"testCoverage"),a=h&&new X5(h),o.fire({taskId:n,runId:t,coverage:a})},enqueued:c(h=>{this.proxy.$updateTestStateInRun(t,n,we.fromExtHostTestItem(h,i).toString(),1)}),skipped:c(h=>{this.proxy.$updateTestStateInRun(t,n,we.fromExtHostTestItem(h,i).toString(),5)}),started:c(h=>{this.proxy.$updateTestStateInRun(t,n,we.fromExtHostTestItem(h,i).toString(),2)}),errored:c((h,g,w)=>{l(h,g),this.proxy.$updateTestStateInRun(t,n,we.fromExtHostTestItem(h,i).toString(),6,w)}),failed:c((h,g,w)=>{l(h,g),this.proxy.$updateTestStateInRun(t,n,we.fromExtHostTestItem(h,i).toString(),4,w)}),passed:c((h,g)=>{this.proxy.$updateTestStateInRun(t,n,we.fromExtHostTestItem(h,this.dto.controllerId).toString(),3,g)}),appendOutput:(h,g,w)=>{u||(w&&(this.dto.isIncluded(w)?this.ensureTestIsKnown(w):w=void 0),this.proxy.$appendOutputToRun(t,n,me.fromString(h),g&&_i.from(g),w&&we.fromExtHostTestItem(w,i).toString()))},end:()=>{u||(u=!0,this.proxy.$finishedTestRunTask(t,n),this.tasks.delete(n),this.tasks.size||this.markEnded())}};return this.tasks.set(n,{run:d}),this.proxy.$startedTestRunTask(t,{id:n,name:e,running:!0}),d}forciblyEndTasks(){for(const{run:e}of this.tasks.values())e.end()}markEnded(){this.state!==2&&(this.state=2,this.endEmitter.fire())}ensureTestIsKnown(e){if(!(e instanceof $s))throw new _d(e.id);if(this.sharedTestIds.has(we.fromExtHostTestItem(e,this.dto.controllerId).toString()))return;const t=[],i=this.dto.colllection.root;for(;;){const n=Sr.from(e);if(t.unshift(n),this.sharedTestIds.has(n.extId)||(this.sharedTestIds.add(n.extId),e===i))break;e=e.parent||i}this.proxy.$addTestsToRun(this.dto.controllerId,this.dto.id,t)}dispose(){this.markEnded(),super.dispose()}}class K5{get trackers(){return this.tracked.values()}constructor(e,t){this.proxy=e,this.logService=t,this.tracked=new Map,this.coverageReports=[]}getCoverageReport(e,t){var i;return(i=this.coverageReports.find(n=>n.runId===e))==null?void 0:i.coverage.get(t)}prepareForMainThreadTestRun(e,t,i,n){return this.getTracker(e,t,i,n)}cancelRunById(e){for(const t of this.tracked.values())if(t.id===e){t.cancel();return}}cancelAllRuns(){for(const e of this.tracked.values())e.cancel()}createTestRun(e,t,i,n,s,o){var d,h;const a=this.tracked.get(n);if(a)return a.createRun(s);const c=Kl.fromPublic(t,i,n,o),l=P0(n);this.proxy.$startedExtensionTestRun({controllerId:t,continuous:!!n.continuous,profile:l&&{group:pw[l.kind],id:l.profileId},exclude:((d=n.exclude)==null?void 0:d.map(g=>we.fromExtHostTestItem(g,i.root.id).toString()))??[],id:c.id,include:((h=n.include)==null?void 0:h.map(g=>we.fromExtHostTestItem(g,i.root.id).toString()))??[i.root.id],persist:o});const u=this.getTracker(n,c,e);return _t.once(u.onEnd)(()=>{this.proxy.$finishedExtensionTestRun(c.id),u.dispose()}),u.createRun(s)}getTracker(e,t,i,n){const s=new J5(t,this.proxy,i,this.logService,n);this.tracked.set(e,s);let o;const a=s.onDidCoverage(({runId:c,taskId:l,coverage:u})=>{o||(o={runId:c,coverage:new Map},this.coverageReports.unshift(o),this.coverageReports.length>G2&&this.coverageReports.pop()),o.coverage.set(l,u),this.proxy.$signalCoverageAvailable(c,l,!!u)});return _t.once(s.onEnd)(()=>{this.tracked.delete(e),a.dispose()}),s}}const P0=r=>{if(r.profile){if(!(r.profile instanceof T0))throw new Error("TestRunRequest.profile is not an instance created from TestController.createRunProfile");return r.profile}};class Kl{static fromPublic(e,t,i,n){var s,o;return new Kl(e,xn(),((s=i.include)==null?void 0:s.map(a=>we.fromExtHostTestItem(a,e).toString()))??[e],((o=i.exclude)==null?void 0:o.map(a=>we.fromExtHostTestItem(a,e).toString()))??[],n,t)}static fromInternal(e,t){return new Kl(e.controllerId,e.runId,e.testIds,e.excludeExtIds,!0,t)}constructor(e,t,i,n,s,o){this.controllerId=e,this.id=t,this.isPersisted=s,this.colllection=o,this.includePrefix=i.map(a=>a+"\0"),this.excludePrefix=n.map(a=>a+"\0")}isIncluded(e){const t=we.fromExtHostTestItem(e,this.controllerId).toString()+"\0";for(const i of this.excludePrefix)if(t===i||t.startsWith(i))return!1;for(const i of this.includePrefix)if(t===i||t.startsWith(i))return!0;return!1}}class X5{constructor(e){this.provider=e}async provideFileCoverage(e){this.fileCoverage||(this.fileCoverage=(async()=>this.provider.provideFileCoverage(e))());try{const t=await this.fileCoverage;return(t==null?void 0:t.map($h.fromFile))??[]}catch(t){throw this.fileCoverage=void 0,t}}async resolveFileCoverage(e,t){var s,o,a;const i=await this.fileCoverage;let n=i==null?void 0:i[e];return!this.provider||!i||!n?[]:(n.detailedCoverage||(n=i[e]=await((o=(s=this.provider).resolveFileCoverage)==null?void 0:o.call(s,n,t))??n),((a=n.detailedCoverage)==null?void 0:a.map($h.fromDetailed))??[])}}class Y5{get isEmpty(){return this.added.size===0&&this.removed.size===0&&this.updated.size===0}constructor(e){this.emitter=e,this.added=new Set,this.updated=new Set,this.removed=new Set,this.alreadyRemoved=new Set}add(e){this.added.add(e)}update(e){Object.assign(e.revived,Sr.toPlain(e.item)),this.added.has(e)||this.updated.add(e)}remove(e){if(this.added.has(e)){this.added.delete(e);return}this.updated.delete(e);const t=we.parentId(e.item.extId);if(t&&this.alreadyRemoved.has(t.toString())){this.alreadyRemoved.add(e.item.extId);return}this.removed.add(e)}getChangeEvent(){const{added:e,updated:t,removed:i}=this;return{get added(){return[...e].map(n=>n.revived)},get updated(){return[...t].map(n=>n.revived)},get removed(){return[...i].map(n=>n.revived)}}}complete(){this.isEmpty||this.emitter.fire(this.getChangeEvent())}}class Z5 extends Q2{constructor(){super(...arguments),this.changeEmitter=new T,this.onDidChangeTests=this.changeEmitter.event}get rootTests(){return this.roots}getMirroredTestDataById(e){return this.items.get(e)}getMirroredTestDataByReference(e){return this.items.get(e.id)}createItem(e,t){return{...e,revived:Sr.toPlain(e.item),depth:t?t.depth+1:0,children:new Set}}createChangeCollector(){return new Y5(this.changeEmitter)}}class eA{constructor(e){this.proxy=e}checkout(){this.current||(this.current=this.createObserverData());const e=this.current;return e.observers++,{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(t=>t.revived)},dispose:yp(()=>{--e.observers===0&&(this.proxy.$unsubscribeFromDiffs(),this.current=void 0)})}}getMirroredTestDataByReference(e){var t;return(t=this.current)==null?void 0:t.tests.getMirroredTestDataByReference(e)}applyDiff(e){var t;(t=this.current)==null||t.tests.apply(e)}createObserverData(){const e=new Z5({asCanonicalUri:t=>t});return this.proxy.$subscribeToDiffs(),{observers:0,tests:e}}}const Xl=(r,e,t,i)=>{t?Object.assign(t,i):e.$updateTestRunConfig(r.controllerId,r.profileId,i)};class T0{constructor(e,t,i,n,s,o,a,c,l,u=!1,d=void 0,h=!1){ae(this,ji,void 0);ae(this,ro,void 0);ae(this,mu,void 0);ae(this,yi,void 0);ae(this,Ba,void 0);this.controllerId=s,this.profileId=o,this._label=a,this.kind=c,this.runHandler=l,this._tag=d,this._supportsContinuousRun=h,K(this,ji,e),K(this,Ba,t),K(this,ro,i),K(this,mu,n),t.set(o,this);const g=pw[c];if(typeof g!="number")throw new Error(`Unknown TestRunProfile.group ${c}`);u&&i.add(o),K(this,yi,{profileId:o,controllerId:s,tag:d?Ui.namespace(this.controllerId,d.id):null,label:a,group:g,isDefault:u,hasConfigurationHandler:!1,supportsContinuousRun:h}),queueMicrotask(()=>{I(this,yi)&&(I(this,ji).$publishTestRunProfile(I(this,yi)),K(this,yi,void 0))})}get label(){return this._label}set label(e){e!==this._label&&(this._label=e,Xl(this,I(this,ji),I(this,yi),{label:e}))}get supportsContinuousRun(){return this._supportsContinuousRun}set supportsContinuousRun(e){e!==this._supportsContinuousRun&&(this._supportsContinuousRun=e,Xl(this,I(this,ji),I(this,yi),{supportsContinuousRun:e}))}get isDefault(){return I(this,ro).has(this.profileId)}set isDefault(e){e!==this.isDefault&&(e?I(this,ro).add(this.profileId):I(this,ro).delete(this.profileId),Xl(this,I(this,ji),I(this,yi),{isDefault:e}))}get tag(){return this._tag}set tag(e){var t;(e==null?void 0:e.id)!==((t=this._tag)==null?void 0:t.id)&&(this._tag=e,Xl(this,I(this,ji),I(this,yi),{tag:e?Ui.namespace(this.controllerId,e.id):null}))}get configureHandler(){return this._configureHandler}set configureHandler(e){e!==this._configureHandler&&(this._configureHandler=e,Xl(this,I(this,ji),I(this,yi),{hasConfigurationHandler:!!e}))}get onDidChangeDefault(){return _t.chain(I(this,mu),e=>e.map(t=>{var i;return(i=t.get(this.controllerId))==null?void 0:i.get(this.profileId)}).filter(bo))}dispose(){var e;(e=I(this,Ba))!=null&&e.delete(this.profileId)&&(K(this,Ba,void 0),I(this,ji).$removeTestProfile(this.controllerId,this.profileId)),K(this,yi,void 0)}}ji=new WeakMap,ro=new WeakMap,mu=new WeakMap,yi=new WeakMap,Ba=new WeakMap;const pw={[Zo.Coverage]:8,[Zo.Debug]:4,[Zo.Run]:2};class tA{constructor(e,t){this._extHostDocumentsAndEditors=t,this._onDidChangeTextEditorSelection=new T,this._onDidChangeTextEditorOptions=new T,this._onDidChangeTextEditorVisibleRanges=new T,this._onDidChangeTextEditorViewColumn=new T,this._onDidChangeActiveTextEditor=new T,this._onDidChangeVisibleTextEditors=new T,this.onDidChangeTextEditorSelection=this._onDidChangeTextEditorSelection.event,this.onDidChangeTextEditorOptions=this._onDidChangeTextEditorOptions.event,this.onDidChangeTextEditorVisibleRanges=this._onDidChangeTextEditorVisibleRanges.event,this.onDidChangeTextEditorViewColumn=this._onDidChangeTextEditorViewColumn.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this._proxy=e.getProxy(G.MainThreadTextEditors),this._extHostDocumentsAndEditors.onDidChangeVisibleTextEditors(i=>this._onDidChangeVisibleTextEditors.fire(i)),this._extHostDocumentsAndEditors.onDidChangeActiveTextEditor(i=>this._onDidChangeActiveTextEditor.fire(i))}getActiveTextEditor(){return this._extHostDocumentsAndEditors.activeEditor()}getVisibleTextEditors(e){const t=this._extHostDocumentsAndEditors.allEditors();return e?t:t.map(i=>i.value)}async showTextDocument(e,t,i){let n;typeof t=="number"?n={position:bt.from(t),preserveFocus:i}:typeof t=="object"?n={position:bt.from(t.viewColumn),preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?F.from(t.selection):void 0,pinned:typeof t.preview=="boolean"?!t.preview:void 0}:n={preserveFocus:!1};const s=await this._proxy.$tryShowTextDocument(e.uri,n),o=s&&this._extHostDocumentsAndEditors.getEditor(s);if(o)return o.value;throw s?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}createTextEditorDecorationType(e,t){return new Kv(this._proxy,e,t).value}$acceptEditorPropertiesChanged(e,t){const i=this._extHostDocumentsAndEditors.getEditor(e);if(!i)throw new Error("unknown text editor");if(t.options&&i._acceptOptions(t.options),t.selections){const n=t.selections.selections.map(Ii.to);i._acceptSelections(n)}if(t.visibleRanges){const n=Jt(t.visibleRanges.map(F.to));i._acceptVisibleRanges(n)}if(t.options&&this._onDidChangeTextEditorOptions.fire({textEditor:i.value,options:{...t.options,lineNumbers:sa.to(t.options.lineNumbers)}}),t.selections){const n=Bo.fromValue(t.selections.source),s=t.selections.selections.map(Ii.to);this._onDidChangeTextEditorSelection.fire({textEditor:i.value,selections:s,kind:n})}if(t.visibleRanges){const n=Jt(t.visibleRanges.map(F.to));this._onDidChangeTextEditorVisibleRanges.fire({textEditor:i.value,visibleRanges:n})}}$acceptEditorPositionData(e){for(const t in e){const i=this._extHostDocumentsAndEditors.getEditor(t);if(!i)throw new Error("Unknown text editor");const n=bt.to(e[t]);i.value.viewColumn!==n&&(i._acceptViewColumn(n),this._onDidChangeTextEditorViewColumn.fire({textEditor:i.value,viewColumn:n}))}}getDiffInformation(e){return Promise.resolve(this._proxy.$getDiffInformation(e))}}let gw=class{constructor(e){this._actual=new ih(_r.Dark),this._onDidChangeActiveColorTheme=new T}get activeColorTheme(){return this._actual}$onColorThemeChange(e){let t;switch(e){case"light":t=_r.Light;break;case"hcDark":t=_r.HighContrast;break;case"hcLight":t=_r.HighContrastLight;break;default:t=_r.Dark}this._actual=new ih(t),this._onDidChangeActiveColorTheme.fire(this._actual)}get onDidChangeActiveColorTheme(){return this._onDidChangeActiveColorTheme.event}};gw=H([N(0,Ve)],gw);class iA{constructor(e,t){this._providers=new Map,this._itemsBySourceAndUriMap=new Map,this._proxy=e.getProxy(G.MainThreadTimeline),t.registerArgumentProcessor({processArgument:(i,n)=>{var s,o,a;if(i&&i.$mid===12)if(this._providers.get(i.source)&&Xe.equals(n,(s=this._providers.get(i.source))==null?void 0:s.extension)){const c=i.uri===void 0?void 0:y.revive(i.uri);return(a=(o=this._itemsBySourceAndUriMap.get(i.source))==null?void 0:o.get(A0(c)))==null?void 0:a.get(i.handle)}else return;return i}})}async $getTimeline(e,t,i,n){const s=this._providers.get(e);return s==null?void 0:s.provider.provideTimeline(y.revive(t),i,n)}registerTimelineProvider(e,t,i,n){const s=new Ae,o=this.convertTimelineItem(t.id,n,s).bind(this);let a;t.onDidChange&&(a=t.onDidChange(l=>this._proxy.$emitTimelineChangeEvent({uri:void 0,reset:!0,...l,id:t.id}),this));const c=this._itemsBySourceAndUriMap;return this.registerTimelineProviderCore({...t,scheme:e,onDidChange:void 0,async provideTimeline(l,u,d){var w;u!=null&&u.resetCache&&(s.clear(),(w=c.get(t.id))==null||w.clear());const h=await t.provideTimeline(l,u,d);if(h==null)return;const g=o(l,u);return{...h,source:t.id,items:h.items.map(g)}},dispose(){var l;for(const u of c.values())(l=u.get(t.id))==null||l.clear();a==null||a.dispose(),s.dispose()}},i)}convertTimelineItem(e,t,i){return(n,s)=>{let o;if(s!=null&&s.cacheResults){let a=this._itemsBySourceAndUriMap.get(e);a===void 0&&(a=new Map,this._itemsBySourceAndUriMap.set(e,a));const c=A0(n);o=a.get(c),o===void 0&&(o=new Map,a.set(c,o))}return a=>{const{iconPath:c,...l}=a,u=`${e}|${a.id??a.timestamp}`;o==null||o.set(u,a);let d,h,g;a.iconPath&&(c instanceof Gt?g={id:c.id,color:c.color}:y.isUri(c)?(d=c,h=c):{light:d,dark:h}=c);let w;return Di.isMarkdownString(l.tooltip)?w=Te.from(l.tooltip):Ne(l.tooltip)?w=l.tooltip:Di.isMarkdownString(l.detail)?(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),w=Te.from(l.detail)):Ne(l.detail)&&(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),w=l.detail),{...l,id:l.id??void 0,handle:u,source:e,command:a.command?t.toInternal(a.command,i):void 0,icon:d,iconDark:h,themeIcon:g,tooltip:w,accessibilityInformation:a.accessibilityInformation}}}}registerTimelineProviderCore(e,t){if(this._providers.get(e.id))throw new Error(`Timeline Provider ${e.id} already exists.`);return this._proxy.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme}),this._providers.set(e.id,{provider:e,extension:t}),Le(()=>{var n;for(const s of this._itemsBySourceAndUriMap.values())(n=s.get(e.id))==null||n.clear();this._providers.delete(e.id),this._proxy.$unregisterTimelineProvider(e.id),e.dispose()})}}function A0(r){return r==null?void 0:r.toString()}const nA={IconContribution:"base.contributions.icons"};var R0;(function(r){function e(i){return{weight:i.weight,style:i.style,src:i.src.map(n=>({format:n.format,location:n.location.toString()}))}}r.toJSONObject=e;function t(i){const n=s=>Ne(s)?s:void 0;if(i&&Array.isArray(i.src)&&i.src.every(s=>Ne(s.format)&&Ne(s.location)))return{weight:n(i.weight),style:n(i.style),src:i.src.map(s=>({format:s.format,location:y.parse(s.location)}))}}r.fromJSONObject=t})(R0||(R0={}));class rA{constructor(){this._onDidChange=new T,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:m("vs/platform/theme/common/iconRegistry","iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:m("vs/platform/theme/common/iconRegistry","iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${Xt.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,n){const s=this.iconsById[e];if(s){if(i&&!s.description){s.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const c=this.iconReferenceSchema.enum.indexOf(e);c!==-1&&(this.iconReferenceSchema.enumDescriptions[c]=i),this._onDidChange.fire()}return s}const o={id:e,description:i,defaults:t,deprecationMessage:n};this.iconsById[e]=o;const a={$ref:"#/definitions/icons"};return n&&(a.deprecationMessage=n),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];const t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){const i=this.iconFontsById[e];return i||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){const e=(s,o)=>s.id.localeCompare(o.id),t=s=>{for(;Xt.isThemeIcon(s.defaults);)s=this.iconsById[s.defaults.id];return`codicon codicon-${s?s.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const n=Object.keys(this.iconsById).map(s=>this.iconsById[s]);for(const s of n.filter(o=>!!o.description).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|${Xt.isThemeIcon(s.defaults)?s.defaults.id:s.id}|${s.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const s of n.filter(o=>!Xt.isThemeIcon(o.defaults)).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|`);return i.join(`
`)}}const Yl=new rA;mi.add(nA.IconContribution,Yl);function Pf(r,e,t,i){return Yl.registerIcon(r,e,t,i)}function sA(){const r=qk();for(const e in r){const t="\\"+r[e].toString(16);Yl.registerIcon(e,{fontCharacter:t})}}sA();const L0="vscode://schemas/icons",O0=mi.as(hv.JSONContribution);O0.registerSchema(L0,Yl.getIconSchema());const $0=new _c(()=>O0.notifySchemaChanged(L0),200);Yl.onDidChange(()=>{$0.isScheduled()||$0.schedule()}),Pf("widget-close",ce.close,m("vs/platform/theme/common/iconRegistry","widgetClose","Icon for the close action in widgets.")),Pf("goto-previous-location",ce.arrowUp,m("vs/platform/theme/common/iconRegistry","previousChangeIcon","Icon for goto previous editor location.")),Pf("goto-next-location",ce.arrowDown,m("vs/platform/theme/common/iconRegistry","nextChangeIcon","Icon for goto next editor location.")),Xt.modify(ce.sync,"spin"),Xt.modify(ce.loading,"spin"),m("vs/workbench/common/views","views log","Views"),Pf("default-view-icon",ce.window,m("vs/workbench/common/views","defaultViewIcon","Default view icon."));var Tf;(function(r){r.ViewContainersRegistry="workbench.registry.view.containers",r.ViewsRegistry="workbench.registry.view"})(Tf||(Tf={}));var N0;(function(r){r[r.Sidebar=0]="Sidebar",r[r.Panel=1]="Panel",r[r.AuxiliaryBar=2]="AuxiliaryBar"})(N0||(N0={}));class oA extends Be{constructor(){super(...arguments),this._onDidRegister=this._register(new T),this.onDidRegister=this._onDidRegister.event,this._onDidDeregister=this._register(new T),this.onDidDeregister=this._onDidDeregister.event,this.viewContainers=new Map,this.defaultViewContainers=[]}get all(){return Iu([...this.viewContainers.values()])}registerViewContainer(e,t,i){const n=this.get(e.id);if(n)return n;const s=e;return s.openCommandActionDescriptor=i!=null&&i.doNotRegisterOpenCommand?void 0:s.openCommandActionDescriptor??{id:s.id},sS(this.viewContainers,t,[]).push(s),i!=null&&i.isDefault&&this.defaultViewContainers.push(s),this._onDidRegister.fire({viewContainer:s,viewContainerLocation:t}),s}deregisterViewContainer(e){for(const t of this.viewContainers.keys()){const i=this.viewContainers.get(t),n=i==null?void 0:i.indexOf(e);if(n!==-1){i==null||i.splice(n,1),i.length===0&&this.viewContainers.delete(t),this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(t=>this.getViewContainers(t).filter(i=>(i==null?void 0:i.id)===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(t=>this.getViewContainerLocation(t)===e)}}mi.add(Tf.ViewContainersRegistry,new oA);var Af;(function(r){r.Open="2_open",r.Debug="4_debug",r.SCM="5_scm",r.More="9_more"})(Af||(Af={}));function aA(r,e){const t=r.group??Af.More,i=e.group??Af.More;return t!==i?t.localeCompare(i):(r.order??5)-(e.order??5)}class cA extends Be{constructor(){super(...arguments),this._onViewsRegistered=this._register(new T),this.onViewsRegistered=this._onViewsRegistered.event,this._onViewsDeregistered=this._register(new T),this.onViewsDeregistered=this._onViewsDeregistered.event,this._onDidChangeContainer=this._register(new T),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeViewWelcomeContent=this._register(new T),this.onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event,this._viewContainers=[],this._views=new Map,this._viewWelcomeContents=new lS}registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:i})=>this.addViews(t,i)),this._onViewsRegistered.fire(e)}deregisterViews(e,t){const i=this.removeViews(e,t);i.length&&this._onViewsDeregistered.fire({views:i,viewContainer:t})}moveViews(e,t){for(const i of this._views.keys())if(i!==t){const n=this.removeViews(e,i);n.length&&(this.addViews(n,t),this._onDidChangeContainer.fire({views:n,from:i,to:t}))}}getViews(e){return this._views.get(e)||[]}getView(e){for(const t of this._viewContainers){const i=(this._views.get(t)||[]).filter(n=>n.id===e)[0];if(i)return i}return null}getViewContainer(e){for(const t of this._viewContainers)if((this._views.get(t)||[]).filter(n=>n.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this._viewWelcomeContents.add(e,t),this._onDidChangeViewWelcomeContent.fire(e),Le(()=>{this._viewWelcomeContents.delete(e,t),this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,t){const i=new Map;for(const[n,s]of t)this._viewWelcomeContents.add(e,s),i.set(n,Le(()=>{this._viewWelcomeContents.delete(e,s),this._onDidChangeViewWelcomeContent.fire(e)}));return this._onDidChangeViewWelcomeContent.fire(e),i}getViewWelcomeContent(e){const t=[];return this._viewWelcomeContents.forEach(e,i=>t.push(i)),t.sort(aA)}addViews(e,t){let i=this._views.get(t);i||(i=[],this._views.set(t,i),this._viewContainers.push(t));for(const n of e){if(this.getView(n.id)!==null)throw new Error(m("vs/workbench/common/views","duplicateId","A view with id '{0}' is already registered",n.id));i.push(n)}}removeViews(e,t){const i=this._views.get(t);if(!i)return[];const n=[],s=[];for(const o of i)e.includes(o)?n.push(o):s.push(o);return n.length&&(s.length?this._views.set(t,s):(this._views.delete(t),this._viewContainers.splice(this._viewContainers.indexOf(t),1))),n}}mi.add(Tf.ViewsRegistry,new cA),ne("viewDescriptorService");var F0;(function(r){r[r.Default=0]="Default",r[r.Expand=1]="Expand"})(F0||(F0={}));var M0;(function(r){r[r.None=0]="None",r[r.Collapsed=1]="Collapsed",r[r.Expanded=2]="Expanded"})(M0||(M0={}));class Bn extends Error{constructor(e){super(m("vs/workbench/common/views","treeView.notRegistered","No tree view with id '{0}' registered.",e)),this.name="NoTreeViewError"}static is(e){return e.name==="NoTreeViewError"}}class lA{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){const t=this._dragOperations.get(e);return this._dragOperations.delete(e),t}}addDragOperationTransfer(e,t){this._dragOperations.set(e,t)}}function H0(r,e){if(Ne(r))return{label:r};if(r&&typeof r=="object"&&typeof r.label=="string"){let t;return Array.isArray(r.highlights)&&(t=r.highlights.filter(i=>i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"),t=t.length?t:void 0),{label:r.label,highlights:t}}}class uA extends Be{constructor(e,t,i){super(),this._proxy=e,this.commands=t,this.logService=i,this.treeViews=new Map,this.treeDragAndDropService=new lA;function n(s){return s&&s.$treeViewId&&(s.$treeItemHandle||s.$selectedTreeItems||s.$focusedTreeItem)}t.registerArgumentProcessor({processArgument:s=>n(s)?this.convertArgument(s):Array.isArray(s)&&s.length>0?s.map(o=>n(o)?this.convertArgument(o):o):s})}registerTreeDataProvider(e,t,i){const n=this.createTreeView(e,{treeDataProvider:t},i);return{dispose:()=>n.dispose()}}createTreeView(e,t,i){var h,g,w,p;if(!t||!t.treeDataProvider)throw new Error("Options with treeDataProvider is mandatory");const n=((h=t.dragAndDropController)==null?void 0:h.dropMimeTypes)??[],s=((g=t.dragAndDropController)==null?void 0:g.dragMimeTypes)??[],o=!!((w=t.dragAndDropController)!=null&&w.handleDrag),a=!!((p=t.dragAndDropController)!=null&&p.handleDrop),c=this.createExtHostTreeView(e,t,i),l={showCollapseAll:!!t.showCollapseAll,canSelectMany:!!t.canSelectMany,dropMimeTypes:n,dragMimeTypes:s,hasHandleDrag:o,hasHandleDrop:a,manuallyManageCheckboxes:!!t.manageCheckboxStateManually},u=this._proxy.$registerTreeViewDataProvider(e,l),d={get onDidCollapseElement(){return c.onDidCollapseElement},get onDidExpandElement(){return c.onDidExpandElement},get selection(){return c.selectedElements},get onDidChangeSelection(){return c.onDidChangeSelection},get activeItem(){return M(i,"treeViewActiveItem"),c.focusedElement},get onDidChangeActiveItem(){return M(i,"treeViewActiveItem"),c.onDidChangeActiveItem},get visible(){return c.visible},get onDidChangeVisibility(){return c.onDidChangeVisibility},get onDidChangeCheckboxState(){return c.onDidChangeCheckboxState},get message(){return c.message},set message(b){ls(b)&&M(i,"treeViewMarkdownMessage"),c.message=b},get title(){return c.title},set title(b){c.title=b},get description(){return c.description},set description(b){c.description=b},get badge(){return c.badge},set badge(b){b!==void 0&&Xg.isViewBadge(b)?c.badge={value:Math.floor(Math.abs(b.value)),tooltip:b.tooltip}:b===void 0&&(c.badge=void 0)},reveal:(b,k)=>c.reveal(b,k),dispose:async()=>{await u,this.treeViews.delete(e),c.dispose()}};return this._register(d),d}$getChildren(e,t){const i=this.treeViews.get(e);return i?i.getChildren(t):Promise.reject(new Bn(e))}async $handleDrop(e,t,i,n,s,o,a,c){const l=this.treeViews.get(e);if(!l)return Promise.reject(new Bn(e));const u=Er.toDataTransfer(i,async d=>(await this._proxy.$resolveDropFileData(e,t,d)).buffer);return a===e&&c&&await this.addAdditionalTransferItems(u,l,c,s,o),l.onDrop(u,n,s)}async addAdditionalTransferItems(e,t,i,n,s){var a;const o=this.treeDragAndDropService.removeDragOperationTransfer(s);if(o)(a=await o)==null||a.forEach((c,l)=>{c&&e.set(l,c)});else if(s&&t.handleDrag){const c=t.handleDrag(i,e,n);this.treeDragAndDropService.addDragOperationTransfer(s,c),await c}return e}async $handleDrag(e,t,i,n){const s=this.treeViews.get(e);if(!s)return Promise.reject(new Bn(e));const o=await this.addAdditionalTransferItems(new Xc,s,t,n,i);if(!(!o||n.isCancellationRequested))return Er.from(o)}async $hasResolve(e){const t=this.treeViews.get(e);if(!t)throw new Bn(e);return t.hasResolve}$resolve(e,t,i){const n=this.treeViews.get(e);if(!n)throw new Bn(e);return n.resolveTreeItem(t,i)}$setExpanded(e,t,i){const n=this.treeViews.get(e);if(!n)throw new Bn(e);n.setExpanded(t,i)}$setSelectionAndFocus(e,t,i){const n=this.treeViews.get(e);if(!n)throw new Bn(e);n.setSelectionAndFocus(t,i)}$setVisible(e,t){const i=this.treeViews.get(e);if(!i){if(!t)return;throw new Bn(e)}i.setVisible(t)}$changeCheckboxState(e,t){const i=this.treeViews.get(e);if(!i)throw new Bn(e);i.setCheckboxState(t)}createExtHostTreeView(e,t,i){const n=this._register(new mw(e,t,this._proxy,this.commands.converter,this.logService,i));return this.treeViews.set(e,n),n}convertArgument(e){const t=this.treeViews.get(e.$treeViewId);return t&&"$treeItemHandle"in e?t.getExtensionElement(e.$treeItemHandle):t&&"$focusedTreeItem"in e&&e.$focusedTreeItem?t.focusedElement:null}}const Wa=class Wa extends Be{get visible(){return this._visible}get selectedElements(){return this._selectedHandles.map(e=>this.getExtensionElement(e)).filter(e=>!jt(e))}get focusedElement(){return this._focusedHandle?this.getExtensionElement(this._focusedHandle):void 0}constructor(e,t,i,n,s,o){if(super(),this.viewId=e,this.proxy=i,this.commands=n,this.logService=s,this.extension=o,this.roots=void 0,this.elements=new Map,this.nodes=new Map,this._visible=!1,this._selectedHandles=[],this._focusedHandle=void 0,this._onDidExpandElement=this._register(new T),this.onDidExpandElement=this._onDidExpandElement.event,this._onDidCollapseElement=this._register(new T),this.onDidCollapseElement=this._onDidCollapseElement.event,this._onDidChangeSelection=this._register(new T),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeActiveItem=this._register(new T),this.onDidChangeActiveItem=this._onDidChangeActiveItem.event,this._onDidChangeVisibility=this._register(new T),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDidChangeCheckboxState=this._register(new T),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidChangeData=this._register(new T),this.refreshPromise=Promise.resolve(),this.refreshQueue=Promise.resolve(),this._message="",this._title="",this._refreshCancellationSource=new mt,o.contributes&&o.contributes.views)for(const u in o.contributes.views)for(const d of o.contributes.views[u])d.id===e&&(this._title=d.name);this.dataProvider=t.treeDataProvider,this.dndController=t.dragAndDropController,this.dataProvider.onDidChangeTreeData&&this._register(this.dataProvider.onDidChangeTreeData(u=>this._onDidChangeData.fire({message:!1,element:u})));let a,c;const l=_t.debounce(this._onDidChangeData.event,(u,d)=>(u||(u={message:!1,elements:[]}),d.element!==!1&&(a||(a=new Promise(h=>c=h),this.refreshPromise=this.refreshPromise.then(()=>a)),Array.isArray(d.element)?u.elements.push(...d.element):u.elements.push(d.element)),d.message&&(u.message=!0),u),200,!0);this._register(l(({message:u,elements:d})=>{d.length&&(this.refreshQueue=this.refreshQueue.then(()=>{const h=c;return a=null,this.refresh(d).then(()=>h())})),u&&this.proxy.$setMessage(this.viewId,Te.fromStrict(this._message)??"")}))}async getChildren(e){const t=e?this.getExtensionElement(e):void 0;if(e&&!t)return this.logService.error(`No tree item with id '${e}' found.`),Promise.resolve([]);let i=this.getChildrenNodes(e);return i||(i=await this.fetchChildrenNodes(t)),i?i.map(n=>n.item):void 0}getExtensionElement(e){return this.elements.get(e)}reveal(e,t){t=t||{select:!0,focus:!1};const i=jt(t.select)?!0:t.select,n=jt(t.focus)?!1:t.focus,s=jt(t.expand)?!1:t.expand;return typeof this.dataProvider.getParent!="function"?Promise.reject(new Error("Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method")):e?this.refreshPromise.then(()=>this.resolveUnknownParentChain(e)).then(o=>this.resolveTreeNode(e,o[o.length-1]).then(a=>this.proxy.$reveal(this.viewId,{item:a.item,parentChain:o.map(c=>c.item)},{select:i,focus:n,expand:s})),o=>this.logService.error(o)):this.proxy.$reveal(this.viewId,void 0,{select:i,focus:n,expand:s})}get message(){return this._message}set message(e){this._message=e,this._onDidChangeData.fire({message:!0,element:!1})}get title(){return this._title}set title(e){this._title=e,this.proxy.$setTitle(this.viewId,e,this._description)}get description(){return this._description}set description(e){this._description=e,this.proxy.$setTitle(this.viewId,this._title,e)}get badge(){return this._badge}set badge(e){var t,i;((t=this._badge)==null?void 0:t.value)===(e==null?void 0:e.value)&&((i=this._badge)==null?void 0:i.tooltip)===(e==null?void 0:e.tooltip)||(this._badge=Nh.from(e),this.proxy.$setBadge(this.viewId,e))}setExpanded(e,t){const i=this.getExtensionElement(e);i&&(t?this._onDidExpandElement.fire(Object.freeze({element:i})):this._onDidCollapseElement.fire(Object.freeze({element:i})))}setSelectionAndFocus(e,t){const i=!er(this._selectedHandles,e);this._selectedHandles=e;const n=this._focusedHandle!==t;this._focusedHandle=t,i&&this._onDidChangeSelection.fire(Object.freeze({selection:this.selectedElements})),n&&this._onDidChangeActiveItem.fire(Object.freeze({activeItem:this.focusedElement}))}setVisible(e){e!==this._visible&&(this._visible=e,this._onDidChangeVisibility.fire(Object.freeze({visible:this._visible})))}async setCheckboxState(e){const t=(await Promise.all(e.map(async i=>{const n=this.getExtensionElement(i.treeItemHandle);return n?{extensionItem:n,treeItem:await this.dataProvider.getTreeItem(n),newState:i.newState?rn.Checked:rn.Unchecked}:Promise.resolve(void 0)}))).filter(i=>i!==void 0);t.forEach(i=>{i.treeItem.checkboxState=i.newState?rn.Checked:rn.Unchecked}),this._onDidChangeCheckboxState.fire({items:t.map(i=>[i.extensionItem,i.newState])})}async handleDrag(e,t,i){var s;const n=[];for(const o of e){const a=this.getExtensionElement(o);a&&n.push(a)}if(!(!((s=this.dndController)!=null&&s.handleDrag)||n.length===0))return await this.dndController.handleDrag(n,t,i),t}get hasHandleDrag(){var e;return!!((e=this.dndController)!=null&&e.handleDrag)}async onDrop(e,t,i){var s;const n=t?this.getExtensionElement(t):void 0;if(!(!n&&t||!((s=this.dndController)!=null&&s.handleDrop)))return Mt(()=>{var o;return(o=this.dndController)!=null&&o.handleDrop?this.dndController.handleDrop(n,e,i):void 0})}get hasResolve(){return!!this.dataProvider.resolveTreeItem}async resolveTreeItem(e,t){if(!this.dataProvider.resolveTreeItem)return;const i=this.elements.get(e);if(i){const n=this.nodes.get(i);if(n){const s=await this.dataProvider.resolveTreeItem(n.extensionItem,i,t)??n.extensionItem;return this.validateTreeItem(s),n.item.tooltip=this.getTooltip(s.tooltip),n.item.command=this.getCommand(n.disposableStore,s.command),n.item}}}resolveUnknownParentChain(e){return this.resolveParent(e).then(t=>t?this.resolveUnknownParentChain(t).then(i=>this.resolveTreeNode(t,i[i.length-1]).then(n=>(i.push(n),i))):Promise.resolve([]))}resolveParent(e){const t=this.nodes.get(e);return t?Promise.resolve(t.parent?this.elements.get(t.parent.item.handle):void 0):Mt(()=>this.dataProvider.getParent(e))}resolveTreeNode(e,t){const i=this.nodes.get(e);return i?Promise.resolve(i):Mt(()=>this.dataProvider.getTreeItem(e)).then(n=>this.createHandle(e,n,t,!0)).then(n=>this.getChildren(t?t.item.handle:void 0).then(()=>{const s=this.getExtensionElement(n);if(s){const o=this.nodes.get(s);if(o)return Promise.resolve(o)}throw new Error(`Cannot resolve tree item for element ${n} from extension ${this.extension.identifier.value}`)}))}getChildrenNodes(e){if(e){let t;if(typeof e=="string"){const i=this.getExtensionElement(e);t=i?this.nodes.get(i):void 0}else t=e;return t&&t.children||void 0}return this.roots}async fetchChildrenNodes(e){this.clearChildren(e);const t=new mt(this._refreshCancellationSource.token);try{const i=e?this.nodes.get(e):void 0,n=await this.dataProvider.getChildren(e);if(t.token.isCancellationRequested)return;const s=Jt(n||[]),o=await Promise.all(Jt(s).map(c=>this.dataProvider.getTreeItem(c)));if(t.token.isCancellationRequested)return;const a=o.map((c,l)=>c?this.createAndRegisterTreeNode(s[l],c,i):null);return Jt(a)}finally{t.dispose()}}refresh(e){if(e.some(i=>!i))return this._refreshCancellationSource.dispose(!0),this._refreshCancellationSource=new mt,this.clearAll(),this.proxy.$refresh(this.viewId);{const i=this.getHandlesToRefresh(e);if(i.length)return this.refreshHandles(i)}return Promise.resolve(void 0)}getHandlesToRefresh(e){const t=new Set,i=e.map(s=>this.nodes.get(s));for(const s of i)if(s&&!t.has(s.item.handle)){let o=s;for(;o&&o.parent&&i.findIndex(a=>o&&o.parent&&a&&a.item.handle===o.parent.item.handle)===-1;){const a=this.elements.get(o.parent.item.handle);o=a?this.nodes.get(a):void 0}o&&!o.parent&&t.add(s.item.handle)}const n=[];return t.forEach(s=>{const o=this.elements.get(s);if(o){const a=this.nodes.get(o);a&&(!a.parent||!t.has(a.parent.item.handle))&&n.push(s)}}),n}refreshHandles(e){const t={};return Promise.all(e.map(i=>this.refreshNode(i).then(n=>{n&&(t[i]=n.item)}))).then(()=>Object.keys(t).length?this.proxy.$refresh(this.viewId,t):void 0)}refreshNode(e){const t=this.getExtensionElement(e);if(t){const i=this.nodes.get(t);if(i)return this.clearChildren(t),Mt(()=>this.dataProvider.getTreeItem(t)).then(n=>{if(n){const s=this.createTreeNode(t,n,i.parent);return this.updateNodeCache(t,s,i,i.parent),i.dispose(),s}return null})}return Promise.resolve(null)}createAndRegisterTreeNode(e,t,i){const n=this.createTreeNode(e,t,i);if(t.id&&this.elements.has(n.item.handle))throw new Error(m("vs/workbench/api/common/extHostTreeViews","treeView.duplicateElement","Element with id {0} is already registered",t.id));return this.addNodeToCache(e,n),this.addNodeToParentCache(n,i),n}getTooltip(e){return Di.isMarkdownString(e)?Te.from(e):e}getCommand(e,t){return t?{...this.commands.toInternal(t,e),originalId:t.command}:void 0}getCheckbox(e){if(e.checkboxState===void 0)return;let t,i,n;return typeof e.checkboxState=="number"?t=e.checkboxState:(t=e.checkboxState.state,i=e.checkboxState.tooltip,n=e.checkboxState.accessibilityInformation),{isChecked:t===rn.Checked,tooltip:i,accessibilityInformation:n}}validateTreeItem(e){if(!Bd.isTreeItem(e,this.extension))throw new Error(`Extension ${this.extension.identifier.value} has provided an invalid tree item.`)}createTreeNode(e,t,i){this.validateTreeItem(t);const n=this._register(new Ae),s=this.createHandle(e,t,i),o=this.getLightIconPath(t);return{item:{handle:s,parentHandle:i?i.item.handle:void 0,label:H0(t.label),description:t.description,resourceUri:t.resourceUri,tooltip:this.getTooltip(t.tooltip),command:this.getCommand(n,t.command),contextValue:t.contextValue,icon:o,iconDark:this.getDarkIconPath(t)||o,themeIcon:this.getThemeIcon(t),collapsibleState:jt(t.collapsibleState)?Cs.None:t.collapsibleState,accessibilityInformation:t.accessibilityInformation,checkbox:this.getCheckbox(t)},extensionItem:t,parent:i,children:void 0,disposableStore:n,dispose(){n.dispose()}}}getThemeIcon(e){return e.iconPath instanceof Gt?e.iconPath:void 0}createHandle(e,{id:t,label:i,resourceUri:n},s,o){if(t)return`${Wa.ID_HANDLE_PREFIX}/${t}`;const a=H0(i),c=s?s.item.handle:Wa.LABEL_HANDLE_PREFIX;let l=a?a.label:n?ns(n):"";l=l.indexOf("/")!==-1?l.replace("/","//"):l;const u=this.nodes.has(e)?this.nodes.get(e).item.handle:void 0,d=this.getChildrenNodes(s)||[];let h,g=0;do{if(h=`${c}/${g}:${l}`,o||!this.elements.has(h)||u===h)break;g++}while(g<=d.length);return h}getLightIconPath(e){if(e.iconPath&&!(e.iconPath instanceof Gt))return typeof e.iconPath=="string"||y.isUri(e.iconPath)?this.getIconPath(e.iconPath):this.getIconPath(e.iconPath.light)}getDarkIconPath(e){if(e.iconPath&&!(e.iconPath instanceof Gt)&&e.iconPath.dark)return this.getIconPath(e.iconPath.dark)}getIconPath(e){return y.isUri(e)?e:y.file(e)}addNodeToCache(e,t){this.elements.set(t.item.handle,e),this.nodes.set(e,t)}updateNodeCache(e,t,i,n){this.elements.delete(t.item.handle),this.nodes.delete(e),t.item.handle!==i.item.handle&&this.elements.delete(i.item.handle),this.addNodeToCache(e,t);const s=this.getChildrenNodes(n)||[],o=s.filter(a=>a.item.handle===i.item.handle)[0];o&&s.splice(s.indexOf(o),1,t)}addNodeToParentCache(e,t){t?(t.children||(t.children=[]),t.children.push(e)):(this.roots||(this.roots=[]),this.roots.push(e))}clearChildren(e){if(e){const t=this.nodes.get(e);if(t){if(t.children)for(const i of t.children){const n=this.elements.get(i.item.handle);n&&this.clear(n)}t.children=void 0}}else this.clearAll()}clear(e){const t=this.nodes.get(e);if(t){if(t.children)for(const i of t.children){const n=this.elements.get(i.item.handle);n&&this.clear(n)}this.nodes.delete(e),this.elements.delete(t.item.handle),t.dispose()}}clearAll(){this.roots=void 0,this.elements.clear(),this.nodes.forEach(e=>e.dispose()),this.nodes.clear()}dispose(){super.dispose(),this._refreshCancellationSource.dispose(),this.clearAll(),this.proxy.$disposeTree(this.viewId)}};Wa.LABEL_HANDLE_PREFIX="0",Wa.ID_HANDLE_PREFIX="1";let mw=Wa;const ap=class ap{constructor(e){this._openers=new Map,this._proxy=e.getProxy(G.MainThreadUriOpeners)}registerExternalUriOpener(e,t,i,n){if(this._openers.has(t))throw new Error(`Opener with id '${t}' already registered`);const s=n.schemes.find(o=>!ap.supportedSchemes.has(o));if(s)throw new Error(`Scheme '${s}' is not supported. Only http and https are currently supported.`);return this._openers.set(t,i),this._proxy.$registerUriOpener(t,n.schemes,e,n.label),Le(()=>{this._openers.delete(t),this._proxy.$unregisterUriOpener(t)})}async $canOpenUri(e,t,i){const n=this._openers.get(e);if(!n)throw new Error(`Unknown opener with id: ${e}`);const s=y.revive(t);return n.canOpenExternalUri(s,i)}async $openUri(e,t,i){const n=this._openers.get(e);if(!n)throw new Error(`Unknown opener id: '${e}'`);return n.openExternalUri(y.revive(t.resolvedUri),{sourceUri:y.revive(t.sourceUri)},i)}};ap.supportedSchemes=new Set([Z.http,Z.https]);let vw=ap;const cp=class cp{constructor(e){this.handles=new $o,this.handlers=new Map,this._proxy=e.getProxy(G.MainThreadUrls)}registerUriHandler(e,t){const i=e.identifier;if(this.handles.has(i))throw new Error(`Protocol handler already registered for extension ${i}`);const n=cp.HandlePool++;return this.handles.add(i),this.handlers.set(n,t),this._proxy.$registerUriHandler(n,i,e.displayName||e.name),Le(()=>{this.handles.delete(i),this.handlers.delete(n),this._proxy.$unregisterUriHandler(n)})}$handleExternalUri(e,t){const i=this.handlers.get(e);if(!i)return Promise.resolve(void 0);try{i.handleUri(y.revive(t))}catch(n){mn(n)}return Promise.resolve(void 0)}async createAppUri(e){return y.revive(await this._proxy.$createAppUri(e))}};cp.HandlePool=0;let _w=cp;class dA extends Be{constructor(t,i,n,s){super();ae(this,Nr,void 0);ae(this,Fr,void 0);ae(this,vu,void 0);ae(this,Va,void 0);ae(this,_u,void 0);ae(this,so,void 0);ae(this,za,void 0);ae(this,Kn,void 0);ae(this,ja,void 0);ae(this,qa,void 0);ae(this,Mr,void 0);ae(this,Ga,void 0);ae(this,Qa,void 0);K(this,Kn,void 0),K(this,ja,!0),K(this,Mr,!1),K(this,Ga,this._register(new T)),this.onDidDispose=I(this,Ga).event,K(this,Qa,this._register(new T)),this.onDidChangeViewState=I(this,Qa).event,K(this,Nr,t),K(this,Fr,i),K(this,Va,n),K(this,vu,s.viewType),K(this,_u,s.panelOptions),K(this,Kn,s.viewColumn),K(this,so,s.title),K(this,qa,s.active)}dispose(){I(this,Mr)||(K(this,Mr,!0),I(this,Ga).fire(),I(this,Fr).$disposeWebview(I(this,Nr)),I(this,Va).dispose(),super.dispose())}get webview(){return this.assertNotDisposed(),I(this,Va)}get viewType(){return this.assertNotDisposed(),I(this,vu)}get title(){return this.assertNotDisposed(),I(this,so)}set title(t){this.assertNotDisposed(),I(this,so)!==t&&(K(this,so,t),I(this,Fr).$setTitle(I(this,Nr),t))}get iconPath(){return this.assertNotDisposed(),I(this,za)}set iconPath(t){this.assertNotDisposed(),I(this,za)!==t&&(K(this,za,t),I(this,Fr).$setIconPath(I(this,Nr),y.isUri(t)?{light:t,dark:t}:t))}get options(){return I(this,_u)}get viewColumn(){if(this.assertNotDisposed(),!(typeof I(this,Kn)=="number"&&I(this,Kn)<0))return I(this,Kn)}get active(){return this.assertNotDisposed(),I(this,qa)}get visible(){return this.assertNotDisposed(),I(this,ja)}_updateViewState(t){I(this,Mr)||(this.active!==t.active||this.visible!==t.visible||this.viewColumn!==t.viewColumn)&&(K(this,qa,t.active),K(this,ja,t.visible),K(this,Kn,t.viewColumn),I(this,Qa).fire({webviewPanel:this}))}reveal(t,i){this.assertNotDisposed(),I(this,Fr).$reveal(I(this,Nr),{viewColumn:typeof t>"u"?void 0:bt.from(t),preserveFocus:!!i})}assertNotDisposed(){if(I(this,Mr))throw new Error("Webview is disposed")}}Nr=new WeakMap,Fr=new WeakMap,vu=new WeakMap,Va=new WeakMap,_u=new WeakMap,so=new WeakMap,za=new WeakMap,Kn=new WeakMap,ja=new WeakMap,qa=new WeakMap,Mr=new WeakMap,Ga=new WeakMap,Qa=new WeakMap;class ww extends Be{static newHandle(){return xn()}constructor(e,t,i){super(),this.webviews=t,this.workspace=i,this._webviewPanels=new Map,this._serializers=new Map,this._proxy=e.getProxy(G.MainThreadWebviewPanels)}dispose(){super.dispose(),this._webviewPanels.forEach(e=>e.dispose()),this._webviewPanels.clear()}createWebviewPanel(e,t,i,n,s={}){const o=typeof n=="object"?n.viewColumn:n,a={viewColumn:bt.from(o),preserveFocus:typeof n=="object"&&!!n.preserveFocus},c=Ca(e),l=ww.newHandle();this._proxy.$createWebviewPanel(ff(e),l,t,{title:i,panelOptions:hA(s),webviewOptions:JC(e,this.workspace,s),serializeBuffersForPostMessage:c},a);const u=this.webviews.createNewWebview(l,s,e);return this.createNewWebviewPanel(l,t,i,o,s,u,!0)}$onDidChangeWebviewPanelViewStates(e){const t=Object.keys(e);t.sort((i,n)=>{const s=e[i],o=e[n];return s.active?1:o.active?-1:+s.visible-+o.visible});for(const i of t){const n=this.getWebviewPanel(i);if(!n)continue;const s=e[i];n._updateViewState({active:s.active,visible:s.visible,viewColumn:bt.to(s.position)})}}async $onDidDisposeWebviewPanel(e){const t=this.getWebviewPanel(e);t==null||t.dispose(),this._webviewPanels.delete(e),this.webviews.deleteWebview(e)}registerWebviewPanelSerializer(e,t,i){if(this._serializers.has(t))throw new Error(`Serializer for '${t}' already registered`);return this._serializers.set(t,{serializer:i,extension:e}),this._proxy.$registerSerializer(t,{serializeBuffersForPostMessage:Ca(e)}),new Pe(()=>{this._serializers.delete(t),this._proxy.$unregisterSerializer(t)})}async $deserializeWebviewPanel(e,t,i,n){const s=this._serializers.get(t);if(!s)throw new Error(`No serializer found for '${t}'`);const{serializer:o,extension:a}=s,c=this.webviews.createNewWebview(e,i.webviewOptions,a),l=this.createNewWebviewPanel(e,t,i.title,n,i.panelOptions,c,i.active);await o.deserializeWebviewPanel(l,i.state)}createNewWebviewPanel(e,t,i,n,s,o,a){const c=new dA(e,this._proxy,o,{viewType:t,title:i,viewColumn:n,panelOptions:s,active:a});return this._webviewPanels.set(e,c),c}getWebviewPanel(e){return this._webviewPanels.get(e)}}function hA(r){return{enableFindWidget:r.enableFindWidget,retainContextWhenHidden:r.retainContextWhenHidden}}class fA extends Be{constructor(t,i,n,s,o,a){super();ae(this,Hr,void 0);ae(this,Ur,void 0);ae(this,wu,void 0);ae(this,Ja,void 0);ae(this,Br,void 0);ae(this,oo,void 0);ae(this,ao,void 0);ae(this,Ka,void 0);ae(this,co,void 0);ae(this,Xa,void 0);ae(this,Ya,void 0);K(this,Br,!1),K(this,Xa,this._register(new T)),this.onDidChangeVisibility=I(this,Xa).event,K(this,Ya,this._register(new T)),this.onDidDispose=I(this,Ya).event,K(this,wu,n),K(this,ao,s),K(this,Hr,t),K(this,Ur,i),K(this,Ja,o),K(this,oo,a)}dispose(){I(this,Br)||(K(this,Br,!0),I(this,Ya).fire(),I(this,Ja).dispose(),super.dispose())}get title(){return this.assertNotDisposed(),I(this,ao)}set title(t){this.assertNotDisposed(),I(this,ao)!==t&&(K(this,ao,t),I(this,Ur).$setWebviewViewTitle(I(this,Hr),t))}get description(){return this.assertNotDisposed(),I(this,Ka)}set description(t){this.assertNotDisposed(),I(this,Ka)!==t&&(K(this,Ka,t),I(this,Ur).$setWebviewViewDescription(I(this,Hr),t))}get visible(){return I(this,oo)}get webview(){return I(this,Ja)}get viewType(){return I(this,wu)}_setVisible(t){t===I(this,oo)||I(this,Br)||(K(this,oo,t),I(this,Xa).fire())}get badge(){return this.assertNotDisposed(),I(this,co)}set badge(t){var i,n;this.assertNotDisposed(),!((t==null?void 0:t.value)===((i=I(this,co))==null?void 0:i.value)&&(t==null?void 0:t.tooltip)===((n=I(this,co))==null?void 0:n.tooltip))&&(K(this,co,Nh.from(t)),I(this,Ur).$setWebviewViewBadge(I(this,Hr),t))}show(t){this.assertNotDisposed(),I(this,Ur).$show(I(this,Hr),!!t)}assertNotDisposed(){if(I(this,Br))throw new Error("Webview is disposed")}}Hr=new WeakMap,Ur=new WeakMap,wu=new WeakMap,Ja=new WeakMap,Br=new WeakMap,oo=new WeakMap,ao=new WeakMap,Ka=new WeakMap,co=new WeakMap,Xa=new WeakMap,Ya=new WeakMap;class pA{constructor(e,t){this._extHostWebview=t,this._viewProviders=new Map,this._webviewViews=new Map,this._proxy=e.getProxy(G.MainThreadWebviewViews)}registerWebviewViewProvider(e,t,i,n){if(this._viewProviders.has(t))throw new Error(`View provider for '${t}' already registered`);return this._viewProviders.set(t,{provider:i,extension:e}),this._proxy.$registerWebviewViewProvider(ff(e),t,{retainContextWhenHidden:n==null?void 0:n.retainContextWhenHidden,serializeBuffersForPostMessage:Ca(e)}),new Pe(()=>{this._viewProviders.delete(t),this._proxy.$unregisterWebviewViewProvider(t)})}async $resolveWebviewView(e,t,i,n,s){const o=this._viewProviders.get(t);if(!o)throw new Error(`No view provider found for '${t}'`);const{provider:a,extension:c}=o,l=this._extHostWebview.createNewWebview(e,{},c),u=new fA(e,this._proxy,t,i,l,!0);this._webviewViews.set(e,u),await a.resolveWebviewView(u,{state:n},s)}async $onDidChangeWebviewViewVisibility(e,t){this.getWebviewView(e)._setVisible(t)}async $disposeWebviewView(e){const t=this.getWebviewView(e);this._webviewViews.delete(e),t.dispose(),this._extHostWebview.deleteWebview(e)}getWebviewView(e){const t=this._webviewViews.get(e);if(!t)throw new Error("No webview found");return t}}new re("debugType",void 0,{type:"string",description:m("vs/workbench/contrib/debug/common/debug","debugType","Debug type of the active debug session. For example 'python'.")}),new re("debugConfigurationType",void 0,{type:"string",description:m("vs/workbench/contrib/debug/common/debug","debugConfigurationType","Debug type of the selected launch configuration. For example 'python'.")}),new re("debugState","inactive",{type:"string",description:m("vs/workbench/contrib/debug/common/debug","debugState","State that the focused debug session is in. One of the following: 'inactive', 'initializing', 'stopped' or 'running'.")});const gA="debugUx";new re(gA,"default",{type:"string",description:m("vs/workbench/contrib/debug/common/debug","debugUX","Debug UX state. When there are no debug configurations it is 'simple', otherwise 'default'. Used to decide when to show welcome views in the debug viewlet.")}),new re("hasDebugged",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","hasDebugged","True when a debug session has been started at least once, false otherwise.")}),new re("inDebugMode",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","inDebugMode","True when debugging, false otherwise.")}),new re("inDebugRepl",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","inDebugRepl","True when focus is in the debug console, false otherwise.")}),new re("breakpointWidgetVisible",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","breakpointWidgetVisibile","True when breakpoint editor zone widget is visible, false otherwise.")}),new re("inBreakpointWidget",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","inBreakpointWidget","True when focus is in the breakpoint editor zone widget, false otherwise.")}),new re("breakpointsFocused",!0,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","breakpointsFocused","True when the BREAKPOINTS view is focused, false otherwise.")}),new re("watchExpressionsFocused",!0,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","watchExpressionsFocused","True when the WATCH view is focused, false otherwsie.")}),new re("watchExpressionsExist",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","watchExpressionsExist","True when at least one watch expression exists, false otherwise.")}),new re("variablesFocused",!0,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","variablesFocused","True when the VARIABLES views is focused, false otherwsie")}),new re("expressionSelected",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","expressionSelected","True when an expression input box is open in either the WATCH or the VARIABLES view, false otherwise.")}),new re("breakpointInputFocused",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","breakpointInputFocused","True when the input box has focus in the BREAKPOINTS view.")}),new re("callStackItemType",void 0,{type:"string",description:m("vs/workbench/contrib/debug/common/debug","callStackItemType","Represents the item type of the focused element in the CALL STACK view. For example: 'session', 'thread', 'stackFrame'")}),new re("callStackSessionIsAttach",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","callStackSessionIsAttach","True when the session in the CALL STACK view is attach, false otherwise. Used internally for inline menus in the CALL STACK view.")}),new re("callStackItemStopped",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","callStackItemStopped","True when the focused item in the CALL STACK is stopped. Used internaly for inline menus in the CALL STACK view.")}),new re("callStackSessionHasOneThread",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","callStackSessionHasOneThread","True when the focused session in the CALL STACK view has exactly one thread. Used internally for inline menus in the CALL STACK view.")}),new re("watchItemType",void 0,{type:"string",description:m("vs/workbench/contrib/debug/common/debug","watchItemType","Represents the item type of the focused element in the WATCH view. For example: 'expression', 'variable'")}),new re("canViewMemory",void 0,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","canViewMemory","Indicates whether the item in the view has an associated memory refrence.")}),new re("breakpointItemType",void 0,{type:"string",description:m("vs/workbench/contrib/debug/common/debug","breakpointItemType","Represents the item type of the focused element in the BREAKPOINTS view. For example: 'breakpoint', 'exceptionBreakppint', 'functionBreakpoint', 'dataBreakpoint'")}),new re("breakpointHasModes",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","breakpointHasModes","Whether the breakpoint has multiple modes it can switch to.")}),new re("breakpointSupportsCondition",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","breakpointSupportsCondition","True when the focused breakpoint supports conditions.")}),new re("loadedScriptsSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","loadedScriptsSupported","True when the focused sessions supports the LOADED SCRIPTS view")}),new re("loadedScriptsItemType",void 0,{type:"string",description:m("vs/workbench/contrib/debug/common/debug","loadedScriptsItemType","Represents the item type of the focused element in the LOADED SCRIPTS view.")}),new re("focusedSessionIsAttach",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","focusedSessionIsAttach","True when the focused session is 'attach'.")}),new re("focusedSessionIsNoDebug",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","focusedSessionIsNoDebug","True when the focused session is run without debugging.")}),new re("stepBackSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","stepBackSupported","True when the focused session supports 'stepBack' requests.")}),new re("restartFrameSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","restartFrameSupported","True when the focused session supports 'restartFrame' requests.")}),new re("stackFrameSupportsRestart",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","stackFrameSupportsRestart","True when the focused stack frame suppots 'restartFrame'.")}),new re("jumpToCursorSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","jumpToCursorSupported","True when the focused session supports 'jumpToCursor' request.")}),new re("stepIntoTargetsSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","stepIntoTargetsSupported","True when the focused session supports 'stepIntoTargets' request.")}),new re("breakpointsExist",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","breakpointsExist","True when at least one breakpoint exists.")}),new re("debuggersAvailable",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","debuggersAvailable","True when there is at least one debug extensions active.")}),new re("debugExtensionAvailable",!0,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","debugExtensionsAvailable","True when there is at least one debug extension installed and enabled.")}),new re("debugProtocolVariableMenuContext",void 0,{type:"string",description:m("vs/workbench/contrib/debug/common/debug","debugProtocolVariableMenuContext","Represents the context the debug adapter sets on the focused variable in the VARIABLES view.")}),new re("debugSetVariableSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","debugSetVariableSupported","True when the focused session supports 'setVariable' request.")}),new re("debugSetExpressionSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","debugSetExpressionSupported","True when the focused session supports 'setExpression' request.")}),new re("breakWhenValueChangesSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","breakWhenValueChangesSupported","True when the focused session supports to break when value changes.")}),new re("breakWhenValueIsAccessedSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","breakWhenValueIsAccessedSupported","True when the focused breakpoint supports to break when value is accessed.")}),new re("breakWhenValueIsReadSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","breakWhenValueIsReadSupported","True when the focused breakpoint supports to break when value is read.")}),new re("terminateDebuggeeSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","terminateDebuggeeSupported","True when the focused session supports the terminate debuggee capability.")}),new re("suspendDebuggeeSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","suspendDebuggeeSupported","True when the focused session supports the suspend debuggee capability.")}),new re("variableEvaluateNamePresent",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","variableEvaluateNamePresent","True when the focused variable has an 'evalauteName' field set.")}),new re("variableIsReadonly",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","variableIsReadonly","True when the focused variable is read-only.")}),new re("variableValue",!1,{type:"string",description:m("vs/workbench/contrib/debug/common/debug","variableValue","Value of the variable, present for debug visualization clauses.")}),new re("variableType",!1,{type:"string",description:m("vs/workbench/contrib/debug/common/debug","variableType","Type of the variable, present for debug visualization clauses.")}),new re("variableName",!1,{type:"string",description:m("vs/workbench/contrib/debug/common/debug","variableName","Name of the variable, present for debug visualization clauses.")}),new re("variableLanguage",!1,{type:"string",description:m("vs/workbench/contrib/debug/common/debug","variableLanguage","Language of the variable source, present for debug visualization clauses.")}),new re("variableExtensionId",!1,{type:"string",description:m("vs/workbench/contrib/debug/common/debug","variableExtensionId","Extension ID of the variable source, present for debug visualization clauses.")}),new re("exceptionWidgetVisible",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","exceptionWidgetVisible","True when the exception widget is visible.")}),new re("multiSessionRepl",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","multiSessionRepl","True when there is more than 1 debug console.")}),new re("multiSessionDebug",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","multiSessionDebug","True when there is more than 1 active debug session.")}),new re("disassembleRequestSupported",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","disassembleRequestSupported","True when the focused sessions supports disassemble request.")}),new re("disassemblyViewFocus",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","disassemblyViewFocus","True when the Disassembly View is focused.")}),new re("languageSupportsDisassembleRequest",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","languageSupportsDisassembleRequest","True when the language in the current editor supports disassemble request.")}),new re("focusedStackFrameHasInstructionReference",!1,{type:"boolean",description:m("vs/workbench/contrib/debug/common/debug","focusedStackFrameHasInstructionReference","True when the focused stack frame has instruction pointer reference.")}),m("vs/workbench/contrib/debug/common/debug","internalConsoleOptions","Controls when the internal Debug Console should open.");var Rf;(function(r){r[r.Initial=1]="Initial",r[r.Dynamic=2]="Dynamic"})(Rf||(Rf={}));var U0;(function(r){r.UnverifiedBreakpoints="unverifiedBreakpoints"})(U0||(U0={})),ne("debugService");var B0;(function(r){r.deserialize=e=>({id:e.id,name:e.name,iconPath:e.iconPath&&{light:y.revive(e.iconPath.light),dark:y.revive(e.iconPath.dark)},iconClass:e.iconClass,visualization:e.visualization}),r.serialize=e=>e})(B0||(B0={}));var bw;(function(r){r[r.Information=1]="Information",r[r.Warning=2]="Warning"})(bw||(bw={}));function mA(r){const e=r.get(Ut),t=r.get(ko),i=r.get(Yh),n=r.get(Ir),s=r.get(An),o=r.get(Zh),a=r.get(Rn),c=r.get(Yu),l=r.get(Ve),u=r.get(vv),d=r.get(wv),h=r.get(So),g=r.get(Ge),w=r.get(Sv),p=r.get(rf),b=r.get(RC),k=r.get(Fv),D=r.get($l),C=r.get(Uv);l.set(ie.ExtHostFileSystemInfo,t),l.set(ie.ExtHostLogLevelServiceShape,h),l.set(ie.ExtHostWorkspace,s),l.set(ie.ExtHostConfiguration,a),l.set(ie.ExtHostExtensionService,n),l.set(ie.ExtHostStorage,u),l.set(ie.ExtHostTunnelService,w),l.set(ie.ExtHostWindow,b),l.set(ie.ExtHostSecretState,k),l.set(ie.ExtHostTelemetry,o),l.set(ie.ExtHostEditorTabs,D),l.set(ie.ExtHostManagedSockets,C);const R=l.set(ie.ExtHostDecorations,r.get(wC)),A=l.set(ie.ExtHostDocumentsAndEditors,r.get(Rl)),B=l.set(ie.ExtHostCommands,r.get(_a)),Q=l.set(ie.ExtHostTerminalService,r.get(Dl)),ee=l.set(ie.ExtHostDebugService,r.get(PC)),ue=l.set(ie.ExtHostSearch,r.get(TC)),Re=l.set(ie.ExtHostTask,r.get(SC)),q=l.set(ie.ExtHostOutputService,r.get(_C)),U=l.set(ie.ExtHostLocalization,r.get(Hv)),J=l.set(ie.ExtHostUrls,new _w(l)),j=l.set(ie.ExtHostDocuments,new QT(l,A)),oe=l.set(ie.ExtHostDocumentContentProviders,new A_(l,A,g)),ge=l.set(ie.ExtHostDocumentSaveParticipant,new GT(g,j,l.getProxy(G.MainThreadBulkEdits))),le=l.set(ie.ExtHostNotebook,new Y_(l,B,A,j,i,ue)),Ye=l.set(ie.ExtHostNotebookDocuments,new I5(le)),Ze=l.set(ie.ExtHostNotebookEditors,new Z_(g,le)),kt=l.set(ie.ExtHostNotebookKernels,new ew(l,e,le,B,g)),Qt=l.set(ie.ExtHostNotebookRenderers,new A5(l,le)),vt=l.set(ie.ExtHostNotebookDocumentSaveParticipant,new D5(g,le,l.getProxy(G.MainThreadBulkEdits))),ct=l.set(ie.ExtHostEditors,new tA(l,A)),ft=l.set(ie.ExtHostTreeViews,new uA(l.getProxy(G.MainThreadTreeViews),B,g)),xi=l.set(ie.ExtHostEditorInsets,new kT(l.getProxy(G.MainThreadEditorInsets),ct,e.remote)),Nt=l.set(ie.ExtHostDiagnostics,new T_(l,g,t,A)),qi=l.set(ie.ExtHostLanguages,new c5(l,j,B.converter,c)),ye=l.set(ie.ExtHostLanguageFeatures,new U_(l,c,j,B,Nt,g,p,o)),Pw=l.set(ie.ExtHostFileSystem,new vf(l,ye)),fn=l.set(ie.ExtHostFileSystemEventService,new i5(l,g,A)),Wr=l.set(ie.ExtHostQuickOpen,N5(l,s,B)),bu=l.set(ie.ExtHostSCM,new lw(l,B,j,g)),Xn=l.set(ie.ExtHostQuickDiff,new rw(l,c)),Yn=l.set(ie.ExtHostShare,new uw(l,c)),Tw=l.set(ie.ExtHostComments,DT(l,B,j)),lp=l.set(ie.ExtHostProgress,new O5(l.getProxy(G.MainThreadProgress))),He=l.set(ie.ExtHostLabelService,new o5(l)),up=l.set(ie.ExtHostTheming,new gw(l)),Vr=l.set(ie.ExtHostAuthentication,new vT(l)),dp=l.set(ie.ExtHostTimeline,new iA(l,B)),pn=l.set(ie.ExtHostWebviews,new NT(l,e.remote,s,g,p)),yu=l.set(ie.ExtHostWebviewPanels,new ww(l,pn,s)),Aw=l.set(ie.ExtHostCustomEditors,new WT(l,j,d,pn,yu)),Rw=l.set(ie.ExtHostWebviewViews,new pA(l,pn)),lo=l.set(ie.ExtHostTesting,new fw(l,g,B,A)),Gi=l.set(ie.ExtHostUriOpeners,new vw(l)),Lw=l.set(ie.ExtHostProfileContentHandlers,new R5(l));l.set(ie.ExtHostInteractive,new r5(l,le,A,B,g));const Ow=l.set(ie.ExtHostInlineChat,new O_(l,B,j,g)),ec=l.set(ie.ExtHostChatProvider,new D_(l,g,Vr)),$w=l.set(ie.ExtHostChatAgents2,new k_(l,g,B)),tc=l.set(ie.ExtHostChatVariables,new I_(l)),zr=l.set(ie.ExtHostChat,new E_(l)),ic=l.set(ie.ExtHostAiRelatedInformation,new dT(l)),hp=l.set(ie.ExtHostAiEmbeddingVector,new JT(l)),nc=l.set(ie.ExtHostIssueReporter,new s5(l)),rc=l.set(ie.ExtHostStatusBar,new G5(l,B.converter)),sc=l.set(ie.ExtHostSpeech,new dw(l)),fi=Object.values(ie);l.assertRegistered(fi);const uo=new C_(l,A),lt=new CT(l),xu=new B_(l,g),fp=new qT(l);return mT.register(B),function(E,gn,pp){function de(v){return(_,S,z)=>{const ke=v(Ke=>{try{_.call(S,Ke)}catch(Dt){mp(new Error(`[ExtensionListenerError] Extension '${E.identifier.value}' FAILED to handle event: ${Dt.toString()}`,{cause:Dt})),o.onExtensionError(E.identifier,Dt)}});return z==null||z.push(ke),ke}}const Ue=function(){let v=!E.isUnderDevelopment;function _(){v||(g.info(`Extension '${E.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`),v=!0)}return function S(z){if(Array.isArray(z))z.forEach(S);else if(typeof z=="string")_();else{const ke=z;typeof ke.scheme>"u"&&_(),typeof ke.exclusive=="boolean"&&M(E,"documentFiltersExclusive")}return z}}(),Nw={getSession(v,_,S){return Vr.getSession(E,v,_,S)},getSessions(v,_){return M(E,"authGetSessions"),Vr.getSessions(E,v,_)},async hasSession(v,_){return M(E,"authSession"),!!await Vr.getSession(E,v,_,{silent:!0})},get onDidChangeSessions(){return de(Vr.onDidChangeSessions)},registerAuthenticationProvider(v,_,S,z){return Vr.registerAuthenticationProvider(v,_,S,z)}},Fw={registerCommand(v,_,S){return B.registerCommand(!0,v,_,S,void 0,E)},registerTextEditorCommand(v,_,S){return B.registerCommand(!0,v,(...z)=>{const ke=ct.getActiveTextEditor();if(!ke){g.warn("Cannot execute "+v+" because there is no active text editor.");return}return ke.edit(Ke=>{_.apply(S,[ke,Ke,...z])}).then(Ke=>{Ke||g.warn("Edits from command "+v+" were not applied.")},Ke=>{g.warn("An error occurred while running command "+v,Ke)})},void 0,void 0,E)},registerDiffInformationCommand:(v,_,S)=>(M(E,"diffCommand"),B.registerCommand(!0,v,async(...z)=>{const ke=A.activeEditor(!0);if(!ke){g.warn("Cannot execute "+v+" because there is no active text editor.");return}const Ke=await ct.getDiffInformation(ke.id);_.apply(S,[Ke,...z])},void 0,void 0,E)),executeCommand(v,..._){return B.executeCommand(v,..._)},getCommands(v=!1){return B.getCommands(v)}},Mw={get machineId(){return e.telemetryInfo.machineId},get sessionId(){return e.telemetryInfo.sessionId},get language(){return e.environment.appLanguage},get appName(){return e.environment.appName},get appRoot(){var v;return((v=e.environment.appRoot)==null?void 0:v.fsPath)??""},get appHost(){return e.environment.appHost},get uriScheme(){return e.environment.appUriScheme},get clipboard(){return lt.value},get shell(){return Q.getDefaultShell(!1)},get onDidChangeShell(){return de(Q.onDidChangeShell)},get isTelemetryEnabled(){return o.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return de(o.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){return M(E,"telemetry"),o.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){return M(E,"telemetry"),de(o.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return Gx(e.telemetryInfo.firstSessionDate)},createTelemetryLogger(v,_){return qx.validateSender(v),o.instantiateLogger(E,v,_)},openExternal(v,_){return b.openUri(v,{allowTunneling:!!e.remote.authority,allowContributedOpeners:_==null?void 0:_.allowContributedOpeners})},async asExternalUri(v){if(v.scheme===e.environment.appUriScheme)return J.createAppUri(v);try{return await b.asExternalUri(v,{allowTunneling:!!e.remote.authority})}catch(_){if(zp(v,Z.http)||zp(v,Z.https))return v;throw _}},get remoteName(){return kg(e.remote.authority)},get remoteAuthority(){return M(E,"resolvers"),e.remote.authority},get uiKind(){return e.uiKind},get logLevel(){return g.getLevel()},get onDidChangeLogLevel(){return de(g.onDidChangeLogLevel)},registerIssueUriRequestHandler(v){return M(E,"handleIssueUri"),nc.registerIssueUriRequestHandler(E,v)},registerIssueDataProvider(v){return M(E,"handleIssueUri"),nc.registerIssueDataProvider(E,v)},get appQuality(){return M(E,"resolvers"),e.quality},get appCommit(){return M(E,"resolvers"),e.commit}},Hw={createTestController(v,_,S){return lo.createTestController(E,v,_,S)},createTestObserver(){return M(E,"testObserver"),lo.createTestObserver()},runTests(v){return M(E,"testObserver"),lo.runTests(v)},get onDidChangeTestResults(){return M(E,"testObserver"),de(lo.onResultsChanged)},get testResults(){return M(E,"testObserver"),lo.results}},oc=e.remote.isRemote?ks.Workspace:ks.UI,ac={getExtension(v,_){Tt(E,"extensionsAny")||(_=!1);const S=gn.mine.getExtensionDescription(v);if(S)return new Pl(n,E.identifier,S,oc,!1);if(_){const z=gn.all.getExtensionDescription(v);if(z)return new Pl(n,E.identifier,z,oc,!0)}},get all(){const v=[];for(const _ of gn.mine.getAllExtensionDescriptions())v.push(new Pl(n,E.identifier,_,oc,!1));return v},get allAcrossExtensionHosts(){M(E,"extensionsAny");const v=new $o(gn.mine.getAllExtensionDescriptions().map(S=>S.identifier)),_=[];for(const S of gn.all.getAllExtensionDescriptions()){const z=!v.has(S.identifier);_.push(new Pl(n,E.identifier,S,oc,z))}return _},get onDidChange(){return Tt(E,"extensionsAny")?de(_t.any(gn.mine.onDidChange,gn.all.onDidChange)):de(gn.mine.onDidChange)}},Uw={createDiagnosticCollection(v){return Nt.createDiagnosticCollection(E.identifier,v)},get onDidChangeDiagnostics(){return de(Nt.onDidChangeDiagnostics)},getDiagnostics:v=>Nt.getDiagnostics(v),getLanguages(){return qi.getLanguages()},setTextDocumentLanguage(v,_){return qi.changeLanguage(v.uri,_)},match(v,_){var ke;const S=qm.from(v);let z;return NC(S)&&(z=(ke=le.notebookDocuments.find(Ke=>Ke.apiNotebook.getCells().find(Dt=>Dt.document===_)))==null?void 0:ke.apiNotebook),$C(S,_.uri,_.languageId,!0,z==null?void 0:z.uri,z==null?void 0:z.notebookType)},registerCodeActionsProvider(v,_,S){return ye.registerCodeActionProvider(E,Ue(v),_,S)},registerDocumentPasteEditProvider(v,_,S){return M(E,"documentPaste"),ye.registerDocumentPasteEditProvider(E,Ue(v),_,S)},registerCodeLensProvider(v,_){return ye.registerCodeLensProvider(E,Ue(v),_)},registerDefinitionProvider(v,_){return ye.registerDefinitionProvider(E,Ue(v),_)},registerDeclarationProvider(v,_){return ye.registerDeclarationProvider(E,Ue(v),_)},registerImplementationProvider(v,_){return ye.registerImplementationProvider(E,Ue(v),_)},registerTypeDefinitionProvider(v,_){return ye.registerTypeDefinitionProvider(E,Ue(v),_)},registerHoverProvider(v,_){return ye.registerHoverProvider(E,Ue(v),_,E.identifier)},registerEvaluatableExpressionProvider(v,_){return ye.registerEvaluatableExpressionProvider(E,Ue(v),_,E.identifier)},registerInlineValuesProvider(v,_){return ye.registerInlineValuesProvider(E,Ue(v),_,E.identifier)},registerDocumentHighlightProvider(v,_){return ye.registerDocumentHighlightProvider(E,Ue(v),_)},registerMultiDocumentHighlightProvider(v,_){return ye.registerMultiDocumentHighlightProvider(E,Ue(v),_)},registerLinkedEditingRangeProvider(v,_){return ye.registerLinkedEditingRangeProvider(E,Ue(v),_)},registerReferenceProvider(v,_){return ye.registerReferenceProvider(E,Ue(v),_)},registerRenameProvider(v,_){return ye.registerRenameProvider(E,Ue(v),_)},registerNewSymbolNamesProvider(v,_){return M(E,"newSymbolNamesProvider"),ye.registerNewSymbolNamesProvider(E,Ue(v),_)},registerDocumentSymbolProvider(v,_,S){return ye.registerDocumentSymbolProvider(E,Ue(v),_,S)},registerWorkspaceSymbolProvider(v){return ye.registerWorkspaceSymbolProvider(E,v)},registerDocumentFormattingEditProvider(v,_){return ye.registerDocumentFormattingEditProvider(E,Ue(v),_)},registerDocumentRangeFormattingEditProvider(v,_){return ye.registerDocumentRangeFormattingEditProvider(E,Ue(v),_)},registerOnTypeFormattingEditProvider(v,_,S,...z){return ye.registerOnTypeFormattingEditProvider(E,Ue(v),_,[S].concat(z))},registerDocumentSemanticTokensProvider(v,_,S){return ye.registerDocumentSemanticTokensProvider(E,Ue(v),_,S)},registerDocumentRangeSemanticTokensProvider(v,_,S){return ye.registerDocumentRangeSemanticTokensProvider(E,Ue(v),_,S)},registerSignatureHelpProvider(v,_,S,...z){return typeof S=="object"?ye.registerSignatureHelpProvider(E,Ue(v),_,S):ye.registerSignatureHelpProvider(E,Ue(v),_,typeof S>"u"?[]:[S,...z])},registerCompletionItemProvider(v,_,...S){return ye.registerCompletionItemProvider(E,Ue(v),_,S)},registerInlineCompletionItemProvider(v,_,S){return _.handleDidShowCompletionItem&&M(E,"inlineCompletionsAdditions"),_.handleDidPartiallyAcceptCompletionItem&&M(E,"inlineCompletionsAdditions"),S&&M(E,"inlineCompletionsAdditions"),ye.registerInlineCompletionsProvider(E,Ue(v),_,S)},registerInlineEditProvider(v,_){return M(E,"inlineEdit"),ye.registerInlineEditProvider(E,Ue(v),_)},registerDocumentLinkProvider(v,_){return ye.registerDocumentLinkProvider(E,Ue(v),_)},registerColorProvider(v,_){return ye.registerColorProvider(E,Ue(v),_)},registerFoldingRangeProvider(v,_){return ye.registerFoldingRangeProvider(E,Ue(v),_)},registerSelectionRangeProvider(v,_){return ye.registerSelectionRangeProvider(E,v,_)},registerCallHierarchyProvider(v,_){return ye.registerCallHierarchyProvider(E,v,_)},registerTypeHierarchyProvider(v,_){return ye.registerTypeHierarchyProvider(E,v,_)},setLanguageConfiguration:(v,_)=>ye.setLanguageConfiguration(E,v,_),getTokenInformationAtPosition(v,_){return M(E,"tokenInformation"),qi.tokenAtPosition(v,_)},registerInlayHintsProvider(v,_){return ye.registerInlayHintsProvider(E,v,_)},createLanguageStatusItem(v,_){return qi.createLanguageStatusItem(E,v,_)},registerDocumentDropEditProvider(v,_,S){return ye.registerDocumentOnDropEditProvider(E,v,_,Tt(E,"dropMetadata")?S:void 0)}},Bw={get activeTextEditor(){return ct.getActiveTextEditor()},get visibleTextEditors(){return ct.getVisibleTextEditors()},get activeTerminal(){return Q.activeTerminal},get terminals(){return Q.terminals},async showTextDocument(v,_,S){y.isUri(v)&&v.scheme===Z.vscodeRemote&&!v.authority&&p.report("workspace.showTextDocument",E,"A URI of 'vscode-remote' scheme requires an authority.");const z=await(y.isUri(v)?Promise.resolve(gp.openTextDocument(v)):Promise.resolve(v));return ct.showTextDocument(z,_,S)},createTextEditorDecorationType(v){return ct.createTextEditorDecorationType(E,v)},onDidChangeActiveTextEditor(v,_,S){return de(ct.onDidChangeActiveTextEditor)(v,_,S)},onDidChangeVisibleTextEditors(v,_,S){return de(ct.onDidChangeVisibleTextEditors)(v,_,S)},onDidChangeTextEditorSelection(v,_,S){return de(ct.onDidChangeTextEditorSelection)(v,_,S)},onDidChangeTextEditorOptions(v,_,S){return de(ct.onDidChangeTextEditorOptions)(v,_,S)},onDidChangeTextEditorVisibleRanges(v,_,S){return de(ct.onDidChangeTextEditorVisibleRanges)(v,_,S)},onDidChangeTextEditorViewColumn(v,_,S){return de(ct.onDidChangeTextEditorViewColumn)(v,_,S)},onDidCloseTerminal(v,_,S){return de(Q.onDidCloseTerminal)(v,_,S)},onDidOpenTerminal(v,_,S){return de(Q.onDidOpenTerminal)(v,_,S)},onDidChangeActiveTerminal(v,_,S){return de(Q.onDidChangeActiveTerminal)(v,_,S)},onDidChangeTerminalDimensions(v,_,S){return M(E,"terminalDimensions"),de(Q.onDidChangeTerminalDimensions)(v,_,S)},onDidChangeTerminalState(v,_,S){return de(Q.onDidChangeTerminalState)(v,_,S)},onDidWriteTerminalData(v,_,S){return M(E,"terminalDataWriteEvent"),de(Q.onDidWriteTerminalData)(v,_,S)},onDidExecuteTerminalCommand(v,_,S){return M(E,"terminalExecuteCommandEvent"),de(Q.onDidExecuteTerminalCommand)(v,_,S)},get state(){return b.getState(E)},onDidChangeWindowState(v,_,S){return de(b.onDidChangeWindowState)(v,_,S)},showInformationMessage(v,..._){return xu.showMessage(E,tt.Info,v,_[0],_.slice(1))},showWarningMessage(v,..._){return xu.showMessage(E,tt.Warning,v,_[0],_.slice(1))},showErrorMessage(v,..._){return xu.showMessage(E,tt.Error,v,_[0],_.slice(1))},showQuickPick(v,_,S){return Wr.showQuickPick(E,v,_,S)},showWorkspaceFolderPick(v){return Wr.showWorkspaceFolderPick(v)},showInputBox(v,_){return Wr.showInput(v,_)},showOpenDialog(v){return fp.showOpenDialog(E,v)},showSaveDialog(v){return fp.showSaveDialog(v)},createStatusBarItem(v,_,S){let z,ke,Ke;return typeof v=="string"?(z=v,ke=_,Ke=S):(ke=v,Ke=_),rc.createStatusBarEntry(E,z,ke,Ke)},setStatusBarMessage(v,_){return rc.setStatusBarMessage(v,_)},withScmProgress(v){return p.report("window.withScmProgress",E,"Use 'withProgress' instead."),lp.withProgress(E,{location:xs.SourceControl},(_,S)=>v({report(z){}}))},withProgress(v,_){return lp.withProgress(E,v,_)},createOutputChannel(v,_){return q.createOutputChannel(v,_,E)},createWebviewPanel(v,_,S,z){return yu.createWebviewPanel(E,v,_,S,z)},createWebviewTextEditorInset(v,_,S,z){return M(E,"editorInsets"),xi.createWebviewEditorInset(v,_,S,z,E)},createTerminal(v,_,S){return typeof v=="object"?"pty"in v?Q.createExtensionTerminal(v):Q.createTerminalFromOptions(v):Q.createTerminal(v,_,S)},registerTerminalLinkProvider(v){return Q.registerLinkProvider(v)},registerTerminalProfileProvider(v,_){return Q.registerProfileProvider(E,v,_)},registerTerminalQuickFixProvider(v,_){return M(E,"terminalQuickFixProvider"),Q.registerTerminalQuickFixProvider(v,E.identifier.value,_)},registerTreeDataProvider(v,_){return ft.registerTreeDataProvider(v,_,E)},createTreeView(v,_){return ft.createTreeView(v,_,E)},registerWebviewPanelSerializer:(v,_)=>yu.registerWebviewPanelSerializer(E,v,_),registerCustomEditorProvider:(v,_,S={})=>Aw.registerCustomEditorProvider(E,v,_,S),registerFileDecorationProvider(v){return R.registerFileDecorationProvider(v,E)},registerUriHandler(v){return J.registerUriHandler(E,v)},createQuickPick(){return Wr.createQuickPick(E)},createInputBox(){return Wr.createInputBox(E)},get activeColorTheme(){return up.activeColorTheme},onDidChangeActiveColorTheme(v,_,S){return de(up.onDidChangeActiveColorTheme)(v,_,S)},registerWebviewViewProvider(v,_,S){return Rw.registerWebviewViewProvider(E,v,_,S==null?void 0:S.webviewOptions)},get activeNotebookEditor(){return le.activeNotebookEditor},onDidChangeActiveNotebookEditor(v,_,S){return de(le.onDidChangeActiveNotebookEditor)(v,_,S)},get visibleNotebookEditors(){return le.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return de(le.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(v,_,S){return de(Ze.onDidChangeNotebookEditorSelection)(v,_,S)},onDidChangeNotebookEditorVisibleRanges(v,_,S){return de(Ze.onDidChangeNotebookEditorVisibleRanges)(v,_,S)},showNotebookDocument(v,_){return le.showNotebookDocument(v,_)},registerExternalUriOpener(v,_,S){return M(E,"externalUriOpener"),Gi.registerExternalUriOpener(E.identifier,v,_,S)},registerProfileContentHandler(v,_){return M(E,"profileContentHandlers"),Lw.registerProfileContentHandler(E,v,_)},registerQuickDiffProvider(v,_,S,z){return M(E,"quickDiffProvider"),Xn.registerQuickDiffProvider(Ue(v),_,S,z)},get tabGroups(){return D.tabGroups},registerShareProvider(v,_){return M(E,"shareProvider"),Yn.registerShareProvider(Ue(v),_)}},gp={get rootPath(){return p.report("workspace.rootPath",E,"Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath"),s.getPath()},set rootPath(v){throw new Qr("rootPath")},getWorkspaceFolder(v){return s.getWorkspaceFolder(v)},get workspaceFolders(){return s.getWorkspaceFolders()},get name(){return s.name},set name(v){throw new Qr("name")},get workspaceFile(){return s.workspaceFile},set workspaceFile(v){throw new Qr("workspaceFile")},updateWorkspaceFolders:(v,_,...S)=>s.updateWorkspaceFolders(E,v,_||0,...S),onDidChangeWorkspaceFolders:function(v,_,S){return de(s.onDidChangeWorkspace)(v,_,S)},asRelativePath:(v,_)=>s.getRelativePath(v,_),findFiles:(v,_,S,z)=>s.findFiles(v,_,S,E.identifier,z),findFiles2:(v,_,S)=>(M(E,"findFiles2"),s.findFiles2(v,_,E.identifier,S)),findTextInFiles:(v,_,S,z)=>{M(E,"findTextInFiles");let ke,Ke;return typeof _=="object"?(ke=_,Ke=S):(ke={},Ke=_,z=S),s.findTextInFiles(v,ke||{},Ke,E.identifier,z)},save:v=>s.save(v),saveAs:v=>s.saveAs(v),saveAll:v=>s.saveAll(v),applyEdit(v,_){return uo.applyWorkspaceEdit(v,E,_)},createFileSystemWatcher:(v,_,S,z)=>{let ke;return typeof _=="boolean"?ke={ignoreCreateEvents:!!_,ignoreChangeEvents:!!S,ignoreDeleteEvents:!!z,correlate:!1}:_&&(M(E,"createFileSystemWatcher"),ke={..._,correlate:!0}),fn.createFileSystemWatcher(s,E,v,ke)},get textDocuments(){return j.getAllDocumentData().map(v=>v.document)},set textDocuments(v){throw new Qr("textDocuments")},openTextDocument(v){let _;const S=v;if(typeof v=="string")_=Promise.resolve(y.file(v));else if(y.isUri(v))_=Promise.resolve(v);else if(!S||typeof S=="object")_=j.createDocumentData(S);else throw new Error("illegal argument - uriOrFileNameOrOptions");return _.then(z=>(z.scheme===Z.vscodeRemote&&!z.authority&&p.report("workspace.openTextDocument",E,"A URI of 'vscode-remote' scheme requires an authority."),j.ensureDocumentData(z).then(ke=>ke.document)))},onDidOpenTextDocument:(v,_,S)=>de(j.onDidAddDocument)(v,_,S),onDidCloseTextDocument:(v,_,S)=>de(j.onDidRemoveDocument)(v,_,S),onDidChangeTextDocument:(v,_,S)=>de(j.onDidChangeDocument)(v,_,S),onDidSaveTextDocument:(v,_,S)=>de(j.onDidSaveDocument)(v,_,S),onWillSaveTextDocument:(v,_,S)=>de(ge.getOnWillSaveTextDocumentEvent(E))(v,_,S),get notebookDocuments(){return le.notebookDocuments.map(v=>v.apiNotebook)},async openNotebookDocument(v,_){let S;if(y.isUri(v))S=v,await le.openNotebookDocument(v);else if(typeof v=="string")S=y.revive(await le.createNotebookDocument({viewType:v,content:_}));else throw new Error("Invalid arguments");return le.getNotebookDocument(S).apiNotebook},onDidSaveNotebookDocument(v,_,S){return de(Ye.onDidSaveNotebookDocument)(v,_,S)},onDidChangeNotebookDocument(v,_,S){return de(Ye.onDidChangeNotebookDocument)(v,_,S)},onWillSaveNotebookDocument(v,_,S){return de(vt.getOnWillSaveNotebookDocumentEvent(E))(v,_,S)},get onDidOpenNotebookDocument(){return de(le.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return de(le.onDidCloseNotebookDocument)},registerNotebookSerializer(v,_,S,z){return le.registerNotebookSerializer(E,v,_,S,Tt(E,"notebookLiveShare")?z:void 0)},onDidChangeConfiguration:(v,_,S)=>de(pp.onDidChangeConfiguration)(v,_,S),getConfiguration(v,_){return _=arguments.length===1?void 0:_,pp.getConfiguration(v,_,E)},registerTextDocumentContentProvider(v,_){return oe.registerTextDocumentContentProvider(v,_)},registerTaskProvider:(v,_)=>(p.report("window.registerTaskProvider",E,"Use the corresponding function on the 'tasks' namespace instead"),Re.registerTaskProvider(E,v,_)),registerFileSystemProvider(v,_,S){return cb(Pw.registerFileSystemProvider(E,v,_,S),i.addFileSystemProvider(v,_,S))},get fs(){return i.value},registerFileSearchProvider:(v,_)=>(M(E,"fileSearchProvider"),ue.registerFileSearchProvider(v,_)),registerTextSearchProvider:(v,_)=>(M(E,"textSearchProvider"),ue.registerTextSearchProvider(v,_)),registerRemoteAuthorityResolver:(v,_)=>(M(E,"resolvers"),n.registerRemoteAuthorityResolver(v,_)),registerResourceLabelFormatter:v=>(M(E,"resolvers"),He.$registerResourceLabelFormatter(v)),getRemoteExecServer:v=>(M(E,"resolvers"),n.getRemoteExecServer(v)),onDidCreateFiles:(v,_,S)=>de(fn.onDidCreateFile)(v,_,S),onDidDeleteFiles:(v,_,S)=>de(fn.onDidDeleteFile)(v,_,S),onDidRenameFiles:(v,_,S)=>de(fn.onDidRenameFile)(v,_,S),onWillCreateFiles:(v,_,S)=>de(fn.getOnWillCreateFileEvent(E))(v,_,S),onWillDeleteFiles:(v,_,S)=>de(fn.getOnWillDeleteFileEvent(E))(v,_,S),onWillRenameFiles:(v,_,S)=>de(fn.getOnWillRenameFileEvent(E))(v,_,S),openTunnel:v=>(M(E,"tunnels"),w.openTunnel(E,v).then(_=>{if(!_)throw new Error("cannot open tunnel");return _})),get tunnels(){return M(E,"tunnels"),w.getTunnels()},onDidChangeTunnels:(v,_,S)=>(M(E,"tunnels"),de(w.onDidChangeTunnels)(v,_,S)),registerPortAttributesProvider:(v,_)=>(M(E,"portsAttributes"),w.registerPortsAttributesProvider(v,_)),registerTunnelProvider:(v,_)=>(M(E,"tunnelFactory"),w.registerTunnelProvider(v,_)),registerTimelineProvider:(v,_)=>(M(E,"timeline"),dp.registerTimelineProvider(v,_,E.identifier,B.converter)),get isTrusted(){return s.trusted},requestWorkspaceTrust:v=>(M(E,"workspaceTrust"),s.requestWorkspaceTrust(v)),onDidGrantWorkspaceTrust:(v,_,S)=>de(s.onDidGrantWorkspaceTrust)(v,_,S),registerEditSessionIdentityProvider:(v,_)=>(M(E,"editSessionIdentityProvider"),s.registerEditSessionIdentityProvider(v,_)),onWillCreateEditSessionIdentity:(v,_,S)=>(M(E,"editSessionIdentityProvider"),de(s.getOnWillCreateEditSessionIdentityEvent(E))(v,_,S)),registerCanonicalUriProvider:(v,_)=>(M(E,"canonicalUriProvider"),s.registerCanonicalUriProvider(v,_)),getCanonicalUri:(v,_,S)=>(M(E,"canonicalUriProvider"),s.provideCanonicalUri(v,_,S))},Ww={get inputBox(){return p.report("scm.inputBox",E,"Use 'SourceControl.inputBox' instead"),bu.getLastInputBox(E)},createSourceControl(v,_,S){return bu.createSourceControl(E,v,_,S)}},Vw={createCommentController(v,_){return Tw.createCommentController(E,v,_)}},Cu={get activeDebugSession(){return ee.activeDebugSession},get activeDebugConsole(){return ee.activeDebugConsole},get breakpoints(){return ee.breakpoints},get stackFrameFocus(){return ee.stackFrameFocus},registerDebugVisualizationProvider(v,_){return M(E,"debugVisualization"),ee.registerDebugVisualizationProvider(E,v,_)},registerDebugVisualizationTreeProvider(v,_){return M(E,"debugVisualization"),ee.registerDebugVisualizationTree(E,v,_)},onDidStartDebugSession(v,_,S){return de(ee.onDidStartDebugSession)(v,_,S)},onDidTerminateDebugSession(v,_,S){return de(ee.onDidTerminateDebugSession)(v,_,S)},onDidChangeActiveDebugSession(v,_,S){return de(ee.onDidChangeActiveDebugSession)(v,_,S)},onDidReceiveDebugSessionCustomEvent(v,_,S){return de(ee.onDidReceiveDebugSessionCustomEvent)(v,_,S)},onDidChangeBreakpoints(v,_,S){return de(ee.onDidChangeBreakpoints)(v,_,S)},onDidChangeStackFrameFocus(v,_,S){return M(E,"debugFocus"),de(ee.onDidChangeStackFrameFocus)(v,_,S)},registerDebugConfigurationProvider(v,_,S){return ee.registerDebugConfigurationProvider(v,_,S||Rf.Initial)},registerDebugAdapterDescriptorFactory(v,_){return ee.registerDebugAdapterDescriptorFactory(E,v,_)},registerDebugAdapterTrackerFactory(v,_){return ee.registerDebugAdapterTrackerFactory(v,_)},startDebugging(v,_,S){return!S||typeof S=="object"&&"configuration"in S?ee.startDebugging(v,_,{parentSession:S}):ee.startDebugging(v,_,S||{})},stopDebugging(v){return ee.stopDebugging(v)},addBreakpoints(v){return ee.addBreakpoints(v)},removeBreakpoints(v){return ee.removeBreakpoints(v)},asDebugSourceUri(v,_){return ee.asDebugSourceUri(v,_)}},zw={registerTaskProvider:(v,_)=>Re.registerTaskProvider(E,v,_),fetchTasks:v=>Re.fetchTasks(v),executeTask:v=>Re.executeTask(E,v),get taskExecutions(){return Re.taskExecutions},onDidStartTask:(v,_,S)=>de(Re.onDidStartTask)(v,_,S),onDidEndTask:(v,_,S)=>de(Re.onDidEndTask)(v,_,S),onDidStartTaskProcess:(v,_,S)=>de(Re.onDidStartTaskProcess)(v,_,S),onDidEndTaskProcess:(v,_,S)=>de(Re.onDidEndTaskProcess)(v,_,S)},jw={createNotebookController(v,_,S,z,ke){return kt.createNotebookController(E,v,_,S,z,Tt(E,"notebookMessaging")?ke:void 0)},registerNotebookCellStatusBarItemProvider:(v,_)=>le.registerNotebookCellStatusBarItemProvider(E,v,_),createRendererMessaging(v){return Qt.createRendererMessaging(E,v)},createNotebookControllerDetectionTask(v){return M(E,"notebookKernelSource"),kt.createNotebookControllerDetectionTask(E,v)},registerKernelSourceActionProvider(v,_){return M(E,"notebookKernelSource"),kt.registerKernelSourceActionProvider(E,v,_)},onDidChangeNotebookCellExecutionState(v,_,S){return M(E,"notebookCellExecutionState"),de(kt.onDidChangeNotebookCellExecutionState)(v,_,S)}},qw={t(...v){if(typeof v[0]=="string"){const _=v.shift(),S=!v||typeof v[0]!="object"?v:v[0];return U.getMessage(E.identifier.value,{message:_,args:S})}return U.getMessage(E.identifier.value,v[0])},get bundle(){return U.getBundle(E.identifier.value)},get uri(){return U.getBundleUri(E.identifier.value)}},x={_version:1,registerInteractiveEditorSessionProvider(v,_){return M(E,"interactive"),Ow.registerProvider(E,v,_)},registerInteractiveSessionProvider(v,_){return M(E,"interactive"),zr.registerChatProvider(E,v,_)},sendInteractiveRequestToProvider(v,_){return M(E,"interactive"),zr.sendInteractiveRequestToProvider(v,_)},transferChatSession(v,_){return M(E,"interactive"),zr.transferChatSession(v,_)}},P={getRelatedInformation(v,_){return M(E,"aiRelatedInformation"),ic.getRelatedInformation(E,v,_)},registerRelatedInformationProvider(v,_){return M(E,"aiRelatedInformation"),ic.registerRelatedInformationProvider(E,v,_)},registerEmbeddingVectorProvider(v,_){return M(E,"aiRelatedInformation"),hp.registerEmbeddingVectorProvider(E,v,_)}},L={registerChatResponseProvider(v,_,S){return M(E,"chatProvider"),ec.registerLanguageModel(E,v,_,S)},registerChatVariableResolver(v,_,S){return M(E,"chatVariableResolver"),tc.registerVariableResolver(E,v,_,S)},registerMappedEditsProvider(v,_){return M(E,"mappedEditsProvider"),ye.registerMappedEditsProvider(E,v,_)},createChatParticipant(v,_){return M(E,"chatParticipant"),$w.createChatAgent(E,v,_)}},X={requestLanguageModelAccess(v,_){return M(E,"languageModels"),ec.requestLanguageModelAccess(E,v,_)},get languageModels(){return M(E,"languageModels"),ec.getLanguageModelIds()},onDidChangeLanguageModels:(v,_,S)=>(M(E,"languageModels"),ec.onDidChangeProviders(v,_,S))},V={registerSpeechProvider(v,_){return M(E,"speech"),sc.registerProvider(E.identifier,v,_)}};return{version:e.version,ai:P,authentication:Nw,commands:Fw,comments:Vw,chat:L,debug:Cu,env:Mw,extensions:ac,interactive:x,l10n:qw,languages:Uw,lm:X,notebooks:jw,scm:Ww,speech:V,tasks:zw,tests:Hw,window:Bw,workspace:gp,Breakpoint:Go,TerminalOutputAnchor:$g,ChatResultFeedbackKind:al,ChatVariableLevel:Pn,ChatCompletionItem:l4,CallHierarchyIncomingCall:rx,CallHierarchyItem:Ng,CallHierarchyOutgoingCall:sx,CancellationError:Gr,CancellationTokenSource:mt,CandidatePortSource:Fp,CodeAction:Ad,CodeActionKind:it,CodeActionTriggerKind:jc,CodeLens:Rd,Color:Vo,ColorInformation:Md,ColorPresentation:Hd,ColorThemeKind:_r,CommentMode:nm,CommentState:rm,CommentThreadCollapsibleState:tl,CommentThreadState:il,CompletionItem:$d,CompletionItemKind:fe,CompletionItemTag:Gc,CompletionList:Ho,CompletionTriggerKind:Mo,ConfigurationTarget:jo,CustomExecution:Kg,DebugAdapterExecutable:jd,DebugAdapterInlineImplementation:Gd,DebugAdapterNamedPipeServer:qd,DebugAdapterServer:Zc,DebugConfigurationProviderTriggerKind:Rf,DebugConsoleMode:th,DebugVisualization:i4,DecorationRangeBehavior:ws,Diagnostic:Dd,DiagnosticRelatedInformation:Uc,DiagnosticSeverity:$t,DiagnosticTag:_s,Disposable:Pe,DocumentHighlight:Pd,DocumentHighlightKind:Bc,MultiDocumentHighlight:Td,DocumentLink:Fd,DocumentSymbol:zc,EndOfLine:Mi,EnvironmentVariableMutatorType:No,EvaluatableExpression:Kd,InlineValueText:Xd,InlineValueVariableLookup:Yd,InlineValueEvaluatableExpression:Zd,InlineCompletionTriggerKind:el,EventEmitter:T,ExtensionKind:ks,ExtensionMode:Yo,ExternalUriOpenerPriority:fm,FileChangeType:Qo,FileDecoration:am,FileDecoration2:am,FileSystemError:wt,FileType:hs,FilePermission:Ro,FoldingRange:im,FoldingRangeKind:Dn,FunctionBreakpoint:Es,InlineCompletionItem:Wg,InlineCompletionList:Vg,Hover:Id,IndentAction:b_,Location:vi,MarkdownString:Di,OverviewRulerLane:Rv,ParameterInformation:Fg,PortAutoForwardAction:gm,Position:Se,ProcessExecution:zo,ProgressLocation:xs,QuickInputButtons:nl,Range:be,RelativePattern:qo,Selection:kn,SelectionRange:qc,SemanticTokens:Jo,SemanticTokensBuilder:om,SemanticTokensEdit:cx,SemanticTokensEdits:eh,SemanticTokensLegend:sm,ShellExecution:bs,ShellQuoting:Jg,SignatureHelp:Hg,SignatureHelpTriggerKind:Ug,SignatureInformation:Mg,SnippetString:vs,SourceBreakpoint:Ss,StandardTokenType:wr,StatusBarAlignment:vr,SymbolInformation:Vc,SymbolKind:qe,SymbolTag:Wc,Task:Ud,TaskGroup:Kc,TaskPanelKind:Qg,TaskRevealKind:Gg,TaskScope:ys,TerminalLink:GD,TerminalQuickFixTerminalCommand:JD,TerminalQuickFixOpener:QD,TerminalLocation:qg,TerminalProfile:KD,TerminalExitReason:jg,TextDocumentSaveReason:Uo,TextEdit:gr,SnippetTextEdit:ms,TextEditorCursorStyle:ln,TextEditorLineNumbersStyle:Hi,TextEditorRevealType:Nd,TextEditorSelectionChangeKind:Bo,SyntaxTokenType:Wo,TextDocumentChangeReason:Jc,ThemeColor:Yc,ThemeIcon:Gt,TreeItem:Bd,TreeItemCheckboxState:rn,TreeItemCollapsibleState:Cs,TypeHierarchyItem:mm,UIKind:fc,Uri:y,ViewColumn:Qc,WorkspaceEdit:mr,DocumentDropEdit:Yg,DocumentPasteEdit:Zg,InlayHint:Od,InlayHintLabelPart:Ld,InlayHintKind:Bg,RemoteAuthorityResolverError:nn,ResolvedAuthority:jD,ManagedResolvedAuthority:Ed,SourceControlInputBoxValidationType:zg,ExtensionRuntime:ch,TimelineItem:lm,NotebookRange:In,NotebookCellKind:Ds,NotebookCellExecutionState:Xo,NotebookCellData:nh,NotebookData:lx,NotebookRendererScript:dx,NotebookCellStatusBarAlignment:sh,NotebookEditorRevealType:oh,NotebookCellOutput:rh,NotebookCellOutputItem:ux,NotebookCellStatusBarItem:n4,NotebookControllerAffinity:cm,NotebookControllerAffinity2:ah,NotebookEdit:kd,NotebookKernelSourceAction:r4,NotebookVariablesRequestKind:sl,PortAttributes:o4,LinkedEditingRanges:s4,TestResultState:um,TestRunRequest:lh,TestMessage:uh,TestTag:ol,TestRunProfileKind:Zo,TextSearchCompleteMessageType:bw,DataTransfer:Xc,DataTransferItem:Wd,CoveredCount:dh,FileCoverage:hm,StatementCoverage:a4,BranchCoverage:c4,DeclarationCoverage:hx,FunctionCoverage:hx,WorkspaceTrustState:pm,LanguageStatusSeverity:Fo,QuickPickItemKind:rl,InputBoxValidationSeverity:Ko,TabInputText:vm,TabInputTextDiff:_m,TabInputTextMerge:fx,TabInputCustom:wm,TabInputNotebook:bm,TabInputNotebookDiff:ym,TabInputWebview:px,TabInputTerminal:gx,TabInputInteractiveWindow:mx,TabInputChat:vx,TelemetryTrustedValue:Dg,LogLevel:Oe,EditSessionIdentityMatch:y_,InteractiveSessionVoteDirection:xm,ChatCopyKind:Cm,InteractiveEditorResponseFeedbackKind:br,StackFrameFocus:Qd,ThreadFocus:Jd,RelatedInformationType:Im,SpeechToTextStatus:Pm,KeywordRecognitionStatus:Tm,ChatResponseMarkdownPart:hh,ChatResponseFileTreePart:fh,ChatResponseAnchorPart:ph,ChatResponseProgressPart:cl,ChatResponseReferencePart:ll,ChatResponseCommandButtonPart:Sm,ChatRequestTurn:_x,ChatResponseTurn:wx,LanguageModelSystemMessage:Em,LanguageModelUserMessage:km,LanguageModelAssistantMessage:Dm,NewSymbolName:e4,NewSymbolNameTag:tm,InlineEdit:u4,InlineEditTriggerKind:ul}}}var Lf;let yw=class{constructor(e,t,i,n,s,o,a){this._apiFactory=e,this._extensionRegistry=t,this._instaService=i,this._extHostConfiguration=n,this._extHostExtensionService=s,this._initData=o,this._logService=a,this._factories=new Map,this._alternatives=[]}async install(){this._installInterceptor(),pi("code/extHost/willWaitForConfig");const e=await this._extHostConfiguration.getConfigProvider();pi("code/extHost/didWaitForConfig");const t=await this._extHostExtensionService.getExtensionPathIndex();this.register(new vA(this._apiFactory,t,this._extensionRegistry,e,this._logService)),this.register(this._instaService.createInstance(xw)),this._initData.remote.isRemote&&this.register(this._instaService.createInstance(Cw,t,this._initData.environment.appUriScheme))}register(e){if("nodeModuleName"in e)if(Array.isArray(e.nodeModuleName))for(const t of e.nodeModuleName)this._factories.set(t,e);else this._factories.set(e.nodeModuleName,e);typeof e.alternativeModuleName=="function"&&this._alternatives.push(t=>e.alternativeModuleName(t))}};yw=H([N(2,qu),N(3,Rn),N(4,Ir),N(5,Ut),N(6,Ge)],yw);let xw=(Za=class{constructor(e){if(e.environment.appRoot&&Lf.aliased.size){const t=wo(this.forceForwardSlashes(e.environment.appRoot.fsPath)),i="[a-z0-9_.-]",n=`@${i}+\\/${i}+|${i}+`,s="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.re=new RegExp(`^(${t}/${s}\\/)(${n})(.*)$`,"i")}}alternativeModuleName(e){if(!this.re)return;const t=this.re.exec(this.forceForwardSlashes(e));if(!t)return;const[,i,n,s]=t,o=Lf.aliased.get(n);if(o!==void 0)return console.warn(`${n} as been renamed to ${o}, please update your imports`),i+o+s}forceForwardSlashes(e){return e.replace(/\\/g,"/")}},Lf=Za,Za.aliased=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]]),Za);xw=Lf=H([N(0,Ut)],xw);class vA{constructor(e,t,i,n,s){this._apiFactory=e,this._extensionPaths=t,this._extensionRegistry=i,this._configProvider=n,this._logService=s,this.nodeModuleName="vscode",this._extApiImpl=new fr}load(e,t){const i=this._extensionPaths.findSubstr(t);if(i){let n=this._extApiImpl.get(i.identifier);return n||(n=this._apiFactory(i,this._extensionRegistry,this._configProvider),this._extApiImpl.set(i.identifier,n)),n}if(!this._defaultApiImpl){let n="";this._extensionPaths.forEach((s,o)=>n+=`	${o} -> ${s.identifier.value}
`),this._logService.warn(`Could not identify extension for 'vscode' require call from ${t}. These are the extension path mappings: 
${n}`),this._defaultApiImpl=this._apiFactory(WD,this._extensionRegistry,this._configProvider)}return this._defaultApiImpl}}let Cw=class{constructor(e,t,i){this._extensionPaths=e,this._appUriScheme=t,this.nodeModuleName=["open","opn"],this._mainThreadTelemetry=i.getProxy(G.MainThreadTelemetry);const n=i.getProxy(G.MainThreadWindow);this._impl=(s,o)=>{const a=y.parse(s);return o?this.callOriginal(s,o):a.scheme==="http"||a.scheme==="https"?n.$openUri(a,s,{allowTunneling:!0}):a.scheme==="mailto"||a.scheme===this._appUriScheme?n.$openUri(a,s,{}):this.callOriginal(s,o)}}load(e,t,i){const n=this._extensionPaths.findSubstr(t);return n&&(this._extensionId=n.identifier.value,this.sendShimmingTelemetry()),this._original=i(e),this._impl}callOriginal(e,t){return this.sendNoForwardTelemetry(),this._original(e,t)}sendShimmingTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open",{extension:this._extensionId})}sendNoForwardTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open.call.noForward",{extension:this._extensionId})}};Cw=H([N(2,Ve)],Cw);let Sw=class{constructor(e,t){this._mainThreadConsole=e.getProxy(G.MainThreadConsole),this._includeStack=t.consoleForward.includeStack,this._logNative=t.consoleForward.logNative,this._wrapConsoleMethod("info","log"),this._wrapConsoleMethod("log","log"),this._wrapConsoleMethod("warn","warn"),this._wrapConsoleMethod("debug","debug"),this._wrapConsoleMethod("error","error")}_wrapConsoleMethod(e,t){const i=this,n=console[e];Object.defineProperty(console,e,{set:()=>{},get:()=>function(){i._handleConsoleCall(e,t,n,arguments)}})}_handleConsoleCall(e,t,i,n){this._mainThreadConsole.$logExtensionHostMessage({type:"__$console",severity:t,arguments:wA(n,this._includeStack)}),this._logNative&&this._nativeConsoleLogMessage(e,i,n)}};Sw=H([N(0,Ve),N(1,Ut)],Sw);const _A=1e5;function wA(r,e){const t=[];if(r.length)for(let i=0;i<r.length;i++){let n=r[i];if(typeof n>"u")n="undefined";else if(n instanceof Error){const s=n;s.stack?n=s.stack:n=s.toString()}t.push(n)}if(e){const i=new Error().stack;i&&t.push({__$stack:i.split(`
`).slice(3).join(`
`)})}try{const i=Hk(t);return i.length>_A?"Output omitted for a large object that exceeds the limits":i}catch(i){return`Output omitted for an object that cannot be inspected ('${i.toString()}')`}}let Ew=class extends Sw{constructor(e,t){super(e,t)}_nativeConsoleLogMessage(e,t,i){t.apply(console,i)}};Ew=H([N(0,Ve),N(1,Ut)],Ew);class bA extends yw{_installInterceptor(){}getModule(e,t){for(const i of this._alternatives){const n=i(e);if(n){e=n;break}}if(this._factories.has(e))return this._factories.get(e).load(e,t,()=>{throw new Error("CANNOT LOAD MODULE from here.")})}}class yA extends Vv{constructor(){super(...arguments),this.extensionRuntime=ch.Webworker}async _beforeAlmostReadyToRunExtensions(){pc&&this._instaService.createInstance(Ew),this._apiFactory=this._instaService.invokeFunction(mA),this._fakeModules=this._instaService.createInstance(bA,this._apiFactory,{mine:this._myRegistry,all:this._globalRegistry}),await this._fakeModules.install(),performance.mark("code/extHost/didInitAPI"),await this._waitForDebuggerAttachment()}_getEntryPoint(e){return e.browser}async _loadCommonJSModule(e,t,i){t=t.with({path:xA(t.path,".js")});const n=e==null?void 0:e.identifier.value;n&&performance.mark(`code/extHost/willFetchExtensionCode/${n}`);const s=y.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(t)),o=await fetch(s.toString(!0));if(n&&performance.mark(`code/extHost/didFetchExtensionCode/${n}`),o.status!==200)throw new Error(o.statusText);const a=await o.text(),c=`${t.toString(!0)}#vscode-extension`,l=`${a}
//# sourceURL=${c}`;let u;try{u=new Function("module","exports","require",l)}catch(w){throw console.error(n?`Loading code for extension ${n} failed: ${w.message}`:`Loading code failed: ${w.message}`),console.error(`${t.toString(!0)}${typeof w.line=="number"?` line ${w.line}`:""}${typeof w.column=="number"?` column ${w.column}`:""}`),console.error(w),w}e&&await this._extHostLocalizationService.initializeLocalizedMessages(e);const d={},h={exports:d},g=w=>{const p=this._fakeModules.getModule(w,t);if(p===void 0)throw new Error(`Cannot load module '${w}'`);return p};try{return i.codeLoadingStart(),n&&performance.mark(`code/extHost/willLoadExtensionCode/${n}`),u(h,d,g),h.exports!==d?h.exports:d}finally{n&&performance.mark(`code/extHost/didLoadExtensionCode/${n}`),i.codeLoadingStop()}}async $setRemoteEnvironment(e){}async _waitForDebuggerAttachment(e=5e3){if(!this._initData.environment.isExtensionDevelopmentDebug)return;const t=Date.now()+e;for(;Date.now()<t&&!("__jsDebugIsReady"in globalThis);)await lr(10)}}function xA(r,e){return r.endsWith(e)?r:r+e}ot(Ir,yA,0),ot(wv,bv,0);const W0=self.close.bind(self);self.close=()=>console.trace("'close' has been blocked");const V0=postMessage.bind(self);self.postMessage=()=>console.trace("'postMessage' has been blocked");function z0(r){return/^(file|extension-file|vscode-remote):/i.test(r)}const j0=fetch.bind(self);function CA(r){self.fetch=async function(e,t){return e instanceof Request||z0(String(e))&&(e=(await r(y.parse(String(e)))).toString(!0)),j0(e,t)},self.XMLHttpRequest=class extends XMLHttpRequest{open(e,t,i,n,s){(async()=>(z0(t.toString())&&(t=(await r(y.parse(t.toString()))).toString(!0)),super.open(e,t,i??!0,n,s)))()}}}self.importScripts=()=>{throw new Error("'importScripts' has been blocked")},self.addEventListener=()=>console.trace("'addEventListener' has been blocked"),self.AMDLoader=void 0,self.NLSLoaderPlugin=void 0,self.define=void 0,self.require=void 0,self.webkitRequestFileSystem=void 0,self.webkitRequestFileSystemSync=void 0,self.webkitResolveLocalFileSystemSyncURL=void 0,self.webkitResolveLocalFileSystemURL=void 0;function SA(r,e){if(self.Worker){const t=self.Worker;Worker=function(i,n){if(/^vscode-remote:/i.test(i.toString()))throw new Error("Creating workers from remote extensions is currently not supported.");async function s(a){const[c,l]=await Promise.all([r(a).then(g=>g.toString(!0)),e().then(g=>Object.fromEntries(g.map(([w,p])=>[w.toString(!0),p.toString(!0)])))]),d=`(${(function(w,p){function b(C){return typeof C=="string"||C instanceof URL?(C=String(C).replace(/^file:\/\//i,"vscode-file://vscode-app"),p[C]??C):C}const k=fetch.bind(self);self.fetch=function(C,R){return C instanceof Request?k(C,R):k(b(C),R)},self.XMLHttpRequest=class extends XMLHttpRequest{constructor(){super(...arguments),this.notFound=!1}open(C,R,A,B,Q){const ee=b(R);return this.notFound=ee.startsWith("extension-file:"),super.open(C,ee,A??!0,B,Q)}send(C){this.notFound||super.send(C)}get status(){return this.notFound?404:super.status}};const D=importScripts.bind(self);self.importScripts=(...C)=>{D(...C.map(b))},self.importExt=C=>new Function("url","return import(url)")(b(C)),D(w)}).toString()}('${c}', ${JSON.stringify(l)}))`,h=new Blob([d],{type:"application/javascript"});return URL.createObjectURL(h)}n=n||{},n.name=`${name} -> ${n.name||ai(i.toString())}`;class o{constructor(c,l){this._onmessage=null,this._onmessageerror=null,this._onerror=null,this.workerPromise=s(y.parse(c instanceof URL?c.toString():c)).then(u=>new t(u,l))}set onmessage(c){this._onmessage=c,this.workerPromise.then(l=>{l.onmessage=c},console.error)}get onmessage(){return this._onmessage}set onmessageerror(c){this._onmessageerror=c,this.workerPromise.then(l=>{l.onmessageerror=c},console.error)}get onmessageerror(){return this._onmessageerror}set onerror(c){this._onerror=c,this.workerPromise.then(l=>{l.onerror=c},console.error)}get onerror(){return this._onerror}postMessage(c,l){this.workerPromise.then(u=>{u.postMessage(c,l)},console.error)}terminate(){this.workerPromise.then(c=>{c.terminate()},console.error)}addEventListener(c,l,u){this.workerPromise.then(d=>{d.addEventListener(c,l,u)},console.error)}removeEventListener(c,l,u){this.workerPromise.then(d=>{d.removeEventListener(c,l,u)},console.error)}dispatchEvent(c){return this.workerPromise.then(l=>{l.dispatchEvent(c)},console.error),!1}}return new o(i,n)}}else self.Worker=class extends MI{constructor(t,i){super(V0,t,{name:ai(t.toString()),...i})}}}const EA=new class{constructor(){this.pid=void 0}exit(r){W0()}};class kA{constructor(){const e=new MessageChannel,t=new T;let i=!1;V0(e.port2,[e.port2]),e.port1.onmessage=n=>{const{data:s}=n;if(!(s instanceof ArrayBuffer)){console.warn("UNKNOWN data received",s);return}const o=me.wrap(new Uint8Array(s,0,s.byteLength));if(TS(o,2)){i=!0,q0("received terminate message from renderer");return}t.fire(o)},this.protocol={onMessage:t.event,send:n=>{if(!i){const s=n.buffer.buffer.slice(n.buffer.byteOffset,n.buffer.byteOffset+n.buffer.byteLength);e.port1.postMessage(s,[s])}}}}}function DA(r){return new Promise(e=>{const t=r.onMessage(i=>{t.dispose();const n=JSON.parse(i.toString());r.send(db(0)),e({protocol:r,initData:n})});r.send(db(1))})}let q0=r=>W0();function IA(r){return!!r&&typeof r=="object"&&r.type==="vscode.init"&&r.data instanceof Map}function PA(){pi("code/extHost/willConnectToRenderer");const r=new kA;return{onmessage(e){IA(e)&&DA(r.protocol).then(t=>{pi("code/extHost/didWaitForInitData");const i=new jv(t.protocol,t.initData,EA,null,e.data);CA(n=>i.asBrowserUri(n)),SA(n=>i.asBrowserUri(n),()=>i.getAllStaticBrowserUris()),q0=n=>i.terminate(n)})}}}const TA=PA();globalThis.onmessage=r=>TA.onmessage(r.data)})();
//# sourceMappingURL=extensionHost.worker-dNAT2Dz7.js.map
